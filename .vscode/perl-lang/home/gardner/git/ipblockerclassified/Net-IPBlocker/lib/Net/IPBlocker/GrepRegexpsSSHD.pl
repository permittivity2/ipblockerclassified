{"vars":[{"definition":1,"name":"Net::IPBlocker::GrepRegexpsSSHD","line":2,"kind":2},{"kind":2,"line":4,"name":"strict","containerName":""},{"containerName":"","line":5,"name":"warnings","kind":2},{"kind":2,"line":6,"name":"Exporter","containerName":""},{"containerName":"Regexp","name":"IPv6","line":7,"kind":2},{"containerName":"Log","line":8,"name":"Any","kind":2},{"kind":2,"name":"threads","line":9,"containerName":""},{"kind":2,"containerName":"Data","name":"Dumper","line":10},{"kind":13,"containerName":null,"line":12,"name":"$Data"},{"name":"Dumper","line":12,"containerName":"Sortkeys","kind":12},{"line":13,"name":"$Data","containerName":null,"kind":13},{"containerName":"Indent","name":"Dumper","line":13,"kind":12},{"kind":13,"definition":"our","name":"@EXPORT_OK","line":15,"containerName":"Net::IPBlocker::GrepRegexpsSSHD"},{"kind":13,"localvar":"my","containerName":null,"name":"$logger","line":17,"definition":"my"},{"kind":13,"name":"$log","line":17,"containerName":null},{"kind":13,"localvar":"my","definition":"my","containerName":null,"name":"$REGEX_IPV4","line":18},{"kind":13,"localvar":"my","definition":"my","containerName":null,"name":"$REGEX_IPV6","line":19},{"detail":"($self,$log)","kind":12,"signature":{"documentation":"# FILEPATH: Untitled-1\n\npackage Net::IPBlocker::GrepRegexpsSSHD;\n\nuse strict;\nuse warnings;\nuse Exporter;\nuse Regexp::IPv6     qw($IPv6_re);\nuse Log::Any qw($log);  # Allegedly handles lots of different logging modules\nuse threads;\nuse Data::Dumper;\n\nlocal $Data::Dumper::Sortkeys = 1;\nlocal $Data::Dumper::Indent   = 1;\n\nour @EXPORT_OK = qw(grep_regexps);\n\nmy $logger = $log;\nmy $REGEX_IPV4 = q/\\b((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))\\b/;\nmy $REGEX_IPV6      = q/\\b($IPv6_re)\\b/;\n\n=head1 NAME\n\nNet::IPBlocker::GrepRegexpsDefault - Default regular expressions for IP blocking for sshd logs (auth.log)\n\n=head1 SYNOPSIS\n\nThis works with the Net::IPBlocker module to provide a framework for getting bad IPs from a ssh log file.\n\nThe calling code will always pass in the log object and the log contents.\n\nThe sshd log has two special items.  We don't want to add IPs to be blocked with special user names.  \nAlso, the sshd log is usually an auth log so we filter out lines that don't have sshd in them.\nBoth of these may be set in the configs file like this (as an example):\n\n logs_to_review[authlog][filterin][01] = \"sshd\"\n logs_to_review[authlog][filterin][02] = \"openssh\"\n logs_to_review[authlog][filterout][01] = \"sshd.*for johnboy\"\n logs_to_review[authlog][filterout][02] = \"sshd.*Accepted.*for trinity\"\n logs_to_review[authlog][filterout][03] = \"sshd.*Accepted.*for neo\"\n\n\n=head1 DESCRIPTION\n\nThis module provides a default regular expression sub for IP blocking. \nThese regular expressions can be used with the L<Net::IPBlocker> module to match and block IP addresses.\n\n=head1 METHODS\n\n=head2 get_regexps\n\nReturns an array of default regular expressions for IP blocking.\n\n    my @regexps = Net::IPBlocker::GrepRegexpsDefault->get_regexps();\n\n Description:  Using the logobj, this greps against the log contents for matching lines and then gets the\n               IP address on each line.\n Requires:     $self, $log\n Returns:      Hash reference of IP addresses with count of how many times the IP address was found","label":"grep_regexps($self,$log)","parameters":[{"label":"$self"},{"label":"$log"}]},"definition":"sub","children":[{"containerName":"grep_regexps","name":"$self","line":62,"definition":"my","localvar":"my","kind":13},{"containerName":"grep_regexps","name":"$log","line":62,"kind":13},{"definition":"my","containerName":"grep_regexps","line":63,"name":"$TID","localvar":"my","kind":13},{"kind":12,"name":"tid","line":63,"containerName":"grep_regexps"},{"kind":13,"line":64,"name":"$logger","containerName":"grep_regexps"},{"containerName":"grep_regexps","name":"debug","line":64,"kind":12},{"containerName":"grep_regexps","name":"$logger","line":66,"kind":13},{"line":66,"name":"debug","containerName":"grep_regexps","kind":12},{"kind":13,"containerName":"grep_regexps","line":66,"name":"$log"},{"definition":"my","containerName":"grep_regexps","name":"$matches","line":68,"kind":13,"localvar":"my"},{"definition":"my","containerName":"grep_regexps","line":69,"name":"@log_contents","localvar":"my","kind":13},{"kind":13,"line":69,"name":"$log","containerName":"grep_regexps"}],"containerName":"Net::IPBlocker::GrepRegexpsSSHD","line":61,"name":"grep_regexps","range":{"end":{"line":69,"character":9999},"start":{"line":61,"character":0}}},{"line":63,"name":"threads","kind":12},{"kind":12,"line":66,"name":"Dumper"},{"kind":12,"name":"logcontents","line":69},{"containerName":null,"line":71,"name":"$logger","kind":13},{"kind":12,"containerName":"Net::IPBlocker::GrepRegexpsSSHD","line":71,"name":"debug"},{"kind":12,"name":"Dumper","line":71},{"containerName":null,"line":71,"name":"@log_contents","kind":13},{"containerName":null,"name":"@log_contents","line":73,"kind":13},{"containerName":null,"line":75,"name":"$logger","kind":13},{"kind":12,"containerName":"Net::IPBlocker::GrepRegexpsSSHD","name":"info","line":75},{"containerName":null,"name":"@log_contents","line":75,"kind":13},{"definition":"my","containerName":null,"name":"$filterin","line":76,"localvar":"my","kind":13},{"containerName":null,"line":76,"name":"%log","kind":13},{"line":76,"name":"filterin","kind":12},{"localvar":"my","kind":13,"containerName":null,"line":77,"name":"$pattern","definition":"my"},{"containerName":null,"name":"%log","line":77,"kind":13},{"line":77,"name":"filterin","kind":12},{"name":"$filterin","line":77,"containerName":null,"kind":13},{"containerName":null,"name":"$logger","line":78,"kind":13},{"kind":12,"line":78,"name":"debug","containerName":"Net::IPBlocker::GrepRegexpsSSHD"},{"containerName":null,"line":80,"name":"@log_contents","kind":13},{"kind":13,"containerName":null,"line":80,"name":"@log_contents"},{"kind":13,"name":"$logger","line":82,"containerName":null},{"name":"info","line":82,"containerName":"Net::IPBlocker::GrepRegexpsSSHD","kind":12},{"kind":13,"line":82,"name":"@log_contents","containerName":null},{"kind":13,"localvar":"my","containerName":null,"name":"$filterout","line":84,"definition":"my"},{"containerName":null,"name":"%log","line":84,"kind":13},{"name":"filterout","line":84,"kind":12},{"localvar":"my","kind":13,"definition":"my","containerName":null,"name":"$pattern","line":85},{"containerName":null,"line":85,"name":"%log","kind":13},{"line":85,"name":"filterout","kind":12},{"kind":13,"name":"$filterout","line":85,"containerName":null},{"containerName":null,"line":86,"name":"$logger","kind":13},{"containerName":"Net::IPBlocker::GrepRegexpsSSHD","line":86,"name":"debug","kind":12},{"kind":13,"containerName":null,"line":88,"name":"@log_contents"},{"kind":13,"name":"@log_contents","line":88,"containerName":null},{"kind":13,"containerName":null,"name":"$logger","line":90},{"containerName":"Net::IPBlocker::GrepRegexpsSSHD","name":"info","line":90,"kind":12},{"kind":13,"name":"@log_contents","line":90,"containerName":null},{"kind":13,"localvar":"my","line":93,"name":"$regex","containerName":null,"definition":"my"},{"kind":13,"containerName":null,"name":"%log","line":93},{"kind":12,"name":"regexpdeny","line":93},{"name":"$pattern","line":94,"containerName":null,"definition":"my","localvar":"my","kind":13},{"containerName":null,"line":94,"name":"%log","kind":13},{"line":94,"name":"regexpdeny","kind":12},{"kind":13,"containerName":null,"name":"$regex","line":94},{"kind":13,"line":95,"name":"$logger","containerName":null},{"containerName":"Net::IPBlocker::GrepRegexpsSSHD","name":"debug","line":95,"kind":12},{"containerName":null,"line":97,"name":"@current_matches","definition":"my","localvar":"my","kind":13},{"containerName":null,"line":97,"name":"@log_contents","kind":13},{"line":98,"name":"$logger","containerName":null,"kind":13},{"containerName":"Net::IPBlocker::GrepRegexpsSSHD","name":"debug","line":98,"kind":12},{"line":98,"name":"Dumper","kind":12},{"line":98,"name":"@current_matches","containerName":null,"kind":13},{"kind":13,"name":"$logger","line":98,"containerName":null},{"name":"is_debug","line":98,"containerName":"Net::IPBlocker::GrepRegexpsSSHD","kind":12},{"definition":"my","containerName":null,"name":"$line","line":100,"kind":13,"localvar":"my"},{"containerName":null,"line":100,"name":"@current_matches","kind":13},{"name":"$line","line":101,"containerName":null,"kind":13},{"containerName":null,"line":102,"name":"$logger","kind":13},{"containerName":"Net::IPBlocker::GrepRegexpsSSHD","line":102,"name":"debug","kind":12},{"localvar":"my","kind":13,"definition":"my","name":"$ip_address","line":104,"containerName":null},{"line":104,"name":"$line","containerName":null,"kind":13},{"kind":13,"line":104,"name":"%line","containerName":null},{"name":"%matches","line":105,"containerName":null,"kind":13},{"name":"$ip_address","line":105,"containerName":null,"kind":13},{"kind":13,"containerName":null,"name":"$logger","line":106},{"name":"debug","line":106,"containerName":"Net::IPBlocker::GrepRegexpsSSHD","kind":12},{"line":111,"name":"$logger","containerName":null,"kind":13},{"kind":12,"containerName":"Net::IPBlocker::GrepRegexpsSSHD","line":111,"name":"debug"},{"kind":12,"name":"Dumper","line":111},{"line":111,"name":"$matches","containerName":null,"kind":13},{"name":"$logger","line":111,"containerName":null,"kind":13},{"containerName":"Net::IPBlocker::GrepRegexpsSSHD","line":111,"name":"is_debug","kind":12},{"definition":"my","containerName":null,"line":113,"name":"$log_msg","kind":13,"localvar":"my"},{"kind":13,"line":114,"name":"$log_msg","containerName":null},{"containerName":null,"name":"$matches","line":114,"kind":13},{"kind":13,"line":115,"name":"$logger","containerName":null},{"name":"debug","line":115,"containerName":"Net::IPBlocker::GrepRegexpsSSHD","kind":12},{"kind":13,"containerName":null,"line":115,"name":"$log_msg"},{"name":"$matches","line":117,"containerName":null,"kind":13},{"line":122,"name":"gdr","containerName":"Net::IPBlocker::GrepRegexpsSSHD","children":[],"definition":"sub","range":{"start":{"character":0,"line":122},"end":{"line":123,"character":9999}},"signature":{"documentation":" Description: This is the gosh darn retaliatory strike and attack method.  It will strike the malicious IP addresses\n              with a malformed tcp packet to the port that the malicious IP address was attacking.","parameters":[],"label":"gdr()"},"kind":12,"detail":"()"}],"version":5}