{"vars":[{"line":2,"definition":1,"kind":2,"name":"Net::IPBlocker::ReviewLogDefault"},{"containerName":"","line":4,"kind":2,"name":"strict"},{"kind":2,"line":5,"containerName":"","name":"warnings"},{"containerName":"","line":6,"kind":2,"name":"Exporter"},{"name":"IPv6","kind":2,"containerName":"Regexp","line":7},{"kind":2,"line":8,"containerName":"Log","name":"Any"},{"name":"threads","kind":2,"line":9,"containerName":""},{"name":"Dumper","line":10,"containerName":"Data","kind":2},{"name":"POSIX","line":11,"containerName":"","kind":2},{"kind":13,"containerName":null,"line":13,"name":"$Data"},{"name":"Dumper","kind":12,"containerName":"Sortkeys","line":13},{"name":"$Data","containerName":null,"line":14,"kind":13},{"kind":12,"containerName":"Indent","line":14,"name":"Dumper"},{"kind":13,"definition":"our","containerName":"Net::IPBlocker::ReviewLogDefault","line":17,"name":"@EXPORT_OK"},{"line":20,"containerName":null,"localvar":"my","definition":"my","kind":13,"name":"$logger"},{"name":"$log","kind":13,"line":20,"containerName":null},{"name":"$REGEX_IPV4","kind":13,"line":21,"containerName":null,"localvar":"my","definition":"my"},{"containerName":null,"line":22,"localvar":"my","definition":"my","name":"$REGEX_IPV6","kind":13},{"kind":13,"name":"%tracker","definition":"my","localvar":"my","line":23,"containerName":null},{"children":[{"containerName":"new","line":55,"localvar":"my","definition":"my","kind":13,"name":"$class"},{"line":56,"containerName":"new","localvar":"my","definition":"my","name":"$args","kind":13},{"name":"$TID","kind":13,"definition":"my","localvar":"my","containerName":"new","line":57},{"name":"tid","kind":12,"line":57,"containerName":"new"},{"kind":13,"name":"$self","containerName":"new","line":58,"localvar":"my","definition":"my"},{"name":"$args","containerName":"new","line":59,"kind":13},{"kind":13,"line":60,"containerName":"new","name":"$args"},{"kind":13,"containerName":"new","line":61,"name":"$args"},{"name":"$logger","kind":13,"line":64,"containerName":"new"},{"kind":12,"line":64,"containerName":"new","name":"info"},{"kind":13,"containerName":"new","line":65,"name":"$logger"},{"name":"debug","kind":12,"containerName":"new","line":65},{"kind":13,"containerName":"new","line":65,"name":"$self"},{"name":"$logger","containerName":"new","line":65,"kind":13},{"line":65,"containerName":"new","kind":12,"name":"is_debug"},{"name":"$args","kind":13,"containerName":"new","line":68},{"name":"$self","containerName":"new","line":70,"kind":13},{"line":70,"containerName":"new","kind":13,"name":"$class"},{"name":"$self","line":71,"containerName":"new","kind":13}],"name":"new","signature":{"documentation":"# FILEPATH: Untitled-1\n\npackage Net::IPBlocker::ReviewLogDefault;\n\nuse strict;\nuse warnings;\nuse Exporter;\nuse Regexp::IPv6     qw($IPv6_re);\nuse Log::Any qw($log);  # Allegedly handles lots of different logging modules\nuse threads;\nuse Data::Dumper;\nuse POSIX qw(LONG_MAX);\n\nlocal $Data::Dumper::Sortkeys = 1;\nlocal $Data::Dumper::Indent   = 1;\n\n\nour @EXPORT_OK = qw(grep_regexps);\n\n# \"Global\" variables\nmy $logger = $log;\nmy $REGEX_IPV4 = q/\\b((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))\\b/;\nmy $REGEX_IPV6      = q/\\b($IPv6_re)\\b/;\nmy $tracker = {};\n\n=head1 NAME\n\nNet::IPBlocker::GrepRegexpsDefault - Default regular expressions for IP blocking\n\n=head1 SYNOPSIS\n\n    This works with the Net::IPBlocker module to provide a default sub for regular expressions for IP blocking.\n    This is alos a framework that could be used to create other modules that provide default regular expressions for \n    IP Blocking of particular types of files such as Apache logs, Postfix logs, Auth logs, etc.\n\n    The calling code will always pass in the log object and the log contents.\n\n=head1 DESCRIPTION\n\nThis module provides a default regular expression sub for IP blocking. \nThese regular expressions can be used with the L<Net::IPBlocker> module to match and block IP addresses.\n\n=head1 METHODS\n\n=head2 new\n\nThis is the constructor for the module.  It is not required but is nice to have.\n\nThis sub is called after the module is successfully loaded as a sanity check.\n\n Description:  Constructor for the module\n Returns:      blessed reference","label":"new()","parameters":[]},"kind":12,"detail":"()","containerName":"Net::IPBlocker::ReviewLogDefault","line":54,"definition":"sub","range":{"start":{"line":54,"character":0},"end":{"character":9999,"line":72}}},{"name":"threads","kind":12,"line":57},{"line":59,"kind":12,"name":"parentobjself"},{"name":"parentobjself","kind":12,"line":59},{"line":60,"kind":12,"name":"logobj"},{"name":"logobj","line":60,"kind":12},{"line":61,"kind":12,"name":"configs"},{"name":"parentobjself","kind":12,"line":61},{"line":61,"kind":12,"name":"configs"},{"kind":12,"line":65,"name":"Dumper"},{"kind":12,"line":68,"name":"iptablesqueue_enqueue"},{"signature":{"parameters":[{"label":"$self"},{"label":"$log"}],"label":"grep_regexps($self,$log)","documentation":"# FILEPATH: Untitled-1\n\npackage Net::IPBlocker::ReviewLogDefault;\n\nuse strict;\nuse warnings;\nuse Exporter;\nuse Regexp::IPv6     qw($IPv6_re);\nuse Log::Any qw($log);  # Allegedly handles lots of different logging modules\nuse threads;\nuse Data::Dumper;\nuse POSIX qw(LONG_MAX);\n\nlocal $Data::Dumper::Sortkeys = 1;\nlocal $Data::Dumper::Indent   = 1;\n\n\nour @EXPORT_OK = qw(grep_regexps);\n\n# \"Global\" variables\nmy $logger = $log;\nmy $REGEX_IPV4 = q/\\b((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))\\b/;\nmy $REGEX_IPV6      = q/\\b($IPv6_re)\\b/;\nmy $tracker = {};\n\n=head1 NAME\n\nNet::IPBlocker::GrepRegexpsDefault - Default regular expressions for IP blocking\n\n=head1 SYNOPSIS\n\n    This works with the Net::IPBlocker module to provide a default sub for regular expressions for IP blocking.\n    This is alos a framework that could be used to create other modules that provide default regular expressions for \n    IP Blocking of particular types of files such as Apache logs, Postfix logs, Auth logs, etc.\n\n    The calling code will always pass in the log object and the log contents.\n\n=head1 DESCRIPTION\n\nThis module provides a default regular expression sub for IP blocking. \nThese regular expressions can be used with the L<Net::IPBlocker> module to match and block IP addresses.\n\n=head1 METHODS\n\n=head2 new\n\nThis is the constructor for the module.  It is not required but is nice to have.\n\nThis sub is called after the module is successfully loaded as a sanity check.\n\n\n# Description:  Constructor for the module\n# Returns:      blessed reference\nsub new() {\n    my $class = shift;\n    my $args  = shift;\n    my $TID = \"TID: \" . threads->tid;\n    my $self = {\n        parentobjself => $args->{parentobjself},\n        logobj        => $args->{logobj},\n        configs       => $args->{parentobjself}->{configs},\n    };\n\n    $logger->info(\"$TID|In new in \" . __PACKAGE__ . \" module\");\n    $logger->debug(\"$TID|Dumper of self: \" . Dumper($self)) if $logger->is_debug();\n\n    # Set the enqueue alias\n    *iptablesqueue_enqueue = $args->{iptablesqueue_enqueue};\n\n    bless $self, $class;  \n    return $self;\n} ## end sub new\n\n=head2 get_regexps\n\nReturns an array of default regular expressions for IP blocking.\n\n    my @regexps = Net::IPBlocker::GrepRegexpsDefault->get_regexps();\n\n Description:  Using the logobj, this greps against the log contents for matching lines and then gets the\n               IP address on each line.\n Requires:     $self, $log\n Returns:      Hash reference of IP addresses with count of how many times the IP address was found"},"kind":12,"children":[{"definition":"my","containerName":"grep_regexps","line":87,"localvar":"my","kind":13,"name":"$self"},{"kind":13,"containerName":"grep_regexps","line":87,"name":"$log"},{"name":"$TID","kind":13,"definition":"my","line":88,"containerName":"grep_regexps","localvar":"my"},{"kind":12,"containerName":"grep_regexps","line":88,"name":"tid"},{"name":"$logger","line":89,"containerName":"grep_regexps","kind":13},{"containerName":"grep_regexps","line":89,"kind":12,"name":"debug"},{"definition":"my","localvar":"my","containerName":"grep_regexps","line":91,"kind":13,"name":"$matches"},{"localvar":"my","containerName":"grep_regexps","line":92,"definition":"my","name":"@log_contents","kind":13},{"name":"$log","line":92,"containerName":"grep_regexps","kind":13}],"name":"grep_regexps","line":86,"containerName":"Net::IPBlocker::ReviewLogDefault","range":{"start":{"character":0,"line":86},"end":{"line":92,"character":9999}},"definition":"sub","detail":"($self,$log)"},{"name":"threads","kind":12,"line":88},{"kind":12,"line":92,"name":"logcontents"},{"line":94,"containerName":null,"kind":13,"name":"$matches"},{"name":"@log_contents","line":94,"containerName":null,"kind":13},{"kind":13,"name":"$epoch","definition":"my","line":97,"containerName":null,"localvar":"my"},{"kind":13,"name":"$regex","definition":"my","containerName":null,"line":98,"localvar":"my"},{"containerName":null,"line":98,"kind":13,"name":"%log"},{"name":"regexpdeny","line":98,"kind":12},{"localvar":"my","containerName":null,"line":99,"definition":"my","name":"$pattern","kind":13},{"name":"%log","containerName":null,"line":99,"kind":13},{"line":99,"kind":12,"name":"regexpdeny"},{"name":"$regex","kind":13,"line":99,"containerName":null},{"kind":13,"line":100,"containerName":null,"name":"$logger"},{"kind":12,"containerName":"Net::IPBlocker::ReviewLogDefault","line":100,"name":"debug"},{"definition":"my","localvar":"my","line":102,"containerName":null,"kind":13,"name":"@current_matches"},{"name":"@log_contents","containerName":null,"line":102,"kind":13},{"line":103,"containerName":null,"kind":13,"name":"$logger"},{"containerName":"Net::IPBlocker::ReviewLogDefault","line":103,"kind":12,"name":"debug"},{"line":103,"kind":12,"name":"Dumper"},{"containerName":null,"line":103,"kind":13,"name":"@current_matches"},{"line":103,"containerName":null,"kind":13,"name":"$logger"},{"name":"is_debug","line":103,"containerName":"Net::IPBlocker::ReviewLogDefault","kind":12},{"definition":"my","localvar":"my","line":105,"containerName":null,"kind":13,"name":"$line"},{"containerName":null,"line":105,"kind":13,"name":"@current_matches"},{"line":106,"containerName":null,"kind":13,"name":"$line"},{"name":"$logger","containerName":null,"line":107,"kind":13},{"name":"debug","containerName":"Net::IPBlocker::ReviewLogDefault","line":107,"kind":12},{"kind":13,"name":"$ip_address","localvar":"my","line":109,"containerName":null,"definition":"my"},{"line":109,"containerName":null,"kind":13,"name":"$line"},{"line":109,"containerName":null,"kind":13,"name":"%line"},{"containerName":null,"line":111,"kind":13,"name":"%tracker"},{"kind":12,"line":111,"name":"jailed"},{"line":111,"containerName":null,"kind":13,"name":"%ip_address"},{"name":"%tracker","kind":13,"containerName":null,"line":112},{"kind":12,"line":112,"name":"jailed"},{"name":"$ip_address","containerName":null,"line":112,"kind":13},{"name":"$epoch","kind":13,"line":112,"containerName":null},{"name":"%matches","line":113,"containerName":null,"kind":13},{"kind":13,"containerName":null,"line":113,"name":"%ip_address"},{"name":"count","kind":12,"line":113},{"name":"%matches","containerName":null,"line":114,"kind":13},{"line":114,"containerName":null,"kind":13,"name":"%ip_address"},{"kind":12,"line":114,"name":"logline"},{"name":"$line","kind":13,"containerName":null,"line":114},{"kind":13,"containerName":null,"line":115,"name":"$logger"},{"name":"debug","line":115,"containerName":"Net::IPBlocker::ReviewLogDefault","kind":12},{"containerName":null,"line":121,"kind":13,"name":"$logger"},{"kind":12,"containerName":"Net::IPBlocker::ReviewLogDefault","line":121,"name":"debug"},{"name":"Dumper","kind":12,"line":121},{"containerName":null,"line":121,"kind":13,"name":"$matches"},{"kind":13,"line":121,"containerName":null,"name":"$logger"},{"kind":12,"containerName":"Net::IPBlocker::ReviewLogDefault","line":121,"name":"is_debug"},{"localvar":"my","line":123,"containerName":null,"definition":"my","kind":13,"name":"$log_msg"},{"containerName":null,"line":124,"kind":13,"name":"$log_msg"},{"kind":13,"line":124,"containerName":null,"name":"$matches"},{"line":125,"containerName":null,"kind":13,"name":"$logger"},{"name":"info","containerName":"Net::IPBlocker::ReviewLogDefault","line":125,"kind":12},{"name":"$log_msg","line":125,"containerName":null,"kind":13},{"name":"$matches","kind":13,"line":127,"containerName":null},{"definition":"sub","range":{"end":{"character":9999,"line":146},"start":{"character":0,"line":135}},"containerName":"Net::IPBlocker::ReviewLogDefault","line":135,"detail":"($self,$logobj)","kind":12,"signature":{"label":"post_enqueue($self,$logobj)","parameters":[{"label":"$self"},{"label":"$logobj"}],"documentation":" Description:  A sub ran after the IPs have been enqueue'd for blocking\n               By default, this sub will track the IPs that have been enqueued and then after 30 minutes will delete the rule from iptables\n               Actually, this sub passes a delete rule to the iptablesqueue_enqueue sub\n Assumes:      $logobj has set $logobj->{enqueued} to rules that have been enqueued\n Requires:     $self, $logobj"},"name":"post_enqueue","children":[{"kind":13,"name":"$self","localvar":"my","containerName":"post_enqueue","line":136,"definition":"my"},{"name":"$logobj","kind":13,"containerName":"post_enqueue","line":136},{"definition":"my","localvar":"my","line":137,"containerName":"post_enqueue","name":"$TID","kind":13},{"kind":12,"line":137,"containerName":"post_enqueue","name":"tid"},{"name":"$jailtime","kind":13,"definition":"my","containerName":"post_enqueue","line":138,"localvar":"my"},{"kind":13,"containerName":"post_enqueue","line":138,"name":"$logobj"},{"containerName":"post_enqueue","line":138,"kind":13,"name":"$self"},{"containerName":"post_enqueue","line":139,"kind":13,"name":"$logger"},{"containerName":"post_enqueue","line":139,"kind":12,"name":"debug"},{"name":"$logger","containerName":"post_enqueue","line":141,"kind":13},{"containerName":"post_enqueue","line":141,"kind":12,"name":"debug"},{"kind":13,"line":141,"containerName":"post_enqueue","name":"$logobj"},{"line":141,"containerName":"post_enqueue","kind":13,"name":"$logger"},{"name":"is_debug","line":141,"containerName":"post_enqueue","kind":12},{"kind":13,"line":143,"containerName":"post_enqueue","name":"$logger"},{"containerName":"post_enqueue","line":143,"kind":12,"name":"debug"},{"containerName":"post_enqueue","line":143,"kind":13,"name":"$self"},{"name":"$logger","line":143,"containerName":"post_enqueue","kind":13},{"kind":12,"line":143,"containerName":"post_enqueue","name":"is_debug"},{"kind":13,"name":"$epoch","containerName":"post_enqueue","line":145,"localvar":"my","definition":"my"},{"name":"$jailedtime","kind":13,"definition":"my","localvar":"my","line":146,"containerName":"post_enqueue"},{"line":146,"containerName":"post_enqueue","kind":13,"name":"$tracker"}]},{"line":137,"kind":12,"name":"threads"},{"name":"jailtime","line":138,"kind":12},{"line":138,"kind":12,"name":"configs"},{"name":"jailtime","line":138,"kind":12},{"line":141,"kind":12,"name":"Dumper"},{"line":143,"kind":12,"name":"Dumper"},{"kind":12,"line":146,"name":"jailed"},{"line":147,"containerName":null,"kind":13,"name":"$logger"},{"kind":12,"containerName":"Net::IPBlocker::ReviewLogDefault","line":147,"name":"debug"},{"kind":13,"line":148,"containerName":null,"name":"$jailedtime"},{"name":"$jailtime","kind":13,"containerName":null,"line":148},{"kind":13,"containerName":null,"line":148,"name":"%epoch"},{"definition":"my","containerName":null,"line":149,"localvar":"my","name":"$rule","kind":13},{"line":149,"containerName":null,"kind":13,"name":"%tracker"},{"kind":12,"line":149,"name":"jailed"},{"name":"%jailedtime","kind":13,"containerName":null,"line":149},{"line":150,"containerName":null,"localvar":"my","definition":"my","name":"%args","kind":13},{"name":"options","kind":12,"line":150},{"name":"rule","kind":12,"line":150},{"name":"$rule","containerName":null,"line":150,"kind":13},{"containerName":null,"line":151,"kind":13,"name":"$self"},{"name":"iptablesqueue_enqueue","kind":12,"line":151,"containerName":"Net::IPBlocker::ReviewLogDefault"},{"name":"$args","line":151,"containerName":null,"kind":13},{"name":"$logger","kind":13,"containerName":null,"line":152},{"name":"info","kind":12,"line":152,"containerName":"Net::IPBlocker::ReviewLogDefault"},{"kind":13,"containerName":null,"line":154,"name":"%tracker"},{"name":"jailed","kind":12,"line":154},{"kind":12,"line":154,"name":"jailedtime"},{"kind":13,"line":155,"containerName":null,"name":"$logger"},{"line":155,"containerName":"Net::IPBlocker::ReviewLogDefault","kind":12,"name":"info"}],"version":5}