{"vars":[{"kind":2,"name":"Net::IPBlocker::GrepRegexpsMail","line":2,"definition":1},{"containerName":"","name":"strict","line":4,"kind":2},{"kind":2,"line":5,"name":"warnings","containerName":""},{"containerName":"","line":6,"name":"Exporter","kind":2},{"kind":2,"containerName":"Regexp","line":7,"name":"IPv6"},{"kind":2,"containerName":"Log","name":"Any","line":8},{"kind":2,"name":"threads","line":9,"containerName":""},{"containerName":"Data","line":10,"name":"Dumper","kind":2},{"kind":13,"containerName":null,"name":"$Data","line":12},{"containerName":"Sortkeys","line":12,"name":"Dumper","kind":12},{"kind":13,"containerName":null,"line":13,"name":"$Data"},{"name":"Dumper","line":13,"containerName":"Indent","kind":12},{"containerName":"Net::IPBlocker::GrepRegexpsMail","name":"@EXPORT_OK","line":15,"definition":"our","kind":13},{"definition":"my","containerName":null,"line":17,"name":"$logger","localvar":"my","kind":13},{"line":17,"name":"$log","containerName":null,"kind":13},{"kind":13,"localvar":"my","containerName":null,"line":18,"name":"$REGEX_IPV4","definition":"my"},{"kind":13,"localvar":"my","definition":"my","line":19,"name":"$REGEX_IPV6","containerName":null},{"detail":"($self,$log)","kind":12,"signature":{"parameters":[{"label":"$self"},{"label":"$log"}],"label":"grep_regexps($self,$log)","documentation":"# FILEPATH: Untitled-1\n\npackage Net::IPBlocker::GrepRegexpsMail;\n\nuse strict;\nuse warnings;\nuse Exporter;\nuse Regexp::IPv6     qw($IPv6_re);\nuse Log::Any qw($log);  # Allegedly handles lots of different logging modules\nuse threads;\nuse Data::Dumper;\n\nlocal $Data::Dumper::Sortkeys = 1;\nlocal $Data::Dumper::Indent   = 1;\n\nour @EXPORT_OK = qw(grep_regexps);\n\nmy $logger = $log;\nmy $REGEX_IPV4 = q/\\b((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))\\b/;\nmy $REGEX_IPV6      = q/\\b($IPv6_re)\\b/;\n\n=head1 NAME\n\nNet::IPBlocker::GrepRegexpsDefault - Default regular expressions for IP blocking\n\n=head1 SYNOPSIS\n\nThis works with the Net::IPBlocker module to provide a framework for getting bad IPs from a mail log file.\n\nThe calling code will always pass in the log object and the log contents.\n\n=head1 DESCRIPTION\n\nThis module provides a default regular expression sub for IP blocking. \nThese regular expressions can be used with the L<Net::IPBlocker> module to match and block IP addresses.\n\n=head1 METHODS\n\n=head2 get_regexps\n\nReturns an array of default regular expressions for IP blocking.\n\n    my @regexps = Net::IPBlocker::GrepRegexpsDefault->get_regexps();\n\n Description:  Using the logobj, this greps against the log contents for matching lines and then gets the\n               IP address on each line.\n Requires:     $self, $log\n Returns:      Hash reference of IP addresses with count of how many times the IP address was found"},"definition":"sub","children":[{"localvar":"my","kind":13,"containerName":"grep_regexps","name":"$self","line":51,"definition":"my"},{"line":51,"name":"$log","containerName":"grep_regexps","kind":13},{"definition":"my","name":"$TID","line":52,"containerName":"grep_regexps","localvar":"my","kind":13},{"name":"tid","line":52,"containerName":"grep_regexps","kind":12},{"line":53,"name":"$logger","containerName":"grep_regexps","kind":13},{"name":"debug","line":53,"containerName":"grep_regexps","kind":12},{"kind":13,"containerName":"grep_regexps","name":"$logger","line":55},{"kind":12,"containerName":"grep_regexps","line":55,"name":"debug"},{"name":"$log","line":55,"containerName":"grep_regexps","kind":13},{"containerName":"grep_regexps","name":"$matches","line":57,"definition":"my","localvar":"my","kind":13},{"kind":13,"localvar":"my","definition":"my","containerName":"grep_regexps","name":"@log_contents","line":58},{"line":58,"name":"$log","containerName":"grep_regexps","kind":13}],"containerName":"Net::IPBlocker::GrepRegexpsMail","name":"grep_regexps","line":50,"range":{"start":{"line":50,"character":0},"end":{"character":9999,"line":58}}},{"line":52,"name":"threads","kind":12},{"kind":12,"line":55,"name":"Dumper"},{"name":"logcontents","line":58,"kind":12},{"containerName":null,"line":60,"name":"$logger","kind":13},{"kind":12,"containerName":"Net::IPBlocker::GrepRegexpsMail","name":"debug","line":60},{"kind":12,"line":60,"name":"Dumper"},{"kind":13,"containerName":null,"line":60,"name":"@log_contents"},{"line":62,"name":"@log_contents","containerName":null,"kind":13},{"containerName":null,"line":65,"name":"$regex","definition":"my","localvar":"my","kind":13},{"containerName":null,"name":"%log","line":65,"kind":13},{"name":"regexpdeny","line":65,"kind":12},{"containerName":null,"name":"$pattern","line":66,"definition":"my","kind":13,"localvar":"my"},{"kind":13,"containerName":null,"line":66,"name":"%log"},{"kind":12,"line":66,"name":"regexpdeny"},{"containerName":null,"name":"$regex","line":66,"kind":13},{"name":"$logger","line":67,"containerName":null,"kind":13},{"name":"debug","line":67,"containerName":"Net::IPBlocker::GrepRegexpsMail","kind":12},{"containerName":null,"line":69,"name":"@current_matches","definition":"my","kind":13,"localvar":"my"},{"kind":13,"line":69,"name":"@log_contents","containerName":null},{"kind":13,"line":70,"name":"$logger","containerName":null},{"kind":12,"name":"debug","line":70,"containerName":"Net::IPBlocker::GrepRegexpsMail"},{"kind":12,"name":"Dumper","line":70},{"kind":13,"containerName":null,"name":"@current_matches","line":70},{"kind":13,"name":"$logger","line":70,"containerName":null},{"containerName":"Net::IPBlocker::GrepRegexpsMail","line":70,"name":"is_debug","kind":12},{"definition":"my","containerName":null,"line":72,"name":"$line","kind":13,"localvar":"my"},{"containerName":null,"name":"@current_matches","line":72,"kind":13},{"line":73,"name":"$line","containerName":null,"kind":13},{"kind":13,"containerName":null,"name":"$logger","line":74},{"kind":12,"line":74,"name":"debug","containerName":"Net::IPBlocker::GrepRegexpsMail"},{"localvar":"my","kind":13,"containerName":null,"name":"$ip_address","line":76,"definition":"my"},{"containerName":null,"name":"$line","line":76,"kind":13},{"line":76,"name":"%line","containerName":null,"kind":13},{"kind":13,"line":77,"name":"%matches","containerName":null},{"kind":13,"containerName":null,"line":77,"name":"$ip_address"},{"kind":13,"name":"$logger","line":78,"containerName":null},{"containerName":"Net::IPBlocker::GrepRegexpsMail","line":78,"name":"debug","kind":12},{"kind":13,"containerName":null,"line":83,"name":"$logger"},{"containerName":"Net::IPBlocker::GrepRegexpsMail","line":83,"name":"debug","kind":12},{"kind":12,"line":83,"name":"Dumper"},{"kind":13,"line":83,"name":"$matches","containerName":null},{"containerName":null,"line":83,"name":"$logger","kind":13},{"containerName":"Net::IPBlocker::GrepRegexpsMail","name":"is_debug","line":83,"kind":12},{"definition":"my","name":"$log_msg","line":85,"containerName":null,"kind":13,"localvar":"my"},{"containerName":null,"name":"$log_msg","line":86,"kind":13},{"kind":13,"name":"$matches","line":86,"containerName":null},{"containerName":null,"name":"$logger","line":87,"kind":13},{"containerName":"Net::IPBlocker::GrepRegexpsMail","name":"debug","line":87,"kind":12},{"kind":13,"containerName":null,"line":87,"name":"$log_msg"},{"line":89,"name":"$matches","containerName":null,"kind":13},{"definition":"sub","children":[],"containerName":"Net::IPBlocker::GrepRegexpsMail","line":94,"name":"gdr","range":{"end":{"line":95,"character":9999},"start":{"line":94,"character":0}},"detail":"()","kind":12,"signature":{"documentation":" Description: This is the gosh darn retaliatory strike and attack method.  It will strike the malicious IP addresses\n              with a malformed tcp packet to the port that the malicious IP address was attacking.","parameters":[],"label":"gdr()"}},{"range":{"start":{"character":0,"line":97},"end":{"line":104,"character":9999}},"children":[{"kind":13,"localvar":"my","definition":"my","line":98,"name":"$self","containerName":"test"},{"name":"$TID","line":99,"containerName":"test","definition":"my","localvar":"my","kind":13},{"kind":12,"line":99,"name":"tid","containerName":"test"},{"name":"$logger","line":101,"containerName":"test","kind":13},{"name":"debug","line":101,"containerName":"test","kind":12},{"name":"$logger","line":102,"containerName":"test","kind":13},{"kind":12,"line":102,"name":"debug","containerName":"test"},{"kind":13,"containerName":"test","line":102,"name":"$self"}],"definition":"sub","line":97,"name":"test","containerName":"Net::IPBlocker::GrepRegexpsMail","detail":"()","signature":{"label":"test()","parameters":[],"documentation":""},"kind":12},{"line":99,"name":"threads","kind":12},{"kind":12,"name":"Dumper","line":102}],"version":5}