{"vars":[{"definition":1,"name":"Net::IPBlocker::GrepRegexpsMail","kind":2,"line":2},{"containerName":"","name":"strict","kind":2,"line":4},{"containerName":"","kind":2,"line":5,"name":"warnings"},{"containerName":"","name":"Exporter","line":6,"kind":2},{"line":7,"kind":2,"name":"IPv6","containerName":"Regexp"},{"line":8,"kind":2,"name":"Any","containerName":"Log"},{"containerName":"","line":9,"kind":2,"name":"threads"},{"containerName":"Data","line":10,"kind":2,"name":"Dumper"},{"containerName":null,"name":"$Data","kind":13,"line":12},{"containerName":"Sortkeys","line":12,"kind":12,"name":"Dumper"},{"line":13,"kind":13,"name":"$Data","containerName":null},{"name":"Dumper","kind":12,"line":13,"containerName":"Indent"},{"definition":"our","name":"@EXPORT_OK","kind":13,"line":15,"containerName":"Net::IPBlocker::GrepRegexpsMail"},{"containerName":null,"line":17,"localvar":"my","definition":"my","name":"$logger","kind":13},{"containerName":null,"name":"$log","line":17,"kind":13},{"containerName":null,"line":18,"definition":"my","name":"$REGEX_IPV4","localvar":"my","kind":13},{"localvar":"my","name":"$REGEX_IPV6","definition":"my","line":19,"containerName":null,"kind":13},{"children":[{"line":51,"localvar":"my","name":"$self","definition":"my","containerName":"grep_regexps","kind":13},{"name":"$log","line":51,"kind":13,"containerName":"grep_regexps"},{"line":52,"localvar":"my","definition":"my","name":"$TID","containerName":"grep_regexps","kind":13},{"containerName":"grep_regexps","kind":12,"line":52,"name":"tid"},{"name":"$logger","kind":13,"line":53,"containerName":"grep_regexps"},{"line":53,"kind":12,"name":"debug","containerName":"grep_regexps"},{"name":"$logger","kind":13,"line":55,"containerName":"grep_regexps"},{"containerName":"grep_regexps","name":"debug","line":55,"kind":12},{"line":55,"kind":13,"name":"$log","containerName":"grep_regexps"},{"name":"$matches","definition":"my","localvar":"my","line":57,"containerName":"grep_regexps","kind":13},{"containerName":"grep_regexps","line":58,"localvar":"my","name":"@log_contents","definition":"my","kind":13},{"kind":13,"line":58,"name":"$log","containerName":"grep_regexps"}],"detail":"($self,$log)","containerName":"Net::IPBlocker::GrepRegexpsMail","line":50,"definition":"sub","name":"grep_regexps","signature":{"parameters":[{"label":"$self"},{"label":"$log"}],"documentation":"# FILEPATH: Untitled-1\n\npackage Net::IPBlocker::GrepRegexpsMail;\n\nuse strict;\nuse warnings;\nuse Exporter;\nuse Regexp::IPv6     qw($IPv6_re);\nuse Log::Any qw($log);  # Allegedly handles lots of different logging modules\nuse threads;\nuse Data::Dumper;\n\nlocal $Data::Dumper::Sortkeys = 1;\nlocal $Data::Dumper::Indent   = 1;\n\nour @EXPORT_OK = qw(grep_regexps);\n\nmy $logger = $log;\nmy $REGEX_IPV4 = q/\\b((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))\\b/;\nmy $REGEX_IPV6      = q/\\b($IPv6_re)\\b/;\n\n=head1 NAME\n\nNet::IPBlocker::GrepRegexpsDefault - Default regular expressions for IP blocking\n\n=head1 SYNOPSIS\n\nThis works with the Net::IPBlocker module to provide a framework for getting bad IPs from a mail log file.\n\nThe calling code will always pass in the log object and the log contents.\n\n=head1 DESCRIPTION\n\nThis module provides a default regular expression sub for IP blocking. \nThese regular expressions can be used with the L<Net::IPBlocker> module to match and block IP addresses.\n\n=head1 METHODS\n\n=head2 get_regexps\n\nReturns an array of default regular expressions for IP blocking.\n\n    my @regexps = Net::IPBlocker::GrepRegexpsDefault->get_regexps();\n\n Description:  Using the logobj, this greps against the log contents for matching lines and then gets the\n               IP address on each line.\n Requires:     $self, $log\n Returns:      Hash reference of IP addresses with count of how many times the IP address was found","label":"grep_regexps($self,$log)"},"range":{"start":{"line":50,"character":0},"end":{"line":58,"character":9999}},"kind":12},{"line":52,"kind":12,"name":"threads"},{"name":"Dumper","line":55,"kind":12},{"line":58,"kind":12,"name":"logcontents"},{"containerName":null,"name":"$logger","line":60,"kind":13},{"containerName":"Net::IPBlocker::GrepRegexpsMail","line":60,"kind":12,"name":"debug"},{"kind":12,"line":60,"name":"Dumper"},{"containerName":null,"kind":13,"line":60,"name":"@log_contents"},{"name":"@log_contents","line":62,"kind":13,"containerName":null},{"containerName":null,"line":65,"localvar":"my","definition":"my","name":"$regex","kind":13},{"line":65,"kind":13,"name":"%log","containerName":null},{"line":65,"kind":12,"name":"regexpdeny"},{"kind":13,"line":66,"localvar":"my","definition":"my","name":"$pattern","containerName":null},{"name":"%log","kind":13,"line":66,"containerName":null},{"name":"regexpdeny","kind":12,"line":66},{"containerName":null,"kind":13,"line":66,"name":"$regex"},{"line":67,"kind":13,"name":"$logger","containerName":null},{"name":"debug","kind":12,"line":67,"containerName":"Net::IPBlocker::GrepRegexpsMail"},{"kind":13,"containerName":null,"line":69,"name":"@current_matches","definition":"my","localvar":"my"},{"name":"@log_contents","line":69,"kind":13,"containerName":null},{"containerName":null,"kind":13,"line":70,"name":"$logger"},{"containerName":"Net::IPBlocker::GrepRegexpsMail","kind":12,"line":70,"name":"debug"},{"line":70,"kind":12,"name":"Dumper"},{"containerName":null,"line":70,"kind":13,"name":"@current_matches"},{"name":"$logger","kind":13,"line":70,"containerName":null},{"containerName":"Net::IPBlocker::GrepRegexpsMail","line":70,"kind":12,"name":"is_debug"},{"containerName":null,"line":72,"name":"$line","definition":"my","localvar":"my","kind":13},{"name":"@current_matches","line":72,"kind":13,"containerName":null},{"name":"$line","kind":13,"line":73,"containerName":null},{"containerName":null,"kind":13,"line":74,"name":"$logger"},{"line":74,"kind":12,"name":"debug","containerName":"Net::IPBlocker::GrepRegexpsMail"},{"containerName":null,"line":76,"name":"$ip_address","definition":"my","localvar":"my","kind":13},{"containerName":null,"name":"$line","kind":13,"line":76},{"containerName":null,"line":76,"kind":13,"name":"%line"},{"kind":13,"line":77,"name":"%matches","containerName":null},{"line":77,"kind":13,"name":"$ip_address","containerName":null},{"containerName":null,"name":"$logger","kind":13,"line":78},{"name":"debug","kind":12,"line":78,"containerName":"Net::IPBlocker::GrepRegexpsMail"},{"containerName":null,"line":83,"kind":13,"name":"$logger"},{"kind":12,"line":83,"name":"debug","containerName":"Net::IPBlocker::GrepRegexpsMail"},{"kind":12,"line":83,"name":"Dumper"},{"line":83,"kind":13,"name":"$matches","containerName":null},{"name":"$logger","line":83,"kind":13,"containerName":null},{"kind":12,"line":83,"name":"is_debug","containerName":"Net::IPBlocker::GrepRegexpsMail"},{"kind":13,"containerName":null,"line":85,"definition":"my","name":"$log_msg","localvar":"my"},{"line":86,"kind":13,"name":"$log_msg","containerName":null},{"containerName":null,"name":"$matches","kind":13,"line":86},{"kind":13,"line":87,"name":"$logger","containerName":null},{"kind":12,"line":87,"name":"debug","containerName":"Net::IPBlocker::GrepRegexpsMail"},{"containerName":null,"line":87,"kind":13,"name":"$log_msg"},{"line":89,"kind":13,"name":"$matches","containerName":null},{"name":"gdr","definition":"sub","line":94,"containerName":"Net::IPBlocker::GrepRegexpsMail","detail":"()","children":[],"kind":12,"range":{"end":{"line":95,"character":9999},"start":{"character":0,"line":94}},"signature":{"label":"gdr()","documentation":" Description: This is the gosh darn retaliatory strike and attack method.  It will strike the malicious IP addresses\n              with a malformed tcp packet to the port that the malicious IP address was attacking.","parameters":[]}},{"children":[{"kind":13,"definition":"my","name":"$self","localvar":"my","line":98,"containerName":"test"},{"kind":13,"containerName":"test","name":"$TID","definition":"my","localvar":"my","line":99},{"containerName":"test","name":"tid","line":99,"kind":12},{"line":101,"kind":13,"name":"$logger","containerName":"test"},{"containerName":"test","name":"debug","line":101,"kind":12},{"line":102,"kind":13,"name":"$logger","containerName":"test"},{"name":"debug","kind":12,"line":102,"containerName":"test"},{"containerName":"test","name":"$self","line":102,"kind":13}],"containerName":"Net::IPBlocker::GrepRegexpsMail","detail":"()","line":97,"definition":"sub","name":"test","signature":{"label":"test()","parameters":[],"documentation":""},"kind":12,"range":{"start":{"character":0,"line":97},"end":{"line":104,"character":9999}}},{"name":"threads","line":99,"kind":12},{"name":"Dumper","kind":12,"line":102}],"version":5}