{"vars":[{"kind":2,"definition":1,"name":"Net::IPBlocker::GrepRegexpsMail","line":2},{"kind":2,"containerName":"","line":4,"name":"strict"},{"kind":2,"name":"warnings","line":5,"containerName":""},{"containerName":"","line":6,"name":"Exporter","kind":2},{"kind":2,"containerName":"Regexp","line":7,"name":"IPv6"},{"containerName":"Log","line":8,"name":"Any","kind":2},{"line":9,"name":"threads","containerName":"","kind":2},{"containerName":"Data","line":10,"name":"Dumper","kind":2},{"kind":13,"containerName":null,"line":12,"name":"$Data"},{"kind":12,"name":"Dumper","line":12,"containerName":"Sortkeys"},{"line":13,"name":"$Data","containerName":null,"kind":13},{"containerName":"Indent","line":13,"name":"Dumper","kind":12},{"kind":13,"definition":"our","name":"@EXPORT_OK","line":15,"containerName":"Net::IPBlocker::GrepRegexpsMail"},{"definition":"my","containerName":null,"line":17,"name":"$logger","localvar":"my","kind":13},{"containerName":null,"line":17,"name":"$log","kind":13},{"kind":13,"localvar":"my","containerName":null,"name":"$REGEX_IPV4","line":18,"definition":"my"},{"kind":13,"localvar":"my","name":"$REGEX_IPV6","line":19,"containerName":null,"definition":"my"},{"detail":"($self,$log)","signature":{"documentation":"# FILEPATH: Untitled-1\n\npackage Net::IPBlocker::GrepRegexpsMail;\n\nuse strict;\nuse warnings;\nuse Exporter;\nuse Regexp::IPv6     qw($IPv6_re);\nuse Log::Any qw($log);  # Allegedly handles lots of different logging modules\nuse threads;\nuse Data::Dumper;\n\nlocal $Data::Dumper::Sortkeys = 1;\nlocal $Data::Dumper::Indent   = 1;\n\nour @EXPORT_OK = qw(grep_regexps);\n\nmy $logger = $log;\nmy $REGEX_IPV4 = q/\\b((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))\\b/;\nmy $REGEX_IPV6      = q/\\b($IPv6_re)\\b/;\n\n=head1 NAME\n\nNet::IPBlocker::GrepRegexpsDefault - Default regular expressions for IP blocking\n\n=head1 SYNOPSIS\n\nThis works with the Net::IPBlocker module to provide a framework for getting bad IPs from a mail log file.\n\nThe calling code will always pass in the log object and the log contents.\n\n=head1 DESCRIPTION\n\nThis module provides a default regular expression sub for IP blocking. \nThese regular expressions can be used with the L<Net::IPBlocker> module to match and block IP addresses.\n\n=head1 METHODS\n\n=head2 get_regexps\n\nReturns an array of default regular expressions for IP blocking.\n\n    my @regexps = Net::IPBlocker::GrepRegexpsDefault->get_regexps();\n\n Description:  Using the logobj, this greps against the log contents for matching lines and then gets the\n               IP address on each line.\n Requires:     $self, $log\n Returns:      Hash reference of IP addresses with count of how many times the IP address was found","parameters":[{"label":"$self"},{"label":"$log"}],"label":"grep_regexps($self,$log)"},"kind":12,"children":[{"localvar":"my","kind":13,"definition":"my","containerName":"grep_regexps","name":"$self","line":51},{"containerName":"grep_regexps","line":51,"name":"$log","kind":13},{"kind":13,"localvar":"my","definition":"my","line":52,"name":"$TID","containerName":"grep_regexps"},{"name":"tid","line":52,"containerName":"grep_regexps","kind":12},{"containerName":"grep_regexps","name":"$logger","line":53,"kind":13},{"kind":12,"containerName":"grep_regexps","name":"debug","line":53},{"kind":13,"line":55,"name":"$logger","containerName":"grep_regexps"},{"kind":12,"line":55,"name":"debug","containerName":"grep_regexps"},{"containerName":"grep_regexps","line":55,"name":"$log","kind":13},{"localvar":"my","kind":13,"definition":"my","containerName":"grep_regexps","name":"$matches","line":57},{"definition":"my","containerName":"grep_regexps","line":58,"name":"@log_contents","kind":13,"localvar":"my"},{"kind":13,"line":58,"name":"$log","containerName":"grep_regexps"}],"definition":"sub","line":50,"name":"grep_regexps","containerName":"Net::IPBlocker::GrepRegexpsMail","range":{"start":{"line":50,"character":0},"end":{"character":9999,"line":58}}},{"name":"threads","line":52,"kind":12},{"kind":12,"name":"Dumper","line":55},{"kind":12,"line":58,"name":"logcontents"},{"kind":13,"line":60,"name":"$logger","containerName":null},{"kind":12,"name":"debug","line":60,"containerName":"Net::IPBlocker::GrepRegexpsMail"},{"kind":12,"line":60,"name":"Dumper"},{"name":"@log_contents","line":60,"containerName":null,"kind":13},{"name":"@log_contents","line":62,"containerName":null,"kind":13},{"line":65,"name":"$regex","containerName":null,"definition":"my","kind":13,"localvar":"my"},{"kind":13,"containerName":null,"line":65,"name":"%log"},{"kind":12,"name":"regexpdeny","line":65},{"definition":"my","containerName":null,"line":66,"name":"$pattern","kind":13,"localvar":"my"},{"line":66,"name":"%log","containerName":null,"kind":13},{"kind":12,"line":66,"name":"regexpdeny"},{"kind":13,"line":66,"name":"$regex","containerName":null},{"containerName":null,"name":"$logger","line":67,"kind":13},{"kind":12,"containerName":"Net::IPBlocker::GrepRegexpsMail","name":"debug","line":67},{"name":"@current_matches","line":69,"containerName":null,"definition":"my","localvar":"my","kind":13},{"kind":13,"containerName":null,"name":"@log_contents","line":69},{"name":"$logger","line":70,"containerName":null,"kind":13},{"kind":12,"containerName":"Net::IPBlocker::GrepRegexpsMail","name":"debug","line":70},{"kind":12,"line":70,"name":"Dumper"},{"containerName":null,"name":"@current_matches","line":70,"kind":13},{"containerName":null,"name":"$logger","line":70,"kind":13},{"kind":12,"name":"is_debug","line":70,"containerName":"Net::IPBlocker::GrepRegexpsMail"},{"definition":"my","containerName":null,"line":72,"name":"$line","localvar":"my","kind":13},{"name":"@current_matches","line":72,"containerName":null,"kind":13},{"kind":13,"containerName":null,"name":"$line","line":73},{"kind":13,"containerName":null,"line":74,"name":"$logger"},{"kind":12,"containerName":"Net::IPBlocker::GrepRegexpsMail","name":"debug","line":74},{"name":"$ip_address","line":76,"containerName":null,"definition":"my","localvar":"my","kind":13},{"containerName":null,"line":76,"name":"$line","kind":13},{"kind":13,"containerName":null,"line":76,"name":"%line"},{"kind":13,"name":"%matches","line":77,"containerName":null},{"kind":13,"containerName":null,"name":"$ip_address","line":77},{"containerName":null,"line":78,"name":"$logger","kind":13},{"containerName":"Net::IPBlocker::GrepRegexpsMail","name":"debug","line":78,"kind":12},{"name":"$logger","line":83,"containerName":null,"kind":13},{"containerName":"Net::IPBlocker::GrepRegexpsMail","name":"debug","line":83,"kind":12},{"name":"Dumper","line":83,"kind":12},{"kind":13,"containerName":null,"line":83,"name":"$matches"},{"kind":13,"name":"$logger","line":83,"containerName":null},{"name":"is_debug","line":83,"containerName":"Net::IPBlocker::GrepRegexpsMail","kind":12},{"localvar":"my","kind":13,"line":85,"name":"$log_msg","containerName":null,"definition":"my"},{"kind":13,"name":"$log_msg","line":86,"containerName":null},{"kind":13,"line":86,"name":"$matches","containerName":null},{"kind":13,"line":87,"name":"$logger","containerName":null},{"kind":12,"containerName":"Net::IPBlocker::GrepRegexpsMail","name":"debug","line":87},{"containerName":null,"line":87,"name":"$log_msg","kind":13},{"kind":13,"name":"$matches","line":89,"containerName":null},{"detail":"()","signature":{"label":"gdr()","parameters":[],"documentation":" Description: This is the gosh darn retaliatory strike and attack method.  It will strike the malicious IP addresses\n              with a malformed tcp packet to the port that the malicious IP address was attacking."},"kind":12,"children":[],"definition":"sub","line":94,"name":"gdr","containerName":"Net::IPBlocker::GrepRegexpsMail","range":{"start":{"character":0,"line":94},"end":{"character":9999,"line":95}}}],"version":5}