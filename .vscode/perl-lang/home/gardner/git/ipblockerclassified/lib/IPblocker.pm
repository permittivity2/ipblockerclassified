{"vars":[{"containerName":"","name":"POSIX","kind":2,"line":53},{"name":"strict","kind":2,"containerName":"","line":54},{"line":55,"containerName":"","name":"DateTime","kind":2},{"containerName":"File","name":"Basename","kind":2,"line":56},{"kind":2,"name":"strict","containerName":"","line":60},{"kind":2,"name":"HiRes","containerName":"Time","line":61},{"line":67,"containerName":"Config","kind":2,"name":"File"},{"line":68,"kind":2,"name":"Carp","containerName":""},{"kind":2,"name":"Log4perl","containerName":"Log","line":69},{"containerName":"Data","name":"Dumper","kind":2,"line":70},{"line":71,"kind":2,"name":"IPv6","containerName":"Regexp"},{"line":72,"containerName":"LockFile","name":"Simple","kind":2},{"line":73,"containerName":"File","name":"Path","kind":2},{"name":"Wrapper","kind":2,"containerName":"Net::Ifconfig","line":74},{"line":77,"name":"threads","kind":2,"containerName":""},{"kind":2,"name":"Queue","containerName":"Thread","line":80},{"containerName":null,"localvar":"my","definition":"my","line":81,"name":"$DataQueue","kind":13},{"line":81,"containerName":"Queue","kind":12,"name":"Thread"},{"line":81,"containerName":"main::","name":"new","kind":12},{"localvar":"my","containerName":null,"kind":13,"name":"$LoggerTIDS","line":82,"definition":"my"},{"localvar":"my","containerName":null,"definition":"my","line":85,"name":"$IptablesQueue","kind":13},{"kind":12,"name":"Thread","containerName":"Queue","line":85},{"containerName":"main::","name":"new","kind":12,"line":85},{"localvar":"my","containerName":null,"kind":13,"name":"$IptablesTIDS","line":86,"definition":"my"},{"line":89,"kind":13,"name":"$Data","containerName":null},{"line":89,"containerName":"Sortkeys","kind":12,"name":"Dumper"},{"line":90,"kind":13,"name":"$Data","containerName":null},{"containerName":"Indent","name":"Dumper","kind":12,"line":90},{"containerName":null,"localvar":"my","kind":13,"name":"$logger","definition":"my","line":97},{"name":"$lock_obj","kind":13,"line":100,"definition":"my","localvar":"my","containerName":null},{"containerName":null,"localvar":"my","kind":13,"name":"$REGEX_IPV4","definition":"my","line":105},{"localvar":"my","containerName":null,"name":"$REGEX_IPV6","kind":13,"line":107,"definition":"my"},{"containerName":null,"localvar":"my","kind":13,"name":"%DEFAULTS","line":108,"definition":"my"},{"line":109,"name":"allowdeny","kind":12},{"line":110,"name":"allowlist","kind":12},{"line":111,"name":"configsfile","kind":12},{"line":112,"name":"cycles","kind":12},{"name":"LONG_MAX","kind":12,"line":112},{"line":113,"name":"cyclesleep","kind":12},{"name":"dumpconfigsandexit","kind":12,"line":114},{"kind":12,"name":"denylist","line":115},{"name":"forceremovelockfile","kind":12,"line":116},{"line":117,"kind":12,"name":"globalallowlist"},{"name":"globalchain","kind":12,"line":118},{"kind":12,"name":"globalchains","line":122},{"line":123,"name":"globaldenylist","kind":12},{"kind":12,"name":"globalregexallowlist","line":124},{"line":125,"kind":12,"name":"globalregexdenylist"},{"kind":12,"name":"ignoreinterfaceips","line":126},{"name":"iptables","kind":12,"line":127},{"kind":12,"name":"lockfile","line":128},{"line":129,"kind":12,"name":"log4perlconf"},{"name":"loglevel","kind":12,"line":130},{"line":134,"kind":12,"name":"logcontents"},{"name":"logs_to_review","kind":12,"line":135},{"kind":12,"name":"logwatch_interval","line":136},{"line":137,"name":"prodmode","kind":12},{"name":"queuechecktime","kind":12,"line":138},{"line":139,"name":"queuecycles","kind":12},{"line":139,"kind":12,"name":"LONG_MAX"},{"name":"readentirefile","kind":12,"line":140},{"line":149,"definition":"sub","detail":"()","kind":12,"name":"new","children":[{"containerName":"new","localvar":"my","name":"$class","kind":13,"definition":"my","line":150},{"kind":13,"name":"$args","line":151,"definition":"my","localvar":"my","containerName":"new"},{"containerName":"new","kind":13,"name":"$args","line":153},{"line":155,"containerName":"new","kind":13,"name":"$args"},{"kind":13,"name":"$args","containerName":"new","line":157},{"containerName":"new","localvar":"my","kind":13,"name":"$configsfile","line":162,"definition":"my"},{"name":"$args","kind":13,"containerName":"new","line":162},{"line":162,"containerName":"new","kind":13,"name":"$DEFAULTS"},{"line":164,"definition":"my","kind":13,"name":"$self","localvar":"my","containerName":"new"},{"line":165,"kind":13,"name":"$configsfile","containerName":"new"},{"containerName":"new","kind":13,"name":"$args","line":166},{"containerName":"new","kind":13,"name":"$self","line":170},{"line":170,"containerName":"new","name":"$class","kind":13},{"line":174,"containerName":"new","name":"$self","kind":13},{"line":174,"name":"load_configs","kind":12,"containerName":"new"},{"line":176,"kind":13,"name":"$self","containerName":"new"},{"containerName":"new","kind":13,"name":"$self","line":178},{"line":179,"containerName":"new","kind":13,"name":"$self"},{"line":180,"kind":13,"name":"$self","containerName":"new"},{"line":182,"kind":13,"name":"$self","containerName":"new"},{"line":187,"name":"$logger","kind":13,"containerName":"new"},{"line":187,"name":"$self","kind":13,"containerName":"new"},{"name":"setup_Logger","kind":12,"containerName":"new","line":187},{"kind":13,"name":"$logger","containerName":"new","line":188},{"name":"info","kind":12,"containerName":"new","line":188},{"containerName":"new","kind":13,"name":"$logger","line":189},{"line":189,"containerName":"new","name":"debug","kind":12},{"line":189,"name":"$self","kind":13,"containerName":"new"},{"line":189,"name":"$logger","kind":13,"containerName":"new"},{"kind":12,"name":"is_debug","containerName":"new","line":189},{"kind":13,"name":"$self","containerName":"new","line":191}],"range":{"start":{"line":149,"character":0},"end":{"character":9999,"line":192}},"containerName":"main::","signature":{"parameters":[],"documentation":"#### Subs below here #####\n Reads configs, logging configs, sets up logging, sets up a class and returns a blessed object\n   The sub go() is where the action starts","label":"new()"}},{"kind":12,"name":"carp","line":154},{"line":158,"name":"croak","kind":12},{"kind":12,"name":"configsfile","line":162},{"line":162,"name":"configsfile","kind":12},{"line":165,"kind":12,"name":"configsfile"},{"line":166,"kind":12,"name":"clargs"},{"kind":12,"name":"configs","line":176},{"kind":12,"name":"dumpconfigsandexit","line":176},{"name":"configs","kind":12,"line":178},{"name":"configsfile","kind":12,"line":178},{"line":179,"name":"configs","kind":12},{"line":179,"kind":12,"name":"globalchain"},{"name":"configs","kind":12,"line":180},{"line":180,"name":"dumpconfigsandexit","kind":12},{"line":182,"name":"recursiveHashPrint","kind":12},{"line":182,"kind":12,"name":"configs"},{"line":189,"name":"Dumper","kind":12},{"kind":12,"name":"recursiveHashPrint","detail":"($ref,$prefix)","line":195,"definition":"sub","containerName":"main::","signature":{"label":"recursiveHashPrint($ref,$prefix)","documentation":"# Recursive sub to print out a hash to STDOUT in a manner that matches \"use Config::File;\"","parameters":[{"label":"$ref"},{"label":"$prefix"}]},"children":[{"line":196,"definition":"my","kind":13,"name":"$ref","containerName":"recursiveHashPrint","localvar":"my"},{"line":196,"name":"$prefix","kind":13,"containerName":"recursiveHashPrint"},{"line":197,"name":"$prefix","kind":13,"containerName":"recursiveHashPrint"},{"line":197,"name":"$prefix","kind":13,"containerName":"recursiveHashPrint"},{"line":199,"containerName":"recursiveHashPrint","kind":13,"name":"$ref"},{"containerName":"recursiveHashPrint","localvar":"my","kind":13,"name":"$key","definition":"my","line":200},{"line":200,"containerName":"recursiveHashPrint","kind":13,"name":"$ref"},{"line":203,"definition":"my","name":"$new_prefix","kind":13,"containerName":"recursiveHashPrint","localvar":"my"},{"line":203,"kind":13,"name":"$prefix","containerName":"recursiveHashPrint"},{"line":204,"containerName":"recursiveHashPrint","kind":13,"name":"$ref"},{"line":204,"kind":13,"name":"$key","containerName":"recursiveHashPrint"},{"line":204,"kind":13,"name":"$new_prefix","containerName":"recursiveHashPrint"}],"range":{"start":{"line":195,"character":0},"end":{"character":9999,"line":206}}},{"containerName":null,"name":"%ref","kind":13,"line":207},{"containerName":null,"localvar":"my","name":"$line","kind":13,"line":210,"definition":"my"},{"line":210,"kind":13,"name":"$ref","containerName":null},{"line":211,"kind":13,"name":"$line","containerName":null},{"line":212,"containerName":null,"kind":13,"name":"$line"},{"line":213,"containerName":null,"kind":13,"name":"%line"},{"kind":13,"name":"$line","line":217,"definition":"my","localvar":"my","containerName":null},{"name":"$line","kind":13,"containerName":null,"line":218},{"line":219,"containerName":null,"name":"$line","kind":13},{"line":220,"name":"$line","kind":13,"containerName":null},{"range":{"start":{"line":224,"character":0},"end":{"character":9999,"line":255}},"children":[{"name":"$self","kind":13,"line":225,"definition":"my","containerName":"iptables_thread","localvar":"my"},{"localvar":"my","containerName":"iptables_thread","name":"$TID","kind":13,"line":226,"definition":"my"},{"name":"tid","kind":12,"containerName":"iptables_thread","line":226},{"line":227,"kind":13,"name":"$TID","containerName":"iptables_thread"},{"line":227,"name":"$TID","kind":13,"containerName":"iptables_thread"},{"line":229,"kind":13,"name":"$logger","containerName":"iptables_thread"},{"line":229,"containerName":"iptables_thread","name":"info","kind":12},{"name":"$iptablesQueue_pending","kind":13,"definition":"my","line":232,"localvar":"my","containerName":"iptables_thread"},{"name":"$IptablesQueue","kind":13,"containerName":"iptables_thread","line":232},{"kind":12,"name":"pending","containerName":"iptables_thread","line":232},{"containerName":"iptables_thread","kind":13,"name":"$iptablesQueue_pending","line":233},{"line":234,"definition":"my","kind":13,"name":"$logmsg","containerName":"iptables_thread","localvar":"my"},{"containerName":"iptables_thread","kind":13,"name":"$logmsg","line":235},{"kind":13,"name":"$logger","containerName":"iptables_thread","line":236},{"line":236,"containerName":"iptables_thread","kind":12,"name":"info"},{"kind":13,"name":"$logmsg","containerName":"iptables_thread","line":236},{"containerName":"iptables_thread","name":"$iptablesQueue_pending","kind":13,"line":240},{"containerName":"iptables_thread","kind":13,"name":"$logger","line":241},{"containerName":"iptables_thread","kind":12,"name":"info","line":241},{"name":"$data","kind":13,"definition":"my","line":242,"localvar":"my","containerName":"iptables_thread"},{"line":242,"containerName":"iptables_thread","kind":13,"name":"$IptablesQueue"},{"line":242,"kind":12,"name":"dequeue","containerName":"iptables_thread"},{"kind":13,"name":"$logger","containerName":"iptables_thread","line":243},{"containerName":"iptables_thread","kind":12,"name":"debug","line":243},{"kind":13,"name":"$data","containerName":"iptables_thread","line":243},{"line":243,"name":"$logger","kind":13,"containerName":"iptables_thread"},{"kind":12,"name":"is_debug","containerName":"iptables_thread","line":243},{"line":244,"containerName":"iptables_thread","kind":13,"name":"$self"},{"containerName":"iptables_thread","name":"run_iptables","kind":12,"line":244},{"line":244,"kind":13,"name":"$data","containerName":"iptables_thread"},{"containerName":"iptables_thread","kind":13,"name":"$logger","line":244},{"containerName":"iptables_thread","name":"error","kind":12,"line":244},{"line":244,"name":"$data","kind":13,"containerName":"iptables_thread"},{"kind":13,"name":"$iptablesQueue_pending","containerName":"iptables_thread","line":246},{"line":247,"name":"$logger","kind":13,"containerName":"iptables_thread"},{"line":247,"kind":12,"name":"info","containerName":"iptables_thread"},{"kind":13,"name":"$logger","containerName":"iptables_thread","line":251},{"name":"error","kind":12,"containerName":"iptables_thread","line":251}],"signature":{"documentation":"","label":"iptables_thread()","parameters":[]},"containerName":"main::","line":224,"definition":"sub","name":"iptables_thread","kind":12,"detail":"()"},{"kind":12,"name":"threads","line":226},{"line":243,"kind":12,"name":"Dumper"},{"line":244,"name":"Dumper","kind":12},{"detail":"()","name":"go","kind":12,"line":262,"definition":"sub","containerName":"main::","signature":{"documentation":" Creates two initial threads:\n   One for iptables commands to run.\n   Another to watch the log files\n       This in turn creates a thread for each log file to watch\n Also starts running the DataQueue queue which handles the data","label":"go()","parameters":[]},"children":[{"kind":13,"name":"$self","line":263,"definition":"my","containerName":"go","localvar":"my"},{"containerName":"go","kind":13,"name":"$self","line":266},{"containerName":"go","kind":13,"name":"$logger","line":267},{"line":267,"containerName":"go","name":"error","kind":12},{"line":272,"containerName":"go","name":"$self","kind":13},{"line":273,"containerName":"go","name":"$self","kind":13},{"name":"set_iptables_command","kind":12,"containerName":"go","line":273},{"line":273,"name":"$logger","kind":13,"containerName":"go"},{"line":273,"containerName":"go","name":"error","kind":12},{"line":274,"containerName":"go","kind":13,"name":"$self"},{"line":274,"containerName":"go","kind":12,"name":"set_signal_handler"},{"containerName":"go","kind":13,"name":"$self","line":275},{"line":275,"containerName":"go","kind":12,"name":"set_lockFile"},{"line":275,"containerName":"go","name":"$logger","kind":13},{"kind":12,"name":"logdie","containerName":"go","line":275},{"name":"$iptables_thr","kind":13,"definition":"my","line":279,"localvar":"my","containerName":"go"},{"line":279,"containerName":"go","name":"create","kind":12},{"kind":13,"name":"$self","containerName":"go","line":279},{"line":282,"containerName":"go","kind":13,"name":"$self"},{"containerName":"go","name":"add_global_chains_to_input_output","kind":12,"line":282},{"kind":13,"name":"$logger","containerName":"go","line":283},{"containerName":"go","kind":12,"name":"logdie","line":283},{"line":287,"containerName":"go","name":"$logger","kind":13},{"containerName":"go","kind":12,"name":"logdie","line":287},{"line":287,"kind":13,"name":"$self","containerName":"go"},{"kind":12,"name":"logger_thread","containerName":"go","line":287},{"name":"$self","kind":13,"containerName":"go","line":295},{"line":295,"name":"dataQueue_runner","kind":12,"containerName":"go"}],"range":{"start":{"line":262,"character":0},"end":{"character":9999,"line":296}}},{"kind":12,"name":"configs","line":266},{"name":"logs_to_review","kind":12,"line":266},{"kind":12,"name":"run_iptables_line","line":272},{"name":"threads","kind":12,"line":279},{"signature":{"label":"add_ifconfig_ips_to_allowlist()","documentation":" Description:  Adds IPs on the local interfaces to the global allowlist\n  This does not work becasue it onkly handles IPv4 addresses","parameters":[]},"containerName":"main::","range":{"start":{"line":300,"character":0},"end":{"character":9999,"line":328}},"children":[{"kind":13,"name":"$self","definition":"my","line":301,"localvar":"my","containerName":"add_ifconfig_ips_to_allowlist"}],"detail":"()","name":"add_ifconfig_ips_to_allowlist","kind":12,"line":300,"definition":"sub"},{"detail":"()","kind":12,"name":"dataQueue_runner","line":330,"definition":"sub","signature":{"documentation":"","label":"dataQueue_runner()","parameters":[]},"containerName":"main::","range":{"start":{"character":0,"line":330},"end":{"character":9999,"line":370}},"children":[{"kind":13,"name":"$self","definition":"my","line":331,"containerName":"dataQueue_runner","localvar":"my"},{"kind":13,"name":"$TID","line":332,"definition":"my","localvar":"my","containerName":"dataQueue_runner"},{"line":332,"name":"tid","kind":12,"containerName":"dataQueue_runner"},{"line":333,"kind":13,"name":"$TID","containerName":"dataQueue_runner"},{"kind":13,"name":"$TID","containerName":"dataQueue_runner","line":333},{"containerName":"dataQueue_runner","name":"$Data","kind":13,"line":335},{"kind":13,"name":"$Data","containerName":"dataQueue_runner","line":336},{"line":338,"name":"$logger","kind":13,"containerName":"dataQueue_runner"},{"name":"info","kind":12,"containerName":"dataQueue_runner","line":338},{"localvar":"my","containerName":"dataQueue_runner","line":339,"definition":"my","kind":13,"name":"$queuechecktime"},{"line":339,"name":"$self","kind":13,"containerName":"dataQueue_runner"},{"localvar":"my","containerName":"dataQueue_runner","line":340,"definition":"my","kind":13,"name":"$queuecycles"},{"line":340,"name":"$self","kind":13,"containerName":"dataQueue_runner"},{"localvar":"my","containerName":"dataQueue_runner","definition":"my","line":343,"kind":13,"name":"$dataqueue_pending"},{"line":343,"containerName":"dataQueue_runner","name":"$DataQueue","kind":13},{"name":"pending","kind":12,"containerName":"dataQueue_runner","line":343},{"line":344,"containerName":"dataQueue_runner","name":"$dataqueue_pending","kind":13},{"kind":13,"name":"$logger","containerName":"dataQueue_runner","line":345},{"line":345,"containerName":"dataQueue_runner","name":"info","kind":12},{"line":349,"containerName":"dataQueue_runner","name":"$dataqueue_pending","kind":13},{"line":350,"name":"$logger","kind":13,"containerName":"dataQueue_runner"},{"line":350,"name":"info","kind":12,"containerName":"dataQueue_runner"},{"name":"$data","kind":13,"line":351,"definition":"my","containerName":"dataQueue_runner","localvar":"my"},{"line":351,"kind":13,"name":"$DataQueue","containerName":"dataQueue_runner"},{"line":351,"kind":12,"name":"dequeue","containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","kind":13,"name":"$logger","line":353},{"containerName":"dataQueue_runner","kind":12,"name":"debug","line":353},{"name":"$data","kind":13,"containerName":"dataQueue_runner","line":353},{"line":353,"kind":13,"name":"$logger","containerName":"dataQueue_runner"},{"name":"is_debug","kind":12,"containerName":"dataQueue_runner","line":353},{"containerName":"dataQueue_runner","kind":13,"name":"$dataqueue_pending","line":355},{"line":356,"definition":"my","name":"$logmsg","kind":13,"localvar":"my","containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","kind":13,"name":"$logmsg","line":357},{"line":358,"kind":13,"name":"$logger","containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","kind":12,"name":"info","line":358},{"containerName":"dataQueue_runner","name":"$logmsg","kind":13,"line":358},{"line":359,"name":"$queuecycles","kind":13,"containerName":"dataQueue_runner"},{"name":"$queuecycles","kind":13,"containerName":"dataQueue_runner","line":360},{"kind":13,"name":"$queuechecktime","containerName":"dataQueue_runner","line":361},{"containerName":"dataQueue_runner","name":"$logger","kind":13,"line":364},{"name":"error","kind":12,"containerName":"dataQueue_runner","line":364},{"line":369,"name":"$logger","kind":13,"containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","kind":12,"name":"info","line":369}]},{"kind":12,"name":"threads","line":332},{"containerName":"Terse","name":"Dumper","kind":12,"line":335},{"kind":12,"name":"Dumper","containerName":"Indent","line":336},{"line":339,"kind":12,"name":"configs"},{"line":339,"kind":12,"name":"queuechecktime"},{"line":340,"kind":12,"name":"configs"},{"name":"queuecycles","kind":12,"line":340},{"kind":12,"name":"Dumper","line":353},{"line":376,"definition":"sub","kind":12,"name":"setup_Logger","detail":"()","range":{"end":{"line":401,"character":9999},"start":{"line":376,"character":0}},"children":[{"localvar":"my","containerName":"setup_Logger","line":377,"definition":"my","kind":13,"name":"$self"},{"line":380,"definition":"my","name":"$log4perlconf","kind":13,"localvar":"my","containerName":"setup_Logger"},{"containerName":"setup_Logger","kind":13,"name":"$self","line":380},{"containerName":"setup_Logger","localvar":"my","line":381,"definition":"my","kind":13,"name":"$logwatch_interval"},{"containerName":"setup_Logger","name":"$self","kind":13,"line":381},{"line":382,"containerName":"setup_Logger","name":"init_and_watch","kind":12},{"line":382,"containerName":"setup_Logger","name":"$log4perlconf","kind":13},{"containerName":"setup_Logger","name":"$logwatch_interval","kind":13,"line":382},{"containerName":"setup_Logger","name":"easy_init","kind":12,"line":386},{"containerName":"setup_Logger","kind":13,"name":"$Log","line":386},{"name":"$logger","kind":13,"containerName":"setup_Logger","line":388},{"line":389,"kind":13,"name":"$self","containerName":"setup_Logger"},{"containerName":"setup_Logger","name":"$logger","kind":13,"line":390},{"name":"level","kind":12,"containerName":"setup_Logger","line":390},{"containerName":"setup_Logger","name":"$self","kind":13,"line":390},{"line":391,"kind":13,"name":"$logger","containerName":"setup_Logger"},{"line":391,"containerName":"setup_Logger","kind":12,"name":"info"},{"kind":13,"name":"$logger","containerName":"setup_Logger","line":391},{"line":391,"containerName":"setup_Logger","kind":12,"name":"level"},{"line":398,"containerName":"setup_Logger","name":"$logger","kind":13},{"line":398,"containerName":"setup_Logger","kind":12,"name":"info"},{"containerName":"setup_Logger","name":"$logger","kind":13,"line":400}],"containerName":"main::","signature":{"label":"setup_Logger()","documentation":" Assumptions:\n   $self->{configs}->{log4perlconf} is set\n   $self->{configs}->{logwatch_interval} is set\n These assumptions *should* be true because this is called from new()","parameters":[]}},{"name":"configs","kind":12,"line":380},{"line":380,"name":"log4perlconf","kind":12},{"name":"configs","kind":12,"line":381},{"line":381,"name":"logwatch_interval","kind":12},{"kind":12,"name":"Log","containerName":"Log4perl","line":382},{"name":"carp","kind":12,"line":384},{"line":385,"name":"carp","kind":12},{"line":386,"name":"Log","kind":12,"containerName":"Log4perl"},{"line":386,"kind":12,"name":"Log4perl","containerName":"DEBUG"},{"name":"get_logger","kind":12,"line":388},{"line":388,"name":"croak","kind":12},{"line":389,"name":"configs","kind":12},{"name":"loglevel","kind":12,"line":389},{"line":390,"name":"configs","kind":12},{"name":"loglevel","kind":12,"line":390},{"line":405,"definition":"sub","name":"set_lockFile","kind":12,"detail":"()","range":{"start":{"character":0,"line":405},"end":{"character":9999,"line":447}},"children":[{"definition":"my","line":406,"name":"$self","kind":13,"containerName":"set_lockFile","localvar":"my"},{"kind":13,"name":"$self","containerName":"set_lockFile","line":408},{"line":409,"containerName":"set_lockFile","name":"$logger","kind":13},{"line":409,"name":"logdie","kind":12,"containerName":"set_lockFile"},{"definition":"my","line":412,"kind":13,"name":"$lockfile","localvar":"my","containerName":"set_lockFile"},{"kind":13,"name":"$self","containerName":"set_lockFile","line":412},{"kind":13,"name":"$lf","line":415,"definition":"my","localvar":"my","containerName":"set_lockFile"},{"line":415,"containerName":"set_lockFile","name":"$self","kind":13},{"containerName":"set_lockFile","name":"$logger","kind":13,"line":416},{"name":"debug","kind":12,"containerName":"set_lockFile","line":416},{"name":"$lf","kind":13,"containerName":"set_lockFile","line":418},{"line":419,"containerName":"set_lockFile","name":"$self","kind":13},{"containerName":"set_lockFile","kind":13,"name":"$logger","line":420},{"kind":12,"name":"info","containerName":"set_lockFile","line":420},{"containerName":"set_lockFile","kind":13,"name":"$lf","line":421},{"kind":13,"name":"$logger","containerName":"set_lockFile","line":421},{"line":421,"containerName":"set_lockFile","name":"logdie","kind":12},{"containerName":"set_lockFile","localvar":"my","line":424,"definition":"my","name":"$fh","kind":13},{"line":424,"name":"$lf","kind":13,"containerName":"set_lockFile"},{"containerName":"set_lockFile","kind":13,"name":"$logger","line":424},{"containerName":"set_lockFile","kind":12,"name":"logdie","line":424},{"containerName":"set_lockFile","localvar":"my","line":425,"definition":"my","kind":13,"name":"@contents"},{"name":"$fh","kind":13,"containerName":"set_lockFile","line":425},{"containerName":"set_lockFile","name":"$fh","kind":13,"line":426},{"containerName":"set_lockFile","name":"@contents","kind":13,"line":427},{"name":"$printable_contents","kind":13,"line":428,"definition":"my","containerName":"set_lockFile","localvar":"my"},{"containerName":"set_lockFile","name":"@contents","kind":13,"line":428},{"kind":13,"name":"$logmsg","definition":"my","line":429,"containerName":"set_lockFile","localvar":"my"},{"line":430,"containerName":"set_lockFile","kind":13,"name":"$logger"},{"line":430,"containerName":"set_lockFile","kind":12,"name":"info"},{"containerName":"set_lockFile","kind":13,"name":"$logmsg","line":430},{"containerName":"set_lockFile","name":"$lf","kind":13,"line":434},{"containerName":"set_lockFile","name":"$logger","kind":13,"line":434},{"containerName":"set_lockFile","name":"logdie","kind":12,"line":434},{"containerName":"set_lockFile","name":"$self","kind":13,"line":437},{"line":437,"kind":12,"name":"make","containerName":"set_lockFile"},{"line":440,"name":"$logger","kind":13,"containerName":"set_lockFile"},{"line":440,"containerName":"set_lockFile","kind":12,"name":"debug"},{"name":"$self","kind":13,"containerName":"set_lockFile","line":440},{"containerName":"set_lockFile","kind":13,"name":"$logger","line":440},{"line":440,"containerName":"set_lockFile","kind":12,"name":"is_debug"},{"kind":13,"name":"$self","containerName":"set_lockFile","line":441},{"name":"$self","kind":13,"containerName":"set_lockFile","line":441},{"line":441,"name":"lock","kind":12,"containerName":"set_lockFile"},{"line":441,"containerName":"set_lockFile","name":"$lf","kind":13},{"containerName":"set_lockFile","kind":13,"name":"$logger","line":442},{"name":"logdie","kind":12,"containerName":"set_lockFile","line":442},{"line":443,"containerName":"set_lockFile","kind":13,"name":"$lock_obj"},{"containerName":"set_lockFile","name":"$self","kind":13,"line":443},{"name":"$logger","kind":13,"containerName":"set_lockFile","line":445},{"containerName":"set_lockFile","name":"info","kind":12,"line":445}],"containerName":"main::","signature":{"parameters":[],"documentation":" Set lock file\n   Returns 1 if lock file is set, otherwise returns 0","label":"set_lockFile()"}},{"name":"configs","kind":12,"line":408},{"kind":12,"name":"lockfile","line":408},{"line":412,"name":"configs","kind":12},{"name":"lockfile","kind":12,"line":412},{"name":"configs","kind":12,"line":415},{"line":415,"name":"lockfile","kind":12},{"line":419,"kind":12,"name":"configs"},{"line":419,"name":"forceremovelockfile","kind":12},{"line":437,"kind":12,"name":"lockmgr"},{"name":"LockFile","kind":12,"containerName":"Simple","line":437},{"line":440,"kind":12,"name":"Dumper"},{"kind":12,"name":"lockmgr","line":440},{"kind":12,"name":"lock","line":441},{"line":441,"kind":12,"name":"lockmgr"},{"line":443,"kind":12,"name":"lock"},{"containerName":"main::","signature":{"parameters":[],"documentation":"# Description: Creates a thread for each log file to review\n# Returns 1 or dies if thread can not be created","label":"logger_thread()"},"children":[{"containerName":"logger_thread","localvar":"my","name":"$self","kind":13,"line":452,"definition":"my"},{"kind":13,"name":"$logstoreview","definition":"my","line":454,"localvar":"my","containerName":"logger_thread"},{"name":"$self","kind":13,"containerName":"logger_thread","line":454},{"line":455,"containerName":"logger_thread","name":"$logstoreview","kind":13},{"line":458,"definition":"my","name":"$logtoreview","kind":13,"localvar":"my","containerName":"logger_thread"},{"kind":13,"name":"$logstoreview","containerName":"logger_thread","line":458}],"range":{"start":{"line":451,"character":0},"end":{"line":458,"character":9999}},"kind":12,"name":"logger_thread","detail":"()","definition":"sub","line":451},{"name":"configs","kind":12,"line":454},{"line":454,"name":"logs_to_review","kind":12},{"containerName":null,"kind":13,"name":"$logger","line":459},{"name":"info","kind":12,"containerName":"main::","line":459},{"localvar":"my","containerName":null,"name":"$logobj","kind":13,"definition":"my","line":460},{"containerName":null,"kind":13,"name":"%logstoreview","line":460},{"name":"$logtoreview","kind":13,"containerName":null,"line":460},{"containerName":null,"kind":13,"name":"%logobj","line":461},{"line":461,"name":"chain","kind":12},{"containerName":null,"name":"$logtoreview","kind":13,"line":461},{"containerName":null,"localvar":"my","name":"$thr","kind":13,"line":463,"definition":"my"},{"line":463,"kind":12,"name":"threads"},{"line":463,"containerName":"main::","kind":12,"name":"create"},{"name":"review_log","kind":12,"line":463},{"line":463,"name":"$self","kind":13,"containerName":null},{"line":463,"containerName":null,"kind":13,"name":"$logobj"},{"line":463,"kind":13,"name":"$logger","containerName":null},{"kind":12,"name":"logdie","containerName":"main::","line":463},{"containerName":null,"name":"$LoggerTIDS","kind":13,"line":464},{"line":464,"kind":13,"name":"$thr","containerName":null},{"kind":12,"name":"tid","containerName":"main::","line":464},{"line":465,"name":"$logger","kind":13,"containerName":null},{"containerName":"main::","name":"debug","kind":12,"line":465},{"name":"$thr","kind":13,"containerName":null,"line":465},{"containerName":"main::","name":"tid","kind":12,"line":465},{"name":"$logger","kind":13,"containerName":null,"line":465},{"line":465,"containerName":"main::","name":"is_debug","kind":12},{"kind":13,"name":"$logger","containerName":null,"line":466},{"line":466,"containerName":"main::","name":"debug","kind":12},{"kind":13,"name":"$thr","containerName":null,"line":466},{"line":466,"containerName":"main::","kind":12,"name":"tid"},{"kind":13,"name":"$thr","containerName":null,"line":466},{"name":"is_running","kind":12,"containerName":"main::","line":466},{"name":"$logger","kind":13,"containerName":null,"line":466},{"kind":12,"name":"is_debug","containerName":"main::","line":466},{"containerName":"main::","signature":{"documentation":" This is called as a thread and runs a loop to check the log file for new entries\n   Prior to checking the log file, it creates a chain for the log file and adds it to the global chain","label":"review_log()","parameters":[]},"range":{"start":{"character":0,"line":476},"end":{"character":9999,"line":548}},"children":[{"line":477,"definition":"my","kind":13,"name":"$self","containerName":"review_log","localvar":"my"},{"line":477,"name":"$logobj","kind":13,"containerName":"review_log"},{"kind":13,"name":"$logobj","containerName":"review_log","line":479},{"containerName":"review_log","localvar":"my","name":"$TID","kind":13,"line":480,"definition":"my"},{"kind":12,"name":"tid","containerName":"review_log","line":480},{"containerName":"review_log","kind":13,"name":"$TID","line":481},{"containerName":"review_log","name":"$TID","kind":13,"line":481},{"line":483,"name":"$logger","kind":13,"containerName":"review_log"},{"kind":12,"name":"debug","containerName":"review_log","line":483},{"line":483,"containerName":"review_log","name":"$logobj","kind":13},{"line":483,"name":"$logger","kind":13,"containerName":"review_log"},{"line":483,"kind":12,"name":"is_debug","containerName":"review_log"},{"kind":13,"name":"$logobj","containerName":"review_log","line":486},{"containerName":"review_log","kind":13,"name":"$self","line":486},{"localvar":"my","containerName":"review_log","definition":"my","line":487,"name":"$cycles","kind":13},{"kind":13,"name":"$logobj","containerName":"review_log","line":487},{"kind":13,"name":"$logobj","containerName":"review_log","line":488},{"kind":13,"name":"$self","containerName":"review_log","line":488},{"kind":13,"name":"$cyclesleep","line":489,"definition":"my","containerName":"review_log","localvar":"my"},{"containerName":"review_log","name":"$logobj","kind":13,"line":489},{"name":"$cyclesleep","kind":13,"containerName":"review_log","line":490},{"line":490,"containerName":"review_log","name":"$cyclesleep","kind":13},{"line":492,"name":"$logger","kind":13,"containerName":"review_log"},{"line":492,"name":"info","kind":12,"containerName":"review_log"},{"containerName":"review_log","localvar":"my","name":"$chain","kind":13,"definition":"my","line":499},{"line":499,"containerName":"review_log","name":"$logobj","kind":13},{"line":500,"kind":13,"name":"$logger","containerName":"review_log"},{"containerName":"review_log","name":"info","kind":12,"line":500},{"line":501,"name":"$self","kind":13,"containerName":"review_log"},{"kind":12,"name":"create_iptables_chain","containerName":"review_log","line":501},{"containerName":"review_log","kind":13,"name":"$chain","line":501},{"containerName":"review_log","kind":13,"name":"$logger","line":504},{"kind":12,"name":"info","containerName":"review_log","line":504},{"localvar":"my","containerName":"review_log","kind":13,"name":"$table","definition":"my","line":505},{"containerName":"review_log","localvar":"my","definition":"my","line":506,"kind":13,"name":"$args"},{"containerName":"review_log","name":"$logger","kind":13,"line":510},{"name":"info","kind":12,"containerName":"review_log","line":510},{"line":511,"name":"$self","kind":13,"containerName":"review_log"},{"line":511,"containerName":"review_log","name":"iptablesqueue_enqueue","kind":12},{"containerName":"review_log","kind":13,"name":"$args","line":511},{"containerName":"review_log","name":"$cycles","kind":13,"line":514},{"line":515,"name":"$logger","kind":13,"containerName":"review_log"},{"containerName":"review_log","kind":12,"name":"info","line":515},{"line":516,"kind":13,"name":"$logobj","containerName":"review_log"},{"containerName":"review_log","name":"$self","kind":13,"line":516},{"line":516,"name":"readlogfile","kind":12,"containerName":"review_log"},{"kind":13,"name":"$logobj","containerName":"review_log","line":516},{"name":"$logobj","kind":13,"containerName":"review_log","line":517},{"line":517,"containerName":"review_log","kind":13,"name":"$self"},{"name":"_grep_regexps","kind":12,"containerName":"review_log","line":517},{"kind":13,"name":"$logobj","containerName":"review_log","line":517},{"line":517,"name":"$logobj","kind":13,"containerName":"review_log"},{"containerName":"review_log","kind":13,"name":"$logobj","line":518},{"line":518,"containerName":"review_log","name":"$self","kind":13},{"line":518,"containerName":"review_log","name":"clean_ips_to_block_allowdeny","kind":12},{"kind":13,"name":"$logobj","containerName":"review_log","line":518},{"name":"$ip","kind":13,"line":528,"definition":"my","containerName":"review_log","localvar":"my"},{"containerName":"review_log","kind":13,"name":"$logobj","line":528},{"containerName":"review_log","name":"$logger","kind":13,"line":529},{"containerName":"review_log","kind":12,"name":"info","line":529},{"containerName":"review_log","localvar":"my","name":"$args","kind":13,"definition":"my","line":530},{"line":534,"containerName":"review_log","name":"$logger","kind":13},{"line":534,"containerName":"review_log","kind":12,"name":"debug"},{"containerName":"review_log","name":"$self","kind":13,"line":535},{"kind":12,"name":"iptablesqueue_enqueue","containerName":"review_log","line":535},{"line":535,"containerName":"review_log","kind":13,"name":"$args"},{"localvar":"my","containerName":"review_log","kind":13,"name":"$args","definition":"my","line":537},{"line":541,"kind":13,"name":"$logger","containerName":"review_log"},{"line":541,"containerName":"review_log","name":"debug","kind":12},{"containerName":"review_log","kind":13,"name":"$self","line":542},{"containerName":"review_log","kind":12,"name":"iptablesqueue_enqueue","line":542},{"line":542,"name":"$args","kind":13,"containerName":"review_log"},{"line":545,"containerName":"review_log","kind":13,"name":"$cycles"},{"name":"$logger","kind":13,"containerName":"review_log","line":546},{"line":546,"containerName":"review_log","kind":12,"name":"info"},{"line":547,"name":"$cyclesleep","kind":13,"containerName":"review_log"}],"kind":12,"name":"review_log","detail":"()","definition":"sub","line":476},{"line":480,"kind":12,"name":"threads"},{"name":"Dumper","kind":12,"line":483},{"line":486,"name":"cycles","kind":12},{"line":486,"kind":12,"name":"configs"},{"name":"cycles","kind":12,"line":486},{"line":486,"name":"LONG_MAX","kind":12},{"line":487,"kind":12,"name":"cycles"},{"name":"cyclesleep","kind":12,"line":488},{"line":488,"kind":12,"name":"configs"},{"name":"cyclesleep","kind":12,"line":488},{"name":"cyclesleep","kind":12,"line":489},{"line":499,"name":"chain","kind":12},{"line":507,"name":"options","kind":12},{"name":"rule","kind":12,"line":508},{"line":517,"name":"ips_to_block","kind":12},{"name":"logcontents","kind":12,"line":517},{"kind":12,"name":"ips_to_block","line":528},{"name":"options","kind":12,"line":531},{"line":532,"kind":12,"name":"rule"},{"name":"options","kind":12,"line":538},{"kind":12,"name":"rule","line":539},{"kind":12,"name":"usleep","line":547},{"containerName":null,"name":"$logger","kind":13,"line":550},{"containerName":"main::","kind":12,"name":"info","line":550},{"detail":"()","name":"iptables_ipblock_commands","kind":12,"line":556,"definition":"sub","signature":{"documentation":" Description: takes the ips_to_block, ports, and protocols and creates the iptables commands to run\n Returns a hash of iptables commands to run","label":"iptables_ipblock_commands()","parameters":[]},"containerName":"main::","range":{"end":{"character":9999,"line":580},"start":{"line":556,"character":0}},"children":[{"name":"$self","kind":13,"line":557,"definition":"my","localvar":"my","containerName":"iptables_ipblock_commands"},{"localvar":"my","containerName":"iptables_ipblock_commands","definition":"my","line":558,"kind":13,"name":"$logobj"},{"localvar":"my","containerName":"iptables_ipblock_commands","kind":13,"name":"$TID","line":560,"definition":"my"},{"line":560,"name":"tid","kind":12,"containerName":"iptables_ipblock_commands"},{"line":561,"containerName":"iptables_ipblock_commands","name":"$TID","kind":13},{"line":561,"containerName":"iptables_ipblock_commands","kind":13,"name":"$TID"},{"containerName":"iptables_ipblock_commands","kind":13,"name":"$logobj","line":563},{"kind":13,"name":"$iptables_commands","line":567,"definition":"my","localvar":"my","containerName":"iptables_ipblock_commands"},{"name":"$ips_to_block","kind":13,"definition":"my","line":579,"localvar":"my","containerName":"iptables_ipblock_commands"},{"line":579,"containerName":"iptables_ipblock_commands","kind":13,"name":"$logobj"},{"containerName":"iptables_ipblock_commands","localvar":"my","name":"$chain","kind":13,"line":580,"definition":"my"},{"line":580,"containerName":"iptables_ipblock_commands","kind":13,"name":"$ips_to_block"}]},{"line":560,"name":"threads","kind":12},{"line":579,"kind":12,"name":"ips_to_block"},{"definition":"my","line":581,"name":"$ip","kind":13,"containerName":null,"localvar":"my"},{"line":581,"name":"%ips_to_block","kind":13,"containerName":null},{"containerName":null,"name":"%chain","kind":13,"line":581},{"name":"$port","kind":13,"line":582,"definition":"my","localvar":"my","containerName":null},{"line":582,"containerName":null,"kind":13,"name":"%ips_to_block"},{"name":"%chain","kind":13,"containerName":null,"line":582},{"line":582,"containerName":null,"kind":13,"name":"%ip"},{"line":583,"definition":"my","name":"$protocol","kind":13,"localvar":"my","containerName":null},{"name":"%ips_to_block","kind":13,"containerName":null,"line":583},{"line":583,"name":"%chain","kind":13,"containerName":null},{"line":583,"name":"%ip","kind":13,"containerName":null},{"containerName":null,"kind":13,"name":"%port","line":583},{"containerName":null,"localvar":"my","line":584,"definition":"my","kind":13,"name":"$iptables_command"},{"containerName":null,"kind":13,"name":"%self","line":584},{"kind":12,"name":"iptables_command","line":584},{"containerName":null,"name":"$iptables_command","kind":13,"line":585},{"line":586,"containerName":null,"kind":13,"name":"$iptables_command"},{"containerName":null,"name":"$iptables_command","kind":13,"line":587},{"line":588,"kind":13,"name":"$iptables_command","containerName":null},{"containerName":null,"name":"%iptables_commands","kind":13,"line":589},{"kind":13,"name":"%chain","containerName":null,"line":589},{"kind":13,"name":"%ip","containerName":null,"line":589},{"containerName":null,"name":"%port","kind":13,"line":589},{"kind":13,"name":"$protocol","containerName":null,"line":589},{"kind":13,"name":"$iptables_command","containerName":null,"line":589},{"name":"$logger","kind":13,"containerName":null,"line":595},{"kind":12,"name":"debug","containerName":"main::","line":595},{"line":595,"kind":12,"name":"Dumper"},{"name":"$iptables_commands","kind":13,"containerName":null,"line":595},{"line":595,"kind":13,"name":"$logger","containerName":null},{"line":595,"kind":12,"name":"is_debug","containerName":"main::"},{"containerName":null,"kind":13,"name":"$iptables_commands","line":597},{"containerName":"main::","range":{"end":{"character":9999,"line":625},"start":{"character":0,"line":601}},"children":[{"line":602,"definition":"my","name":"$self","kind":13,"containerName":"load_configs","localvar":"my"},{"localvar":"my","containerName":"load_configs","line":603,"definition":"my","name":"$configsfile","kind":13},{"line":603,"kind":13,"name":"$self","containerName":"load_configs"},{"kind":13,"name":"$clargs","line":604,"definition":"my","containerName":"load_configs","localvar":"my"},{"line":604,"name":"$self","kind":13,"containerName":"load_configs"},{"line":606,"containerName":"load_configs","name":"$configsfile","kind":13},{"line":609,"name":"$self","kind":13,"containerName":"load_configs"},{"line":609,"name":"$self","kind":13,"containerName":"load_configs"},{"kind":13,"name":"$self","containerName":"load_configs","line":610},{"containerName":"load_configs","name":"$self","kind":13,"line":610},{"containerName":"load_configs","name":"$self","kind":13,"line":611},{"definition":"my","line":616,"name":"$msg","kind":13,"localvar":"my","containerName":"load_configs"},{"name":"$msg","kind":13,"containerName":"load_configs","line":617},{"kind":13,"name":"$msg","containerName":"load_configs","line":618},{"containerName":"load_configs","name":"$clargs","kind":13,"line":618},{"containerName":"load_configs","kind":13,"name":"$msg","line":619},{"line":619,"kind":13,"name":"$DEFAULTS","containerName":"load_configs"},{"name":"$msg","kind":13,"containerName":"load_configs","line":620},{"containerName":"load_configs","kind":13,"name":"$msg","line":621},{"line":622,"name":"$msg","kind":13,"containerName":"load_configs"},{"localvar":"my","containerName":"load_configs","definition":"my","line":625,"kind":13,"name":"$config"},{"kind":13,"name":"$DEFAULTS","containerName":"load_configs","line":625}],"name":"load_configs","kind":12,"definition":"sub","line":601},{"line":603,"kind":12,"name":"configsfile"},{"kind":12,"name":"clargs","line":604},{"line":609,"kind":12,"name":"configs"},{"line":609,"name":"Config","kind":12,"containerName":"File::read_config_file"},{"line":609,"kind":12,"name":"configsfile"},{"name":"configs","kind":12,"line":610},{"name":"globalchain","kind":12,"line":610},{"kind":12,"name":"configs","line":610},{"line":610,"name":"globalchain","kind":12},{"line":611,"kind":12,"name":"configs"},{"line":611,"name":"globalchain","kind":12},{"line":618,"kind":12,"name":"Dumper"},{"line":619,"name":"Dumper","kind":12},{"line":621,"kind":12,"name":"carp"},{"line":629,"containerName":null,"name":"%self","kind":13},{"kind":12,"name":"configs","line":629},{"line":629,"name":"$config","kind":13,"containerName":null},{"kind":13,"name":"%clargs","containerName":null,"line":630},{"kind":13,"name":"$config","containerName":null,"line":630},{"line":631,"kind":13,"name":"%clargs","containerName":null},{"line":631,"kind":13,"name":"$config","containerName":null},{"line":632,"kind":13,"name":"%self","containerName":null},{"kind":12,"name":"configs","line":632},{"kind":13,"name":"$config","containerName":null,"line":632},{"line":632,"containerName":null,"kind":13,"name":"%DEFAULTS"},{"line":632,"containerName":null,"kind":13,"name":"$config"},{"kind":13,"name":"%self","containerName":null,"line":635},{"line":635,"kind":12,"name":"configs"},{"signature":{"parameters":[],"label":"reverseMapHash()","documentation":" Special helper function for clean_ips_to_block()"},"containerName":"main::","children":[{"localvar":"my","containerName":"reverseMapHash","name":"$self","kind":13,"definition":"my","line":640},{"kind":13,"name":"$hash","definition":"my","line":641,"localvar":"my","containerName":"reverseMapHash"},{"definition":"my","line":645,"kind":13,"name":"$new_hash","localvar":"my","containerName":"reverseMapHash"},{"line":646,"definition":"my","name":"$key","kind":13,"containerName":"reverseMapHash","localvar":"my"},{"line":646,"name":"$hash","kind":13,"containerName":"reverseMapHash"}],"range":{"start":{"line":639,"character":0},"end":{"line":646,"character":9999}},"name":"reverseMapHash","kind":12,"detail":"()","line":639,"definition":"sub"},{"line":647,"kind":13,"name":"%new_hash","containerName":null},{"line":647,"containerName":null,"kind":13,"name":"%hash"},{"containerName":null,"kind":13,"name":"$key","line":647},{"line":651,"containerName":null,"kind":13,"name":"$new_hash"},{"kind":12,"name":"clean_ips_to_block_combined","detail":"()","line":656,"definition":"sub","signature":{"parameters":[],"documentation":" Description: Combines the IPs from regex from the log to be blocked and the IPs from the allow/deny lists into\n               one hash","label":"clean_ips_to_block_combined()"},"containerName":"main::","children":[{"localvar":"my","containerName":"clean_ips_to_block_combined","kind":13,"name":"$self","line":657,"definition":"my"},{"containerName":"clean_ips_to_block_combined","localvar":"my","name":"$logobj","kind":13,"definition":"my","line":658},{"definition":"my","line":659,"name":"$TID","kind":13,"localvar":"my","containerName":"clean_ips_to_block_combined"},{"name":"tid","kind":12,"containerName":"clean_ips_to_block_combined","line":659},{"line":660,"name":"$TID","kind":13,"containerName":"clean_ips_to_block_combined"},{"line":660,"containerName":"clean_ips_to_block_combined","name":"$TID","kind":13},{"kind":13,"name":"$Data","containerName":"clean_ips_to_block_combined","line":662},{"line":663,"name":"$Data","kind":13,"containerName":"clean_ips_to_block_combined"}],"range":{"start":{"character":0,"line":656},"end":{"character":9999,"line":665}}},{"line":659,"kind":12,"name":"threads"},{"line":662,"containerName":"Terse","name":"Dumper","kind":12},{"line":663,"name":"Dumper","kind":12,"containerName":"Indent"},{"detail":"()","name":"clean_ips_to_block_allowdeny","kind":12,"definition":"sub","line":670,"signature":{"documentation":" Description: Returns the logobj with ips_to_block set with the IPs to block from the allow/deny lists\n   There is a lot of logging available in this sub.\n   This sub is called from review_log()","label":"clean_ips_to_block_allowdeny()","parameters":[]},"containerName":"main::","range":{"end":{"character":9999,"line":704},"start":{"line":670,"character":0}},"children":[{"containerName":"clean_ips_to_block_allowdeny","localvar":"my","name":"$self","kind":13,"line":671,"definition":"my"},{"kind":13,"name":"$logobj","line":672,"definition":"my","localvar":"my","containerName":"clean_ips_to_block_allowdeny"},{"localvar":"my","containerName":"clean_ips_to_block_allowdeny","name":"$TID","kind":13,"line":673,"definition":"my"},{"line":673,"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"tid"},{"kind":13,"name":"$TID","containerName":"clean_ips_to_block_allowdeny","line":674},{"line":674,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$TID"},{"line":676,"kind":13,"name":"$Data","containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$Data","line":677},{"containerName":"clean_ips_to_block_allowdeny","localvar":"my","definition":"my","line":681,"kind":13,"name":"$allowdeny"},{"name":"$logobj","kind":13,"containerName":"clean_ips_to_block_allowdeny","line":681},{"line":681,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$self"},{"line":682,"definition":"my","kind":13,"name":"$logobj_allowlist","localvar":"my","containerName":"clean_ips_to_block_allowdeny"},{"line":682,"name":"$logobj","kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","name":"$self","kind":13,"line":682},{"kind":13,"name":"$logobj_denylist","definition":"my","line":683,"containerName":"clean_ips_to_block_allowdeny","localvar":"my"},{"line":683,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logobj"},{"line":683,"name":"$self","kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"line":684,"definition":"my","kind":13,"name":"$global_denylist","containerName":"clean_ips_to_block_allowdeny","localvar":"my"},{"line":684,"kind":13,"name":"$self","containerName":"clean_ips_to_block_allowdeny"},{"name":"$global_allowlist","kind":13,"definition":"my","line":685,"localvar":"my","containerName":"clean_ips_to_block_allowdeny"},{"line":685,"containerName":"clean_ips_to_block_allowdeny","name":"$self","kind":13},{"localvar":"my","containerName":"clean_ips_to_block_allowdeny","name":"$ips_to_block","kind":13,"definition":"my","line":687},{"line":687,"containerName":"clean_ips_to_block_allowdeny","name":"$logobj","kind":13},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logobj_allowlist","line":690},{"line":690,"containerName":"clean_ips_to_block_allowdeny","name":"$self","kind":13},{"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"reverseMapHash","line":690},{"line":690,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logobj_allowlist"},{"line":691,"name":"$logobj_denylist","kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$self","kind":13,"containerName":"clean_ips_to_block_allowdeny","line":691},{"line":691,"name":"reverseMapHash","kind":12,"containerName":"clean_ips_to_block_allowdeny"},{"line":691,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logobj_denylist"},{"kind":13,"name":"$global_allowlist","containerName":"clean_ips_to_block_allowdeny","line":692},{"line":692,"kind":13,"name":"$self","containerName":"clean_ips_to_block_allowdeny"},{"line":692,"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"reverseMapHash"},{"kind":13,"name":"$global_allowlist","containerName":"clean_ips_to_block_allowdeny","line":692},{"line":693,"name":"$global_denylist","kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","name":"$self","kind":13,"line":693},{"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"reverseMapHash","line":693},{"line":693,"kind":13,"name":"$global_denylist","containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logger","line":696},{"line":696,"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"info"},{"kind":13,"name":"$logger","containerName":"clean_ips_to_block_allowdeny","line":697},{"line":697,"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"debug"},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logobj_allowlist","line":697},{"line":697,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logger"},{"line":697,"name":"is_debug","kind":12,"containerName":"clean_ips_to_block_allowdeny"},{"line":698,"containerName":"clean_ips_to_block_allowdeny","name":"$logger","kind":13},{"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"debug","line":698},{"line":698,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logobj_denylist"},{"kind":13,"name":"$logger","containerName":"clean_ips_to_block_allowdeny","line":698},{"kind":12,"name":"is_debug","containerName":"clean_ips_to_block_allowdeny","line":698},{"line":699,"name":"$logger","kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"line":699,"name":"debug","kind":12,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$ips_to_block","kind":13,"containerName":"clean_ips_to_block_allowdeny","line":699},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logger","line":699},{"line":699,"kind":12,"name":"is_debug","containerName":"clean_ips_to_block_allowdeny"},{"name":"$logger","kind":13,"containerName":"clean_ips_to_block_allowdeny","line":700},{"containerName":"clean_ips_to_block_allowdeny","name":"debug","kind":12,"line":700},{"line":700,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$global_allowlist"},{"line":700,"kind":13,"name":"$logger","containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"is_debug","line":700},{"name":"$logger","kind":13,"containerName":"clean_ips_to_block_allowdeny","line":701},{"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"debug","line":701},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$global_denylist","line":701},{"line":701,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logger"},{"kind":12,"name":"is_debug","containerName":"clean_ips_to_block_allowdeny","line":701},{"line":704,"definition":"my","kind":13,"name":"$allowlist","containerName":"clean_ips_to_block_allowdeny","localvar":"my"},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$global_allowlist","line":704},{"line":704,"kind":13,"name":"$logobj_allowlist","containerName":"clean_ips_to_block_allowdeny"}]},{"line":673,"kind":12,"name":"threads"},{"name":"Dumper","kind":12,"containerName":"Terse","line":676},{"kind":12,"name":"Dumper","containerName":"Indent","line":677},{"line":681,"kind":12,"name":"allowdeny"},{"line":681,"name":"configs","kind":12},{"name":"allowdeny","kind":12,"line":681},{"name":"allowlist","kind":12,"line":682},{"kind":12,"name":"configs","line":682},{"line":682,"kind":12,"name":"allowlist"},{"kind":12,"name":"denylist","line":683},{"line":683,"kind":12,"name":"configs"},{"line":683,"kind":12,"name":"denylist"},{"kind":12,"name":"configs","line":684},{"line":684,"kind":12,"name":"denylist"},{"line":685,"kind":12,"name":"configs"},{"line":685,"name":"allowlist","kind":12},{"kind":12,"name":"ips_to_block","line":687},{"line":697,"name":"Dumper","kind":12},{"line":698,"kind":12,"name":"Dumper"},{"line":699,"name":"Dumper","kind":12},{"kind":12,"name":"Dumper","line":700},{"name":"Dumper","kind":12,"line":701},{"localvar":"my","containerName":null,"definition":"my","line":705,"name":"%denylist","kind":13},{"containerName":null,"kind":13,"name":"$global_denylist","line":705},{"line":705,"kind":13,"name":"$logobj_denylist","containerName":null},{"line":708,"name":"$logger","kind":13,"containerName":null},{"line":708,"containerName":"main::","name":"debug","kind":12},{"kind":12,"name":"Dumper","line":708},{"containerName":null,"name":"$allowlist","kind":13,"line":708},{"containerName":null,"name":"$logger","kind":13,"line":708},{"containerName":"main::","kind":12,"name":"is_debug","line":708},{"kind":13,"name":"$logger","containerName":null,"line":709},{"name":"debug","kind":12,"containerName":"main::","line":709},{"line":709,"kind":12,"name":"Dumper"},{"line":709,"kind":13,"name":"$denylist","containerName":null},{"containerName":null,"name":"$logger","kind":13,"line":709},{"line":709,"name":"is_debug","kind":12,"containerName":"main::"},{"name":"%denylist","kind":13,"containerName":null,"line":712},{"line":712,"containerName":null,"kind":13,"name":"$denylist"},{"containerName":null,"kind":13,"name":"$ips_to_block","line":712},{"kind":13,"name":"$logger","containerName":null,"line":715},{"kind":12,"name":"debug","containerName":"main::","line":715},{"kind":12,"name":"Dumper","line":715},{"name":"$denylist","kind":13,"containerName":null,"line":715},{"line":715,"containerName":null,"name":"$logger","kind":13},{"containerName":"main::","kind":12,"name":"is_debug","line":715},{"kind":13,"name":"%allowdeny","containerName":null,"line":719},{"line":720,"kind":13,"name":"%logobj","containerName":null},{"kind":12,"name":"ips_to_block","line":720},{"line":720,"name":"$denylist","kind":13,"containerName":null},{"kind":13,"name":"%logobj","containerName":null,"line":721},{"line":726,"containerName":null,"kind":13,"name":"%denylist"},{"containerName":null,"name":"$allowlist","kind":13,"line":726},{"line":727,"name":"%logobj","kind":13,"containerName":null},{"kind":12,"name":"ips_to_block","line":727},{"line":727,"name":"$denylist","kind":13,"containerName":null},{"name":"$logobj","kind":13,"containerName":null,"line":728},{"signature":{"parameters":[],"label":"run_iptables()","documentation":" Runs whatever parameters are passed to it against iptables\n  This is intended to be a one stop shop for running iptables out from a queue.\n  However, there are a few instances where it is called directly... especially when creating chains\n   This hopefully prevents excessive wait/locking on iptables\n   and helps to keep commands running in the order they are received.\n Arguments must be passed as a hash reference with (so far) the following keys:\n   rule:  The rule to run\n   options:  Any options to pass to iptables\n  Where it is ran like this:\n   iptables $options $rule 2>&1\n Future enhancement:\n   1. delete existing rule if it exists"},"containerName":"main::","children":[{"containerName":"run_iptables","localvar":"my","name":"$self","kind":13,"definition":"my","line":744},{"name":"$args","kind":13,"containerName":"run_iptables","line":744},{"definition":"my","line":745,"name":"@caller_lst","kind":13,"containerName":"run_iptables","localvar":"my"},{"containerName":"run_iptables","localvar":"my","kind":13,"name":"$goodcaller","definition":"my","line":746},{"name":"$self","kind":13,"containerName":"run_iptables","line":746},{"kind":13,"name":"$caller_lst","containerName":"run_iptables","line":747},{"containerName":"run_iptables","kind":13,"name":"$goodcaller","line":747},{"containerName":"run_iptables","localvar":"my","definition":"my","line":748,"name":"$logmsg","kind":13},{"line":749,"name":"@caller_lst","kind":13,"containerName":"run_iptables"},{"name":"$logger","kind":13,"containerName":"run_iptables","line":754},{"line":754,"containerName":"run_iptables","kind":12,"name":"error"},{"line":754,"containerName":"run_iptables","name":"$logmsg","kind":13},{"containerName":"run_iptables","localvar":"my","line":756,"definition":"my","kind":13,"name":"$TID"},{"name":"tid","kind":12,"containerName":"run_iptables","line":756},{"line":757,"name":"$TID","kind":13,"containerName":"run_iptables"},{"line":757,"containerName":"run_iptables","name":"$TID","kind":13},{"line":760,"kind":13,"name":"$args","containerName":"run_iptables"},{"containerName":"run_iptables","name":"$logger","kind":13,"line":760},{"name":"error","kind":12,"containerName":"run_iptables","line":760},{"kind":13,"name":"$self","containerName":"run_iptables","line":761},{"line":761,"containerName":"run_iptables","kind":13,"name":"$logger"},{"line":761,"containerName":"run_iptables","name":"error","kind":12},{"containerName":"run_iptables","localvar":"my","name":"$iptables","kind":13,"definition":"my","line":763},{"line":763,"containerName":"run_iptables","name":"$self","kind":13},{"localvar":"my","containerName":"run_iptables","name":"$rule","kind":13,"definition":"my","line":764},{"line":764,"kind":13,"name":"$args","containerName":"run_iptables"},{"localvar":"my","containerName":"run_iptables","name":"$options","kind":13,"line":765,"definition":"my"},{"name":"$args","kind":13,"containerName":"run_iptables","line":765},{"line":767,"name":"$logger","kind":13,"containerName":"run_iptables"},{"name":"is_debug","kind":12,"containerName":"run_iptables","line":767},{"containerName":"run_iptables","kind":13,"name":"$logger","line":768},{"name":"debug","kind":12,"containerName":"run_iptables","line":768},{"kind":13,"name":"$args","containerName":"run_iptables","line":769},{"containerName":"run_iptables","kind":13,"name":"$args","line":777},{"name":"$allowdupes","kind":13,"line":778,"definition":"my","localvar":"my","containerName":"run_iptables"},{"line":778,"containerName":"run_iptables","name":"$args","kind":13},{"line":780,"containerName":"run_iptables","name":"$allowdupes","kind":13},{"line":781,"kind":13,"name":"$logger","containerName":"run_iptables"},{"line":781,"kind":12,"name":"debug","containerName":"run_iptables"},{"kind":13,"name":"$retval","line":782,"definition":"my","containerName":"run_iptables","localvar":"my"},{"containerName":"run_iptables","kind":13,"name":"$self","line":782},{"name":"check_if_rule_exists","kind":12,"containerName":"run_iptables","line":782},{"kind":13,"name":"$args","containerName":"run_iptables","line":782},{"containerName":"run_iptables","name":"$retval","kind":13,"line":783},{"name":"$logger","kind":13,"containerName":"run_iptables","line":787},{"line":787,"kind":12,"name":"debug","containerName":"run_iptables"},{"line":790,"name":"$retval","kind":13,"containerName":"run_iptables"},{"containerName":"run_iptables","name":"$logger","kind":13,"line":791},{"kind":12,"name":"debug","containerName":"run_iptables","line":791},{"line":793,"containerName":"run_iptables","name":"$retval","kind":13},{"line":794,"containerName":"run_iptables","kind":13,"name":"$options"},{"containerName":"run_iptables","kind":13,"name":"$logger","line":797},{"containerName":"run_iptables","name":"debug","kind":12,"line":797},{"line":800,"kind":13,"name":"$self","containerName":"run_iptables"},{"name":"$rule","kind":13,"containerName":"run_iptables","line":800},{"line":802,"kind":13,"name":"$retval","containerName":"run_iptables"},{"containerName":"run_iptables","name":"$logger","kind":13,"line":803},{"line":803,"containerName":"run_iptables","kind":12,"name":"error"},{"containerName":"run_iptables","kind":13,"name":"$retval","line":806},{"containerName":"run_iptables","name":"$logger","kind":13,"line":807},{"name":"error","kind":12,"containerName":"run_iptables","line":807},{"line":811,"containerName":"run_iptables","name":"$logger","kind":13},{"line":811,"kind":12,"name":"error","containerName":"run_iptables"},{"kind":13,"name":"$retval","containerName":"run_iptables","line":811},{"containerName":"run_iptables","localvar":"my","kind":13,"name":"$command","line":816,"definition":"my"},{"kind":13,"name":"$self","containerName":"run_iptables","line":817},{"containerName":"run_iptables","kind":13,"name":"$logger","line":818},{"kind":12,"name":"debug","containerName":"run_iptables","line":818},{"localvar":"my","containerName":"run_iptables","definition":"my","line":819,"kind":13,"name":"$output"},{"line":820,"containerName":"run_iptables","kind":13,"name":"$logger"},{"line":820,"containerName":"run_iptables","kind":12,"name":"debug"},{"containerName":"run_iptables","kind":13,"name":"$logger","line":824},{"containerName":"run_iptables","kind":12,"name":"info","line":824},{"containerName":"run_iptables","kind":13,"name":"$logger","line":829},{"line":829,"kind":12,"name":"error","containerName":"run_iptables"}],"range":{"end":{"character":9999,"line":831},"start":{"line":743,"character":0}},"name":"run_iptables","kind":12,"detail":"()","line":743,"definition":"sub"},{"line":746,"kind":12,"name":"run_iptables_line"},{"kind":12,"name":"Dumper","line":749},{"kind":12,"name":"threads","line":756},{"name":"rule","kind":12,"line":760},{"line":761,"name":"configs","kind":12},{"name":"iptables","kind":12,"line":761},{"name":"configs","kind":12,"line":763},{"line":763,"kind":12,"name":"iptables"},{"name":"rule","kind":12,"line":764},{"kind":12,"name":"options","line":765},{"name":"Dumper","kind":12,"line":769},{"line":777,"name":"allowdupes","kind":12},{"kind":12,"name":"allowdupes","line":778},{"kind":12,"name":"chains_created","line":800},{"line":817,"kind":12,"name":"configs"},{"line":817,"name":"PRODMODE","kind":12},{"range":{"end":{"line":842,"character":9999},"start":{"character":0,"line":834}},"children":[{"containerName":"set_iptables_command","localvar":"my","name":"$self","kind":13,"definition":"my","line":835},{"line":838,"containerName":"set_iptables_command","kind":13,"name":"$self"},{"containerName":"set_iptables_command","kind":13,"name":"$self","line":839},{"line":840,"name":"$logger","kind":13,"containerName":"set_iptables_command"},{"kind":12,"name":"info","containerName":"set_iptables_command","line":840}],"signature":{"documentation":" Maybe an unnecessary sub but maybe some better checks down the road","label":"set_iptables_command()","parameters":[]},"containerName":"main::","definition":"sub","line":834,"detail":"()","name":"set_iptables_command","kind":12},{"kind":12,"name":"configs","line":838},{"line":838,"name":"iptables","kind":12},{"line":839,"kind":12,"name":"configs"},{"kind":12,"name":"iptables","line":839},{"detail":"($self,$args)","name":"check_if_rule_exists","kind":12,"definition":"sub","line":846,"signature":{"parameters":[{"label":"$self"},{"label":"$args"}],"label":"check_if_rule_exists($self,$args)","documentation":"# Returns 0 if there is an unknown return value from running iptables\n#          Otherwise returns a string"},"containerName":"main::","children":[{"containerName":"check_if_rule_exists","localvar":"my","definition":"my","line":847,"name":"$self","kind":13},{"line":847,"name":"$args","kind":13,"containerName":"check_if_rule_exists"},{"line":848,"definition":"my","name":"$TID","kind":13,"localvar":"my","containerName":"check_if_rule_exists"},{"line":848,"containerName":"check_if_rule_exists","name":"tid","kind":12},{"line":849,"containerName":"check_if_rule_exists","name":"$TID","kind":13},{"containerName":"check_if_rule_exists","name":"$TID","kind":13,"line":849},{"containerName":"check_if_rule_exists","name":"$args","kind":13,"line":852},{"line":852,"kind":13,"name":"$self","containerName":"check_if_rule_exists"},{"line":852,"kind":12,"name":"log_and_return","containerName":"check_if_rule_exists"},{"name":"$self","kind":13,"containerName":"check_if_rule_exists","line":853},{"kind":13,"name":"$logger","containerName":"check_if_rule_exists","line":853},{"line":853,"containerName":"check_if_rule_exists","name":"error","kind":12},{"line":855,"definition":"my","kind":13,"name":"$iptables","localvar":"my","containerName":"check_if_rule_exists"},{"line":855,"containerName":"check_if_rule_exists","name":"$self","kind":13},{"containerName":"check_if_rule_exists","localvar":"my","name":"$rule","kind":13,"line":856,"definition":"my"},{"line":856,"kind":13,"name":"$args","containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","localvar":"my","definition":"my","line":857,"name":"$options","kind":13},{"containerName":"check_if_rule_exists","kind":13,"name":"$args","line":857},{"containerName":"check_if_rule_exists","kind":13,"name":"$options","line":859},{"name":"$logmsg","kind":13,"definition":"my","line":860,"localvar":"my","containerName":"check_if_rule_exists"},{"line":861,"name":"$logmsg","kind":13,"containerName":"check_if_rule_exists"},{"line":862,"containerName":"check_if_rule_exists","kind":13,"name":"$logger"},{"containerName":"check_if_rule_exists","kind":12,"name":"debug","line":862},{"line":862,"kind":13,"name":"$logmsg","containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","localvar":"my","name":"$checkrule_result","kind":13,"definition":"my","line":866},{"containerName":"check_if_rule_exists","name":"$logger","kind":13,"line":868},{"line":868,"kind":12,"name":"debug","containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","name":"$checkrule_result","kind":13,"line":872},{"line":873,"kind":13,"name":"$logger","containerName":"check_if_rule_exists"},{"line":873,"kind":12,"name":"debug","containerName":"check_if_rule_exists"},{"line":874,"name":"$logger","kind":13,"containerName":"check_if_rule_exists"},{"line":874,"kind":12,"name":"debug","containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","kind":13,"name":"$checkrule_result","line":878},{"containerName":"check_if_rule_exists","kind":13,"name":"$logger","line":879},{"line":879,"kind":12,"name":"debug","containerName":"check_if_rule_exists"},{"line":880,"kind":13,"name":"$logger","containerName":"check_if_rule_exists"},{"line":880,"containerName":"check_if_rule_exists","name":"debug","kind":12},{"line":884,"containerName":"check_if_rule_exists","kind":13,"name":"$checkrule_result"},{"line":885,"name":"$logger","kind":13,"containerName":"check_if_rule_exists"},{"line":885,"name":"debug","kind":12,"containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","name":"$logger","kind":13,"line":886},{"containerName":"check_if_rule_exists","name":"debug","kind":12,"line":886},{"containerName":"check_if_rule_exists","kind":13,"name":"$self","line":890},{"kind":12,"name":"log_and_return","containerName":"check_if_rule_exists","line":890}],"range":{"start":{"character":0,"line":846},"end":{"character":9999,"line":891}}},{"line":848,"kind":12,"name":"threads"},{"line":852,"name":"rule","kind":12},{"kind":12,"name":"configs","line":853},{"name":"iptables","kind":12,"line":853},{"kind":12,"name":"configs","line":855},{"line":855,"kind":12,"name":"iptables"},{"kind":12,"name":"rule","line":856},{"name":"options","kind":12,"line":857},{"containerName":"main::","signature":{"parameters":[{"label":"$self"},{"label":"$error_message"}],"documentation":"","label":"log_and_return($self,$error_message)"},"children":[{"line":894,"definition":"my","kind":13,"name":"$self","localvar":"my","containerName":"log_and_return"},{"containerName":"log_and_return","kind":13,"name":"$error_message","line":894},{"containerName":"log_and_return","localvar":"my","definition":"my","line":895,"kind":13,"name":"$TID"},{"name":"tid","kind":12,"containerName":"log_and_return","line":895},{"name":"$TID","kind":13,"containerName":"log_and_return","line":896},{"line":896,"containerName":"log_and_return","name":"$TID","kind":13},{"containerName":"log_and_return","name":"$logger","kind":13,"line":897},{"line":897,"name":"error","kind":12,"containerName":"log_and_return"},{"line":897,"containerName":"log_and_return","name":"$error_message","kind":13}],"range":{"end":{"line":899,"character":9999},"start":{"line":893,"character":0}},"name":"log_and_return","kind":12,"detail":"($self,$error_message)","definition":"sub","line":893},{"line":895,"kind":12,"name":"threads"},{"line":904,"definition":"sub","detail":"()","name":"add_global_chains_to_input_output","kind":12,"range":{"end":{"character":9999,"line":916},"start":{"character":0,"line":904}},"children":[{"line":905,"definition":"my","kind":13,"name":"$self","localvar":"my","containerName":"add_global_chains_to_input_output"},{"kind":13,"name":"@allowdenyorder","line":908,"definition":"my","containerName":"add_global_chains_to_input_output","localvar":"my"},{"name":"@builtinchains","kind":13,"line":913,"definition":"my","containerName":"add_global_chains_to_input_output","localvar":"my"},{"name":"$self","kind":13,"containerName":"add_global_chains_to_input_output","line":914},{"containerName":"add_global_chains_to_input_output","name":"@builtinchains","kind":13,"line":915},{"line":915,"containerName":"add_global_chains_to_input_output","name":"$self","kind":13}],"containerName":"main::","signature":{"parameters":[],"label":"add_global_chains_to_input_output()","documentation":" This is a one time event to add the global chains to the INPUT and OUTPUT chains\n   This is only called once when the module is first run\n   This is only called if the global rules do not exist"}},{"kind":12,"name":"configs","line":914},{"line":914,"name":"globalchains","kind":12},{"line":915,"name":"configs","kind":12},{"kind":12,"name":"globalchains","line":915},{"containerName":null,"kind":13,"name":"%self","line":921},{"line":921,"kind":12,"name":"configs"},{"kind":12,"name":"allowdeny","line":921},{"line":922,"kind":13,"name":"@allowdenyorder","containerName":null},{"line":922,"kind":13,"name":"@allowdenyorder","containerName":null},{"name":"%self","kind":13,"containerName":null,"line":922},{"kind":12,"name":"configs","line":922},{"line":922,"kind":12,"name":"allowdeny"},{"definition":"my","line":931,"name":"$newchain","kind":13,"localvar":"my","containerName":null},{"line":931,"name":"@allowdenyorder","kind":13,"containerName":null},{"line":934,"kind":13,"name":"$IptablesQueue","containerName":null},{"line":934,"kind":12,"name":"enqueue","containerName":"main::"},{"kind":12,"name":"options","line":936},{"name":"rule","kind":12,"line":937},{"containerName":null,"localvar":"my","name":"$builtinchain","kind":13,"definition":"my","line":941},{"line":941,"name":"@builtinchains","kind":13,"containerName":null},{"localvar":"my","containerName":null,"definition":"my","line":942,"name":"$arguments","kind":13},{"line":947,"containerName":null,"kind":13,"name":"$IptablesQueue"},{"kind":12,"name":"enqueue","containerName":"main::","line":947},{"kind":12,"name":"options","line":949},{"kind":12,"name":"rule","line":950},{"line":951,"name":"allowdupes","kind":12},{"name":"deleteexisting","kind":12,"line":952},{"detail":"()","name":"create_iptables_chain","kind":12,"definition":"sub","line":963,"containerName":"main::","signature":{"label":"create_iptables_chain()","documentation":" Create iptables chain","parameters":[]},"range":{"end":{"line":980,"character":9999},"start":{"character":0,"line":963}},"children":[{"line":964,"definition":"my","kind":13,"name":"$self","containerName":"create_iptables_chain","localvar":"my"},{"name":"$name","kind":13,"containerName":"create_iptables_chain","line":964},{"containerName":"create_iptables_chain","localvar":"my","definition":"my","line":965,"name":"$TID","kind":13},{"line":965,"kind":12,"name":"tid","containerName":"create_iptables_chain"},{"containerName":"create_iptables_chain","kind":13,"name":"$logger","line":967},{"line":967,"containerName":"create_iptables_chain","kind":12,"name":"info"},{"line":968,"name":"$name","kind":13,"containerName":"create_iptables_chain"},{"containerName":"create_iptables_chain","kind":13,"name":"$logger","line":971},{"line":971,"containerName":"create_iptables_chain","kind":12,"name":"error"},{"localvar":"my","containerName":"create_iptables_chain","definition":"my","line":974,"name":"$rule","kind":13},{"kind":13,"name":"$options","definition":"my","line":975,"containerName":"create_iptables_chain","localvar":"my"},{"localvar":"my","containerName":"create_iptables_chain","line":976,"definition":"my","name":"$args","kind":13},{"name":"$rule","kind":13,"containerName":"create_iptables_chain","line":976},{"line":976,"name":"$options","kind":13,"containerName":"create_iptables_chain"},{"line":978,"kind":13,"name":"$self","containerName":"create_iptables_chain"},{"line":978,"containerName":"create_iptables_chain","kind":12,"name":"iptablesqueue_enqueue"},{"kind":13,"name":"$args","containerName":"create_iptables_chain","line":978}]},{"name":"threads","kind":12,"line":965},{"name":"rule","kind":12,"line":976},{"name":"options","kind":12,"line":976},{"children":[{"containerName":"iptablesqueue_enqueue","localvar":"my","name":"$self","kind":13,"line":983,"definition":"my"},{"name":"$args","kind":13,"containerName":"iptablesqueue_enqueue","line":983},{"line":984,"definition":"my","kind":13,"name":"$TID","containerName":"iptablesqueue_enqueue","localvar":"my"},{"line":984,"kind":12,"name":"tid","containerName":"iptablesqueue_enqueue"},{"line":985,"kind":13,"name":"$TID","containerName":"iptablesqueue_enqueue"},{"containerName":"iptablesqueue_enqueue","kind":13,"name":"$TID","line":985},{"line":986,"containerName":"iptablesqueue_enqueue","name":"$logger","kind":13},{"line":986,"containerName":"iptablesqueue_enqueue","name":"is_debug","kind":12},{"localvar":"my","containerName":"iptablesqueue_enqueue","kind":13,"name":"$lastqitem","definition":"my","line":987},{"line":987,"containerName":"iptablesqueue_enqueue","name":"$IptablesQueue","kind":13},{"containerName":"iptablesqueue_enqueue","kind":12,"name":"peek","line":987},{"containerName":"iptablesqueue_enqueue","name":"$logger","kind":13,"line":988},{"name":"debug","kind":12,"containerName":"iptablesqueue_enqueue","line":988},{"line":988,"name":"$lastqitem","kind":13,"containerName":"iptablesqueue_enqueue"},{"kind":13,"name":"$logger","containerName":"iptablesqueue_enqueue","line":989},{"line":989,"containerName":"iptablesqueue_enqueue","kind":12,"name":"debug"},{"line":989,"containerName":"iptablesqueue_enqueue","kind":13,"name":"$args"},{"name":"$IptablesQueue","kind":13,"containerName":"iptablesqueue_enqueue","line":991},{"line":991,"name":"enqueue","kind":12,"containerName":"iptablesqueue_enqueue"},{"line":991,"name":"$args","kind":13,"containerName":"iptablesqueue_enqueue"},{"name":"$logger","kind":13,"containerName":"iptablesqueue_enqueue","line":992},{"containerName":"iptablesqueue_enqueue","name":"is_debug","kind":12,"line":992},{"line":993,"definition":"my","kind":13,"name":"$lastqitem","containerName":"iptablesqueue_enqueue","localvar":"my"},{"kind":13,"name":"$IptablesQueue","containerName":"iptablesqueue_enqueue","line":993},{"containerName":"iptablesqueue_enqueue","kind":12,"name":"peek","line":993},{"line":994,"name":"$logger","kind":13,"containerName":"iptablesqueue_enqueue"},{"containerName":"iptablesqueue_enqueue","kind":12,"name":"debug","line":994},{"name":"$lastqitem","kind":13,"containerName":"iptablesqueue_enqueue","line":994}],"range":{"start":{"line":982,"character":0},"end":{"character":9999,"line":997}},"containerName":"main::","signature":{"parameters":[],"label":"iptablesqueue_enqueue()","documentation":""},"line":982,"definition":"sub","detail":"()","kind":12,"name":"iptablesqueue_enqueue"},{"name":"threads","kind":12,"line":984},{"line":988,"kind":12,"name":"Dumper"},{"line":989,"name":"Dumper","kind":12},{"line":994,"name":"Dumper","kind":12},{"definition":"sub","line":1004,"name":"readlogfile","kind":12,"detail":"($self,$logobj)","children":[{"name":"$self","kind":13,"definition":"my","line":1005,"containerName":"readlogfile","localvar":"my"},{"line":1005,"containerName":"readlogfile","kind":13,"name":"$logobj"},{"definition":"my","line":1006,"kind":13,"name":"$TID","containerName":"readlogfile","localvar":"my"},{"line":1006,"kind":12,"name":"tid","containerName":"readlogfile"},{"line":1007,"name":"$TID","kind":13,"containerName":"readlogfile"},{"line":1007,"containerName":"readlogfile","kind":13,"name":"$TID"},{"localvar":"my","containerName":"readlogfile","line":1010,"definition":"my","name":"$file","kind":13},{"kind":13,"name":"$logobj","containerName":"readlogfile","line":1010},{"name":"$file","kind":13,"containerName":"readlogfile","line":1011},{"containerName":"readlogfile","name":"$logger","kind":13,"line":1011},{"line":1011,"containerName":"readlogfile","name":"error","kind":12},{"line":1011,"kind":13,"name":"$logobj","containerName":"readlogfile"},{"line":1014,"kind":13,"name":"$logobj","containerName":"readlogfile"},{"kind":13,"name":"$logobj","containerName":"readlogfile","line":1015},{"line":1015,"kind":13,"name":"$file","containerName":"readlogfile"},{"containerName":"readlogfile","kind":13,"name":"$logobj","line":1015},{"name":"$logobj","kind":13,"containerName":"readlogfile","line":1016},{"name":"$self","kind":13,"containerName":"readlogfile","line":1016},{"line":1017,"containerName":"readlogfile","name":"$logobj","kind":13},{"containerName":"readlogfile","kind":13,"name":"$logobj","line":1017},{"name":"$logger","kind":13,"containerName":"readlogfile","line":1019},{"line":1019,"containerName":"readlogfile","name":"debug","kind":12},{"definition":"my","line":1025,"name":"$fh","kind":13,"localvar":"my","containerName":"readlogfile"},{"line":1025,"containerName":"readlogfile","kind":13,"name":"$file"},{"containerName":"readlogfile","name":"$logger","kind":13,"line":1026},{"line":1026,"kind":12,"name":"error","containerName":"readlogfile"},{"line":1027,"containerName":"readlogfile","kind":13,"name":"$logobj"},{"line":1029,"containerName":"readlogfile","name":"$fh","kind":13},{"kind":13,"name":"$logobj","containerName":"readlogfile","line":1029},{"localvar":"my","containerName":"readlogfile","line":1030,"definition":"my","kind":13,"name":"@logcontents"},{"containerName":"readlogfile","name":"$fh","kind":13,"line":1030},{"name":"$logobj","kind":13,"containerName":"readlogfile","line":1031},{"name":"$fh","kind":13,"containerName":"readlogfile","line":1031},{"line":1032,"name":"$fh","kind":13,"containerName":"readlogfile"},{"line":1034,"containerName":"readlogfile","kind":13,"name":"@logcontents"},{"containerName":"readlogfile","name":"$logger","kind":13,"line":1035},{"containerName":"readlogfile","name":"info","kind":12,"line":1035},{"name":"$logobj","kind":13,"containerName":"readlogfile","line":1036},{"kind":13,"name":"$logger","containerName":"readlogfile","line":1039},{"containerName":"readlogfile","name":"debug","kind":12,"line":1039},{"line":1039,"kind":13,"name":"@logcontents","containerName":"readlogfile"},{"kind":13,"name":"@logcontents","containerName":"readlogfile","line":1042},{"containerName":"readlogfile","name":"$logobj","kind":13,"line":1043},{"line":1043,"containerName":"readlogfile","kind":13,"name":"@logcontents"},{"name":"$logger","kind":13,"containerName":"readlogfile","line":1045},{"line":1045,"name":"debug","kind":12,"containerName":"readlogfile"},{"line":1045,"containerName":"readlogfile","kind":13,"name":"@logcontents"},{"line":1046,"kind":13,"name":"$logger","containerName":"readlogfile"},{"containerName":"readlogfile","name":"trace","kind":12,"line":1046},{"line":1046,"containerName":"readlogfile","name":"$logobj","kind":13},{"line":1046,"kind":13,"name":"$logger","containerName":"readlogfile"},{"containerName":"readlogfile","name":"is_trace","kind":12,"line":1046},{"kind":13,"name":"$logobj","containerName":"readlogfile","line":1048}],"range":{"end":{"line":1049,"character":9999},"start":{"character":0,"line":1004}},"containerName":"main::","signature":{"parameters":[{"label":"$self"},{"label":"$logobj"}],"label":"readlogfile($self,$logobj)","documentation":" This function reads the log file into memory from the seek position (if it exists)\n The reading of a log file based on the seek position creates a big issue if the log file is rotated AND is larger than\n   the seek position\n   This is a tradeoff of reading the entire log file into memory and then grepping for the regexps\n Returns: $logobj"}},{"name":"threads","kind":12,"line":1006},{"line":1010,"kind":12,"name":"file"},{"name":"seek","kind":12,"line":1014},{"line":1015,"kind":12,"name":"seek"},{"kind":12,"name":"seek","line":1015},{"line":1016,"kind":12,"name":"readentirefile"},{"name":"configs","kind":12,"line":1016},{"line":1016,"name":"readentirefile","kind":12},{"line":1017,"kind":12,"name":"seek"},{"name":"readentirefile","kind":12,"line":1017},{"kind":12,"name":"seek","line":1029},{"line":1031,"name":"seek","kind":12},{"kind":12,"name":"logcontents","line":1036},{"line":1043,"name":"logcontents","kind":12},{"line":1046,"name":"Dumper","kind":12},{"name":"logcontents","kind":12,"line":1046},{"line":1073,"definition":"sub","detail":"($self,$log)","kind":12,"name":"_grep_regexps","range":{"start":{"line":1073,"character":0},"end":{"character":9999,"line":1078}},"children":[{"line":1074,"definition":"my","kind":13,"name":"$self","containerName":"_grep_regexps","localvar":"my"},{"line":1074,"kind":13,"name":"$log","containerName":"_grep_regexps"},{"kind":13,"name":"$TID","line":1075,"definition":"my","localvar":"my","containerName":"_grep_regexps"},{"kind":12,"name":"tid","containerName":"_grep_regexps","line":1075},{"localvar":"my","containerName":"_grep_regexps","definition":"my","line":1077,"kind":13,"name":"$matches"},{"kind":13,"name":"@log_contents","definition":"my","line":1078,"containerName":"_grep_regexps","localvar":"my"},{"kind":13,"name":"$log","containerName":"_grep_regexps","line":1078}],"containerName":"main::","signature":{"parameters":[{"label":"$self"},{"label":"$log"}],"label":"_grep_regexps($self,$log)","documentation":" # This greps for multiple regexps and returns the matchedlines from logobj->{logcontents}\n # Returns an array reference of matched lines\n sub _grep_regexp() {\n     my ( $self, $logobj, $regexps ) = @_;\n     my @matchedlines = ();\n     foreach my $regexp ( sort keys %{$regexps} ) {\n         # my $value = $regexps->{$regexp};\n         my $value = ${$regexps}{$regexp};\n         $logger->info(\"Grep'ing for >>$value<< in $logobj->{file} from byte position $logobj->{seek}\");\n         # @matchedlines = grep { /$value/ } @{ $logobj->{logcontents} };\n         push @matchedlines, grep { /$value/ } @{ $logobj->{logcontents} };\n         $logger->debug( \"Dumper of current matches: \" . Dumper(@matchedlines) ) if ( $logger->is_debug() );\n     } ## end foreach my $regexp ( sort keys...)\n     return \\@matchedlines;\n } ## end sub _grep_regexp\n Description:  Using the logobj, this greps against the log contents for matching lines and then gets the\n               IP address on each line.\n Returns:  Hash reference of IP addresses with count of how many times the IP address was found"}},{"kind":12,"name":"threads","line":1075},{"line":1078,"kind":12,"name":"logcontents"},{"containerName":null,"localvar":"my","name":"$regex","kind":13,"definition":"my","line":1081},{"containerName":null,"kind":13,"name":"%log","line":1081},{"line":1081,"kind":12,"name":"regexpdeny"},{"localvar":"my","containerName":null,"kind":13,"name":"$pattern","line":1082,"definition":"my"},{"containerName":null,"kind":13,"name":"%log","line":1082},{"line":1082,"kind":12,"name":"regexpdeny"},{"containerName":null,"name":"$regex","kind":13,"line":1082},{"containerName":null,"name":"$logger","kind":13,"line":1083},{"containerName":"main::","name":"info","kind":12,"line":1083},{"line":1085,"definition":"my","name":"@current_matches","kind":13,"containerName":null,"localvar":"my"},{"line":1085,"containerName":null,"kind":13,"name":"@log_contents"},{"containerName":null,"name":"$logger","kind":13,"line":1086},{"containerName":"main::","kind":12,"name":"debug","line":1086},{"name":"Dumper","kind":12,"line":1086},{"containerName":null,"kind":13,"name":"@current_matches","line":1086},{"line":1086,"containerName":null,"kind":13,"name":"$logger"},{"line":1086,"containerName":"main::","kind":12,"name":"is_debug"},{"definition":"my","line":1088,"name":"$line","kind":13,"localvar":"my","containerName":null},{"containerName":null,"kind":13,"name":"@current_matches","line":1088},{"name":"$line","kind":13,"containerName":null,"line":1089},{"containerName":null,"kind":13,"name":"$logger","line":1090},{"line":1090,"name":"debug","kind":12,"containerName":"main::"},{"definition":"my","line":1092,"name":"$ip_address","kind":13,"localvar":"my","containerName":null},{"containerName":null,"kind":13,"name":"$line","line":1092},{"name":"%line","kind":13,"containerName":null,"line":1092},{"containerName":null,"kind":13,"name":"%matches","line":1093},{"line":1093,"name":"$ip_address","kind":13,"containerName":null},{"line":1094,"containerName":null,"kind":13,"name":"$logger"},{"line":1094,"kind":12,"name":"debug","containerName":"main::"},{"kind":13,"name":"$logger","containerName":null,"line":1099},{"containerName":"main::","name":"debug","kind":12,"line":1099},{"line":1099,"name":"Dumper","kind":12},{"kind":13,"name":"$matches","containerName":null,"line":1099},{"line":1099,"name":"$logger","kind":13,"containerName":null},{"line":1099,"containerName":"main::","name":"is_debug","kind":12},{"containerName":null,"localvar":"my","line":1101,"definition":"my","name":"$log_msg","kind":13},{"containerName":null,"name":"$log_msg","kind":13,"line":1102},{"line":1102,"name":"$matches","kind":13,"containerName":null},{"kind":13,"name":"$logger","containerName":null,"line":1103},{"containerName":"main::","kind":12,"name":"info","line":1103},{"containerName":null,"name":"$log_msg","kind":13,"line":1103},{"containerName":null,"kind":13,"name":"$matches","line":1105},{"detail":"()","name":"stop","kind":12,"definition":"sub","line":1167,"containerName":"main::","signature":{"parameters":[],"label":"stop()","documentation":"### My original sub _grep_regexps() before refactor by chat gpt\n sub _grep_regexps() {\n     my ( $self, $logobj ) = @_;\n     my $TID = threads->tid;\n     $TID = \"TID: \" . $TID;\n     # my @matches = ( );\n     my $matches;\n     my @logcontents = @{ $logobj->{logcontents} };\n     my $IPs = {};\n     for my $regex ( sort keys %{ $logobj->{regexpdeny} } ) {\n         my $value = $logobj->{regexpdeny}{$regex};\n         # my $value = ${ $logobj->{regexpdeny} }{$regex};\n         $logger->info(\"$TID|Grep'ing for >>$value<< in $logobj->{file} from byte position $logobj->{seek}\");\n         my @current_matches = grep { /$value/ } @logcontents;\n         $logger->debug( \"$TID|Dumper of current matches: \" . Dumper( \\@current_matches ) ) if ( $logger->is_debug() );\n         my $array_size  = scalar(@current_matches);\n         my $array_index = 0;\n         for my $line (@current_matches) {\n             chomp($line);\n             # $logger->info(\"Checking array record $array_index of $array_size for IP address\");\n             $array_index++;\n             $logger->debug(\"$TID|Checking >>$line<< for IP address\");\n             # if (s/$REGEX_IPV4/$1/) {\n             #     $logger->debug(\"Found IPv4 address $1: \");\n             #     $matches{$1}++;\n             # }\n             my @ip_addresses = ();\n             push @ip_addresses, $line =~ /$REGEX_IPV4/g;\n             push @ip_addresses, $line =~ /$REGEX_IPV6/g;\n             map { $matches->{$_}++ && $logger->debug(\"Found IP address: $_ \") } @ip_addresses;\n             # if (s/$REGEX_IPV6/$1/) {\n             #     $logger->debug(\"$TID|Found IPv6 address $1: \");\n             #     $matches{$1}++;\n             # }\n             # my @ipv6_addresses = $_ =~ /$REGEX_IPV6/g;\n         } ## end for (@current_matches)\n     } ## end for my $regex ( sort keys...)\n     $logger->debug( \"$TID|Dump of matches: \" . Dumper( $matches ) ) if ( $logger->is_debug() );\n     my $logmsg = \"$TID|Matched IP addresses to be reviewed for potential blocking: \";\n     $logmsg .= join( \",\", sort keys %{$matches} );\n     # foreach ( sort keys %matches ) {\n     #     $logmsg .= \"$_,\";\n     # }\n     # chop $logmsg;\n     $logger->info($logmsg);\n     return $matches;\n } ## end sub _grep_regexps\n Stops the module\n  Future enhancements:\n   Clear the thread queues"},"range":{"end":{"character":9999,"line":1183},"start":{"character":0,"line":1167}},"children":[{"localvar":"my","containerName":"stop","name":"$self","kind":13,"definition":"my","line":1168},{"line":1169,"kind":13,"name":"$logger","containerName":"stop"},{"line":1169,"kind":12,"name":"info","containerName":"stop"},{"kind":13,"name":"$self","containerName":"stop","line":1172},{"line":1173,"containerName":"stop","name":"$logger","kind":13},{"line":1173,"containerName":"stop","name":"info","kind":12},{"name":"$chain","kind":13,"definition":"my","line":1174,"localvar":"my","containerName":"stop"},{"line":1174,"containerName":"stop","kind":13,"name":"$self"},{"kind":13,"name":"$logger","containerName":"stop","line":1175},{"name":"info","kind":12,"containerName":"stop","line":1175},{"line":1176,"name":"$IptablesQueue","kind":13,"containerName":"stop"},{"containerName":"stop","kind":12,"name":"enqueue","line":1176}]},{"line":1172,"kind":12,"name":"chains_created"},{"line":1174,"kind":12,"name":"chains_created"},{"line":1178,"kind":12,"name":"options"},{"kind":12,"name":"rule","line":1179},{"name":"$logger","kind":13,"containerName":null,"line":1185},{"containerName":"main::","name":"info","kind":12,"line":1185},{"containerName":null,"kind":13,"name":"$logger","line":1188},{"kind":12,"name":"info","containerName":"main::","line":1188},{"line":1189,"name":"clear_queues","kind":12},{"containerName":null,"kind":13,"name":"$logger","line":1189},{"line":1189,"containerName":"main::","kind":12,"name":"error"},{"containerName":null,"kind":13,"name":"$logger","line":1190},{"line":1190,"kind":12,"name":"info","containerName":"main::"},{"line":1191,"name":"join_threads","kind":12},{"containerName":null,"kind":13,"name":"$logger","line":1191},{"line":1191,"kind":12,"name":"error","containerName":"main::"},{"name":"$logger","kind":13,"containerName":null,"line":1193},{"containerName":"main::","name":"info","kind":12,"line":1193},{"line":1194,"name":"$lock_obj","kind":13,"containerName":null},{"containerName":"main::","kind":12,"name":"release","line":1194},{"containerName":null,"kind":13,"name":"$logger","line":1195},{"name":"info","kind":12,"containerName":"main::","line":1195},{"range":{"start":{"character":0,"line":1204},"end":{"character":9999,"line":1208}},"children":[{"containerName":"join_threads","kind":13,"name":"$logger","line":1205},{"line":1205,"containerName":"join_threads","kind":12,"name":"debug"},{"line":1206,"containerName":"join_threads","name":"join","kind":12},{"name":"list","kind":12,"containerName":"join_threads","line":1206}],"signature":{"label":"join_threads()","documentation":" Joins all threads\n   Simple sub but really needs some rework\n   If a thread is taking a while to join then it will block the other threads from joining\n   Some of the threads could be reading a log file and if the log file is large then it could take a while or\n   if the log file is causing soem kind of blocking for reading then it could take a while.\n   This may be an issue, if an example, if trying to read a file across NFS or SSHFS and there is a network issue.","parameters":[]},"containerName":"main::","line":1204,"definition":"sub","kind":12,"name":"join_threads","detail":"()"},{"kind":12,"name":"threads","line":1206},{"line":1211,"definition":"sub","kind":12,"name":"clear_queues","detail":"()","children":[{"name":"$logger","kind":13,"containerName":"clear_queues","line":1212},{"containerName":"clear_queues","kind":12,"name":"debug","line":1212},{"line":1213,"containerName":"clear_queues","name":"$DataQueue","kind":13},{"line":1213,"name":"end","kind":12,"containerName":"clear_queues"},{"line":1214,"containerName":"clear_queues","kind":13,"name":"$IptablesQueue"},{"line":1214,"name":"end","kind":12,"containerName":"clear_queues"},{"line":1215,"kind":13,"name":"$DataQueue","containerName":"clear_queues"},{"containerName":"clear_queues","name":"pending","kind":12,"line":1215},{"line":1215,"containerName":"clear_queues","name":"$IptablesQueue","kind":13},{"containerName":"clear_queues","name":"pending","kind":12,"line":1215},{"line":1216,"containerName":"clear_queues","kind":13,"name":"$DataQueue"},{"containerName":"clear_queues","kind":12,"name":"pending","line":1216},{"line":1216,"name":"$logger","kind":13,"containerName":"clear_queues"},{"line":1216,"containerName":"clear_queues","name":"debug","kind":12},{"line":1217,"containerName":"clear_queues","kind":13,"name":"$IptablesQueue"},{"containerName":"clear_queues","kind":12,"name":"pending","line":1217},{"containerName":"clear_queues","kind":13,"name":"$logger","line":1217},{"name":"debug","kind":12,"containerName":"clear_queues","line":1217},{"containerName":"clear_queues","kind":13,"name":"$DataQueue","line":1221},{"line":1221,"containerName":"clear_queues","name":"pending","kind":12},{"containerName":"clear_queues","name":"$IptablesQueue","kind":13,"line":1221},{"line":1221,"name":"pending","kind":12,"containerName":"clear_queues"},{"line":1222,"name":"$logger","kind":13,"containerName":"clear_queues"},{"containerName":"clear_queues","kind":12,"name":"error","line":1222},{"containerName":"clear_queues","kind":13,"name":"$logger","line":1226},{"kind":12,"name":"debug","containerName":"clear_queues","line":1226}],"range":{"start":{"line":1211,"character":0},"end":{"line":1229,"character":9999}},"signature":{"label":"clear_queues()","documentation":" Clears the queues","parameters":[]},"containerName":"main::"},{"definition":"sub","line":1231,"name":"reload","kind":12,"detail":"()","children":[{"containerName":"reload","name":"$logger","kind":13,"line":1232},{"line":1232,"containerName":"reload","name":"info","kind":12}],"range":{"start":{"line":1231,"character":0},"end":{"character":9999,"line":1256}},"containerName":"main::","signature":{"documentation":"","label":"reload()","parameters":[]}},{"name":"SIG_INT","kind":12,"definition":"sub","line":1260,"containerName":"main::","children":[{"line":1261,"containerName":"SIG_INT","name":"$logger","kind":13},{"line":1261,"containerName":"SIG_INT","kind":12,"name":"info"}],"range":{"start":{"line":1260,"character":0},"end":{"line":1264,"character":9999}}},{"definition":"sub","line":1268,"name":"SIG_HUP","kind":12,"range":{"end":{"line":1271,"character":9999},"start":{"character":0,"line":1268}},"children":[{"containerName":"SIG_HUP","kind":13,"name":"$logger","line":1269},{"line":1269,"containerName":"SIG_HUP","kind":12,"name":"info"}],"containerName":"main::"},{"range":{"end":{"line":1278,"character":9999},"start":{"line":1275,"character":0}},"children":[{"line":1276,"containerName":"SIG_TERM","kind":13,"name":"$logger"},{"line":1276,"name":"info","kind":12,"containerName":"SIG_TERM"}],"containerName":"main::","line":1275,"definition":"sub","kind":12,"name":"SIG_TERM"},{"definition":"sub","line":1282,"name":"SIG_QUIT","kind":12,"children":[{"definition":"my","line":1283,"name":"$self","kind":13,"localvar":"my","containerName":"SIG_QUIT"}],"range":{"start":{"character":0,"line":1282},"end":{"line":1285,"character":9999}},"containerName":"main::"},{"kind":12,"name":"set_signal_handler","detail":"()","line":1287,"definition":"sub","signature":{"label":"set_signal_handler()","documentation":"","parameters":[]},"containerName":"main::","range":{"start":{"character":0,"line":1287},"end":{"line":1294,"character":9999}},"children":[{"line":1288,"containerName":"set_signal_handler","name":"$logger","kind":13},{"containerName":"set_signal_handler","kind":12,"name":"info","line":1288},{"line":1290,"containerName":"set_signal_handler","name":"$SIG","kind":13},{"line":1291,"name":"$SIG","kind":13,"containerName":"set_signal_handler"},{"line":1292,"name":"$SIG","kind":13,"containerName":"set_signal_handler"},{"line":1293,"kind":13,"name":"$SIG","containerName":"set_signal_handler"}]},{"kind":12,"name":"INT","line":1290},{"kind":12,"name":"TERM","line":1291},{"line":1292,"kind":12,"name":"HUP"},{"line":1293,"kind":12,"name":"QUIT"}],"version":5}