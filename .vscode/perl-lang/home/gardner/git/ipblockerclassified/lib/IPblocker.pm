{"version":5,"vars":[{"containerName":"","line":36,"name":"POSIX","kind":2},{"name":"strict","line":37,"containerName":"","kind":2},{"kind":2,"line":38,"containerName":"","name":"DateTime"},{"kind":2,"line":39,"containerName":"File","name":"Basename"},{"containerName":"List","line":40,"name":"Util","kind":2},{"containerName":"","line":44,"name":"strict","kind":2},{"kind":2,"line":45,"containerName":"Time","name":"HiRes"},{"kind":2,"line":51,"name":"File","containerName":"Config"},{"kind":2,"line":52,"containerName":"","name":"Carp"},{"name":"Log4perl","line":53,"containerName":"Log","kind":2},{"kind":2,"line":54,"name":"Any","containerName":"Log"},{"containerName":"Data","line":55,"name":"Dumper","kind":2},{"containerName":"Regexp","line":56,"name":"IPv6","kind":2},{"name":"Simple","line":57,"containerName":"LockFile","kind":2},{"kind":2,"name":"Path","line":58,"containerName":"File"},{"kind":2,"containerName":"Net::Ifconfig","line":59,"name":"Wrapper"},{"kind":2,"name":"threads","line":62,"containerName":""},{"kind":2,"containerName":"Thread","line":65,"name":"Queue"},{"name":"$DataQueue","containerName":null,"localvar":"my","line":66,"definition":"my","kind":13},{"kind":12,"containerName":"Queue","line":66,"name":"Thread"},{"kind":12,"line":66,"name":"new","containerName":"main::"},{"localvar":"my","name":"$LoggerTIDS","containerName":null,"kind":13,"definition":"my","line":67},{"name":"$IptablesQueue","containerName":null,"localvar":"my","line":70,"definition":"my","kind":13},{"line":70,"name":"Thread","containerName":"Queue","kind":12},{"kind":12,"line":70,"name":"new","containerName":"main::"},{"name":"$IptablesTIDS","containerName":null,"localvar":"my","line":71,"definition":"my","kind":13},{"kind":13,"line":74,"name":"$Data","containerName":null},{"kind":12,"containerName":"Sortkeys","line":74,"name":"Dumper"},{"kind":13,"containerName":null,"line":75,"name":"$Data"},{"name":"Dumper","line":75,"containerName":"Indent","kind":12},{"line":82,"kind":13,"definition":"my","containerName":null,"name":"$logger","localvar":"my"},{"localvar":"my","containerName":null,"name":"$lock_obj","kind":13,"definition":"my","line":85},{"definition":"my","kind":13,"line":90,"localvar":"my","containerName":null,"name":"$REGEX_IPV4"},{"localvar":"my","containerName":null,"name":"$REGEX_IPV6","kind":13,"definition":"my","line":91},{"line":92,"kind":13,"definition":"my","name":"$IPTABLESRUNLINE","containerName":null,"localvar":"my"},{"containerName":"main::","line":96,"name":"%tracker","definition":"our","kind":13},{"localvar":"my","name":"%DEFAULTS","containerName":null,"definition":"my","kind":13,"line":97},{"kind":12,"line":98,"name":"allowdeny"},{"line":99,"name":"allowlist","kind":12},{"line":100,"name":"configsfile","kind":12},{"name":"cycles","line":101,"kind":12},{"name":"LONG_MAX","line":101,"kind":12},{"kind":12,"name":"cyclesleep","line":102},{"kind":12,"name":"dumpconfigsandexit","line":103},{"line":104,"name":"denylist","kind":12},{"name":"forceremovelockfile","line":105,"kind":12},{"name":"globalallowlist","line":106,"kind":12},{"kind":12,"name":"chainprefix","line":107},{"name":"globalchains","line":108,"kind":12},{"kind":12,"line":109,"name":"globaldenylist"},{"line":110,"name":"globalregexallowlist","kind":12},{"name":"globalregexdenylist","line":111,"kind":12},{"line":112,"name":"ignoreinterfaceips","kind":12},{"name":"iptables","line":113,"kind":12},{"kind":12,"line":114,"name":"lockfile"},{"kind":12,"name":"log4perlconf","line":115},{"kind":12,"name":"loglevel","line":116},{"kind":12,"name":"logcontents","line":120},{"kind":12,"name":"logs_to_review","line":121},{"kind":12,"line":122,"name":"logwatch_interval"},{"line":123,"name":"prodmode","kind":12},{"kind":12,"name":"queuechecktime","line":124},{"kind":12,"line":125,"name":"queuecycles"},{"name":"LONG_MAX","line":125,"kind":12},{"kind":12,"name":"readentirefile","line":126},{"name":"new","containerName":"main::","kind":12,"detail":"()","definition":"sub","range":{"end":{"character":9999,"line":177},"start":{"line":134,"character":0}},"line":134,"children":[{"localvar":"my","containerName":"new","name":"$class","definition":"my","kind":13,"line":135},{"containerName":"new","name":"$args","localvar":"my","line":136,"definition":"my","kind":13},{"line":138,"containerName":"new","name":"$args","kind":13},{"kind":13,"line":140,"containerName":"new","name":"$args"},{"containerName":"new","line":142,"name":"$args","kind":13},{"localvar":"my","containerName":"new","name":"$configsfile","definition":"my","kind":13,"line":147},{"line":147,"containerName":"new","name":"$args","kind":13},{"name":"$DEFAULTS","line":147,"containerName":"new","kind":13},{"line":149,"kind":13,"definition":"my","containerName":"new","name":"$self","localvar":"my"},{"line":150,"name":"$configsfile","containerName":"new","kind":13},{"name":"$args","line":151,"containerName":"new","kind":13},{"kind":13,"line":155,"containerName":"new","name":"$self"},{"line":155,"containerName":"new","name":"$class","kind":13},{"line":159,"name":"$self","containerName":"new","kind":13},{"line":159,"name":"load_configs","containerName":"new","kind":12},{"line":161,"name":"$self","containerName":"new","kind":13},{"kind":13,"line":163,"containerName":"new","name":"$self"},{"line":164,"name":"$self","containerName":"new","kind":13},{"line":165,"name":"$self","containerName":"new","kind":13},{"name":"$self","line":167,"containerName":"new","kind":13},{"kind":13,"line":172,"name":"$logger","containerName":"new"},{"kind":13,"name":"$self","line":172,"containerName":"new"},{"line":172,"name":"setup_Logger","containerName":"new","kind":12},{"containerName":"new","line":173,"name":"$logger","kind":13},{"line":173,"name":"info","containerName":"new","kind":12},{"kind":13,"containerName":"new","line":174,"name":"$logger"},{"kind":12,"line":174,"containerName":"new","name":"debug"},{"containerName":"new","line":174,"name":"$self","kind":13},{"name":"$logger","line":174,"containerName":"new","kind":13},{"kind":12,"line":174,"name":"is_debug","containerName":"new"},{"containerName":"new","line":176,"name":"$self","kind":13}],"signature":{"label":"new()","parameters":[],"documentation":"#### Subs below here #####\n Reads configs, logging configs, sets up logging, sets up a class and returns a blessed object\n   The sub go() is where the action starts"}},{"line":139,"name":"carp","kind":12},{"kind":12,"line":143,"name":"croak"},{"name":"configsfile","line":147,"kind":12},{"name":"configsfile","line":147,"kind":12},{"name":"configsfile","line":150,"kind":12},{"kind":12,"name":"clargs","line":151},{"name":"configs","line":161,"kind":12},{"kind":12,"line":161,"name":"dumpconfigsandexit"},{"kind":12,"line":163,"name":"configs"},{"kind":12,"line":163,"name":"configsfile"},{"line":164,"name":"configs","kind":12},{"kind":12,"line":164,"name":"globalchain"},{"kind":12,"line":165,"name":"configs"},{"line":165,"name":"dumpconfigsandexit","kind":12},{"name":"recursiveHashPrint","line":167,"kind":12},{"name":"configs","line":167,"kind":12},{"line":174,"name":"Dumper","kind":12},{"name":"recursiveHashPrint","containerName":"main::","signature":{"parameters":[{"label":"$ref"},{"label":"$prefix"}],"label":"recursiveHashPrint($ref,$prefix)","documentation":"# Recursive sub to print out a hash to STDOUT in a manner that matches \"use Config::File;\""},"children":[{"localvar":"my","name":"$ref","containerName":"recursiveHashPrint","definition":"my","kind":13,"line":181},{"kind":13,"line":181,"name":"$prefix","containerName":"recursiveHashPrint"},{"kind":13,"name":"$prefix","line":182,"containerName":"recursiveHashPrint"},{"kind":13,"line":182,"containerName":"recursiveHashPrint","name":"$prefix"},{"line":184,"containerName":"recursiveHashPrint","name":"$ref","kind":13},{"localvar":"my","name":"$key","containerName":"recursiveHashPrint","kind":13,"definition":"my","line":185},{"line":185,"name":"$ref","containerName":"recursiveHashPrint","kind":13},{"name":"$new_prefix","containerName":"recursiveHashPrint","localvar":"my","line":188,"definition":"my","kind":13},{"line":188,"containerName":"recursiveHashPrint","name":"$prefix","kind":13},{"line":189,"name":"$ref","containerName":"recursiveHashPrint","kind":13},{"line":189,"containerName":"recursiveHashPrint","name":"$key","kind":13},{"kind":13,"name":"$new_prefix","line":189,"containerName":"recursiveHashPrint"}],"line":180,"definition":"sub","range":{"start":{"line":180,"character":0},"end":{"line":191,"character":9999}},"detail":"($ref,$prefix)","kind":12},{"kind":13,"line":192,"containerName":null,"name":"%ref"},{"localvar":"my","containerName":null,"name":"$line","definition":"my","kind":13,"line":195},{"kind":13,"name":"$ref","line":195,"containerName":null},{"kind":13,"line":196,"containerName":null,"name":"$line"},{"line":197,"name":"$line","containerName":null,"kind":13},{"containerName":null,"line":198,"name":"%line","kind":13},{"definition":"my","kind":13,"line":202,"localvar":"my","containerName":null,"name":"$line"},{"line":203,"containerName":null,"name":"$line","kind":13},{"line":204,"name":"$line","containerName":null,"kind":13},{"containerName":null,"line":205,"name":"$line","kind":13},{"line":209,"children":[{"line":210,"definition":"my","kind":13,"containerName":"iptables_thread","name":"$self","localvar":"my"},{"line":211,"definition":"my","kind":13,"containerName":"iptables_thread","name":"$TID","localvar":"my"},{"name":"tid","line":211,"containerName":"iptables_thread","kind":12},{"line":212,"containerName":"iptables_thread","name":"$TID","kind":13},{"name":"$TID","line":212,"containerName":"iptables_thread","kind":13},{"kind":13,"definition":"my","line":214,"localvar":"my","name":"$cyclesleep","containerName":"iptables_thread"},{"kind":13,"containerName":"iptables_thread","line":214,"name":"$self"},{"definition":"my","kind":13,"line":215,"localvar":"my","containerName":"iptables_thread","name":"$cycles"},{"kind":13,"containerName":"iptables_thread","line":215,"name":"$self"},{"definition":"my","kind":13,"line":216,"localvar":"my","containerName":"iptables_thread","name":"$logmsg"},{"kind":13,"name":"$logmsg","line":217,"containerName":"iptables_thread"},{"name":"$logger","line":218,"containerName":"iptables_thread","kind":13},{"kind":12,"name":"info","line":218,"containerName":"iptables_thread"},{"containerName":"iptables_thread","line":218,"name":"$logmsg","kind":13},{"kind":13,"definition":"my","line":221,"localvar":"my","containerName":"iptables_thread","name":"$iptablesQueue_pending"},{"name":"$IptablesQueue","line":221,"containerName":"iptables_thread","kind":13},{"containerName":"iptables_thread","line":221,"name":"pending","kind":12},{"line":222,"name":"$iptablesQueue_pending","containerName":"iptables_thread","kind":13},{"kind":13,"definition":"my","line":223,"localvar":"my","name":"$logmsg","containerName":"iptables_thread"},{"line":224,"containerName":"iptables_thread","name":"$logmsg","kind":13},{"line":225,"name":"$logger","containerName":"iptables_thread","kind":13},{"line":225,"containerName":"iptables_thread","name":"info","kind":12},{"kind":13,"name":"$logmsg","line":225,"containerName":"iptables_thread"},{"containerName":"iptables_thread","line":229,"name":"$iptablesQueue_pending","kind":13},{"line":230,"containerName":"iptables_thread","name":"$logger","kind":13},{"line":230,"containerName":"iptables_thread","name":"info","kind":12},{"line":231,"kind":13,"definition":"my","name":"$data","containerName":"iptables_thread","localvar":"my"},{"line":231,"containerName":"iptables_thread","name":"$IptablesQueue","kind":13},{"kind":12,"containerName":"iptables_thread","line":231,"name":"dequeue"},{"kind":13,"name":"$logger","line":232,"containerName":"iptables_thread"},{"name":"debug","line":232,"containerName":"iptables_thread","kind":12},{"kind":13,"name":"$data","line":232,"containerName":"iptables_thread"},{"kind":13,"line":232,"containerName":"iptables_thread","name":"$logger"},{"kind":12,"line":232,"containerName":"iptables_thread","name":"is_debug"},{"line":233,"name":"$self","containerName":"iptables_thread","kind":13},{"line":233,"containerName":"iptables_thread","name":"run_iptables","kind":12},{"line":233,"name":"$data","containerName":"iptables_thread","kind":13},{"kind":13,"name":"$logger","line":233,"containerName":"iptables_thread"},{"kind":12,"line":233,"containerName":"iptables_thread","name":"error"},{"kind":13,"name":"$data","line":233,"containerName":"iptables_thread"},{"kind":13,"containerName":"iptables_thread","line":234,"name":"$IPTABLESRUNLINE"},{"kind":13,"line":235,"containerName":"iptables_thread","name":"$IPTABLESRUNLINE"},{"line":235,"containerName":"iptables_thread","name":"$IPTABLESRUNLINE","kind":13},{"containerName":"iptables_thread","line":237,"name":"$iptablesQueue_pending","kind":13},{"kind":13,"definition":"my","line":240,"localvar":"my","name":"$logmsg","containerName":"iptables_thread"},{"name":"$logmsg","line":241,"containerName":"iptables_thread","kind":13},{"line":241,"containerName":"iptables_thread","name":"$cyclesleep","kind":13},{"line":242,"containerName":"iptables_thread","name":"$logmsg","kind":13},{"kind":13,"line":243,"containerName":"iptables_thread","name":"$logger"},{"kind":12,"name":"info","line":243,"containerName":"iptables_thread"},{"line":243,"name":"$logmsg","containerName":"iptables_thread","kind":13},{"line":244,"name":"$cyclesleep","containerName":"iptables_thread","kind":13},{"line":247,"containerName":"iptables_thread","name":"$logger","kind":13},{"kind":12,"line":247,"containerName":"iptables_thread","name":"error"}],"signature":{"parameters":[],"label":"iptables_thread()","documentation":""},"kind":12,"detail":"()","definition":"sub","range":{"end":{"character":9999,"line":251},"start":{"line":209,"character":0}},"containerName":"main::","name":"iptables_thread"},{"name":"threads","line":211,"kind":12},{"line":214,"name":"configs","kind":12},{"kind":12,"name":"queuechecktime","line":214},{"kind":12,"line":215,"name":"configs"},{"kind":12,"line":215,"name":"queuecycles"},{"kind":12,"line":232,"name":"Dumper"},{"kind":12,"line":233,"name":"Dumper"},{"kind":12,"line":244,"name":"usleep"},{"name":"go","containerName":"main::","signature":{"label":"go()","parameters":[],"documentation":" Creates two initial threads:\n   One for iptables commands to run.\n   Another to watch the log files\n       This in turn creates a thread for each log file to watch\n Also starts running the DataQueue queue which handles the data"},"line":258,"children":[{"containerName":"go","name":"$self","localvar":"my","line":259,"definition":"my","kind":13},{"definition":"my","kind":13,"line":260,"localvar":"my","containerName":"go","name":"$start_time"},{"line":263,"name":"$self","containerName":"go","kind":13},{"kind":13,"containerName":"go","line":264,"name":"$logger"},{"kind":12,"containerName":"go","line":264,"name":"error"},{"kind":13,"containerName":"go","line":269,"name":"$self"},{"name":"set_iptables_command","line":269,"containerName":"go","kind":12},{"kind":13,"containerName":"go","line":269,"name":"$logger"},{"name":"error","line":269,"containerName":"go","kind":12},{"kind":13,"line":270,"name":"$self","containerName":"go"},{"containerName":"go","line":270,"name":"set_signal_handler","kind":12},{"line":271,"containerName":"go","name":"$self","kind":13},{"name":"$self","line":271,"containerName":"go","kind":13},{"kind":13,"line":272,"name":"$self","containerName":"go"},{"containerName":"go","line":272,"name":"set_lockFile","kind":12},{"kind":13,"containerName":"go","line":272,"name":"$logger"},{"kind":12,"line":272,"name":"logdie","containerName":"go"},{"kind":13,"definition":"my","line":277,"localvar":"my","containerName":"go","name":"$iptables_thr"},{"kind":12,"line":277,"containerName":"go","name":"create"},{"kind":13,"name":"$self","line":277,"containerName":"go"},{"kind":13,"line":280,"containerName":"go","name":"$self"},{"kind":12,"name":"add_global_chain","line":280,"containerName":"go"},{"line":283,"containerName":"go","name":"$self","kind":13},{"kind":12,"name":"add_global_allow_deny_ips","line":283,"containerName":"go"},{"line":287,"name":"$logger","containerName":"go","kind":13},{"kind":12,"containerName":"go","line":287,"name":"logdie"},{"kind":13,"name":"$self","line":287,"containerName":"go"},{"kind":12,"name":"logger_thread","line":287,"containerName":"go"},{"kind":13,"definition":"my","line":297,"localvar":"my","containerName":"go","name":"$cycles"},{"kind":13,"containerName":"go","line":297,"name":"$self"},{"localvar":"my","name":"$cyclesleep","containerName":"go","kind":13,"definition":"my","line":298},{"kind":13,"line":298,"containerName":"go","name":"$self"},{"name":"$cycles","line":299,"containerName":"go","kind":13},{"kind":13,"line":300,"name":"$cycles","containerName":"go"},{"line":301,"name":"$cyclesleep","containerName":"go","kind":13},{"name":"$logmsg","containerName":"go","localvar":"my","line":302,"kind":13,"definition":"my"},{"line":303,"name":"$logmsg","containerName":"go","kind":13},{"line":303,"containerName":"go","name":"$cycles","kind":13},{"line":304,"name":"$logmsg","containerName":"go","kind":13},{"line":305,"containerName":"go","name":"$logmsg","kind":13},{"name":"$cyclesleep","line":305,"containerName":"go","kind":13},{"kind":13,"line":306,"name":"$logmsg","containerName":"go"},{"line":307,"containerName":"go","name":"$logger","kind":13},{"kind":12,"name":"trace","line":307,"containerName":"go"},{"line":307,"name":"$logmsg","containerName":"go","kind":13},{"kind":13,"line":307,"name":"$logger","containerName":"go"},{"name":"is_debug","line":307,"containerName":"go","kind":12},{"kind":13,"definition":"my","line":310,"localvar":"my","containerName":"go","name":"$runtime"},{"kind":13,"name":"$start_time","line":310,"containerName":"go"},{"kind":13,"line":311,"name":"$runtime","containerName":"go"},{"kind":13,"name":"$runtime","line":311,"containerName":"go"},{"kind":13,"line":312,"containerName":"go","name":"$logger"},{"kind":12,"line":312,"name":"info","containerName":"go"},{"kind":13,"containerName":"go","line":313,"name":"$self"},{"line":313,"containerName":"go","name":"stop","kind":12}],"detail":"()","range":{"end":{"character":9999,"line":314},"start":{"character":0,"line":258}},"definition":"sub","kind":12},{"kind":12,"name":"configs","line":263},{"name":"logs_to_review","line":263,"kind":12},{"kind":12,"name":"configs","line":271},{"line":271,"name":"globalchain","kind":12},{"kind":12,"name":"configs","line":271},{"line":271,"name":"chainprefix","kind":12},{"kind":12,"line":277,"name":"threads"},{"name":"configs","line":297,"kind":12},{"line":297,"name":"cycles","kind":12},{"kind":12,"line":298,"name":"configs"},{"name":"cyclesleep","line":298,"kind":12},{"name":"usleep","line":301,"kind":12},{"signature":{"documentation":" Description:  Adds IPs on the local interfaces to the global allowlist\n  This does not work becasue it only handles IPv4 addresses and other issues","label":"add_ifconfig_ips_to_allowlist()","parameters":[]},"line":318,"children":[{"line":319,"definition":"my","kind":13,"name":"$self","containerName":"add_ifconfig_ips_to_allowlist","localvar":"my"}],"detail":"()","range":{"end":{"character":9999,"line":346},"start":{"character":0,"line":318}},"definition":"sub","kind":12,"containerName":"main::","name":"add_ifconfig_ips_to_allowlist"},{"children":[{"localvar":"my","containerName":"dataQueue_runner","name":"$self","kind":13,"definition":"my","line":349},{"containerName":"dataQueue_runner","name":"$TID","localvar":"my","line":350,"kind":13,"definition":"my"},{"kind":12,"line":350,"name":"tid","containerName":"dataQueue_runner"},{"name":"$TID","line":351,"containerName":"dataQueue_runner","kind":13},{"containerName":"dataQueue_runner","line":351,"name":"$TID","kind":13},{"line":353,"containerName":"dataQueue_runner","name":"$Data","kind":13},{"containerName":"dataQueue_runner","line":354,"name":"$Data","kind":13},{"kind":13,"containerName":"dataQueue_runner","line":356,"name":"$logger"},{"kind":12,"line":356,"name":"info","containerName":"dataQueue_runner"},{"name":"$queuechecktime","containerName":"dataQueue_runner","localvar":"my","line":357,"definition":"my","kind":13},{"line":357,"name":"$self","containerName":"dataQueue_runner","kind":13},{"kind":13,"definition":"my","line":358,"localvar":"my","containerName":"dataQueue_runner","name":"$queuecycles"},{"kind":13,"containerName":"dataQueue_runner","line":358,"name":"$self"},{"definition":"my","kind":13,"line":361,"localvar":"my","name":"$dataqueue_pending","containerName":"dataQueue_runner"},{"kind":13,"line":361,"containerName":"dataQueue_runner","name":"$DataQueue"},{"kind":12,"line":361,"containerName":"dataQueue_runner","name":"pending"},{"name":"$dataqueue_pending","line":362,"containerName":"dataQueue_runner","kind":13},{"kind":13,"name":"$logger","line":363,"containerName":"dataQueue_runner"},{"line":363,"containerName":"dataQueue_runner","name":"info","kind":12},{"name":"$dataqueue_pending","line":367,"containerName":"dataQueue_runner","kind":13},{"containerName":"dataQueue_runner","line":368,"name":"$logger","kind":13},{"containerName":"dataQueue_runner","line":368,"name":"info","kind":12},{"containerName":"dataQueue_runner","name":"$data","localvar":"my","line":369,"definition":"my","kind":13},{"name":"$DataQueue","line":369,"containerName":"dataQueue_runner","kind":13},{"kind":12,"line":369,"containerName":"dataQueue_runner","name":"dequeue"},{"name":"$logger","line":371,"containerName":"dataQueue_runner","kind":13},{"kind":12,"line":371,"containerName":"dataQueue_runner","name":"debug"},{"kind":13,"containerName":"dataQueue_runner","line":371,"name":"$data"},{"line":371,"containerName":"dataQueue_runner","name":"$logger","kind":13},{"kind":12,"name":"is_debug","line":371,"containerName":"dataQueue_runner"},{"name":"$dataqueue_pending","line":373,"containerName":"dataQueue_runner","kind":13},{"definition":"my","kind":13,"line":374,"localvar":"my","containerName":"dataQueue_runner","name":"$logmsg"},{"kind":13,"containerName":"dataQueue_runner","line":375,"name":"$logmsg"},{"line":376,"containerName":"dataQueue_runner","name":"$logger","kind":13},{"kind":12,"containerName":"dataQueue_runner","line":376,"name":"info"},{"line":376,"name":"$logmsg","containerName":"dataQueue_runner","kind":13},{"kind":13,"name":"$queuecycles","line":377,"containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","line":378,"name":"$queuecycles","kind":13},{"name":"$queuechecktime","line":379,"containerName":"dataQueue_runner","kind":13},{"line":382,"containerName":"dataQueue_runner","name":"$logger","kind":13},{"line":382,"containerName":"dataQueue_runner","name":"error","kind":12},{"kind":13,"line":387,"containerName":"dataQueue_runner","name":"$logger"},{"line":387,"containerName":"dataQueue_runner","name":"info","kind":12}],"line":348,"signature":{"documentation":"","parameters":[],"label":"dataQueue_runner()"},"kind":12,"range":{"start":{"character":0,"line":348},"end":{"line":388,"character":9999}},"definition":"sub","detail":"()","containerName":"main::","name":"dataQueue_runner"},{"kind":12,"name":"threads","line":350},{"kind":12,"containerName":"Terse","line":353,"name":"Dumper"},{"kind":12,"containerName":"Indent","line":354,"name":"Dumper"},{"name":"configs","line":357,"kind":12},{"kind":12,"name":"queuechecktime","line":357},{"kind":12,"line":358,"name":"configs"},{"name":"queuecycles","line":358,"kind":12},{"kind":12,"line":371,"name":"Dumper"},{"containerName":"main::","name":"setup_Logger","children":[{"localvar":"my","name":"$self","containerName":"setup_Logger","kind":13,"definition":"my","line":395},{"kind":13,"definition":"my","line":398,"localvar":"my","containerName":"setup_Logger","name":"$log4perlconf"},{"kind":13,"line":398,"name":"$self","containerName":"setup_Logger"},{"localvar":"my","containerName":"setup_Logger","name":"$logwatch_interval","definition":"my","kind":13,"line":399},{"line":399,"name":"$self","containerName":"setup_Logger","kind":13},{"kind":12,"line":400,"name":"init_and_watch","containerName":"setup_Logger"},{"kind":13,"line":400,"containerName":"setup_Logger","name":"$log4perlconf"},{"kind":13,"line":400,"name":"$logwatch_interval","containerName":"setup_Logger"},{"kind":12,"name":"easy_init","line":404,"containerName":"setup_Logger"},{"name":"$Log","line":404,"containerName":"setup_Logger","kind":13},{"kind":13,"line":406,"containerName":"setup_Logger","name":"$logger"},{"kind":13,"line":407,"name":"$self","containerName":"setup_Logger"},{"line":408,"containerName":"setup_Logger","name":"$logger","kind":13},{"line":408,"name":"level","containerName":"setup_Logger","kind":12},{"line":408,"containerName":"setup_Logger","name":"$self","kind":13},{"line":409,"name":"$logger","containerName":"setup_Logger","kind":13},{"line":409,"name":"info","containerName":"setup_Logger","kind":12},{"line":409,"containerName":"setup_Logger","name":"$logger","kind":13},{"line":409,"name":"level","containerName":"setup_Logger","kind":12},{"kind":13,"name":"$logger","line":416,"containerName":"setup_Logger"},{"kind":12,"name":"info","line":416,"containerName":"setup_Logger"},{"line":418,"name":"$logger","containerName":"setup_Logger","kind":13}],"line":394,"signature":{"parameters":[],"label":"setup_Logger()","documentation":" Assumptions:\n   $self->{configs}->{log4perlconf} is set\n   $self->{configs}->{logwatch_interval} is set\n These assumptions *should* be true because this is called from new()"},"kind":12,"range":{"start":{"character":0,"line":394},"end":{"line":419,"character":9999}},"definition":"sub","detail":"()"},{"name":"configs","line":398,"kind":12},{"line":398,"name":"log4perlconf","kind":12},{"name":"configs","line":399,"kind":12},{"line":399,"name":"logwatch_interval","kind":12},{"containerName":"Log4perl","line":400,"name":"Log","kind":12},{"name":"carp","line":402,"kind":12},{"line":403,"name":"carp","kind":12},{"kind":12,"line":404,"containerName":"Log4perl","name":"Log"},{"name":"Log4perl","line":404,"containerName":"DEBUG","kind":12},{"name":"get_logger","line":406,"kind":12},{"name":"croak","line":406,"kind":12},{"kind":12,"name":"configs","line":407},{"name":"loglevel","line":407,"kind":12},{"kind":12,"name":"configs","line":408},{"kind":12,"line":408,"name":"loglevel"},{"containerName":"main::","name":"set_lockFile","kind":12,"detail":"()","definition":"sub","range":{"start":{"character":0,"line":423},"end":{"line":465,"character":9999}},"line":423,"children":[{"containerName":"set_lockFile","name":"$self","localvar":"my","line":424,"kind":13,"definition":"my"},{"line":426,"name":"$self","containerName":"set_lockFile","kind":13},{"kind":13,"containerName":"set_lockFile","line":427,"name":"$logger"},{"kind":12,"line":427,"containerName":"set_lockFile","name":"logdie"},{"kind":13,"definition":"my","line":430,"localvar":"my","name":"$lockfile","containerName":"set_lockFile"},{"containerName":"set_lockFile","line":430,"name":"$self","kind":13},{"containerName":"set_lockFile","name":"$lf","localvar":"my","line":433,"kind":13,"definition":"my"},{"name":"$self","line":433,"containerName":"set_lockFile","kind":13},{"name":"$logger","line":434,"containerName":"set_lockFile","kind":13},{"kind":12,"line":434,"containerName":"set_lockFile","name":"debug"},{"containerName":"set_lockFile","line":436,"name":"$lf","kind":13},{"kind":13,"line":437,"name":"$self","containerName":"set_lockFile"},{"line":438,"name":"$logger","containerName":"set_lockFile","kind":13},{"containerName":"set_lockFile","line":438,"name":"info","kind":12},{"kind":13,"name":"$lf","line":439,"containerName":"set_lockFile"},{"name":"$logger","line":439,"containerName":"set_lockFile","kind":13},{"kind":12,"line":439,"containerName":"set_lockFile","name":"logdie"},{"definition":"my","kind":13,"line":442,"localvar":"my","name":"$fh","containerName":"set_lockFile"},{"line":442,"containerName":"set_lockFile","name":"$lf","kind":13},{"containerName":"set_lockFile","line":442,"name":"$logger","kind":13},{"kind":12,"containerName":"set_lockFile","line":442,"name":"logdie"},{"containerName":"set_lockFile","name":"@contents","localvar":"my","line":443,"kind":13,"definition":"my"},{"kind":13,"containerName":"set_lockFile","line":443,"name":"$fh"},{"containerName":"set_lockFile","line":444,"name":"$fh","kind":13},{"kind":13,"name":"@contents","line":445,"containerName":"set_lockFile"},{"definition":"my","kind":13,"line":446,"localvar":"my","name":"$printable_contents","containerName":"set_lockFile"},{"containerName":"set_lockFile","line":446,"name":"@contents","kind":13},{"containerName":"set_lockFile","name":"$logmsg","localvar":"my","line":447,"definition":"my","kind":13},{"kind":13,"containerName":"set_lockFile","line":448,"name":"$logger"},{"kind":12,"containerName":"set_lockFile","line":448,"name":"info"},{"kind":13,"containerName":"set_lockFile","line":448,"name":"$logmsg"},{"kind":13,"name":"$lf","line":452,"containerName":"set_lockFile"},{"kind":13,"containerName":"set_lockFile","line":452,"name":"$logger"},{"kind":12,"line":452,"name":"logdie","containerName":"set_lockFile"},{"kind":13,"line":455,"name":"$self","containerName":"set_lockFile"},{"kind":12,"name":"make","line":455,"containerName":"set_lockFile"},{"containerName":"set_lockFile","line":458,"name":"$logger","kind":13},{"line":458,"containerName":"set_lockFile","name":"debug","kind":12},{"line":458,"containerName":"set_lockFile","name":"$self","kind":13},{"kind":13,"line":458,"name":"$logger","containerName":"set_lockFile"},{"kind":12,"containerName":"set_lockFile","line":458,"name":"is_debug"},{"line":459,"name":"$self","containerName":"set_lockFile","kind":13},{"name":"$self","line":459,"containerName":"set_lockFile","kind":13},{"line":459,"name":"lock","containerName":"set_lockFile","kind":12},{"name":"$lf","line":459,"containerName":"set_lockFile","kind":13},{"name":"$logger","line":460,"containerName":"set_lockFile","kind":13},{"kind":12,"line":460,"containerName":"set_lockFile","name":"logdie"},{"line":461,"containerName":"set_lockFile","name":"$lock_obj","kind":13},{"containerName":"set_lockFile","line":461,"name":"$self","kind":13},{"kind":13,"line":463,"containerName":"set_lockFile","name":"$logger"},{"name":"info","line":463,"containerName":"set_lockFile","kind":12}],"signature":{"documentation":" Set lock file\n   Returns 1 if lock file is set, otherwise returns 0","label":"set_lockFile()","parameters":[]}},{"line":426,"name":"configs","kind":12},{"kind":12,"name":"lockfile","line":426},{"kind":12,"line":430,"name":"configs"},{"name":"lockfile","line":430,"kind":12},{"kind":12,"name":"configs","line":433},{"kind":12,"name":"lockfile","line":433},{"line":437,"name":"configs","kind":12},{"line":437,"name":"forceremovelockfile","kind":12},{"line":455,"name":"lockmgr","kind":12},{"line":455,"containerName":"Simple","name":"LockFile","kind":12},{"line":458,"name":"Dumper","kind":12},{"kind":12,"name":"lockmgr","line":458},{"kind":12,"line":459,"name":"lock"},{"kind":12,"name":"lockmgr","line":459},{"kind":12,"name":"lock","line":461},{"signature":{"documentation":"# Description: Creates a thread for each log file to review\n# Returns 1 or dies if thread can not be created","label":"logger_thread()","parameters":[]},"line":469,"children":[{"line":470,"kind":13,"definition":"my","name":"$self","containerName":"logger_thread","localvar":"my"},{"kind":13,"definition":"my","line":472,"localvar":"my","name":"$logstoreview","containerName":"logger_thread"},{"kind":13,"line":472,"name":"$self","containerName":"logger_thread"},{"kind":13,"line":473,"name":"$logstoreview","containerName":"logger_thread"},{"localvar":"my","name":"$logtoreview","containerName":"logger_thread","definition":"my","kind":13,"line":476},{"kind":13,"line":476,"containerName":"logger_thread","name":"$logstoreview"}],"detail":"()","range":{"start":{"character":0,"line":469},"end":{"line":476,"character":9999}},"definition":"sub","kind":12,"containerName":"main::","name":"logger_thread"},{"kind":12,"name":"configs","line":472},{"kind":12,"name":"logs_to_review","line":472},{"kind":13,"line":477,"containerName":null,"name":"$logger"},{"kind":12,"name":"info","line":477,"containerName":"main::"},{"line":478,"kind":13,"definition":"my","containerName":null,"name":"$logobj","localvar":"my"},{"kind":13,"line":478,"containerName":null,"name":"%logstoreview"},{"kind":13,"name":"$logtoreview","line":478,"containerName":null},{"containerName":null,"line":479,"name":"%logobj","kind":13},{"line":479,"name":"chain","kind":12},{"kind":13,"name":"$logtoreview","line":479,"containerName":null},{"kind":13,"definition":"my","line":481,"localvar":"my","containerName":null,"name":"$thr"},{"kind":12,"name":"threads","line":481},{"name":"create","line":481,"containerName":"main::","kind":12},{"name":"review_log","line":481,"kind":12},{"line":481,"containerName":null,"name":"$self","kind":13},{"kind":13,"line":481,"containerName":null,"name":"$logobj"},{"kind":13,"containerName":null,"line":481,"name":"$logger"},{"kind":12,"containerName":"main::","line":481,"name":"logdie"},{"kind":13,"name":"$LoggerTIDS","line":482,"containerName":null},{"line":482,"name":"$thr","containerName":null,"kind":13},{"kind":12,"containerName":"main::","line":482,"name":"tid"},{"kind":13,"containerName":null,"line":483,"name":"$logger"},{"line":483,"name":"debug","containerName":"main::","kind":12},{"line":483,"containerName":null,"name":"$thr","kind":13},{"kind":12,"containerName":"main::","line":483,"name":"tid"},{"containerName":null,"line":483,"name":"$logger","kind":13},{"name":"is_debug","line":483,"containerName":"main::","kind":12},{"kind":13,"line":484,"name":"$logger","containerName":null},{"kind":12,"line":484,"containerName":"main::","name":"debug"},{"containerName":null,"line":484,"name":"$thr","kind":13},{"containerName":"main::","line":484,"name":"tid","kind":12},{"kind":13,"line":484,"containerName":null,"name":"$thr"},{"line":484,"name":"is_running","containerName":"main::","kind":12},{"kind":13,"line":484,"containerName":null,"name":"$logger"},{"kind":12,"line":484,"name":"is_debug","containerName":"main::"},{"line":492,"children":[{"containerName":"prepare_directions","name":"$self","localvar":"my","line":493,"definition":"my","kind":13},{"containerName":"prepare_directions","line":493,"name":"$logobj","kind":13},{"localvar":"my","containerName":"prepare_directions","name":"$TID","kind":13,"definition":"my","line":494},{"kind":12,"line":494,"containerName":"prepare_directions","name":"tid"},{"name":"$TID","line":495,"containerName":"prepare_directions","kind":13},{"name":"$TID","line":495,"containerName":"prepare_directions","kind":13},{"line":497,"definition":"my","kind":13,"containerName":"prepare_directions","name":"@directions","localvar":"my"},{"kind":13,"containerName":"prepare_directions","line":497,"name":"$logobj"},{"kind":13,"name":"$logobj","line":497,"containerName":"prepare_directions"},{"line":498,"name":"@directions","containerName":"prepare_directions","kind":13},{"kind":13,"line":498,"name":"@directions","containerName":"prepare_directions"},{"kind":13,"containerName":"prepare_directions","line":499,"name":"@directions"},{"kind":13,"line":499,"name":"@directions","containerName":"prepare_directions"},{"kind":13,"name":"@directions","line":500,"containerName":"prepare_directions"},{"kind":13,"line":500,"name":"@directions","containerName":"prepare_directions"},{"containerName":"prepare_directions","line":501,"name":"@directions","kind":13},{"name":"@directions","line":501,"containerName":"prepare_directions","kind":13},{"line":502,"name":"@directions","containerName":"prepare_directions","kind":13}],"signature":{"documentation":"","label":"prepare_directions()","parameters":[]},"kind":12,"detail":"()","definition":"sub","range":{"start":{"character":0,"line":492},"end":{"character":9999,"line":503}},"containerName":"main::","name":"prepare_directions"},{"kind":12,"line":494,"name":"threads"},{"line":497,"name":"directions","kind":12},{"kind":12,"name":"directions","line":497},{"kind":12,"name":"any","line":500},{"kind":12,"detail":"()","range":{"start":{"character":0,"line":507},"end":{"character":9999,"line":622}},"definition":"sub","line":507,"children":[{"definition":"my","kind":13,"line":508,"localvar":"my","containerName":"review_log","name":"$self"},{"line":508,"name":"$logobj","containerName":"review_log","kind":13},{"localvar":"my","name":"$TID","containerName":"review_log","definition":"my","kind":13,"line":509},{"kind":12,"containerName":"review_log","line":509,"name":"tid"},{"kind":13,"line":510,"containerName":"review_log","name":"$TID"},{"name":"$TID","line":510,"containerName":"review_log","kind":13},{"name":"$start_time","containerName":"review_log","localvar":"my","line":511,"definition":"my","kind":13},{"kind":13,"containerName":"review_log","line":513,"name":"$logobj"},{"containerName":"review_log","name":"$chain","localvar":"my","line":514,"definition":"my","kind":13},{"containerName":"review_log","line":514,"name":"$self","kind":13},{"line":514,"containerName":"review_log","name":"$logobj","kind":13},{"kind":13,"line":515,"containerName":"review_log","name":"$logger"},{"kind":12,"line":515,"name":"info","containerName":"review_log"},{"kind":13,"containerName":"review_log","line":516,"name":"$logger"},{"kind":12,"line":516,"containerName":"review_log","name":"debug"},{"kind":13,"name":"$logobj","line":516,"containerName":"review_log"},{"name":"$logger","line":516,"containerName":"review_log","kind":13},{"kind":12,"name":"is_debug","line":516,"containerName":"review_log"},{"localvar":"my","containerName":"review_log","name":"$cycles","definition":"my","kind":13,"line":519},{"containerName":"review_log","line":519,"name":"$logobj","kind":13},{"line":520,"definition":"my","kind":13,"name":"$cyclesleep","containerName":"review_log","localvar":"my"},{"line":520,"containerName":"review_log","name":"$logobj","kind":13},{"localvar":"my","name":"$microcyclesleep","containerName":"review_log","kind":13,"definition":"my","line":521},{"kind":13,"line":521,"containerName":"review_log","name":"$cyclesleep"},{"kind":13,"line":523,"name":"$logger","containerName":"review_log"},{"kind":12,"name":"info","line":523,"containerName":"review_log"},{"kind":13,"name":"$logger","line":528,"containerName":"review_log"},{"kind":12,"line":528,"name":"info","containerName":"review_log"},{"containerName":"review_log","line":529,"name":"$self","kind":13},{"containerName":"review_log","line":529,"name":"add_chain","kind":12},{"containerName":"review_log","line":529,"name":"$chain","kind":13},{"definition":"my","kind":13,"line":532,"localvar":"my","name":"$globalchain","containerName":"review_log"},{"line":532,"containerName":"review_log","name":"$self","kind":13},{"kind":13,"line":533,"containerName":"review_log","name":"$logger"},{"kind":12,"containerName":"review_log","line":533,"name":"debug"},{"containerName":"review_log","line":534,"name":"$self","kind":13},{"line":534,"name":"iptablesqueue_enqueue","containerName":"review_log","kind":12},{"containerName":"review_log","line":536,"name":"$self","kind":13},{"line":536,"containerName":"review_log","name":"add_logger_allow_deny_ips","kind":12},{"kind":13,"containerName":"review_log","line":536,"name":"$logobj"},{"line":539,"kind":13,"definition":"my","containerName":"review_log","name":"@directions","localvar":"my"},{"line":539,"name":"$self","containerName":"review_log","kind":13},{"kind":12,"line":539,"name":"prepare_directions","containerName":"review_log"},{"kind":13,"line":539,"containerName":"review_log","name":"$logobj"},{"kind":13,"definition":"my","line":540,"localvar":"my","name":"@protocols","containerName":"review_log"},{"line":540,"containerName":"review_log","name":"$logobj","kind":13},{"kind":13,"line":540,"containerName":"review_log","name":"$logobj"},{"definition":"my","kind":13,"line":541,"localvar":"my","containerName":"review_log","name":"$ports"},{"kind":13,"line":541,"containerName":"review_log","name":"$logobj"},{"kind":13,"line":543,"name":"$cycles","containerName":"review_log"},{"containerName":"review_log","name":"$start_loop_time","localvar":"my","line":544,"definition":"my","kind":13},{"kind":13,"line":545,"name":"$logger","containerName":"review_log"},{"containerName":"review_log","line":545,"name":"info","kind":12},{"name":"$logobj","line":546,"containerName":"review_log","kind":13},{"kind":13,"line":546,"containerName":"review_log","name":"$self"},{"kind":12,"name":"readlogfile","line":546,"containerName":"review_log"},{"containerName":"review_log","line":546,"name":"$logobj","kind":13},{"kind":13,"line":547,"containerName":"review_log","name":"$logobj"},{"containerName":"review_log","line":547,"name":"$self","kind":13},{"kind":12,"name":"_grep_regexps","line":547,"containerName":"review_log"},{"kind":13,"line":547,"name":"$logobj","containerName":"review_log"},{"kind":13,"containerName":"review_log","line":547,"name":"$logobj"},{"line":551,"containerName":"review_log","name":"$logger","kind":13},{"kind":12,"line":551,"containerName":"review_log","name":"debug"},{"kind":13,"name":"$logobj","line":551,"containerName":"review_log"},{"kind":13,"name":"$logger","line":552,"containerName":"review_log"},{"kind":12,"line":552,"name":"is_debug","containerName":"review_log"},{"localvar":"my","containerName":"review_log","name":"@rules","definition":"my","kind":13,"line":554},{"containerName":"review_log","name":"$ip","localvar":"my","line":555,"kind":13,"definition":"my"},{"kind":13,"containerName":"review_log","line":555,"name":"$logobj"},{"kind":13,"containerName":"review_log","line":556,"name":"$logger"},{"line":556,"containerName":"review_log","name":"debug","kind":12},{"containerName":"review_log","name":"$direction","localvar":"my","line":558,"kind":13,"definition":"my"},{"kind":13,"containerName":"review_log","line":558,"name":"@directions"},{"line":559,"kind":13,"definition":"my","containerName":"review_log","name":"$direction_switch","localvar":"my"},{"containerName":"review_log","line":559,"name":"$direction","kind":13},{"name":"$randval","containerName":"review_log","localvar":"my","line":560,"definition":"my","kind":13},{"kind":13,"name":"$direction_switch","line":561,"containerName":"review_log"},{"kind":13,"name":"$direction","line":561,"containerName":"review_log"},{"containerName":"review_log","line":562,"name":"$logger","kind":13},{"line":562,"containerName":"review_log","name":"info","kind":12},{"containerName":"review_log","name":"$base_rule","localvar":"my","line":563,"kind":13,"definition":"my"},{"kind":13,"name":"$logger","line":564,"containerName":"review_log"},{"name":"debug","line":564,"containerName":"review_log","kind":12},{"kind":13,"line":566,"name":"@protocols","containerName":"review_log"},{"localvar":"my","name":"$protocol","containerName":"review_log","kind":13,"definition":"my","line":567},{"name":"@protocols","line":567,"containerName":"review_log","kind":13},{"localvar":"my","containerName":"review_log","name":"$rule","kind":13,"definition":"my","line":568},{"name":"$base_rule","line":568,"containerName":"review_log","kind":13},{"kind":13,"line":569,"name":"$logger","containerName":"review_log"},{"name":"debug","line":569,"containerName":"review_log","kind":12},{"kind":13,"line":570,"name":"$logobj","containerName":"review_log"},{"kind":13,"containerName":"review_log","line":574,"name":"$rule"},{"kind":13,"line":576,"containerName":"review_log","name":"$logger"},{"line":576,"name":"debug","containerName":"review_log","kind":12},{"line":577,"name":"@rules","containerName":"review_log","kind":13},{"kind":13,"line":581,"containerName":"review_log","name":"$logger"},{"line":581,"name":"debug","containerName":"review_log","kind":12},{"containerName":"review_log","line":582,"name":"@rules","kind":13},{"line":587,"containerName":"review_log","name":"$logger","kind":13},{"kind":12,"containerName":"review_log","line":587,"name":"debug"},{"name":"@rules","line":587,"containerName":"review_log","kind":13},{"kind":13,"containerName":"review_log","line":588,"name":"$logger"},{"kind":12,"containerName":"review_log","line":588,"name":"is_debug"},{"containerName":"review_log","name":"$eject","localvar":"my","line":589,"kind":13,"definition":"my"},{"localvar":"my","name":"$rule","containerName":"review_log","definition":"my","kind":13,"line":590},{"containerName":"review_log","line":590,"name":"@rules","kind":13},{"kind":13,"line":591,"containerName":"review_log","name":"$tracker"},{"line":592,"containerName":"review_log","name":"$logger","kind":13},{"kind":12,"line":592,"name":"debug","containerName":"review_log"},{"localvar":"my","name":"$args","containerName":"review_log","definition":"my","kind":13,"line":595},{"containerName":"review_log","line":599,"name":"$logger","kind":13},{"kind":12,"line":599,"containerName":"review_log","name":"debug"},{"kind":13,"containerName":"review_log","line":600,"name":"$tracker"},{"name":"$self","line":603,"containerName":"review_log","kind":13},{"name":"iptablesqueue_enqueue","line":603,"containerName":"review_log","kind":12},{"kind":13,"line":603,"containerName":"review_log","name":"$args"},{"kind":13,"name":"$eject","line":603,"containerName":"review_log"},{"line":606,"kind":13,"definition":"my","containerName":"review_log","name":"$logmsg","localvar":"my"},{"name":"$eject","line":607,"containerName":"review_log","kind":13},{"line":607,"containerName":"review_log","name":"$logger","kind":13},{"kind":12,"name":"info","line":607,"containerName":"review_log"},{"line":607,"name":"$logmsg","containerName":"review_log","kind":13},{"line":609,"name":"$logobj","containerName":"review_log","kind":13},{"line":613,"containerName":"review_log","name":"$self","kind":13},{"kind":12,"containerName":"review_log","line":613,"name":"iptablesqueue_enqueue"},{"containerName":"review_log","name":"$timediff","localvar":"my","line":615,"definition":"my","kind":13},{"kind":13,"line":615,"name":"$start_loop_time","containerName":"review_log"},{"name":"$timediff","line":616,"containerName":"review_log","kind":13},{"kind":13,"containerName":"review_log","line":616,"name":"$timediff"},{"kind":13,"containerName":"review_log","line":617,"name":"$logger"},{"containerName":"review_log","line":617,"name":"info","kind":12},{"name":"$cycles","line":619,"containerName":"review_log","kind":13},{"kind":13,"name":"$logger","line":620,"containerName":"review_log"},{"kind":12,"line":620,"containerName":"review_log","name":"info"},{"containerName":"review_log","line":621,"name":"$microcyclesleep","kind":13}],"signature":{"label":"review_log()","parameters":[],"documentation":" This is called as a thread and runs a loop to check the log file for new entries\n   Prior to checking the log file, it creates a chain for the log file and adds it to the global chain"},"containerName":"main::","name":"review_log"},{"name":"threads","line":509,"kind":12},{"line":514,"name":"configs","kind":12},{"kind":12,"name":"chainprefix","line":514},{"kind":12,"name":"chain","line":514},{"name":"Dumper","line":516,"kind":12},{"line":519,"name":"cycles","kind":12},{"line":519,"name":"LONG_MAX","kind":12},{"kind":12,"name":"cyclesleep","line":520},{"line":532,"name":"configs","kind":12},{"name":"globalchain","line":532,"kind":12},{"line":534,"name":"options","kind":12},{"kind":12,"line":534,"name":"rule"},{"kind":12,"line":540,"name":"protocols"},{"kind":12,"line":540,"name":"protocols"},{"kind":12,"name":"ports","line":541},{"kind":12,"line":547,"name":"ips_to_block"},{"line":547,"name":"logcontents","kind":12},{"line":551,"name":"Dumper","kind":12},{"name":"ips_to_block","line":551,"kind":12},{"kind":12,"name":"ips_to_block","line":555},{"kind":12,"name":"ports","line":570},{"kind":12,"name":"Dumper","line":587},{"name":"iptables_rules","line":591,"kind":12},{"kind":12,"line":596,"name":"options"},{"name":"rule","line":597,"kind":12},{"name":"iptables_rules","line":600,"kind":12},{"kind":12,"name":"ips_to_block","line":609},{"name":"check_pending","line":613,"kind":12},{"line":621,"name":"usleep","kind":12},{"line":624,"kind":13,"definition":"my","containerName":null,"name":"$runtime","localvar":"my"},{"line":624,"name":"$start_time","containerName":null,"kind":13},{"line":625,"name":"$runtime","containerName":null,"kind":13},{"line":625,"containerName":null,"name":"$runtime","kind":13},{"name":"$cycles_completed","containerName":null,"localvar":"my","line":626,"kind":13,"definition":"my"},{"line":626,"containerName":null,"name":"%logobj","kind":13},{"name":"cycles","line":626,"kind":12},{"containerName":null,"line":626,"name":"$cycles","kind":13},{"line":627,"definition":"my","kind":13,"name":"$logmsg","containerName":null,"localvar":"my"},{"kind":13,"containerName":null,"line":628,"name":"$logmsg"},{"line":629,"containerName":null,"name":"$logger","kind":13},{"name":"info","line":629,"containerName":"main::","kind":12},{"kind":13,"line":629,"name":"$logmsg","containerName":null},{"children":[{"definition":"my","kind":13,"line":635,"localvar":"my","containerName":"load_configs","name":"$self"},{"localvar":"my","containerName":"load_configs","name":"$configsfile","kind":13,"definition":"my","line":636},{"kind":13,"line":636,"name":"$self","containerName":"load_configs"},{"line":637,"definition":"my","kind":13,"containerName":"load_configs","name":"$clargs","localvar":"my"},{"kind":13,"containerName":"load_configs","line":637,"name":"$self"},{"line":639,"containerName":"load_configs","name":"$configsfile","kind":13},{"kind":13,"line":642,"containerName":"load_configs","name":"$self"},{"kind":13,"line":642,"name":"$self","containerName":"load_configs"},{"line":643,"containerName":"load_configs","name":"$self","kind":13},{"kind":13,"name":"$self","line":643,"containerName":"load_configs"},{"line":644,"containerName":"load_configs","name":"$self","kind":13},{"localvar":"my","containerName":"load_configs","name":"$msg","definition":"my","kind":13,"line":649},{"kind":13,"name":"$msg","line":650,"containerName":"load_configs"},{"name":"$msg","line":651,"containerName":"load_configs","kind":13},{"kind":13,"line":651,"containerName":"load_configs","name":"$clargs"},{"containerName":"load_configs","line":652,"name":"$msg","kind":13},{"line":652,"name":"$DEFAULTS","containerName":"load_configs","kind":13},{"line":653,"containerName":"load_configs","name":"$msg","kind":13},{"kind":13,"containerName":"load_configs","line":654,"name":"$msg"},{"kind":13,"containerName":"load_configs","line":655,"name":"$msg"},{"kind":13,"definition":"my","line":658,"localvar":"my","name":"$config","containerName":"load_configs"},{"line":658,"containerName":"load_configs","name":"$DEFAULTS","kind":13}],"line":634,"definition":"sub","range":{"end":{"line":658,"character":9999},"start":{"character":0,"line":634}},"kind":12,"name":"load_configs","containerName":"main::"},{"kind":12,"line":636,"name":"configsfile"},{"line":637,"name":"clargs","kind":12},{"kind":12,"line":642,"name":"configs"},{"name":"Config","line":642,"containerName":"File::read_config_file","kind":12},{"name":"configsfile","line":642,"kind":12},{"line":643,"name":"configs","kind":12},{"kind":12,"line":643,"name":"globalchain"},{"kind":12,"line":643,"name":"configs"},{"kind":12,"name":"globalchain","line":643},{"kind":12,"line":644,"name":"configs"},{"kind":12,"name":"globalchain","line":644},{"kind":12,"name":"Dumper","line":651},{"kind":12,"line":652,"name":"Dumper"},{"kind":12,"name":"carp","line":654},{"kind":13,"line":662,"containerName":null,"name":"%self"},{"kind":12,"line":662,"name":"configs"},{"kind":13,"line":662,"name":"$config","containerName":null},{"name":"%clargs","line":663,"containerName":null,"kind":13},{"name":"$config","line":663,"containerName":null,"kind":13},{"name":"%clargs","line":664,"containerName":null,"kind":13},{"kind":13,"line":664,"name":"$config","containerName":null},{"kind":13,"line":665,"containerName":null,"name":"%self"},{"name":"configs","line":665,"kind":12},{"kind":13,"name":"$config","line":665,"containerName":null},{"name":"%DEFAULTS","line":665,"containerName":null,"kind":13},{"name":"$config","line":665,"containerName":null,"kind":13},{"line":668,"name":"%self","containerName":null,"kind":13},{"kind":12,"name":"configs","line":668},{"containerName":"main::","name":"reverseMapHash","detail":"()","range":{"start":{"character":0,"line":672},"end":{"character":9999,"line":679}},"definition":"sub","kind":12,"signature":{"documentation":" Special helper function for clean_ips_to_block()","label":"reverseMapHash()","parameters":[]},"line":672,"children":[{"line":673,"definition":"my","kind":13,"containerName":"reverseMapHash","name":"$self","localvar":"my"},{"name":"$hash","containerName":"reverseMapHash","localvar":"my","line":674,"kind":13,"definition":"my"},{"line":678,"definition":"my","kind":13,"name":"$new_hash","containerName":"reverseMapHash","localvar":"my"},{"kind":13,"definition":"my","line":679,"localvar":"my","containerName":"reverseMapHash","name":"$key"},{"name":"$hash","line":679,"containerName":"reverseMapHash","kind":13}]},{"kind":13,"line":680,"name":"%new_hash","containerName":null},{"line":680,"containerName":null,"name":"%hash","kind":13},{"kind":13,"line":680,"name":"$key","containerName":null},{"line":684,"containerName":null,"name":"$new_hash","kind":13},{"kind":12,"detail":"()","definition":"sub","range":{"end":{"character":9999,"line":698},"start":{"character":0,"line":689}},"line":689,"children":[{"line":690,"kind":13,"definition":"my","containerName":"clean_ips_to_block_combined","name":"$self","localvar":"my"},{"name":"$logobj","containerName":"clean_ips_to_block_combined","localvar":"my","line":691,"definition":"my","kind":13},{"name":"$TID","containerName":"clean_ips_to_block_combined","localvar":"my","line":692,"kind":13,"definition":"my"},{"kind":12,"line":692,"name":"tid","containerName":"clean_ips_to_block_combined"},{"containerName":"clean_ips_to_block_combined","line":693,"name":"$TID","kind":13},{"containerName":"clean_ips_to_block_combined","line":693,"name":"$TID","kind":13},{"kind":13,"containerName":"clean_ips_to_block_combined","line":695,"name":"$Data"},{"kind":13,"name":"$Data","line":696,"containerName":"clean_ips_to_block_combined"}],"signature":{"parameters":[],"label":"clean_ips_to_block_combined()","documentation":" Description: Combines the IPs from regex from the log to be blocked and the IPs from the allow/deny lists into\n               one hash"},"containerName":"main::","name":"clean_ips_to_block_combined"},{"kind":12,"line":692,"name":"threads"},{"kind":12,"name":"Dumper","line":695,"containerName":"Terse"},{"line":696,"containerName":"Indent","name":"Dumper","kind":12},{"children":[{"definition":"my","kind":13,"line":704,"localvar":"my","name":"$self","containerName":"clean_ips_to_block_allowdeny"},{"line":705,"kind":13,"definition":"my","containerName":"clean_ips_to_block_allowdeny","name":"$logobj","localvar":"my"},{"kind":13,"definition":"my","line":706,"localvar":"my","containerName":"clean_ips_to_block_allowdeny","name":"$TID"},{"containerName":"clean_ips_to_block_allowdeny","line":706,"name":"tid","kind":12},{"line":707,"containerName":"clean_ips_to_block_allowdeny","name":"$TID","kind":13},{"kind":13,"containerName":"clean_ips_to_block_allowdeny","line":707,"name":"$TID"},{"kind":13,"line":709,"containerName":"clean_ips_to_block_allowdeny","name":"$Data"},{"line":710,"name":"$Data","containerName":"clean_ips_to_block_allowdeny","kind":13},{"name":"$allowdeny","containerName":"clean_ips_to_block_allowdeny","localvar":"my","line":714,"kind":13,"definition":"my"},{"kind":13,"line":714,"name":"$logobj","containerName":"clean_ips_to_block_allowdeny"},{"line":714,"containerName":"clean_ips_to_block_allowdeny","name":"$self","kind":13},{"localvar":"my","name":"$logobj_allowlist","containerName":"clean_ips_to_block_allowdeny","definition":"my","kind":13,"line":715},{"name":"$logobj","line":715,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"kind":13,"name":"$self","line":715,"containerName":"clean_ips_to_block_allowdeny"},{"localvar":"my","containerName":"clean_ips_to_block_allowdeny","name":"$logobj_denylist","definition":"my","kind":13,"line":716},{"kind":13,"line":716,"name":"$logobj","containerName":"clean_ips_to_block_allowdeny"},{"line":716,"name":"$self","containerName":"clean_ips_to_block_allowdeny","kind":13},{"kind":13,"definition":"my","line":717,"localvar":"my","containerName":"clean_ips_to_block_allowdeny","name":"$global_denylist"},{"name":"$self","line":717,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"localvar":"my","containerName":"clean_ips_to_block_allowdeny","name":"$global_allowlist","definition":"my","kind":13,"line":718},{"kind":13,"containerName":"clean_ips_to_block_allowdeny","line":718,"name":"$self"},{"name":"$ips_to_block","containerName":"clean_ips_to_block_allowdeny","localvar":"my","line":720,"definition":"my","kind":13},{"kind":13,"containerName":"clean_ips_to_block_allowdeny","line":720,"name":"$logobj"},{"kind":13,"name":"$logobj_allowlist","line":723,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$self","line":723,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"line":723,"name":"reverseMapHash","containerName":"clean_ips_to_block_allowdeny","kind":12},{"kind":13,"line":723,"containerName":"clean_ips_to_block_allowdeny","name":"$logobj_allowlist"},{"containerName":"clean_ips_to_block_allowdeny","line":724,"name":"$logobj_denylist","kind":13},{"containerName":"clean_ips_to_block_allowdeny","line":724,"name":"$self","kind":13},{"kind":12,"line":724,"name":"reverseMapHash","containerName":"clean_ips_to_block_allowdeny"},{"name":"$logobj_denylist","line":724,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"line":725,"containerName":"clean_ips_to_block_allowdeny","name":"$global_allowlist","kind":13},{"line":725,"containerName":"clean_ips_to_block_allowdeny","name":"$self","kind":13},{"kind":12,"name":"reverseMapHash","line":725,"containerName":"clean_ips_to_block_allowdeny"},{"line":725,"containerName":"clean_ips_to_block_allowdeny","name":"$global_allowlist","kind":13},{"kind":13,"line":726,"containerName":"clean_ips_to_block_allowdeny","name":"$global_denylist"},{"kind":13,"containerName":"clean_ips_to_block_allowdeny","line":726,"name":"$self"},{"line":726,"name":"reverseMapHash","containerName":"clean_ips_to_block_allowdeny","kind":12},{"kind":13,"name":"$global_denylist","line":726,"containerName":"clean_ips_to_block_allowdeny"},{"line":729,"containerName":"clean_ips_to_block_allowdeny","name":"$logger","kind":13},{"kind":12,"line":729,"containerName":"clean_ips_to_block_allowdeny","name":"info"},{"kind":13,"line":730,"name":"$logger","containerName":"clean_ips_to_block_allowdeny"},{"kind":12,"line":730,"name":"debug","containerName":"clean_ips_to_block_allowdeny"},{"kind":13,"containerName":"clean_ips_to_block_allowdeny","line":730,"name":"$logobj_allowlist"},{"kind":13,"containerName":"clean_ips_to_block_allowdeny","line":730,"name":"$logger"},{"kind":12,"line":730,"name":"is_debug","containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","line":731,"name":"$logger","kind":13},{"line":731,"name":"debug","containerName":"clean_ips_to_block_allowdeny","kind":12},{"kind":13,"containerName":"clean_ips_to_block_allowdeny","line":731,"name":"$logobj_denylist"},{"kind":13,"name":"$logger","line":731,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","line":731,"name":"is_debug","kind":12},{"kind":13,"containerName":"clean_ips_to_block_allowdeny","line":732,"name":"$logger"},{"line":732,"name":"debug","containerName":"clean_ips_to_block_allowdeny","kind":12},{"name":"$ips_to_block","line":732,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"kind":13,"name":"$logger","line":732,"containerName":"clean_ips_to_block_allowdeny"},{"kind":12,"name":"is_debug","line":732,"containerName":"clean_ips_to_block_allowdeny"},{"kind":13,"line":733,"containerName":"clean_ips_to_block_allowdeny","name":"$logger"},{"line":733,"containerName":"clean_ips_to_block_allowdeny","name":"debug","kind":12},{"kind":13,"containerName":"clean_ips_to_block_allowdeny","line":733,"name":"$global_allowlist"},{"kind":13,"line":733,"name":"$logger","containerName":"clean_ips_to_block_allowdeny"},{"kind":12,"name":"is_debug","line":733,"containerName":"clean_ips_to_block_allowdeny"},{"kind":13,"line":734,"containerName":"clean_ips_to_block_allowdeny","name":"$logger"},{"line":734,"containerName":"clean_ips_to_block_allowdeny","name":"debug","kind":12},{"kind":13,"line":734,"name":"$global_denylist","containerName":"clean_ips_to_block_allowdeny"},{"line":734,"containerName":"clean_ips_to_block_allowdeny","name":"$logger","kind":13},{"kind":12,"line":734,"containerName":"clean_ips_to_block_allowdeny","name":"is_debug"},{"line":737,"kind":13,"definition":"my","name":"$allowlist","containerName":"clean_ips_to_block_allowdeny","localvar":"my"},{"line":737,"name":"$global_allowlist","containerName":"clean_ips_to_block_allowdeny","kind":13},{"kind":13,"line":737,"containerName":"clean_ips_to_block_allowdeny","name":"$logobj_allowlist"}],"line":703,"signature":{"documentation":" Description: Returns the logobj with ips_to_block set with the IPs to block from the allow/deny lists\n   There is a lot of logging available in this sub.\n   This sub is called from review_log()","parameters":[],"label":"clean_ips_to_block_allowdeny()"},"kind":12,"definition":"sub","range":{"start":{"line":703,"character":0},"end":{"character":9999,"line":737}},"detail":"()","containerName":"main::","name":"clean_ips_to_block_allowdeny"},{"kind":12,"name":"threads","line":706},{"line":709,"containerName":"Terse","name":"Dumper","kind":12},{"kind":12,"name":"Dumper","line":710,"containerName":"Indent"},{"name":"allowdeny","line":714,"kind":12},{"name":"configs","line":714,"kind":12},{"line":714,"name":"allowdeny","kind":12},{"kind":12,"line":715,"name":"allowlist"},{"name":"configs","line":715,"kind":12},{"kind":12,"line":715,"name":"allowlist"},{"kind":12,"line":716,"name":"denylist"},{"line":716,"name":"configs","kind":12},{"line":716,"name":"denylist","kind":12},{"line":717,"name":"configs","kind":12},{"name":"denylist","line":717,"kind":12},{"kind":12,"line":718,"name":"configs"},{"kind":12,"line":718,"name":"allowlist"},{"name":"ips_to_block","line":720,"kind":12},{"kind":12,"line":730,"name":"Dumper"},{"kind":12,"name":"Dumper","line":731},{"name":"Dumper","line":732,"kind":12},{"kind":12,"name":"Dumper","line":733},{"name":"Dumper","line":734,"kind":12},{"line":738,"kind":13,"definition":"my","containerName":null,"name":"%denylist","localvar":"my"},{"kind":13,"line":738,"containerName":null,"name":"$global_denylist"},{"containerName":null,"line":738,"name":"$logobj_denylist","kind":13},{"kind":13,"containerName":null,"line":741,"name":"$logger"},{"kind":12,"line":741,"name":"debug","containerName":"main::"},{"line":741,"name":"Dumper","kind":12},{"kind":13,"name":"$allowlist","line":741,"containerName":null},{"kind":13,"containerName":null,"line":741,"name":"$logger"},{"kind":12,"containerName":"main::","line":741,"name":"is_debug"},{"name":"$logger","line":742,"containerName":null,"kind":13},{"kind":12,"containerName":"main::","line":742,"name":"debug"},{"kind":12,"line":742,"name":"Dumper"},{"kind":13,"name":"$denylist","line":742,"containerName":null},{"line":742,"name":"$logger","containerName":null,"kind":13},{"kind":12,"name":"is_debug","line":742,"containerName":"main::"},{"kind":13,"containerName":null,"line":745,"name":"%denylist"},{"kind":13,"name":"$denylist","line":745,"containerName":null},{"name":"$ips_to_block","line":745,"containerName":null,"kind":13},{"kind":13,"line":748,"containerName":null,"name":"$logger"},{"kind":12,"name":"debug","line":748,"containerName":"main::"},{"name":"Dumper","line":748,"kind":12},{"line":748,"name":"$denylist","containerName":null,"kind":13},{"kind":13,"name":"$logger","line":748,"containerName":null},{"kind":12,"line":748,"name":"is_debug","containerName":"main::"},{"line":752,"containerName":null,"name":"%allowdeny","kind":13},{"kind":13,"name":"%logobj","line":753,"containerName":null},{"kind":12,"name":"ips_to_block","line":753},{"name":"$denylist","line":753,"containerName":null,"kind":13},{"kind":13,"line":754,"containerName":null,"name":"$logger"},{"kind":12,"name":"debug","line":754,"containerName":"main::"},{"kind":12,"name":"Dumper","line":754},{"kind":13,"name":"%logobj","line":754,"containerName":null},{"line":754,"name":"ips_to_block","kind":12},{"kind":13,"name":"$logger","line":755,"containerName":null},{"kind":12,"line":755,"name":"is_debug","containerName":"main::"},{"kind":13,"name":"%logobj","line":756,"containerName":null},{"line":761,"containerName":null,"name":"%denylist","kind":13},{"kind":13,"containerName":null,"line":761,"name":"$allowlist"},{"containerName":null,"line":762,"name":"%logobj","kind":13},{"name":"ips_to_block","line":762,"kind":12},{"line":762,"containerName":null,"name":"$denylist","kind":13},{"kind":13,"name":"$logger","line":763,"containerName":null},{"containerName":"main::","line":763,"name":"debug","kind":12},{"kind":12,"line":763,"name":"Dumper"},{"kind":13,"name":"%logobj","line":763,"containerName":null},{"name":"ips_to_block","line":763,"kind":12},{"kind":13,"containerName":null,"line":764,"name":"$logger"},{"kind":12,"containerName":"main::","line":764,"name":"is_debug"},{"kind":13,"name":"$logobj","line":765,"containerName":null},{"children":[{"localvar":"my","name":"$self","containerName":"run_iptables","kind":13,"definition":"my","line":785},{"line":785,"containerName":"run_iptables","name":"$args","kind":13},{"line":786,"kind":13,"definition":"my","name":"@caller_lst","containerName":"run_iptables","localvar":"my"},{"kind":13,"containerName":"run_iptables","line":787,"name":"$caller_lst"},{"name":"$IPTABLESRUNLINE","line":787,"containerName":"run_iptables","kind":13},{"line":787,"containerName":"run_iptables","name":"$IPTABLESRUNLINE","kind":13},{"containerName":"run_iptables","name":"$logmsg","localvar":"my","line":788,"kind":13,"definition":"my"},{"line":791,"name":"@caller_lst","containerName":"run_iptables","kind":13},{"containerName":"run_iptables","line":796,"name":"$logger","kind":13},{"name":"error","line":796,"containerName":"run_iptables","kind":12},{"name":"$logmsg","line":796,"containerName":"run_iptables","kind":13},{"line":798,"kind":13,"definition":"my","name":"$TID","containerName":"run_iptables","localvar":"my"},{"kind":12,"containerName":"run_iptables","line":798,"name":"tid"},{"line":799,"name":"$TID","containerName":"run_iptables","kind":13},{"kind":13,"line":799,"containerName":"run_iptables","name":"$TID"},{"line":802,"name":"$args","containerName":"run_iptables","kind":13},{"kind":13,"line":802,"containerName":"run_iptables","name":"$logger"},{"line":802,"containerName":"run_iptables","name":"error","kind":12},{"containerName":"run_iptables","line":803,"name":"$self","kind":13},{"line":803,"containerName":"run_iptables","name":"$logger","kind":13},{"containerName":"run_iptables","line":803,"name":"error","kind":12},{"line":805,"definition":"my","kind":13,"containerName":"run_iptables","name":"$iptables","localvar":"my"},{"kind":13,"line":805,"name":"$self","containerName":"run_iptables"},{"localvar":"my","containerName":"run_iptables","name":"$rule","definition":"my","kind":13,"line":806},{"kind":13,"name":"$args","line":806,"containerName":"run_iptables"},{"kind":13,"definition":"my","line":807,"localvar":"my","containerName":"run_iptables","name":"$options"},{"kind":13,"line":807,"containerName":"run_iptables","name":"$args"},{"line":809,"containerName":"run_iptables","name":"$logger","kind":13},{"kind":12,"line":809,"name":"is_debug","containerName":"run_iptables"},{"line":810,"name":"$logger","containerName":"run_iptables","kind":13},{"kind":12,"line":810,"name":"debug","containerName":"run_iptables"},{"kind":13,"name":"$args","line":811,"containerName":"run_iptables"},{"containerName":"run_iptables","line":819,"name":"$args","kind":13},{"localvar":"my","containerName":"run_iptables","name":"$allowdupes","definition":"my","kind":13,"line":820},{"containerName":"run_iptables","line":820,"name":"$args","kind":13},{"kind":13,"line":822,"containerName":"run_iptables","name":"$allowdupes"},{"name":"$logger","line":823,"containerName":"run_iptables","kind":13},{"kind":12,"line":823,"containerName":"run_iptables","name":"debug"},{"line":824,"kind":13,"definition":"my","name":"$retval","containerName":"run_iptables","localvar":"my"},{"line":824,"containerName":"run_iptables","name":"$self","kind":13},{"line":824,"name":"check_if_rule_exists","containerName":"run_iptables","kind":12},{"line":824,"containerName":"run_iptables","name":"$args","kind":13},{"line":825,"containerName":"run_iptables","name":"$retval","kind":13},{"definition":"my","kind":13,"line":826,"localvar":"my","name":"$logmsg","containerName":"run_iptables"},{"kind":13,"line":827,"name":"$logmsg","containerName":"run_iptables"},{"kind":13,"line":828,"containerName":"run_iptables","name":"$logger"},{"kind":12,"line":828,"name":"debug","containerName":"run_iptables"},{"line":828,"containerName":"run_iptables","name":"$logmsg","kind":13},{"line":831,"containerName":"run_iptables","name":"$retval","kind":13},{"kind":13,"containerName":"run_iptables","line":835,"name":"$logger"},{"kind":12,"line":835,"containerName":"run_iptables","name":"debug"},{"line":836,"containerName":"run_iptables","name":"$tracker","kind":13},{"line":836,"name":"$rule","containerName":"run_iptables","kind":13},{"kind":13,"line":839,"name":"$retval","containerName":"run_iptables"},{"kind":13,"line":840,"name":"$logger","containerName":"run_iptables"},{"containerName":"run_iptables","line":840,"name":"debug","kind":12},{"kind":13,"line":842,"containerName":"run_iptables","name":"$retval"},{"name":"$options","line":843,"containerName":"run_iptables","kind":13},{"line":846,"containerName":"run_iptables","name":"$logger","kind":13},{"containerName":"run_iptables","line":846,"name":"debug","kind":12},{"name":"$tracker","line":849,"containerName":"run_iptables","kind":13},{"name":"$rule","line":849,"containerName":"run_iptables","kind":13},{"kind":13,"line":851,"containerName":"run_iptables","name":"$retval"},{"kind":13,"line":852,"name":"$logger","containerName":"run_iptables"},{"line":852,"name":"error","containerName":"run_iptables","kind":12},{"name":"$retval","line":855,"containerName":"run_iptables","kind":13},{"localvar":"my","name":"$logmsg","containerName":"run_iptables","definition":"my","kind":13,"line":856},{"name":"$logmsg","line":857,"containerName":"run_iptables","kind":13},{"kind":13,"line":858,"containerName":"run_iptables","name":"$logger"},{"line":858,"name":"error","containerName":"run_iptables","kind":12},{"kind":13,"line":858,"name":"$logmsg","containerName":"run_iptables"},{"kind":13,"line":862,"name":"$logger","containerName":"run_iptables"},{"kind":12,"name":"error","line":862,"containerName":"run_iptables"},{"line":862,"name":"$retval","containerName":"run_iptables","kind":13},{"kind":13,"definition":"my","line":867,"localvar":"my","name":"$command","containerName":"run_iptables"},{"kind":13,"line":868,"name":"$tracker","containerName":"run_iptables"},{"kind":13,"line":868,"containerName":"run_iptables","name":"$rule"},{"kind":13,"line":869,"containerName":"run_iptables","name":"$self"},{"kind":13,"line":870,"containerName":"run_iptables","name":"$logger"},{"kind":12,"containerName":"run_iptables","line":870,"name":"debug"},{"localvar":"my","name":"$output","containerName":"run_iptables","kind":13,"definition":"my","line":871},{"kind":13,"line":872,"name":"$logger","containerName":"run_iptables"},{"kind":12,"line":872,"containerName":"run_iptables","name":"debug"},{"kind":13,"containerName":"run_iptables","line":876,"name":"$logger"},{"kind":12,"line":876,"containerName":"run_iptables","name":"info"},{"name":"$logger","line":881,"containerName":"run_iptables","kind":13},{"line":881,"name":"error","containerName":"run_iptables","kind":12}],"line":784,"signature":{"documentation":" Runs whatever parameters are passed to it against iptables\n  This is intended to be a one stop shop for running iptables out from a queue.\n  However, there are a few instances where it is called directly... especially when creating chains\n   This hopefully prevents excessive wait/locking on iptables\n   and helps to keep commands running in the order they are received.\n Arguments must be passed as a hash reference with (so far) the following keys:\n   rule:  The rule to run\n   options:  Any options to pass to iptables\n  Where it is ran like this:\n   iptables $options $rule 2>&1\n Future enhancement:\n   1. delete existing rule if it exists\n Take note this sub is intended (but not required) to be called from sub iptables_thread()\n  An error will happen if not called from sub iptables_thread(), but it will not stop the program\n  This is to encourage using the iptablesqueue_enqueue() sub instead of run_iptables() directly\n  So, to say this more clearly, if you want to run iptables commands, then call iptablesqueue_enqueue()","label":"run_iptables()","parameters":[]},"kind":12,"definition":"sub","range":{"start":{"line":784,"character":0},"end":{"character":9999,"line":883}},"detail":"()","containerName":"main::","name":"run_iptables"},{"name":"Dumper","line":791,"kind":12},{"kind":12,"line":798,"name":"threads"},{"line":802,"name":"rule","kind":12},{"name":"configs","line":803,"kind":12},{"kind":12,"name":"iptables","line":803},{"kind":12,"name":"configs","line":805},{"name":"iptables","line":805,"kind":12},{"line":806,"name":"rule","kind":12},{"name":"options","line":807,"kind":12},{"name":"Dumper","line":811,"kind":12},{"kind":12,"name":"allowdupes","line":819},{"name":"allowdupes","line":820,"kind":12},{"kind":12,"name":"iptables_rules","line":836},{"kind":12,"line":849,"name":"chains_created"},{"kind":12,"line":868,"name":"iptables_rules"},{"name":"configs","line":869,"kind":12},{"kind":12,"line":869,"name":"PRODMODE"},{"containerName":"main::","name":"set_iptables_command","detail":"()","definition":"sub","range":{"end":{"line":894,"character":9999},"start":{"character":0,"line":886}},"kind":12,"signature":{"parameters":[],"label":"set_iptables_command()","documentation":" Maybe an unnecessary sub but maybe some better checks down the road"},"line":886,"children":[{"line":887,"kind":13,"definition":"my","name":"$self","containerName":"set_iptables_command","localvar":"my"},{"containerName":"set_iptables_command","line":890,"name":"$self","kind":13},{"kind":13,"containerName":"set_iptables_command","line":891,"name":"$self"},{"name":"$logger","line":892,"containerName":"set_iptables_command","kind":13},{"line":892,"name":"info","containerName":"set_iptables_command","kind":12}]},{"line":890,"name":"configs","kind":12},{"name":"iptables","line":890,"kind":12},{"kind":12,"line":891,"name":"configs"},{"kind":12,"line":891,"name":"iptables"},{"containerName":"main::","name":"check_if_rule_exists","signature":{"label":"check_if_rule_exists($self,$args)","parameters":[{"label":"$self"},{"label":"$args"}],"documentation":"# Returns 0 if there is an unknown return value from running iptables\n#          Otherwise returns a string"},"line":898,"children":[{"name":"$self","containerName":"check_if_rule_exists","localvar":"my","line":899,"definition":"my","kind":13},{"line":899,"containerName":"check_if_rule_exists","name":"$args","kind":13},{"localvar":"my","name":"$TID","containerName":"check_if_rule_exists","definition":"my","kind":13,"line":900},{"kind":12,"name":"tid","line":900,"containerName":"check_if_rule_exists"},{"kind":13,"line":901,"containerName":"check_if_rule_exists","name":"$TID"},{"kind":13,"line":901,"containerName":"check_if_rule_exists","name":"$TID"},{"containerName":"check_if_rule_exists","line":904,"name":"$args","kind":13},{"kind":13,"line":904,"name":"$self","containerName":"check_if_rule_exists"},{"line":904,"name":"log_and_return","containerName":"check_if_rule_exists","kind":12},{"name":"$self","line":905,"containerName":"check_if_rule_exists","kind":13},{"line":905,"name":"$logger","containerName":"check_if_rule_exists","kind":13},{"line":905,"containerName":"check_if_rule_exists","name":"error","kind":12},{"localvar":"my","name":"$iptables","containerName":"check_if_rule_exists","definition":"my","kind":13,"line":907},{"kind":13,"line":907,"name":"$self","containerName":"check_if_rule_exists"},{"localvar":"my","containerName":"check_if_rule_exists","name":"$rule","kind":13,"definition":"my","line":908},{"containerName":"check_if_rule_exists","line":908,"name":"$args","kind":13},{"name":"$options","containerName":"check_if_rule_exists","localvar":"my","line":909,"kind":13,"definition":"my"},{"kind":13,"name":"$args","line":909,"containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","line":911,"name":"$tracker","kind":13},{"containerName":"check_if_rule_exists","line":911,"name":"$rule","kind":13},{"kind":13,"containerName":"check_if_rule_exists","line":912,"name":"$logger"},{"kind":12,"containerName":"check_if_rule_exists","line":912,"name":"debug"},{"line":916,"name":"$tracker","containerName":"check_if_rule_exists","kind":13},{"kind":13,"line":916,"name":"$rule","containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","line":917,"name":"$logger","kind":13},{"containerName":"check_if_rule_exists","line":917,"name":"debug","kind":12},{"containerName":"check_if_rule_exists","line":921,"name":"$options","kind":13},{"line":922,"kind":13,"definition":"my","containerName":"check_if_rule_exists","name":"$logmsg","localvar":"my"},{"containerName":"check_if_rule_exists","line":923,"name":"$logmsg","kind":13},{"line":924,"containerName":"check_if_rule_exists","name":"$logger","kind":13},{"kind":12,"line":924,"name":"debug","containerName":"check_if_rule_exists"},{"kind":13,"name":"$logmsg","line":924,"containerName":"check_if_rule_exists"},{"localvar":"my","containerName":"check_if_rule_exists","name":"$checkrule_result","definition":"my","kind":13,"line":928},{"kind":13,"line":930,"containerName":"check_if_rule_exists","name":"$logger"},{"kind":12,"line":930,"name":"debug","containerName":"check_if_rule_exists"},{"kind":13,"line":934,"name":"$checkrule_result","containerName":"check_if_rule_exists"},{"name":"$logger","line":935,"containerName":"check_if_rule_exists","kind":13},{"kind":12,"containerName":"check_if_rule_exists","line":935,"name":"debug"},{"line":936,"containerName":"check_if_rule_exists","name":"$logger","kind":13},{"containerName":"check_if_rule_exists","line":936,"name":"debug","kind":12},{"name":"$checkrule_result","line":940,"containerName":"check_if_rule_exists","kind":13},{"line":941,"containerName":"check_if_rule_exists","name":"$logger","kind":13},{"kind":12,"line":941,"name":"debug","containerName":"check_if_rule_exists"},{"kind":13,"line":942,"containerName":"check_if_rule_exists","name":"$logger"},{"line":942,"containerName":"check_if_rule_exists","name":"debug","kind":12},{"line":946,"name":"$checkrule_result","containerName":"check_if_rule_exists","kind":13},{"containerName":"check_if_rule_exists","line":947,"name":"$logger","kind":13},{"line":947,"containerName":"check_if_rule_exists","name":"debug","kind":12},{"kind":13,"line":948,"name":"$logger","containerName":"check_if_rule_exists"},{"kind":12,"name":"debug","line":948,"containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","line":952,"name":"$self","kind":13},{"line":952,"containerName":"check_if_rule_exists","name":"log_and_return","kind":12}],"detail":"($self,$args)","definition":"sub","range":{"end":{"character":9999,"line":953},"start":{"line":898,"character":0}},"kind":12},{"kind":12,"line":900,"name":"threads"},{"line":904,"name":"rule","kind":12},{"name":"configs","line":905,"kind":12},{"kind":12,"line":905,"name":"iptables"},{"line":907,"name":"configs","kind":12},{"name":"iptables","line":907,"kind":12},{"name":"rule","line":908,"kind":12},{"kind":12,"name":"options","line":909},{"line":911,"name":"chains_created","kind":12},{"name":"iptables_rules","line":916,"kind":12},{"name":"log_and_return","containerName":"main::","kind":12,"detail":"($self,$error_message)","definition":"sub","range":{"start":{"character":0,"line":955},"end":{"line":961,"character":9999}},"line":955,"children":[{"containerName":"log_and_return","name":"$self","localvar":"my","line":956,"definition":"my","kind":13},{"kind":13,"name":"$error_message","line":956,"containerName":"log_and_return"},{"line":957,"kind":13,"definition":"my","containerName":"log_and_return","name":"$TID","localvar":"my"},{"name":"tid","line":957,"containerName":"log_and_return","kind":12},{"kind":13,"line":958,"name":"$TID","containerName":"log_and_return"},{"kind":13,"line":958,"containerName":"log_and_return","name":"$TID"},{"kind":13,"line":959,"name":"$logger","containerName":"log_and_return"},{"kind":12,"containerName":"log_and_return","line":959,"name":"error"},{"line":959,"containerName":"log_and_return","name":"$error_message","kind":13}],"signature":{"documentation":"","parameters":[{"label":"$self"},{"label":"$error_message"}],"label":"log_and_return($self,$error_message)"}},{"line":957,"name":"threads","kind":12},{"name":"add_global_chain","containerName":"main::","definition":"sub","range":{"start":{"line":969,"character":0},"end":{"line":997,"character":9999}},"detail":"()","kind":12,"signature":{"documentation":" Description: Creates the global chain and then adds a jump rule to the global chains.\n           With default values this means creating the global chain \"IPBLOCKER_glopbal\" and then\n           adding a jump rule to the INPUT, OUTPUT, and FORWARD tables to go to IPBLOCKER_global\n Dies if no chain prefix is set or if no global chains are set\n    Bassically, this dies if it is not called as class or correct configs are not set\n Returns 1 always","label":"add_global_chain()","parameters":[]},"children":[{"localvar":"my","name":"$self","containerName":"add_global_chain","kind":13,"definition":"my","line":970},{"line":971,"kind":13,"definition":"my","containerName":"add_global_chain","name":"$TID","localvar":"my"},{"containerName":"add_global_chain","line":971,"name":"tid","kind":12},{"containerName":"add_global_chain","line":972,"name":"$TID","kind":13},{"line":972,"containerName":"add_global_chain","name":"$TID","kind":13},{"localvar":"my","containerName":"add_global_chain","name":"$chain","kind":13,"definition":"my","line":974},{"containerName":"add_global_chain","line":974,"name":"$self","kind":13},{"kind":13,"name":"$logger","line":974,"containerName":"add_global_chain"},{"name":"logdie","line":974,"containerName":"add_global_chain","kind":12},{"name":"$chain","line":975,"containerName":"add_global_chain","kind":13},{"kind":13,"name":"$chain","line":975,"containerName":"add_global_chain"},{"definition":"my","kind":13,"line":977,"localvar":"my","name":"$globalchains_str","containerName":"add_global_chain"},{"kind":13,"line":977,"containerName":"add_global_chain","name":"$self"},{"kind":13,"line":977,"containerName":"add_global_chain","name":"$logger"},{"name":"logdie","line":977,"containerName":"add_global_chain","kind":12},{"line":978,"definition":"my","kind":13,"name":"@globalchains","containerName":"add_global_chain","localvar":"my"},{"containerName":"add_global_chain","line":978,"name":"$globalchains_str","kind":13},{"kind":13,"line":980,"containerName":"add_global_chain","name":"$logger"},{"name":"info","line":980,"containerName":"add_global_chain","kind":12},{"line":981,"definition":"my","kind":13,"containerName":"add_global_chain","name":"$args","localvar":"my"},{"name":"$self","line":985,"containerName":"add_global_chain","kind":13},{"kind":12,"line":985,"name":"iptablesqueue_enqueue","containerName":"add_global_chain"},{"kind":13,"line":985,"containerName":"add_global_chain","name":"$args"},{"kind":13,"name":"$logger","line":987,"containerName":"add_global_chain"},{"name":"info","line":987,"containerName":"add_global_chain","kind":12},{"kind":13,"definition":"my","line":988,"localvar":"my","name":"$table","containerName":"add_global_chain"},{"line":988,"containerName":"add_global_chain","name":"@globalchains","kind":13},{"line":989,"kind":13,"definition":"my","containerName":"add_global_chain","name":"$args","localvar":"my"},{"kind":13,"containerName":"add_global_chain","line":993,"name":"$self"},{"kind":12,"line":993,"name":"iptablesqueue_enqueue","containerName":"add_global_chain"},{"containerName":"add_global_chain","line":993,"name":"$args","kind":13}],"line":969},{"name":"threads","line":971,"kind":12},{"kind":12,"line":974,"name":"configs"},{"kind":12,"line":974,"name":"chainprefix"},{"kind":12,"name":"configs","line":977},{"kind":12,"line":977,"name":"globalchains"},{"name":"options","line":982,"kind":12},{"kind":12,"line":983,"name":"rule"},{"name":"options","line":990,"kind":12},{"kind":12,"name":"rule","line":991},{"name":"iptablesqueue_enqueue","containerName":"main::","signature":{"documentation":" Description: Queues items onto the iptables queue\n Returns 1 if queue is allowing enqueuing\n Returns 0 if queue is not allowing enqueuing","parameters":[],"label":"iptablesqueue_enqueue()"},"line":1002,"children":[{"name":"$self","containerName":"iptablesqueue_enqueue","localvar":"my","line":1003,"kind":13,"definition":"my"},{"line":1003,"containerName":"iptablesqueue_enqueue","name":"$args","kind":13},{"name":"$TID","containerName":"iptablesqueue_enqueue","localvar":"my","line":1004,"kind":13,"definition":"my"},{"line":1004,"containerName":"iptablesqueue_enqueue","name":"tid","kind":12},{"line":1005,"containerName":"iptablesqueue_enqueue","name":"$TID","kind":13},{"line":1005,"name":"$TID","containerName":"iptablesqueue_enqueue","kind":13},{"name":"$iptablesQueue_pending","containerName":"iptablesqueue_enqueue","localvar":"my","line":1007,"definition":"my","kind":13},{"line":1007,"name":"$IptablesQueue","containerName":"iptablesqueue_enqueue","kind":13},{"kind":12,"containerName":"iptablesqueue_enqueue","line":1007,"name":"pending"},{"line":1008,"name":"$iptablesQueue_pending","containerName":"iptablesqueue_enqueue","kind":13},{"name":"$logmsg","containerName":"iptablesqueue_enqueue","localvar":"my","line":1009,"kind":13,"definition":"my"},{"kind":13,"line":1010,"name":"$logmsg","containerName":"iptablesqueue_enqueue"},{"containerName":"iptablesqueue_enqueue","line":1011,"name":"$logger","kind":13},{"kind":12,"line":1011,"containerName":"iptablesqueue_enqueue","name":"info"},{"line":1011,"name":"$logmsg","containerName":"iptablesqueue_enqueue","kind":13},{"line":1014,"name":"$args","containerName":"iptablesqueue_enqueue","kind":13},{"kind":13,"line":1015,"name":"$logger","containerName":"iptablesqueue_enqueue"},{"name":"debug","line":1015,"containerName":"iptablesqueue_enqueue","kind":12},{"kind":13,"line":1015,"name":"$args","containerName":"iptablesqueue_enqueue"},{"name":"$logger","line":1015,"containerName":"iptablesqueue_enqueue","kind":13},{"line":1015,"name":"is_debug","containerName":"iptablesqueue_enqueue","kind":12},{"kind":13,"line":1016,"containerName":"iptablesqueue_enqueue","name":"$IptablesQueue"},{"line":1016,"name":"enqueue","containerName":"iptablesqueue_enqueue","kind":12},{"name":"$args","line":1016,"containerName":"iptablesqueue_enqueue","kind":13}],"detail":"()","range":{"start":{"line":1002,"character":0},"end":{"line":1018,"character":9999}},"definition":"sub","kind":12},{"line":1004,"name":"threads","kind":12},{"name":"check_pending","line":1014,"kind":12},{"line":1015,"name":"Dumper","kind":12},{"signature":{"label":"readlogfile($self,$logobj)","parameters":[{"label":"$self"},{"label":"$logobj"}],"documentation":" This function reads the log file into memory from the seek position (if it exists)\n The reading of a log file based on the seek position creates a big issue if the log file is rotated AND is larger than\n   the seek position\n   This is a tradeoff of reading the entire log file into memory and then grepping for the regexps\n Returns: $logobj"},"children":[{"line":1026,"definition":"my","kind":13,"containerName":"readlogfile","name":"$self","localvar":"my"},{"name":"$logobj","line":1026,"containerName":"readlogfile","kind":13},{"line":1027,"kind":13,"definition":"my","name":"$TID","containerName":"readlogfile","localvar":"my"},{"containerName":"readlogfile","line":1027,"name":"tid","kind":12},{"kind":13,"name":"$TID","line":1028,"containerName":"readlogfile"},{"line":1028,"containerName":"readlogfile","name":"$TID","kind":13},{"containerName":"readlogfile","name":"$file","localvar":"my","line":1031,"kind":13,"definition":"my"},{"line":1031,"name":"$logobj","containerName":"readlogfile","kind":13},{"line":1032,"name":"$file","containerName":"readlogfile","kind":13},{"kind":13,"containerName":"readlogfile","line":1032,"name":"$logger"},{"kind":12,"name":"error","line":1032,"containerName":"readlogfile"},{"line":1032,"name":"$logobj","containerName":"readlogfile","kind":13},{"name":"$logobj","line":1035,"containerName":"readlogfile","kind":13},{"containerName":"readlogfile","line":1036,"name":"$logobj","kind":13},{"containerName":"readlogfile","line":1036,"name":"$file","kind":13},{"kind":13,"line":1036,"name":"$logobj","containerName":"readlogfile"},{"name":"$logobj","line":1037,"containerName":"readlogfile","kind":13},{"name":"$self","line":1037,"containerName":"readlogfile","kind":13},{"kind":13,"line":1038,"containerName":"readlogfile","name":"$logobj"},{"kind":13,"containerName":"readlogfile","line":1038,"name":"$logobj"},{"line":1040,"name":"$logger","containerName":"readlogfile","kind":13},{"line":1040,"containerName":"readlogfile","name":"debug","kind":12},{"line":1046,"kind":13,"definition":"my","name":"$fh","containerName":"readlogfile","localvar":"my"},{"kind":13,"line":1046,"name":"$file","containerName":"readlogfile"},{"kind":13,"containerName":"readlogfile","line":1047,"name":"$logger"},{"kind":12,"line":1047,"name":"error","containerName":"readlogfile"},{"containerName":"readlogfile","line":1048,"name":"$logobj","kind":13},{"kind":13,"line":1050,"name":"$fh","containerName":"readlogfile"},{"line":1050,"containerName":"readlogfile","name":"$logobj","kind":13},{"localvar":"my","containerName":"readlogfile","name":"@logcontents","definition":"my","kind":13,"line":1051},{"line":1051,"name":"$fh","containerName":"readlogfile","kind":13},{"kind":13,"name":"$logobj","line":1052,"containerName":"readlogfile"},{"containerName":"readlogfile","line":1052,"name":"$fh","kind":13},{"kind":13,"line":1053,"name":"$fh","containerName":"readlogfile"},{"containerName":"readlogfile","line":1055,"name":"@logcontents","kind":13},{"name":"$logger","line":1056,"containerName":"readlogfile","kind":13},{"kind":12,"name":"debug","line":1056,"containerName":"readlogfile"},{"kind":13,"line":1056,"name":"@logcontents","containerName":"readlogfile"},{"kind":13,"line":1059,"containerName":"readlogfile","name":"$logger"},{"kind":12,"containerName":"readlogfile","line":1059,"name":"info"},{"kind":13,"name":"$logobj","line":1060,"containerName":"readlogfile"},{"kind":13,"line":1063,"containerName":"readlogfile","name":"@logcontents"},{"name":"$logobj","line":1064,"containerName":"readlogfile","kind":13},{"line":1064,"containerName":"readlogfile","name":"@logcontents","kind":13},{"kind":13,"line":1066,"containerName":"readlogfile","name":"$logger"},{"line":1066,"name":"debug","containerName":"readlogfile","kind":12},{"kind":13,"name":"@logcontents","line":1066,"containerName":"readlogfile"},{"containerName":"readlogfile","line":1067,"name":"$logger","kind":13},{"kind":12,"line":1067,"containerName":"readlogfile","name":"trace"},{"kind":13,"line":1067,"containerName":"readlogfile","name":"$logobj"},{"line":1067,"containerName":"readlogfile","name":"$logger","kind":13},{"kind":12,"name":"is_trace","line":1067,"containerName":"readlogfile"},{"name":"$logobj","line":1069,"containerName":"readlogfile","kind":13}],"line":1025,"definition":"sub","range":{"end":{"character":9999,"line":1070},"start":{"character":0,"line":1025}},"detail":"($self,$logobj)","kind":12,"name":"readlogfile","containerName":"main::"},{"kind":12,"line":1027,"name":"threads"},{"kind":12,"name":"file","line":1031},{"kind":12,"line":1035,"name":"seek"},{"name":"seek","line":1036,"kind":12},{"kind":12,"line":1036,"name":"seek"},{"kind":12,"name":"readentirefile","line":1037},{"line":1037,"name":"configs","kind":12},{"kind":12,"line":1037,"name":"readentirefile"},{"name":"seek","line":1038,"kind":12},{"line":1038,"name":"readentirefile","kind":12},{"line":1050,"name":"seek","kind":12},{"name":"seek","line":1052,"kind":12},{"kind":12,"name":"logcontents","line":1060},{"kind":12,"line":1064,"name":"logcontents"},{"kind":12,"line":1067,"name":"Dumper"},{"kind":12,"name":"logcontents","line":1067},{"line":1075,"children":[{"containerName":"_grep_regexps","name":"$self","localvar":"my","line":1076,"kind":13,"definition":"my"},{"name":"$log","line":1076,"containerName":"_grep_regexps","kind":13},{"localvar":"my","containerName":"_grep_regexps","name":"$TID","definition":"my","kind":13,"line":1077},{"kind":12,"name":"tid","line":1077,"containerName":"_grep_regexps"},{"line":1079,"kind":13,"definition":"my","containerName":"_grep_regexps","name":"$matches","localvar":"my"},{"containerName":"_grep_regexps","name":"@log_contents","localvar":"my","line":1080,"definition":"my","kind":13},{"kind":13,"name":"$log","line":1080,"containerName":"_grep_regexps"}],"signature":{"label":"_grep_regexps($self,$log)","parameters":[{"label":"$self"},{"label":"$log"}],"documentation":" Description:  Using the logobj, this greps against the log contents for matching lines and then gets the\n               IP address on each line.\n Returns:  Hash reference of IP addresses with count of how many times the IP address was found"},"kind":12,"detail":"($self,$log)","range":{"start":{"character":0,"line":1075},"end":{"character":9999,"line":1080}},"definition":"sub","name":"_grep_regexps","containerName":"main::"},{"kind":12,"name":"threads","line":1077},{"kind":12,"name":"logcontents","line":1080},{"line":1082,"containerName":null,"name":"@log_contents","kind":13},{"localvar":"my","containerName":null,"name":"$regex","definition":"my","kind":13,"line":1085},{"line":1085,"containerName":null,"name":"%log","kind":13},{"line":1085,"name":"regexpdeny","kind":12},{"kind":13,"definition":"my","line":1086,"localvar":"my","containerName":null,"name":"$pattern"},{"line":1086,"name":"%log","containerName":null,"kind":13},{"name":"regexpdeny","line":1086,"kind":12},{"kind":13,"name":"$regex","line":1086,"containerName":null},{"name":"$logger","line":1087,"containerName":null,"kind":13},{"name":"debug","line":1087,"containerName":"main::","kind":12},{"definition":"my","kind":13,"line":1089,"localvar":"my","containerName":null,"name":"@current_matches"},{"containerName":null,"line":1089,"name":"@log_contents","kind":13},{"kind":13,"line":1090,"name":"$logger","containerName":null},{"kind":12,"containerName":"main::","line":1090,"name":"debug"},{"name":"Dumper","line":1090,"kind":12},{"line":1090,"name":"@current_matches","containerName":null,"kind":13},{"kind":13,"line":1090,"containerName":null,"name":"$logger"},{"containerName":"main::","line":1090,"name":"is_debug","kind":12},{"localvar":"my","name":"$line","containerName":null,"definition":"my","kind":13,"line":1092},{"kind":13,"line":1092,"containerName":null,"name":"@current_matches"},{"line":1093,"name":"$line","containerName":null,"kind":13},{"line":1094,"name":"$logger","containerName":null,"kind":13},{"containerName":"main::","line":1094,"name":"debug","kind":12},{"definition":"my","kind":13,"line":1096,"localvar":"my","containerName":null,"name":"$ip_address"},{"kind":13,"containerName":null,"line":1096,"name":"$line"},{"containerName":null,"line":1096,"name":"%line","kind":13},{"line":1097,"containerName":null,"name":"%matches","kind":13},{"line":1097,"containerName":null,"name":"$ip_address","kind":13},{"kind":13,"name":"$logger","line":1098,"containerName":null},{"kind":12,"containerName":"main::","line":1098,"name":"debug"},{"line":1103,"containerName":null,"name":"$logger","kind":13},{"name":"debug","line":1103,"containerName":"main::","kind":12},{"line":1103,"name":"Dumper","kind":12},{"name":"$matches","line":1103,"containerName":null,"kind":13},{"containerName":null,"line":1103,"name":"$logger","kind":13},{"kind":12,"line":1103,"name":"is_debug","containerName":"main::"},{"containerName":null,"name":"$log_msg","localvar":"my","line":1105,"kind":13,"definition":"my"},{"containerName":null,"line":1106,"name":"$log_msg","kind":13},{"kind":13,"containerName":null,"line":1106,"name":"$matches"},{"kind":13,"line":1107,"containerName":null,"name":"$logger"},{"kind":12,"line":1107,"containerName":"main::","name":"info"},{"kind":13,"containerName":null,"line":1107,"name":"$log_msg"},{"line":1109,"name":"$matches","containerName":null,"kind":13},{"containerName":"main::","name":"add_chain","signature":{"parameters":[],"label":"add_chain()","documentation":" Description:  Adds the chain to iptables"},"line":1113,"children":[{"localvar":"my","containerName":"add_chain","name":"$self","definition":"my","kind":13,"line":1114},{"kind":13,"name":"$chain","line":1114,"containerName":"add_chain"},{"name":"$TID","containerName":"add_chain","localvar":"my","line":1115,"definition":"my","kind":13},{"kind":12,"containerName":"add_chain","line":1115,"name":"tid"},{"kind":13,"line":1117,"name":"$logger","containerName":"add_chain"},{"line":1117,"containerName":"add_chain","name":"info","kind":12},{"kind":13,"definition":"my","line":1118,"localvar":"my","containerName":"add_chain","name":"$rule"},{"line":1119,"definition":"my","kind":13,"name":"$options","containerName":"add_chain","localvar":"my"},{"kind":13,"definition":"my","line":1120,"localvar":"my","name":"$args","containerName":"add_chain"},{"kind":13,"containerName":"add_chain","line":1120,"name":"$rule"},{"containerName":"add_chain","line":1120,"name":"$options","kind":13},{"kind":13,"line":1121,"containerName":"add_chain","name":"$self"},{"line":1121,"containerName":"add_chain","name":"iptablesqueue_enqueue","kind":12},{"kind":13,"line":1121,"containerName":"add_chain","name":"$args"},{"containerName":"add_chain","line":1122,"name":"$self","kind":13},{"kind":13,"containerName":"add_chain","line":1122,"name":"$chain"}],"detail":"()","range":{"start":{"line":1113,"character":0},"end":{"character":9999,"line":1124}},"definition":"sub","kind":12},{"kind":12,"name":"threads","line":1115},{"name":"rule","line":1120,"kind":12},{"line":1120,"name":"options","kind":12},{"name":"chains_created","line":1122,"kind":12},{"signature":{"documentation":" Description:  Adds the IPs to DROP or ACCEPT to the chain provided\n Returns:  1\n Requires: $args to be a hash reference with the following optional keys:\n  chain:  The chain to add the rules to.  If no chain provided then the default is ipblocker_global\n  allowlist:  An array of IPs to allow\n  denylist:  An array of IPs to deny\n  allowdenyorder:  The order to add the allow and deny rules","label":"add_allowdeny_ips()","parameters":[]},"line":1133,"children":[{"name":"$self","containerName":"add_allowdeny_ips","localvar":"my","line":1134,"definition":"my","kind":13},{"containerName":"add_allowdeny_ips","line":1134,"name":"$args","kind":13},{"definition":"my","kind":13,"line":1135,"localvar":"my","name":"$TID","containerName":"add_allowdeny_ips"},{"kind":12,"name":"tid","line":1135,"containerName":"add_allowdeny_ips"},{"kind":13,"line":1137,"containerName":"add_allowdeny_ips","name":"$args"},{"name":"$logger","line":1138,"containerName":"add_allowdeny_ips","kind":13},{"name":"error","line":1138,"containerName":"add_allowdeny_ips","kind":12},{"name":"$chain","containerName":"add_allowdeny_ips","localvar":"my","line":1141,"definition":"my","kind":13},{"kind":13,"containerName":"add_allowdeny_ips","line":1141,"name":"$args"},{"line":1143,"definition":"my","kind":13,"containerName":"add_allowdeny_ips","name":"%ip_rules","localvar":"my"},{"containerName":"add_allowdeny_ips","line":1144,"name":"$args","kind":13},{"kind":13,"line":1145,"containerName":"add_allowdeny_ips","name":"$args"},{"localvar":"my","containerName":"add_allowdeny_ips","name":"@allowdenyorder","definition":"my","kind":13,"line":1148},{"containerName":"add_allowdeny_ips","line":1149,"name":"$args","kind":13},{"name":"@allowdenyorder","line":1150,"containerName":"add_allowdeny_ips","kind":13},{"line":1153,"name":"$logger","containerName":"add_allowdeny_ips","kind":13},{"line":1153,"name":"debug","containerName":"add_allowdeny_ips","kind":12},{"kind":13,"line":1153,"containerName":"add_allowdeny_ips","name":"%ip_rules"},{"kind":13,"line":1153,"containerName":"add_allowdeny_ips","name":"$logger"},{"line":1153,"name":"is_debug","containerName":"add_allowdeny_ips","kind":12},{"line":1156,"definition":"my","kind":13,"name":"$action","containerName":"add_allowdeny_ips","localvar":"my"},{"name":"@allowdenyorder","line":1156,"containerName":"add_allowdeny_ips","kind":13},{"kind":13,"line":1157,"name":"$logger","containerName":"add_allowdeny_ips"},{"kind":12,"line":1157,"name":"debug","containerName":"add_allowdeny_ips"},{"line":1160,"definition":"my","kind":13,"containerName":"add_allowdeny_ips","name":"$chain","localvar":"my"},{"line":1160,"name":"$args","containerName":"add_allowdeny_ips","kind":13},{"line":1161,"definition":"my","kind":13,"containerName":"add_allowdeny_ips","name":"$rule_action","localvar":"my"},{"containerName":"add_allowdeny_ips","line":1161,"name":"$action","kind":13},{"containerName":"add_allowdeny_ips","name":"$ip","localvar":"my","line":1162,"definition":"my","kind":13},{"containerName":"add_allowdeny_ips","line":1162,"name":"$ip_rules","kind":13},{"line":1162,"containerName":"add_allowdeny_ips","name":"$action","kind":13},{"line":1163,"name":"$logger","containerName":"add_allowdeny_ips","kind":13},{"line":1163,"containerName":"add_allowdeny_ips","name":"debug","kind":12},{"line":1164,"definition":"my","kind":13,"name":"$direction","containerName":"add_allowdeny_ips","localvar":"my"},{"containerName":"add_allowdeny_ips","name":"$rule","localvar":"my","line":1165,"definition":"my","kind":13},{"localvar":"my","name":"$args","containerName":"add_allowdeny_ips","kind":13,"definition":"my","line":1166},{"kind":13,"line":1166,"name":"$rule","containerName":"add_allowdeny_ips"},{"kind":13,"line":1167,"containerName":"add_allowdeny_ips","name":"$logger"},{"kind":12,"line":1167,"name":"debug","containerName":"add_allowdeny_ips"},{"kind":13,"name":"$self","line":1168,"containerName":"add_allowdeny_ips"},{"name":"iptablesqueue_enqueue","line":1168,"containerName":"add_allowdeny_ips","kind":12},{"kind":13,"line":1168,"containerName":"add_allowdeny_ips","name":"$args"}],"detail":"()","range":{"end":{"line":1171,"character":9999},"start":{"character":0,"line":1133}},"definition":"sub","kind":12,"containerName":"main::","name":"add_allowdeny_ips"},{"kind":12,"name":"threads","line":1135},{"line":1141,"name":"chain","kind":12},{"kind":12,"name":"allow","line":1144},{"line":1144,"name":"allowlist","kind":12},{"name":"deny","line":1145,"kind":12},{"kind":12,"line":1145,"name":"denylist"},{"kind":12,"line":1149,"name":"allowdeny"},{"name":"Dumper","line":1153,"kind":12},{"kind":12,"name":"chain","line":1160},{"kind":12,"name":"rule","line":1166},{"line":1166,"name":"options","kind":12},{"detail":"()","definition":"sub","range":{"end":{"line":1184,"character":9999},"start":{"character":0,"line":1178}},"kind":12,"signature":{"parameters":[],"label":"add_global_allow_deny_ips()","documentation":" Description:  Adds the IPs to block or accept from the configs global allowlist and global denylist to the global chain\n Returns:  1"},"line":1178,"children":[{"containerName":"add_global_allow_deny_ips","name":"$self","localvar":"my","line":1179,"definition":"my","kind":13},{"kind":13,"definition":"my","line":1180,"localvar":"my","containerName":"add_global_allow_deny_ips","name":"$TID"},{"kind":12,"containerName":"add_global_allow_deny_ips","line":1180,"name":"tid"},{"name":"$logger","line":1182,"containerName":"add_global_allow_deny_ips","kind":13},{"kind":12,"containerName":"add_global_allow_deny_ips","line":1182,"name":"debug"},{"kind":13,"definition":"my","line":1183,"localvar":"my","name":"$chain","containerName":"add_global_allow_deny_ips"},{"line":1183,"containerName":"add_global_allow_deny_ips","name":"$self","kind":13},{"kind":13,"definition":"my","line":1184,"localvar":"my","name":"@allowlist","containerName":"add_global_allow_deny_ips"},{"kind":13,"containerName":"add_global_allow_deny_ips","line":1184,"name":"$self"},{"name":"$self","line":1184,"containerName":"add_global_allow_deny_ips","kind":13}],"containerName":"main::","name":"add_global_allow_deny_ips"},{"kind":12,"line":1180,"name":"threads"},{"kind":12,"line":1183,"name":"configs"},{"kind":12,"line":1183,"name":"chainprefix"},{"line":1184,"name":"configs","kind":12},{"line":1184,"name":"allowlist","kind":12},{"line":1184,"name":"configs","kind":12},{"name":"allowlist","line":1184,"kind":12},{"name":"@denylist","containerName":null,"localvar":"my","line":1185,"kind":13,"definition":"my"},{"kind":13,"containerName":null,"line":1185,"name":"%self"},{"kind":12,"name":"configs","line":1185},{"kind":12,"line":1185,"name":"denylist"},{"name":"%self","line":1185,"containerName":null,"kind":13},{"name":"configs","line":1185,"kind":12},{"name":"denylist","line":1185,"kind":12},{"definition":"my","kind":13,"line":1186,"localvar":"my","name":"$allowdeny","containerName":null},{"containerName":null,"line":1186,"name":"%self","kind":13},{"kind":12,"line":1186,"name":"configs"},{"line":1186,"name":"allowdeny","kind":12},{"line":1188,"kind":13,"definition":"my","name":"%args","containerName":null,"localvar":"my"},{"kind":12,"line":1189,"name":"chain"},{"kind":13,"name":"$chain","line":1189,"containerName":null},{"kind":12,"line":1190,"name":"allowlist"},{"kind":13,"containerName":null,"line":1190,"name":"@allowlist"},{"name":"denylist","line":1191,"kind":12},{"name":"@denylist","line":1191,"containerName":null,"kind":13},{"line":1192,"name":"allowdeny","kind":12},{"kind":13,"name":"$allowdeny","line":1193,"containerName":null},{"kind":13,"containerName":null,"line":1195,"name":"$logger"},{"line":1195,"name":"debug","containerName":"main::","kind":12},{"line":1195,"name":"Dumper","kind":12},{"line":1195,"containerName":null,"name":"$args","kind":13},{"name":"$logger","line":1195,"containerName":null,"kind":13},{"line":1195,"name":"is_debug","containerName":"main::","kind":12},{"kind":13,"line":1197,"containerName":null,"name":"$self"},{"kind":12,"line":1197,"containerName":"main::","name":"add_allowdeny_ips"},{"line":1197,"containerName":null,"name":"$args","kind":13},{"name":"add_logger_allow_deny_ips","containerName":"main::","kind":12,"range":{"end":{"character":9999,"line":1206},"start":{"line":1200,"character":0}},"definition":"sub","detail":"()","children":[{"name":"$self","containerName":"add_logger_allow_deny_ips","localvar":"my","line":1201,"definition":"my","kind":13},{"kind":13,"line":1201,"name":"$logobj","containerName":"add_logger_allow_deny_ips"},{"containerName":"add_logger_allow_deny_ips","name":"$TID","localvar":"my","line":1202,"definition":"my","kind":13},{"name":"tid","line":1202,"containerName":"add_logger_allow_deny_ips","kind":12},{"name":"$logger","line":1204,"containerName":"add_logger_allow_deny_ips","kind":13},{"kind":12,"line":1204,"containerName":"add_logger_allow_deny_ips","name":"debug"},{"line":1205,"kind":13,"definition":"my","name":"$chain","containerName":"add_logger_allow_deny_ips","localvar":"my"},{"kind":13,"name":"$self","line":1205,"containerName":"add_logger_allow_deny_ips"},{"line":1205,"containerName":"add_logger_allow_deny_ips","name":"$logobj","kind":13},{"containerName":"add_logger_allow_deny_ips","name":"@allowlist","localvar":"my","line":1206,"kind":13,"definition":"my"},{"containerName":"add_logger_allow_deny_ips","line":1206,"name":"$logobj","kind":13},{"kind":13,"name":"$logobj","line":1206,"containerName":"add_logger_allow_deny_ips"}],"line":1200,"signature":{"label":"add_logger_allow_deny_ips()","parameters":[],"documentation":""}},{"kind":12,"line":1202,"name":"threads"},{"kind":12,"line":1205,"name":"configs"},{"name":"chainprefix","line":1205,"kind":12},{"line":1205,"name":"chain","kind":12},{"line":1206,"name":"allowlist","kind":12},{"name":"allowlist","line":1206,"kind":12},{"name":"@denylist","containerName":null,"localvar":"my","line":1207,"kind":13,"definition":"my"},{"kind":13,"containerName":null,"line":1207,"name":"%logobj"},{"line":1207,"name":"denylist","kind":12},{"name":"%logobj","line":1207,"containerName":null,"kind":13},{"name":"denylist","line":1207,"kind":12},{"containerName":null,"name":"$allowdeny","localvar":"my","line":1208,"kind":13,"definition":"my"},{"kind":13,"containerName":null,"line":1208,"name":"%logobj"},{"kind":12,"line":1208,"name":"allowdeny"},{"localvar":"my","containerName":null,"name":"%args","kind":13,"definition":"my","line":1210},{"kind":12,"name":"chain","line":1211},{"line":1211,"containerName":null,"name":"$chain","kind":13},{"kind":12,"line":1212,"name":"allowlist"},{"kind":13,"line":1212,"containerName":null,"name":"@allowlist"},{"line":1213,"name":"denylist","kind":12},{"kind":13,"name":"@denylist","line":1213,"containerName":null},{"line":1214,"name":"allowdeny","kind":12},{"line":1215,"name":"$allowdeny","containerName":null,"kind":13},{"line":1217,"name":"$logger","containerName":null,"kind":13},{"containerName":"main::","line":1217,"name":"debug","kind":12},{"kind":12,"line":1217,"name":"Dumper"},{"kind":13,"name":"$args","line":1217,"containerName":null},{"kind":13,"line":1217,"name":"$logger","containerName":null},{"name":"is_debug","line":1217,"containerName":"main::","kind":12},{"kind":13,"name":"$self","line":1219,"containerName":null},{"name":"add_allowdeny_ips","line":1219,"containerName":"main::","kind":12},{"containerName":null,"line":1219,"name":"$args","kind":13},{"name":"stop","containerName":"main::","kind":12,"range":{"start":{"character":0,"line":1257},"end":{"character":9999,"line":1278}},"definition":"sub","detail":"()","children":[{"line":1258,"kind":13,"definition":"my","containerName":"stop","name":"$self","localvar":"my"},{"line":1258,"name":"$args","containerName":"stop","kind":13},{"kind":13,"definition":"my","line":1259,"localvar":"my","containerName":"stop","name":"$TID"},{"kind":12,"containerName":"stop","line":1259,"name":"tid"},{"kind":13,"line":1260,"name":"$TID","containerName":"stop"},{"line":1260,"containerName":"stop","name":"$TID","kind":13},{"kind":13,"line":1261,"name":"$logger","containerName":"stop"},{"kind":12,"line":1261,"name":"info","containerName":"stop"},{"name":"$chains_created","containerName":"stop","localvar":"my","line":1263,"definition":"my","kind":13},{"line":1263,"name":"$args","containerName":"stop","kind":13},{"line":1264,"name":"$logger","containerName":"stop","kind":13},{"name":"debug","line":1264,"containerName":"stop","kind":12},{"kind":13,"name":"$tracker","line":1264,"containerName":"stop"},{"name":"$logger","line":1264,"containerName":"stop","kind":13},{"line":1264,"containerName":"stop","name":"is_debug","kind":12},{"kind":13,"containerName":"stop","line":1267,"name":"$self"},{"kind":13,"name":"$chains_created","line":1267,"containerName":"stop"},{"kind":13,"line":1268,"name":"$logger","containerName":"stop"},{"kind":12,"line":1268,"name":"info","containerName":"stop"},{"localvar":"my","name":"$chain","containerName":"stop","definition":"my","kind":13,"line":1269},{"kind":13,"line":1269,"name":"$self","containerName":"stop"},{"kind":13,"line":1270,"containerName":"stop","name":"$logger"},{"kind":12,"name":"info","line":1270,"containerName":"stop"},{"kind":13,"line":1271,"containerName":"stop","name":"$IptablesQueue"},{"kind":12,"containerName":"stop","line":1271,"name":"enqueue"}],"line":1257,"signature":{"parameters":[],"label":"stop()","documentation":" sub add_global_allow_deny_ips {\n     my ($self) = @_;\n     my $TID = \"TID: \" . threads->tid;\n     $logger->debug(\"$TID|Adding global allow/deny IPs to global chains\");\n     my %ip_rules = (\n         allow => $self->{configs}->{allowlist} || {},\n         deny  => $self->{configs}->{denylist}  || {}\n     );\n     $logger->debug(\"$TID|IP rules: \" . Dumper(\\%ip_rules)) if $logger->is_debug();\n     foreach my $action (keys %ip_rules) {\n         my $chain = \"ipblocker_global\" . $action;\n         my $rule_action = $action eq 'allow' ? 'ACCEPT' : 'DROP';\n         foreach my $ruleorder (sort keys %{$ip_rules{$action}}) {\n             my $ip = $ip_rules{$action}{$ruleorder};\n             foreach my $direction ('-s', '-d') {\n                 # my $chain = $chain_prefix . ($direction eq '-s' ? '' : 'regex') . $action;\n                 my $rule = \"$chain $direction $ip -j $rule_action\";\n                 my $args = { rule => $rule, options => \"-w -A\" };\n                 $logger->debug(\"$TID|Adding >>-w -A $rule<< to iptables queue\");\n                 $self->iptablesqueue_enqueue($args);\n             }\n         }\n     }\n     return 1;\n }\n Stops the module\n  Future enhancements:\n   Clear the thread queues"}},{"name":"threads","line":1259,"kind":12},{"kind":12,"name":"chains_created","line":1263},{"kind":12,"line":1264,"name":"Dumper"},{"kind":12,"name":"chains_created","line":1267},{"line":1269,"name":"chains_created","kind":12},{"kind":12,"line":1273,"name":"options"},{"name":"rule","line":1274,"kind":12},{"kind":13,"line":1280,"containerName":null,"name":"$logger"},{"kind":12,"line":1280,"name":"info","containerName":"main::"},{"line":1283,"name":"$logger","containerName":null,"kind":13},{"kind":12,"containerName":"main::","line":1283,"name":"info"},{"kind":12,"name":"clear_queues","line":1284},{"containerName":null,"line":1284,"name":"$logger","kind":13},{"containerName":"main::","line":1284,"name":"error","kind":12},{"line":1285,"name":"$logger","containerName":null,"kind":13},{"containerName":"main::","line":1285,"name":"info","kind":12},{"line":1286,"name":"join_threads","kind":12},{"kind":13,"line":1286,"containerName":null,"name":"$logger"},{"kind":12,"line":1286,"containerName":"main::","name":"error"},{"name":"$logger","line":1288,"containerName":null,"kind":13},{"line":1288,"containerName":"main::","name":"info","kind":12},{"kind":13,"line":1289,"containerName":null,"name":"$lock_obj"},{"kind":12,"name":"release","line":1289,"containerName":"main::"},{"containerName":null,"line":1290,"name":"$logger","kind":13},{"kind":12,"line":1290,"name":"info","containerName":"main::"},{"children":[{"localvar":"my","name":"$TID","containerName":"join_threads","kind":13,"definition":"my","line":1300},{"kind":12,"line":1300,"name":"tid","containerName":"join_threads"},{"kind":13,"containerName":"join_threads","line":1301,"name":"$TID"},{"kind":13,"line":1301,"name":"$TID","containerName":"join_threads"},{"containerName":"join_threads","line":1302,"name":"$logger","kind":13},{"line":1302,"containerName":"join_threads","name":"debug","kind":12},{"kind":12,"line":1303,"containerName":"join_threads","name":"join"},{"kind":12,"line":1303,"name":"list","containerName":"join_threads"}],"line":1299,"signature":{"parameters":[],"label":"join_threads()","documentation":" Joins all threads\n   Simple sub but really needs some rework\n   If a thread is taking a while to join then it will block the other threads from joining\n   Some of the threads could be reading a log file and if the log file is large then it could take a while or\n   if the log file is causing soem kind of blocking for reading then it could take a while.\n   This may be an issue, if an example, if trying to read a file across NFS or SSHFS and there is a network issue."},"kind":12,"definition":"sub","range":{"end":{"line":1305,"character":9999},"start":{"line":1299,"character":0}},"detail":"()","containerName":"main::","name":"join_threads"},{"name":"threads","line":1300,"kind":12},{"kind":12,"name":"threads","line":1303},{"containerName":"main::","name":"clear_queues","kind":12,"detail":"()","definition":"sub","range":{"end":{"line":1328,"character":9999},"start":{"character":0,"line":1308}},"line":1308,"children":[{"definition":"my","kind":13,"line":1309,"localvar":"my","containerName":"clear_queues","name":"$TID"},{"name":"tid","line":1309,"containerName":"clear_queues","kind":12},{"name":"$TID","line":1310,"containerName":"clear_queues","kind":13},{"kind":13,"name":"$TID","line":1310,"containerName":"clear_queues"},{"line":1311,"name":"$logger","containerName":"clear_queues","kind":13},{"kind":12,"name":"debug","line":1311,"containerName":"clear_queues"},{"kind":13,"line":1312,"name":"$DataQueue","containerName":"clear_queues"},{"kind":12,"containerName":"clear_queues","line":1312,"name":"end"},{"line":1313,"name":"$IptablesQueue","containerName":"clear_queues","kind":13},{"containerName":"clear_queues","line":1313,"name":"end","kind":12},{"name":"$DataQueue","line":1314,"containerName":"clear_queues","kind":13},{"kind":12,"line":1314,"name":"pending","containerName":"clear_queues"},{"line":1314,"name":"$IptablesQueue","containerName":"clear_queues","kind":13},{"kind":12,"line":1314,"name":"pending","containerName":"clear_queues"},{"kind":13,"line":1315,"containerName":"clear_queues","name":"$DataQueue"},{"line":1315,"name":"pending","containerName":"clear_queues","kind":12},{"containerName":"clear_queues","line":1315,"name":"$logger","kind":13},{"containerName":"clear_queues","line":1315,"name":"debug","kind":12},{"line":1316,"containerName":"clear_queues","name":"$IptablesQueue","kind":13},{"line":1316,"containerName":"clear_queues","name":"pending","kind":12},{"line":1316,"containerName":"clear_queues","name":"$logger","kind":13},{"kind":12,"line":1316,"name":"debug","containerName":"clear_queues"},{"kind":13,"name":"$DataQueue","line":1320,"containerName":"clear_queues"},{"name":"pending","line":1320,"containerName":"clear_queues","kind":12},{"kind":13,"containerName":"clear_queues","line":1320,"name":"$IptablesQueue"},{"name":"pending","line":1320,"containerName":"clear_queues","kind":12},{"line":1321,"name":"$logger","containerName":"clear_queues","kind":13},{"kind":12,"containerName":"clear_queues","line":1321,"name":"error"},{"line":1325,"name":"$logger","containerName":"clear_queues","kind":13},{"kind":12,"containerName":"clear_queues","line":1325,"name":"debug"}],"signature":{"documentation":" Clears the queues","label":"clear_queues()","parameters":[]}},{"kind":12,"name":"threads","line":1309},{"name":"reload","containerName":"main::","children":[{"name":"$TID","containerName":"reload","localvar":"my","line":1331,"definition":"my","kind":13},{"kind":12,"name":"tid","line":1331,"containerName":"reload"},{"kind":13,"line":1332,"name":"$TID","containerName":"reload"},{"name":"$TID","line":1332,"containerName":"reload","kind":13},{"kind":13,"line":1333,"name":"$logger","containerName":"reload"},{"containerName":"reload","line":1333,"name":"info","kind":12}],"line":1330,"signature":{"documentation":"","label":"reload()","parameters":[]},"kind":12,"range":{"start":{"line":1330,"character":0},"end":{"line":1357,"character":9999}},"definition":"sub","detail":"()"},{"kind":12,"name":"threads","line":1331},{"name":"SIG_INT","containerName":"main::","children":[{"kind":13,"name":"$logger","line":1362,"containerName":"SIG_INT"},{"line":1362,"name":"info","containerName":"SIG_INT","kind":12}],"line":1361,"definition":"sub","range":{"end":{"line":1365,"character":9999},"start":{"character":0,"line":1361}},"kind":12},{"kind":12,"definition":"sub","range":{"end":{"character":9999,"line":1372},"start":{"character":0,"line":1369}},"line":1369,"children":[{"line":1370,"name":"$logger","containerName":"SIG_HUP","kind":13},{"line":1370,"containerName":"SIG_HUP","name":"info","kind":12}],"containerName":"main::","name":"SIG_HUP"},{"kind":12,"range":{"end":{"line":1379,"character":9999},"start":{"character":0,"line":1376}},"definition":"sub","children":[{"name":"$logger","line":1377,"containerName":"SIG_TERM","kind":13},{"kind":12,"line":1377,"containerName":"SIG_TERM","name":"info"}],"line":1376,"containerName":"main::","name":"SIG_TERM"},{"line":1383,"children":[{"line":1384,"definition":"my","kind":13,"containerName":"SIG_QUIT","name":"$self","localvar":"my"}],"definition":"sub","range":{"end":{"character":9999,"line":1386},"start":{"line":1383,"character":0}},"kind":12,"containerName":"main::","name":"SIG_QUIT"},{"containerName":"main::","name":"set_signal_handler","signature":{"documentation":"","parameters":[],"label":"set_signal_handler()"},"line":1388,"children":[{"kind":13,"line":1389,"containerName":"set_signal_handler","name":"$logger"},{"kind":12,"line":1389,"containerName":"set_signal_handler","name":"info"},{"line":1391,"name":"$SIG","containerName":"set_signal_handler","kind":13},{"kind":13,"name":"$SIG","line":1392,"containerName":"set_signal_handler"},{"kind":13,"containerName":"set_signal_handler","line":1393,"name":"$SIG"},{"containerName":"set_signal_handler","line":1394,"name":"$SIG","kind":13}],"detail":"()","range":{"end":{"line":1395,"character":9999},"start":{"character":0,"line":1388}},"definition":"sub","kind":12},{"name":"INT","line":1391,"kind":12},{"kind":12,"name":"TERM","line":1392},{"line":1393,"name":"HUP","kind":12},{"kind":12,"line":1394,"name":"QUIT"}]}