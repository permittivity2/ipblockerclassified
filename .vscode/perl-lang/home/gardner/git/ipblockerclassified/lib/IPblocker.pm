{"vars":[{"containerName":"","line":53,"kind":2,"name":"POSIX"},{"line":54,"kind":2,"containerName":"","name":"strict"},{"kind":2,"line":55,"containerName":"","name":"DateTime"},{"name":"Basename","containerName":"File","line":56,"kind":2},{"kind":2,"line":57,"containerName":"List","name":"Util"},{"containerName":"","line":61,"kind":2,"name":"strict"},{"name":"HiRes","containerName":"Time","line":62,"kind":2},{"name":"File","line":67,"kind":2,"containerName":"Config"},{"line":68,"containerName":"","kind":2,"name":"Carp"},{"kind":2,"line":69,"containerName":"Log","name":"Log4perl"},{"name":"Dumper","line":70,"kind":2,"containerName":"Data"},{"containerName":"Regexp","line":71,"kind":2,"name":"IPv6"},{"name":"Simple","kind":2,"line":72,"containerName":"LockFile"},{"line":73,"containerName":"File","kind":2,"name":"Path"},{"name":"Wrapper","line":74,"kind":2,"containerName":"Net::Ifconfig"},{"name":"threads","kind":2,"line":77,"containerName":""},{"containerName":"Thread","line":80,"kind":2,"name":"Queue"},{"localvar":"my","kind":13,"containerName":null,"name":"$DataQueue","line":81,"definition":"my"},{"name":"Thread","containerName":"Queue","line":81,"kind":12},{"kind":12,"line":81,"containerName":"main::","name":"new"},{"containerName":null,"kind":13,"localvar":"my","line":82,"definition":"my","name":"$LoggerTIDS"},{"definition":"my","line":84,"name":"$IptablesQueue","kind":13,"containerName":null,"localvar":"my"},{"containerName":"Queue","line":84,"kind":12,"name":"Thread"},{"line":84,"kind":12,"containerName":"main::","name":"new"},{"definition":"my","line":85,"name":"$IptablesTIDS","containerName":null,"kind":13,"localvar":"my"},{"line":88,"containerName":null,"kind":13,"name":"$Data"},{"kind":12,"line":88,"containerName":"Sortkeys","name":"Dumper"},{"name":"$Data","line":89,"kind":13,"containerName":null},{"name":"Dumper","line":89,"containerName":"Indent","kind":12},{"name":"$logger","line":96,"definition":"my","localvar":"my","kind":13,"containerName":null},{"name":"$lock_obj","line":99,"definition":"my","localvar":"my","kind":13,"containerName":null},{"localvar":"my","containerName":null,"kind":13,"name":"$REGEX_IPV4","line":104,"definition":"my"},{"kind":13,"containerName":null,"localvar":"my","line":106,"definition":"my","name":"$REGEX_IPV6"},{"kind":13,"containerName":null,"localvar":"my","line":107,"definition":"my","name":"$IPTABLESRUNLINE"},{"definition":"our","line":111,"containerName":"main::","kind":13,"name":"%tracker"},{"localvar":"my","kind":13,"containerName":null,"name":"%DEFAULTS","line":112,"definition":"my"},{"line":113,"kind":12,"name":"allowdeny"},{"name":"allowlist","kind":12,"line":114},{"name":"configsfile","line":115,"kind":12},{"name":"cycles","line":116,"kind":12},{"name":"LONG_MAX","kind":12,"line":116},{"line":117,"kind":12,"name":"cyclesleep"},{"name":"dumpconfigsandexit","kind":12,"line":118},{"name":"denylist","kind":12,"line":119},{"kind":12,"line":120,"name":"forceremovelockfile"},{"line":121,"kind":12,"name":"globalallowlist"},{"line":122,"kind":12,"name":"chainprefix"},{"name":"globalchains","kind":12,"line":123},{"line":124,"kind":12,"name":"globaldenylist"},{"name":"globalregexallowlist","line":125,"kind":12},{"line":126,"kind":12,"name":"globalregexdenylist"},{"name":"ignoreinterfaceips","kind":12,"line":127},{"name":"iptables","line":128,"kind":12},{"name":"lockfile","line":129,"kind":12},{"line":130,"kind":12,"name":"log4perlconf"},{"line":131,"kind":12,"name":"loglevel"},{"line":135,"kind":12,"name":"logcontents"},{"name":"logs_to_review","line":136,"kind":12},{"name":"logwatch_interval","kind":12,"line":137},{"kind":12,"line":138,"name":"prodmode"},{"name":"queuechecktime","kind":12,"line":139},{"line":140,"kind":12,"name":"queuecycles"},{"kind":12,"line":140,"name":"LONG_MAX"},{"kind":12,"line":141,"name":"readentirefile"},{"signature":{"documentation":"#### Subs below here #####\n Reads configs, logging configs, sets up logging, sets up a class and returns a blessed object\n   The sub go() is where the action starts","parameters":[],"label":"new()"},"containerName":"main::","kind":12,"children":[{"definition":"my","line":150,"name":"$class","containerName":"new","kind":13,"localvar":"my"},{"name":"$args","definition":"my","line":151,"localvar":"my","containerName":"new","kind":13},{"name":"$args","line":153,"kind":13,"containerName":"new"},{"name":"$args","line":155,"kind":13,"containerName":"new"},{"kind":13,"line":157,"containerName":"new","name":"$args"},{"name":"$configsfile","line":162,"definition":"my","localvar":"my","kind":13,"containerName":"new"},{"name":"$args","line":162,"kind":13,"containerName":"new"},{"name":"$DEFAULTS","line":162,"containerName":"new","kind":13},{"localvar":"my","kind":13,"containerName":"new","name":"$self","definition":"my","line":164},{"name":"$configsfile","kind":13,"line":165,"containerName":"new"},{"name":"$args","line":166,"containerName":"new","kind":13},{"name":"$self","containerName":"new","line":170,"kind":13},{"name":"$class","containerName":"new","line":170,"kind":13},{"line":174,"kind":13,"containerName":"new","name":"$self"},{"name":"load_configs","line":174,"containerName":"new","kind":12},{"name":"$self","line":176,"containerName":"new","kind":13},{"containerName":"new","line":178,"kind":13,"name":"$self"},{"name":"$self","containerName":"new","line":179,"kind":13},{"name":"$self","line":180,"kind":13,"containerName":"new"},{"name":"$self","kind":13,"line":182,"containerName":"new"},{"containerName":"new","line":187,"kind":13,"name":"$logger"},{"containerName":"new","line":187,"kind":13,"name":"$self"},{"line":187,"kind":12,"containerName":"new","name":"setup_Logger"},{"name":"$logger","line":188,"containerName":"new","kind":13},{"name":"info","line":188,"kind":12,"containerName":"new"},{"kind":13,"line":189,"containerName":"new","name":"$logger"},{"containerName":"new","line":189,"kind":12,"name":"debug"},{"line":189,"kind":13,"containerName":"new","name":"$self"},{"line":189,"containerName":"new","kind":13,"name":"$logger"},{"line":189,"containerName":"new","kind":12,"name":"is_debug"},{"name":"$self","kind":13,"line":191,"containerName":"new"}],"range":{"start":{"character":0,"line":149},"end":{"line":192,"character":9999}},"line":149,"definition":"sub","detail":"()","name":"new"},{"name":"carp","line":154,"kind":12},{"name":"croak","kind":12,"line":158},{"name":"configsfile","kind":12,"line":162},{"name":"configsfile","line":162,"kind":12},{"name":"configsfile","line":165,"kind":12},{"line":166,"kind":12,"name":"clargs"},{"name":"configs","line":176,"kind":12},{"line":176,"kind":12,"name":"dumpconfigsandexit"},{"name":"configs","kind":12,"line":178},{"name":"configsfile","kind":12,"line":178},{"name":"configs","kind":12,"line":179},{"line":179,"kind":12,"name":"globalchain"},{"kind":12,"line":180,"name":"configs"},{"kind":12,"line":180,"name":"dumpconfigsandexit"},{"name":"recursiveHashPrint","kind":12,"line":182},{"name":"configs","line":182,"kind":12},{"name":"Dumper","kind":12,"line":189},{"detail":"($ref,$prefix)","definition":"sub","line":195,"name":"recursiveHashPrint","children":[{"localvar":"my","containerName":"recursiveHashPrint","kind":13,"name":"$ref","definition":"my","line":196},{"containerName":"recursiveHashPrint","line":196,"kind":13,"name":"$prefix"},{"kind":13,"line":197,"containerName":"recursiveHashPrint","name":"$prefix"},{"line":197,"containerName":"recursiveHashPrint","kind":13,"name":"$prefix"},{"name":"$ref","line":199,"containerName":"recursiveHashPrint","kind":13},{"containerName":"recursiveHashPrint","kind":13,"localvar":"my","line":200,"definition":"my","name":"$key"},{"kind":13,"line":200,"containerName":"recursiveHashPrint","name":"$ref"},{"definition":"my","line":203,"name":"$new_prefix","containerName":"recursiveHashPrint","kind":13,"localvar":"my"},{"name":"$prefix","line":203,"kind":13,"containerName":"recursiveHashPrint"},{"name":"$ref","line":204,"containerName":"recursiveHashPrint","kind":13},{"name":"$key","containerName":"recursiveHashPrint","line":204,"kind":13},{"name":"$new_prefix","line":204,"kind":13,"containerName":"recursiveHashPrint"}],"signature":{"parameters":[{"label":"$ref"},{"label":"$prefix"}],"documentation":"# Recursive sub to print out a hash to STDOUT in a manner that matches \"use Config::File;\"","label":"recursiveHashPrint($ref,$prefix)"},"containerName":"main::","kind":12,"range":{"end":{"character":9999,"line":206},"start":{"line":195,"character":0}}},{"line":207,"containerName":null,"kind":13,"name":"%ref"},{"localvar":"my","containerName":null,"kind":13,"name":"$line","definition":"my","line":210},{"name":"$ref","line":210,"kind":13,"containerName":null},{"name":"$line","containerName":null,"line":211,"kind":13},{"line":212,"containerName":null,"kind":13,"name":"$line"},{"name":"%line","line":213,"containerName":null,"kind":13},{"localvar":"my","kind":13,"containerName":null,"name":"$line","definition":"my","line":217},{"line":218,"containerName":null,"kind":13,"name":"$line"},{"line":219,"kind":13,"containerName":null,"name":"$line"},{"name":"$line","containerName":null,"line":220,"kind":13},{"range":{"start":{"line":224,"character":0},"end":{"character":9999,"line":265}},"signature":{"label":"iptables_thread()","parameters":[],"documentation":""},"containerName":"main::","kind":12,"children":[{"localvar":"my","kind":13,"containerName":"iptables_thread","name":"$self","definition":"my","line":225},{"containerName":"iptables_thread","kind":13,"localvar":"my","line":226,"definition":"my","name":"$TID"},{"line":226,"kind":12,"containerName":"iptables_thread","name":"tid"},{"line":227,"containerName":"iptables_thread","kind":13,"name":"$TID"},{"name":"$TID","line":227,"containerName":"iptables_thread","kind":13},{"line":229,"definition":"my","name":"$cyclesleep","containerName":"iptables_thread","kind":13,"localvar":"my"},{"line":229,"containerName":"iptables_thread","kind":13,"name":"$self"},{"line":230,"definition":"my","name":"$cycles","containerName":"iptables_thread","kind":13,"localvar":"my"},{"name":"$self","kind":13,"line":230,"containerName":"iptables_thread"},{"line":231,"definition":"my","name":"$logmsg","containerName":"iptables_thread","kind":13,"localvar":"my"},{"line":232,"containerName":"iptables_thread","kind":13,"name":"$logmsg"},{"name":"$logger","kind":13,"line":233,"containerName":"iptables_thread"},{"line":233,"kind":12,"containerName":"iptables_thread","name":"info"},{"name":"$logmsg","kind":13,"line":233,"containerName":"iptables_thread"},{"localvar":"my","containerName":"iptables_thread","kind":13,"name":"$iptablesQueue_pending","definition":"my","line":236},{"line":236,"containerName":"iptables_thread","kind":13,"name":"$IptablesQueue"},{"kind":12,"line":236,"containerName":"iptables_thread","name":"pending"},{"containerName":"iptables_thread","line":237,"kind":13,"name":"$iptablesQueue_pending"},{"name":"$logmsg","line":238,"definition":"my","localvar":"my","containerName":"iptables_thread","kind":13},{"containerName":"iptables_thread","line":239,"kind":13,"name":"$logmsg"},{"line":240,"kind":13,"containerName":"iptables_thread","name":"$logger"},{"line":240,"containerName":"iptables_thread","kind":12,"name":"info"},{"name":"$logmsg","line":240,"kind":13,"containerName":"iptables_thread"},{"kind":13,"line":244,"containerName":"iptables_thread","name":"$iptablesQueue_pending"},{"name":"$logger","containerName":"iptables_thread","line":245,"kind":13},{"name":"info","containerName":"iptables_thread","line":245,"kind":12},{"definition":"my","line":246,"name":"$data","containerName":"iptables_thread","kind":13,"localvar":"my"},{"line":246,"kind":13,"containerName":"iptables_thread","name":"$IptablesQueue"},{"kind":12,"line":246,"containerName":"iptables_thread","name":"dequeue"},{"name":"$logger","line":247,"kind":13,"containerName":"iptables_thread"},{"line":247,"kind":12,"containerName":"iptables_thread","name":"debug"},{"line":247,"containerName":"iptables_thread","kind":13,"name":"$data"},{"name":"$logger","line":247,"containerName":"iptables_thread","kind":13},{"name":"is_debug","kind":12,"line":247,"containerName":"iptables_thread"},{"name":"$self","kind":13,"line":248,"containerName":"iptables_thread"},{"containerName":"iptables_thread","line":248,"kind":12,"name":"run_iptables"},{"name":"$data","line":248,"kind":13,"containerName":"iptables_thread"},{"name":"$logger","line":248,"kind":13,"containerName":"iptables_thread"},{"name":"error","containerName":"iptables_thread","line":248,"kind":12},{"name":"$data","line":248,"containerName":"iptables_thread","kind":13},{"containerName":"iptables_thread","line":249,"kind":13,"name":"$IPTABLESRUNLINE"},{"kind":13,"line":250,"containerName":"iptables_thread","name":"$IPTABLESRUNLINE"},{"name":"$IPTABLESRUNLINE","kind":13,"line":250,"containerName":"iptables_thread"},{"name":"$iptablesQueue_pending","kind":13,"line":252,"containerName":"iptables_thread"},{"containerName":"iptables_thread","kind":13,"localvar":"my","line":254,"definition":"my","name":"$logmsg"},{"name":"$logmsg","kind":13,"line":255,"containerName":"iptables_thread"},{"name":"$cyclesleep","kind":13,"line":255,"containerName":"iptables_thread"},{"name":"$logmsg","kind":13,"line":256,"containerName":"iptables_thread"},{"name":"$logger","kind":13,"line":257,"containerName":"iptables_thread"},{"kind":12,"line":257,"containerName":"iptables_thread","name":"info"},{"name":"$logmsg","containerName":"iptables_thread","line":257,"kind":13},{"name":"$cyclesleep","line":258,"kind":13,"containerName":"iptables_thread"},{"name":"$logger","kind":13,"line":261,"containerName":"iptables_thread"},{"line":261,"containerName":"iptables_thread","kind":12,"name":"error"}],"name":"iptables_thread","line":224,"definition":"sub","detail":"()"},{"kind":12,"line":226,"name":"threads"},{"line":229,"kind":12,"name":"configs"},{"name":"queuechecktime","line":229,"kind":12},{"name":"configs","kind":12,"line":230},{"name":"queuecycles","line":230,"kind":12},{"name":"Dumper","kind":12,"line":247},{"kind":12,"line":248,"name":"Dumper"},{"kind":12,"line":258,"name":"usleep"},{"detail":"()","definition":"sub","line":272,"name":"go","children":[{"kind":13,"containerName":"go","localvar":"my","line":273,"definition":"my","name":"$self"},{"containerName":"go","kind":13,"localvar":"my","line":274,"definition":"my","name":"$start_time"},{"name":"$self","containerName":"go","line":277,"kind":13},{"line":278,"kind":13,"containerName":"go","name":"$logger"},{"line":278,"containerName":"go","kind":12,"name":"error"},{"name":"$self","containerName":"go","line":283,"kind":13},{"kind":12,"line":283,"containerName":"go","name":"set_iptables_command"},{"name":"$logger","line":283,"containerName":"go","kind":13},{"line":283,"containerName":"go","kind":12,"name":"error"},{"line":284,"kind":13,"containerName":"go","name":"$self"},{"name":"set_signal_handler","containerName":"go","line":284,"kind":12},{"name":"$self","containerName":"go","line":285,"kind":13},{"line":285,"kind":13,"containerName":"go","name":"$self"},{"name":"$self","line":286,"containerName":"go","kind":13},{"line":286,"containerName":"go","kind":12,"name":"set_lockFile"},{"name":"$logger","line":286,"kind":13,"containerName":"go"},{"name":"logdie","line":286,"kind":12,"containerName":"go"},{"localvar":"my","containerName":"go","kind":13,"name":"$iptables_thr","definition":"my","line":290},{"containerName":"go","line":290,"kind":12,"name":"create"},{"line":290,"kind":13,"containerName":"go","name":"$self"},{"name":"$self","containerName":"go","line":293,"kind":13},{"name":"add_global_chain","line":293,"kind":12,"containerName":"go"},{"name":"$self","line":296,"kind":13,"containerName":"go"},{"kind":12,"line":296,"containerName":"go","name":"add_global_allow_deny_ips"},{"name":"$logger","line":300,"containerName":"go","kind":13},{"name":"logdie","containerName":"go","line":300,"kind":12},{"kind":13,"line":300,"containerName":"go","name":"$self"},{"name":"logger_thread","kind":12,"line":300,"containerName":"go"},{"name":"$cycles","definition":"my","line":311,"localvar":"my","containerName":"go","kind":13},{"kind":13,"line":311,"containerName":"go","name":"$self"},{"containerName":"go","kind":13,"localvar":"my","definition":"my","line":312,"name":"$cyclesleep"},{"name":"$self","line":312,"kind":13,"containerName":"go"},{"name":"$cycles","containerName":"go","line":313,"kind":13},{"kind":13,"line":314,"containerName":"go","name":"$cycles"},{"name":"$cyclesleep","line":315,"containerName":"go","kind":13},{"localvar":"my","containerName":"go","kind":13,"name":"$logmsg","definition":"my","line":316},{"name":"$logmsg","line":317,"containerName":"go","kind":13},{"containerName":"go","line":317,"kind":13,"name":"$cycles"},{"name":"$logmsg","kind":13,"line":318,"containerName":"go"},{"containerName":"go","line":319,"kind":13,"name":"$logmsg"},{"line":319,"containerName":"go","kind":13,"name":"$cyclesleep"},{"kind":13,"line":320,"containerName":"go","name":"$logmsg"},{"kind":13,"line":321,"containerName":"go","name":"$logger"},{"name":"trace","kind":12,"line":321,"containerName":"go"},{"line":321,"containerName":"go","kind":13,"name":"$logmsg"},{"kind":13,"line":321,"containerName":"go","name":"$logger"},{"name":"is_debug","containerName":"go","line":321,"kind":12},{"localvar":"my","kind":13,"containerName":"go","name":"$runtime","definition":"my","line":324},{"line":324,"kind":13,"containerName":"go","name":"$start_time"},{"line":325,"kind":13,"containerName":"go","name":"$runtime"},{"name":"$runtime","containerName":"go","line":325,"kind":13},{"name":"$logger","kind":13,"line":326,"containerName":"go"},{"name":"info","containerName":"go","line":326,"kind":12},{"name":"$self","containerName":"go","line":327,"kind":13},{"name":"stop","containerName":"go","line":327,"kind":12}],"kind":12,"signature":{"label":"go()","parameters":[],"documentation":" Creates two initial threads:\n   One for iptables commands to run.\n   Another to watch the log files\n       This in turn creates a thread for each log file to watch\n Also starts running the DataQueue queue which handles the data"},"containerName":"main::","range":{"end":{"character":9999,"line":328},"start":{"line":272,"character":0}}},{"name":"configs","kind":12,"line":277},{"name":"logs_to_review","kind":12,"line":277},{"name":"configs","kind":12,"line":285},{"kind":12,"line":285,"name":"globalchain"},{"name":"configs","line":285,"kind":12},{"name":"chainprefix","line":285,"kind":12},{"kind":12,"line":290,"name":"threads"},{"name":"configs","line":311,"kind":12},{"kind":12,"line":311,"name":"cycles"},{"line":312,"kind":12,"name":"configs"},{"name":"cyclesleep","kind":12,"line":312},{"name":"usleep","line":315,"kind":12},{"range":{"end":{"line":360,"character":9999},"start":{"line":332,"character":0}},"signature":{"label":"add_ifconfig_ips_to_allowlist()","documentation":" Description:  Adds IPs on the local interfaces to the global allowlist\n  This does not work becasue it only handles IPv4 addresses and other issues","parameters":[]},"kind":12,"containerName":"main::","children":[{"localvar":"my","kind":13,"containerName":"add_ifconfig_ips_to_allowlist","name":"$self","definition":"my","line":333}],"name":"add_ifconfig_ips_to_allowlist","line":332,"detail":"()","definition":"sub"},{"children":[{"localvar":"my","kind":13,"containerName":"dataQueue_runner","name":"$self","definition":"my","line":363},{"name":"$TID","definition":"my","line":364,"localvar":"my","containerName":"dataQueue_runner","kind":13},{"name":"tid","containerName":"dataQueue_runner","line":364,"kind":12},{"line":365,"kind":13,"containerName":"dataQueue_runner","name":"$TID"},{"containerName":"dataQueue_runner","line":365,"kind":13,"name":"$TID"},{"containerName":"dataQueue_runner","line":367,"kind":13,"name":"$Data"},{"kind":13,"line":368,"containerName":"dataQueue_runner","name":"$Data"},{"containerName":"dataQueue_runner","line":370,"kind":13,"name":"$logger"},{"kind":12,"line":370,"containerName":"dataQueue_runner","name":"info"},{"name":"$queuechecktime","line":371,"definition":"my","localvar":"my","containerName":"dataQueue_runner","kind":13},{"containerName":"dataQueue_runner","line":371,"kind":13,"name":"$self"},{"name":"$queuecycles","definition":"my","line":372,"localvar":"my","kind":13,"containerName":"dataQueue_runner"},{"line":372,"containerName":"dataQueue_runner","kind":13,"name":"$self"},{"line":375,"definition":"my","name":"$dataqueue_pending","containerName":"dataQueue_runner","kind":13,"localvar":"my"},{"name":"$DataQueue","kind":13,"line":375,"containerName":"dataQueue_runner"},{"name":"pending","kind":12,"line":375,"containerName":"dataQueue_runner"},{"name":"$dataqueue_pending","line":376,"containerName":"dataQueue_runner","kind":13},{"name":"$logger","kind":13,"line":377,"containerName":"dataQueue_runner"},{"name":"info","line":377,"containerName":"dataQueue_runner","kind":12},{"name":"$dataqueue_pending","kind":13,"line":381,"containerName":"dataQueue_runner"},{"line":382,"containerName":"dataQueue_runner","kind":13,"name":"$logger"},{"kind":12,"line":382,"containerName":"dataQueue_runner","name":"info"},{"line":383,"definition":"my","name":"$data","kind":13,"containerName":"dataQueue_runner","localvar":"my"},{"name":"$DataQueue","containerName":"dataQueue_runner","line":383,"kind":13},{"line":383,"containerName":"dataQueue_runner","kind":12,"name":"dequeue"},{"line":385,"kind":13,"containerName":"dataQueue_runner","name":"$logger"},{"containerName":"dataQueue_runner","line":385,"kind":12,"name":"debug"},{"line":385,"containerName":"dataQueue_runner","kind":13,"name":"$data"},{"name":"$logger","line":385,"kind":13,"containerName":"dataQueue_runner"},{"line":385,"kind":12,"containerName":"dataQueue_runner","name":"is_debug"},{"name":"$dataqueue_pending","kind":13,"line":387,"containerName":"dataQueue_runner"},{"line":388,"definition":"my","name":"$logmsg","kind":13,"containerName":"dataQueue_runner","localvar":"my"},{"line":389,"kind":13,"containerName":"dataQueue_runner","name":"$logmsg"},{"name":"$logger","kind":13,"line":390,"containerName":"dataQueue_runner"},{"line":390,"containerName":"dataQueue_runner","kind":12,"name":"info"},{"name":"$logmsg","containerName":"dataQueue_runner","line":390,"kind":13},{"name":"$queuecycles","kind":13,"line":391,"containerName":"dataQueue_runner"},{"line":392,"containerName":"dataQueue_runner","kind":13,"name":"$queuecycles"},{"line":393,"kind":13,"containerName":"dataQueue_runner","name":"$queuechecktime"},{"line":396,"containerName":"dataQueue_runner","kind":13,"name":"$logger"},{"name":"error","line":396,"containerName":"dataQueue_runner","kind":12},{"name":"$logger","kind":13,"line":401,"containerName":"dataQueue_runner"},{"name":"info","line":401,"containerName":"dataQueue_runner","kind":12}],"signature":{"parameters":[],"documentation":"","label":"dataQueue_runner()"},"kind":12,"containerName":"main::","range":{"end":{"line":402,"character":9999},"start":{"line":362,"character":0}},"definition":"sub","detail":"()","line":362,"name":"dataQueue_runner"},{"line":364,"kind":12,"name":"threads"},{"kind":12,"line":367,"containerName":"Terse","name":"Dumper"},{"line":368,"containerName":"Indent","kind":12,"name":"Dumper"},{"kind":12,"line":371,"name":"configs"},{"name":"queuechecktime","kind":12,"line":371},{"kind":12,"line":372,"name":"configs"},{"name":"queuecycles","kind":12,"line":372},{"name":"Dumper","kind":12,"line":385},{"name":"setup_Logger","line":408,"detail":"()","definition":"sub","range":{"start":{"character":0,"line":408},"end":{"character":9999,"line":433}},"signature":{"label":"setup_Logger()","documentation":" Assumptions:\n   $self->{configs}->{log4perlconf} is set\n   $self->{configs}->{logwatch_interval} is set\n These assumptions *should* be true because this is called from new()","parameters":[]},"kind":12,"containerName":"main::","children":[{"localvar":"my","containerName":"setup_Logger","kind":13,"name":"$self","definition":"my","line":409},{"line":412,"definition":"my","name":"$log4perlconf","kind":13,"containerName":"setup_Logger","localvar":"my"},{"line":412,"containerName":"setup_Logger","kind":13,"name":"$self"},{"name":"$logwatch_interval","definition":"my","line":413,"localvar":"my","containerName":"setup_Logger","kind":13},{"containerName":"setup_Logger","line":413,"kind":13,"name":"$self"},{"name":"init_and_watch","containerName":"setup_Logger","line":414,"kind":12},{"name":"$log4perlconf","containerName":"setup_Logger","line":414,"kind":13},{"line":414,"containerName":"setup_Logger","kind":13,"name":"$logwatch_interval"},{"name":"easy_init","containerName":"setup_Logger","line":418,"kind":12},{"line":418,"containerName":"setup_Logger","kind":13,"name":"$Log"},{"kind":13,"line":420,"containerName":"setup_Logger","name":"$logger"},{"name":"$self","line":421,"kind":13,"containerName":"setup_Logger"},{"name":"$logger","line":422,"containerName":"setup_Logger","kind":13},{"line":422,"containerName":"setup_Logger","kind":12,"name":"level"},{"name":"$self","kind":13,"line":422,"containerName":"setup_Logger"},{"kind":13,"line":423,"containerName":"setup_Logger","name":"$logger"},{"kind":12,"line":423,"containerName":"setup_Logger","name":"info"},{"name":"$logger","containerName":"setup_Logger","line":423,"kind":13},{"line":423,"containerName":"setup_Logger","kind":12,"name":"level"},{"line":430,"kind":13,"containerName":"setup_Logger","name":"$logger"},{"containerName":"setup_Logger","line":430,"kind":12,"name":"info"},{"name":"$logger","line":432,"containerName":"setup_Logger","kind":13}]},{"name":"configs","line":412,"kind":12},{"kind":12,"line":412,"name":"log4perlconf"},{"line":413,"kind":12,"name":"configs"},{"line":413,"kind":12,"name":"logwatch_interval"},{"line":414,"kind":12,"containerName":"Log4perl","name":"Log"},{"kind":12,"line":416,"name":"carp"},{"name":"carp","kind":12,"line":417},{"kind":12,"line":418,"containerName":"Log4perl","name":"Log"},{"name":"Log4perl","containerName":"DEBUG","line":418,"kind":12},{"line":420,"kind":12,"name":"get_logger"},{"line":420,"kind":12,"name":"croak"},{"name":"configs","kind":12,"line":421},{"name":"loglevel","kind":12,"line":421},{"name":"configs","line":422,"kind":12},{"kind":12,"line":422,"name":"loglevel"},{"children":[{"line":438,"definition":"my","name":"$self","kind":13,"containerName":"set_lockFile","localvar":"my"},{"line":440,"containerName":"set_lockFile","kind":13,"name":"$self"},{"name":"$logger","containerName":"set_lockFile","line":441,"kind":13},{"name":"logdie","containerName":"set_lockFile","line":441,"kind":12},{"definition":"my","line":444,"name":"$lockfile","containerName":"set_lockFile","kind":13,"localvar":"my"},{"name":"$self","line":444,"kind":13,"containerName":"set_lockFile"},{"line":447,"definition":"my","name":"$lf","containerName":"set_lockFile","kind":13,"localvar":"my"},{"containerName":"set_lockFile","line":447,"kind":13,"name":"$self"},{"line":448,"containerName":"set_lockFile","kind":13,"name":"$logger"},{"name":"debug","line":448,"kind":12,"containerName":"set_lockFile"},{"kind":13,"line":450,"containerName":"set_lockFile","name":"$lf"},{"name":"$self","line":451,"containerName":"set_lockFile","kind":13},{"name":"$logger","line":452,"kind":13,"containerName":"set_lockFile"},{"containerName":"set_lockFile","line":452,"kind":12,"name":"info"},{"containerName":"set_lockFile","line":453,"kind":13,"name":"$lf"},{"name":"$logger","kind":13,"line":453,"containerName":"set_lockFile"},{"line":453,"kind":12,"containerName":"set_lockFile","name":"logdie"},{"line":456,"definition":"my","name":"$fh","kind":13,"containerName":"set_lockFile","localvar":"my"},{"line":456,"kind":13,"containerName":"set_lockFile","name":"$lf"},{"kind":13,"line":456,"containerName":"set_lockFile","name":"$logger"},{"line":456,"kind":12,"containerName":"set_lockFile","name":"logdie"},{"containerName":"set_lockFile","kind":13,"localvar":"my","definition":"my","line":457,"name":"@contents"},{"name":"$fh","line":457,"kind":13,"containerName":"set_lockFile"},{"containerName":"set_lockFile","line":458,"kind":13,"name":"$fh"},{"name":"@contents","line":459,"kind":13,"containerName":"set_lockFile"},{"containerName":"set_lockFile","kind":13,"localvar":"my","definition":"my","line":460,"name":"$printable_contents"},{"containerName":"set_lockFile","line":460,"kind":13,"name":"@contents"},{"kind":13,"containerName":"set_lockFile","localvar":"my","definition":"my","line":461,"name":"$logmsg"},{"kind":13,"line":462,"containerName":"set_lockFile","name":"$logger"},{"name":"info","kind":12,"line":462,"containerName":"set_lockFile"},{"kind":13,"line":462,"containerName":"set_lockFile","name":"$logmsg"},{"name":"$lf","kind":13,"line":466,"containerName":"set_lockFile"},{"line":466,"containerName":"set_lockFile","kind":13,"name":"$logger"},{"line":466,"kind":12,"containerName":"set_lockFile","name":"logdie"},{"containerName":"set_lockFile","line":469,"kind":13,"name":"$self"},{"kind":12,"line":469,"containerName":"set_lockFile","name":"make"},{"containerName":"set_lockFile","line":472,"kind":13,"name":"$logger"},{"line":472,"containerName":"set_lockFile","kind":12,"name":"debug"},{"name":"$self","kind":13,"line":472,"containerName":"set_lockFile"},{"containerName":"set_lockFile","line":472,"kind":13,"name":"$logger"},{"kind":12,"line":472,"containerName":"set_lockFile","name":"is_debug"},{"name":"$self","kind":13,"line":473,"containerName":"set_lockFile"},{"kind":13,"line":473,"containerName":"set_lockFile","name":"$self"},{"name":"lock","line":473,"containerName":"set_lockFile","kind":12},{"name":"$lf","line":473,"kind":13,"containerName":"set_lockFile"},{"name":"$logger","line":474,"containerName":"set_lockFile","kind":13},{"containerName":"set_lockFile","line":474,"kind":12,"name":"logdie"},{"name":"$lock_obj","line":475,"kind":13,"containerName":"set_lockFile"},{"containerName":"set_lockFile","line":475,"kind":13,"name":"$self"},{"name":"$logger","line":477,"kind":13,"containerName":"set_lockFile"},{"name":"info","containerName":"set_lockFile","line":477,"kind":12}],"signature":{"label":"set_lockFile()","parameters":[],"documentation":" Set lock file\n   Returns 1 if lock file is set, otherwise returns 0"},"containerName":"main::","kind":12,"range":{"end":{"line":479,"character":9999},"start":{"character":0,"line":437}},"definition":"sub","detail":"()","line":437,"name":"set_lockFile"},{"name":"configs","kind":12,"line":440},{"line":440,"kind":12,"name":"lockfile"},{"name":"configs","kind":12,"line":444},{"line":444,"kind":12,"name":"lockfile"},{"name":"configs","kind":12,"line":447},{"line":447,"kind":12,"name":"lockfile"},{"name":"configs","line":451,"kind":12},{"line":451,"kind":12,"name":"forceremovelockfile"},{"line":469,"kind":12,"name":"lockmgr"},{"kind":12,"line":469,"containerName":"Simple","name":"LockFile"},{"kind":12,"line":472,"name":"Dumper"},{"kind":12,"line":472,"name":"lockmgr"},{"line":473,"kind":12,"name":"lock"},{"line":473,"kind":12,"name":"lockmgr"},{"line":475,"kind":12,"name":"lock"},{"children":[{"definition":"my","line":484,"name":"$self","containerName":"logger_thread","kind":13,"localvar":"my"},{"containerName":"logger_thread","kind":13,"localvar":"my","definition":"my","line":486,"name":"$logstoreview"},{"containerName":"logger_thread","line":486,"kind":13,"name":"$self"},{"name":"$logstoreview","line":487,"kind":13,"containerName":"logger_thread"},{"localvar":"my","containerName":"logger_thread","kind":13,"name":"$logtoreview","line":490,"definition":"my"},{"line":490,"kind":13,"containerName":"logger_thread","name":"$logstoreview"}],"kind":12,"signature":{"label":"logger_thread()","documentation":"# Description: Creates a thread for each log file to review\n# Returns 1 or dies if thread can not be created","parameters":[]},"containerName":"main::","range":{"end":{"line":490,"character":9999},"start":{"line":483,"character":0}},"definition":"sub","detail":"()","line":483,"name":"logger_thread"},{"line":486,"kind":12,"name":"configs"},{"name":"logs_to_review","line":486,"kind":12},{"name":"$logger","kind":13,"line":491,"containerName":null},{"name":"info","kind":12,"line":491,"containerName":"main::"},{"name":"$logobj","definition":"my","line":492,"localvar":"my","containerName":null,"kind":13},{"name":"%logstoreview","line":492,"kind":13,"containerName":null},{"kind":13,"line":492,"containerName":null,"name":"$logtoreview"},{"line":493,"containerName":null,"kind":13,"name":"%logobj"},{"line":493,"kind":12,"name":"chain"},{"line":493,"containerName":null,"kind":13,"name":"$logtoreview"},{"definition":"my","line":495,"name":"$thr","containerName":null,"kind":13,"localvar":"my"},{"name":"threads","kind":12,"line":495},{"containerName":"main::","line":495,"kind":12,"name":"create"},{"name":"review_log","kind":12,"line":495},{"kind":13,"line":495,"containerName":null,"name":"$self"},{"line":495,"kind":13,"containerName":null,"name":"$logobj"},{"name":"$logger","line":495,"containerName":null,"kind":13},{"containerName":"main::","line":495,"kind":12,"name":"logdie"},{"line":496,"kind":13,"containerName":null,"name":"$LoggerTIDS"},{"kind":13,"line":496,"containerName":null,"name":"$thr"},{"containerName":"main::","line":496,"kind":12,"name":"tid"},{"name":"$logger","line":497,"containerName":null,"kind":13},{"name":"debug","line":497,"containerName":"main::","kind":12},{"name":"$thr","line":497,"containerName":null,"kind":13},{"containerName":"main::","line":497,"kind":12,"name":"tid"},{"line":497,"kind":13,"containerName":null,"name":"$logger"},{"name":"is_debug","kind":12,"line":497,"containerName":"main::"},{"name":"$logger","containerName":null,"line":498,"kind":13},{"line":498,"kind":12,"containerName":"main::","name":"debug"},{"containerName":null,"line":498,"kind":13,"name":"$thr"},{"name":"tid","line":498,"kind":12,"containerName":"main::"},{"kind":13,"line":498,"containerName":null,"name":"$thr"},{"name":"is_running","line":498,"containerName":"main::","kind":12},{"name":"$logger","line":498,"containerName":null,"kind":13},{"name":"is_debug","containerName":"main::","line":498,"kind":12},{"name":"prepare_directions","line":506,"detail":"()","definition":"sub","range":{"end":{"line":522,"character":9999},"start":{"character":0,"line":506}},"kind":12,"signature":{"parameters":[],"documentation":"","label":"prepare_directions()"},"containerName":"main::","children":[{"localvar":"my","containerName":"prepare_directions","kind":13,"name":"$self","definition":"my","line":507},{"kind":13,"line":507,"containerName":"prepare_directions","name":"$logobj"},{"name":"$TID","line":508,"definition":"my","localvar":"my","containerName":"prepare_directions","kind":13},{"name":"tid","kind":12,"line":508,"containerName":"prepare_directions"},{"name":"$TID","kind":13,"line":509,"containerName":"prepare_directions"},{"name":"$TID","line":509,"containerName":"prepare_directions","kind":13},{"definition":"my","line":511,"name":"@directions","kind":13,"containerName":"prepare_directions","localvar":"my"},{"kind":13,"line":511,"containerName":"prepare_directions","name":"$logobj"},{"line":511,"kind":13,"containerName":"prepare_directions","name":"$logobj"},{"line":512,"kind":13,"containerName":"prepare_directions","name":"@directions"},{"name":"@directions","line":512,"containerName":"prepare_directions","kind":13},{"name":"@directions","line":513,"containerName":"prepare_directions","kind":13},{"name":"@directions","kind":13,"line":518,"containerName":"prepare_directions"},{"line":519,"containerName":"prepare_directions","kind":13,"name":"@directions"},{"containerName":"prepare_directions","line":519,"kind":13,"name":"@directions"},{"name":"@directions","kind":13,"line":520,"containerName":"prepare_directions"},{"line":520,"kind":13,"containerName":"prepare_directions","name":"@directions"},{"name":"@directions","containerName":"prepare_directions","line":521,"kind":13}]},{"name":"threads","kind":12,"line":508},{"line":511,"kind":12,"name":"directions"},{"name":"directions","kind":12,"line":511},{"line":519,"kind":12,"name":"any"},{"name":"review_log","detail":"()","definition":"sub","line":526,"range":{"end":{"line":634,"character":9999},"start":{"character":0,"line":526}},"children":[{"name":"$self","line":527,"definition":"my","localvar":"my","containerName":"review_log","kind":13},{"containerName":"review_log","line":527,"kind":13,"name":"$logobj"},{"localvar":"my","containerName":"review_log","kind":13,"name":"$TID","definition":"my","line":528},{"name":"tid","line":528,"kind":12,"containerName":"review_log"},{"containerName":"review_log","line":529,"kind":13,"name":"$TID"},{"name":"$TID","line":529,"kind":13,"containerName":"review_log"},{"containerName":"review_log","kind":13,"localvar":"my","definition":"my","line":530,"name":"$start_time"},{"name":"$logobj","kind":13,"line":532,"containerName":"review_log"},{"localvar":"my","kind":13,"containerName":"review_log","name":"$chain","line":533,"definition":"my"},{"kind":13,"line":533,"containerName":"review_log","name":"$self"},{"line":533,"kind":13,"containerName":"review_log","name":"$logobj"},{"line":534,"kind":13,"containerName":"review_log","name":"$logger"},{"name":"info","line":534,"kind":12,"containerName":"review_log"},{"name":"$logger","line":535,"kind":13,"containerName":"review_log"},{"name":"debug","kind":12,"line":535,"containerName":"review_log"},{"kind":13,"line":535,"containerName":"review_log","name":"$logobj"},{"containerName":"review_log","line":535,"kind":13,"name":"$logger"},{"name":"is_debug","kind":12,"line":535,"containerName":"review_log"},{"line":538,"definition":"my","name":"$cycles","containerName":"review_log","kind":13,"localvar":"my"},{"name":"$logobj","line":538,"kind":13,"containerName":"review_log"},{"localvar":"my","kind":13,"containerName":"review_log","name":"$cyclesleep","line":539,"definition":"my"},{"containerName":"review_log","line":539,"kind":13,"name":"$logobj"},{"kind":13,"containerName":"review_log","localvar":"my","definition":"my","line":540,"name":"$microcyclesleep"},{"name":"$cyclesleep","kind":13,"line":540,"containerName":"review_log"},{"line":542,"containerName":"review_log","kind":13,"name":"$logger"},{"name":"info","containerName":"review_log","line":542,"kind":12},{"name":"$logger","line":547,"containerName":"review_log","kind":13},{"name":"info","line":547,"kind":12,"containerName":"review_log"},{"containerName":"review_log","line":548,"kind":13,"name":"$self"},{"name":"add_chain","kind":12,"line":548,"containerName":"review_log"},{"name":"$chain","line":548,"containerName":"review_log","kind":13},{"localvar":"my","containerName":"review_log","kind":13,"name":"$globalchain","line":550,"definition":"my"},{"line":550,"kind":13,"containerName":"review_log","name":"$self"},{"name":"$logger","line":551,"kind":13,"containerName":"review_log"},{"name":"debug","kind":12,"line":551,"containerName":"review_log"},{"kind":13,"line":552,"containerName":"review_log","name":"$self"},{"line":552,"containerName":"review_log","kind":12,"name":"iptablesqueue_enqueue"},{"name":"$self","containerName":"review_log","line":554,"kind":13},{"name":"add_logger_allow_deny_ips","line":554,"kind":12,"containerName":"review_log"},{"containerName":"review_log","line":554,"kind":13,"name":"$logobj"},{"localvar":"my","kind":13,"containerName":"review_log","name":"@directions","definition":"my","line":557},{"name":"$self","kind":13,"line":557,"containerName":"review_log"},{"name":"prepare_directions","line":557,"kind":12,"containerName":"review_log"},{"kind":13,"line":557,"containerName":"review_log","name":"$logobj"},{"definition":"my","line":558,"name":"@protocols","containerName":"review_log","kind":13,"localvar":"my"},{"line":558,"kind":13,"containerName":"review_log","name":"$logobj"},{"line":558,"containerName":"review_log","kind":13,"name":"$logobj"},{"definition":"my","line":559,"name":"$ports","containerName":"review_log","kind":13,"localvar":"my"},{"name":"$logobj","kind":13,"line":559,"containerName":"review_log"},{"line":561,"kind":13,"containerName":"review_log","name":"$cycles"},{"localvar":"my","kind":13,"containerName":"review_log","name":"$start_loop_time","definition":"my","line":562},{"kind":13,"line":563,"containerName":"review_log","name":"$logger"},{"line":563,"containerName":"review_log","kind":12,"name":"info"},{"line":564,"containerName":"review_log","kind":13,"name":"$logobj"},{"name":"$self","line":564,"kind":13,"containerName":"review_log"},{"line":564,"kind":12,"containerName":"review_log","name":"readlogfile"},{"name":"$logobj","line":564,"kind":13,"containerName":"review_log"},{"line":565,"kind":13,"containerName":"review_log","name":"$logobj"},{"name":"$self","containerName":"review_log","line":565,"kind":13},{"kind":12,"line":565,"containerName":"review_log","name":"_grep_regexps"},{"line":565,"containerName":"review_log","kind":13,"name":"$logobj"},{"name":"$logobj","line":565,"containerName":"review_log","kind":13},{"kind":13,"line":568,"containerName":"review_log","name":"$logger"},{"line":568,"containerName":"review_log","kind":12,"name":"debug"},{"name":"$logobj","line":568,"containerName":"review_log","kind":13},{"name":"$logger","kind":13,"line":568,"containerName":"review_log"},{"name":"is_debug","kind":12,"line":568,"containerName":"review_log"},{"localvar":"my","containerName":"review_log","kind":13,"name":"@rules","line":570,"definition":"my"},{"line":571,"definition":"my","name":"$ip","kind":13,"containerName":"review_log","localvar":"my"},{"name":"$logobj","line":571,"kind":13,"containerName":"review_log"},{"line":572,"containerName":"review_log","kind":13,"name":"$logger"},{"name":"debug","kind":12,"line":572,"containerName":"review_log"},{"localvar":"my","containerName":"review_log","kind":13,"name":"$direction","line":574,"definition":"my"},{"name":"@directions","line":574,"kind":13,"containerName":"review_log"},{"name":"$direction_switch","line":575,"definition":"my","localvar":"my","kind":13,"containerName":"review_log"},{"name":"$direction","line":575,"kind":13,"containerName":"review_log"},{"name":"$randval","line":576,"definition":"my","localvar":"my","kind":13,"containerName":"review_log"},{"kind":13,"line":577,"containerName":"review_log","name":"$direction_switch"},{"containerName":"review_log","line":577,"kind":13,"name":"$direction"},{"line":578,"containerName":"review_log","kind":13,"name":"$logger"},{"name":"info","containerName":"review_log","line":578,"kind":12},{"definition":"my","line":579,"name":"$base_rule","kind":13,"containerName":"review_log","localvar":"my"},{"name":"$logger","line":580,"containerName":"review_log","kind":13},{"kind":12,"line":580,"containerName":"review_log","name":"debug"},{"name":"@protocols","line":582,"kind":13,"containerName":"review_log"},{"line":583,"definition":"my","name":"$protocol","kind":13,"containerName":"review_log","localvar":"my"},{"containerName":"review_log","line":583,"kind":13,"name":"@protocols"},{"name":"$rule","line":584,"definition":"my","localvar":"my","containerName":"review_log","kind":13},{"name":"$base_rule","kind":13,"line":584,"containerName":"review_log"},{"line":585,"containerName":"review_log","kind":13,"name":"$logger"},{"name":"debug","containerName":"review_log","line":585,"kind":12},{"containerName":"review_log","line":586,"kind":13,"name":"$logobj"},{"kind":13,"line":589,"containerName":"review_log","name":"$rule"},{"name":"$logger","line":591,"containerName":"review_log","kind":13},{"kind":12,"line":591,"containerName":"review_log","name":"debug"},{"containerName":"review_log","line":592,"kind":13,"name":"@rules"},{"kind":13,"line":595,"containerName":"review_log","name":"$logger"},{"line":595,"kind":12,"containerName":"review_log","name":"debug"},{"line":596,"kind":13,"containerName":"review_log","name":"@rules"},{"name":"$logger","containerName":"review_log","line":601,"kind":13},{"kind":12,"line":601,"containerName":"review_log","name":"debug"},{"kind":13,"line":601,"containerName":"review_log","name":"@rules"},{"kind":13,"line":601,"containerName":"review_log","name":"$logger"},{"name":"is_debug","containerName":"review_log","line":601,"kind":12},{"name":"$eject","definition":"my","line":602,"localvar":"my","containerName":"review_log","kind":13},{"line":603,"definition":"my","name":"$rule","containerName":"review_log","kind":13,"localvar":"my"},{"line":603,"containerName":"review_log","kind":13,"name":"@rules"},{"name":"$tracker","line":604,"kind":13,"containerName":"review_log"},{"kind":13,"line":605,"containerName":"review_log","name":"$logger"},{"kind":12,"line":605,"containerName":"review_log","name":"debug"},{"kind":13,"containerName":"review_log","localvar":"my","definition":"my","line":608,"name":"$args"},{"name":"$logger","line":612,"kind":13,"containerName":"review_log"},{"kind":12,"line":612,"containerName":"review_log","name":"debug"},{"name":"$tracker","kind":13,"line":613,"containerName":"review_log"},{"containerName":"review_log","line":615,"kind":13,"name":"$self"},{"name":"iptablesqueue_enqueue","containerName":"review_log","line":615,"kind":12},{"name":"$args","kind":13,"line":615,"containerName":"review_log"},{"kind":13,"line":615,"containerName":"review_log","name":"$eject"},{"line":618,"definition":"my","name":"$logmsg","kind":13,"containerName":"review_log","localvar":"my"},{"name":"$eject","line":619,"kind":13,"containerName":"review_log"},{"line":619,"containerName":"review_log","kind":13,"name":"$logger"},{"line":619,"containerName":"review_log","kind":12,"name":"info"},{"name":"$logmsg","containerName":"review_log","line":619,"kind":13},{"name":"$logobj","line":621,"containerName":"review_log","kind":13},{"line":625,"containerName":"review_log","kind":13,"name":"$self"},{"name":"iptablesqueue_enqueue","line":625,"containerName":"review_log","kind":12},{"kind":13,"containerName":"review_log","localvar":"my","definition":"my","line":627,"name":"$timediff"},{"name":"$start_loop_time","line":627,"containerName":"review_log","kind":13},{"line":628,"kind":13,"containerName":"review_log","name":"$timediff"},{"name":"$timediff","kind":13,"line":628,"containerName":"review_log"},{"name":"$logger","kind":13,"line":629,"containerName":"review_log"},{"name":"info","line":629,"containerName":"review_log","kind":12},{"kind":13,"line":631,"containerName":"review_log","name":"$cycles"},{"name":"$logger","line":632,"containerName":"review_log","kind":13},{"containerName":"review_log","line":632,"kind":12,"name":"info"},{"kind":13,"line":633,"containerName":"review_log","name":"$microcyclesleep"}],"signature":{"label":"review_log()","documentation":" This is called as a thread and runs a loop to check the log file for new entries\n   Prior to checking the log file, it creates a chain for the log file and adds it to the global chain","parameters":[]},"containerName":"main::","kind":12},{"kind":12,"line":528,"name":"threads"},{"name":"configs","line":533,"kind":12},{"name":"chainprefix","kind":12,"line":533},{"name":"chain","line":533,"kind":12},{"kind":12,"line":535,"name":"Dumper"},{"line":538,"kind":12,"name":"cycles"},{"kind":12,"line":538,"name":"LONG_MAX"},{"name":"cyclesleep","line":539,"kind":12},{"kind":12,"line":550,"name":"configs"},{"line":550,"kind":12,"name":"globalchain"},{"kind":12,"line":552,"name":"options"},{"line":552,"kind":12,"name":"rule"},{"kind":12,"line":558,"name":"protocols"},{"line":558,"kind":12,"name":"protocols"},{"name":"ports","line":559,"kind":12},{"line":565,"kind":12,"name":"ips_to_block"},{"kind":12,"line":565,"name":"logcontents"},{"name":"Dumper","kind":12,"line":568},{"line":568,"kind":12,"name":"ips_to_block"},{"name":"ips_to_block","kind":12,"line":571},{"line":586,"kind":12,"name":"ports"},{"kind":12,"line":601,"name":"Dumper"},{"kind":12,"line":604,"name":"iptables_rules"},{"name":"options","kind":12,"line":609},{"name":"rule","kind":12,"line":610},{"name":"iptables_rules","line":613,"kind":12},{"name":"ips_to_block","line":621,"kind":12},{"kind":12,"line":625,"name":"check_pending"},{"kind":12,"line":633,"name":"usleep"},{"name":"$runtime","line":636,"definition":"my","localvar":"my","kind":13,"containerName":null},{"name":"$start_time","line":636,"containerName":null,"kind":13},{"kind":13,"line":637,"containerName":null,"name":"$runtime"},{"name":"$runtime","line":637,"kind":13,"containerName":null},{"localvar":"my","kind":13,"containerName":null,"name":"$cycles_completed","line":638,"definition":"my"},{"kind":13,"line":638,"containerName":null,"name":"%logobj"},{"kind":12,"line":638,"name":"cycles"},{"kind":13,"line":638,"containerName":null,"name":"$cycles"},{"kind":13,"containerName":null,"localvar":"my","line":639,"definition":"my","name":"$logmsg"},{"name":"$logmsg","line":640,"kind":13,"containerName":null},{"line":641,"kind":13,"containerName":null,"name":"$logger"},{"line":641,"containerName":"main::","kind":12,"name":"info"},{"line":641,"containerName":null,"kind":13,"name":"$logmsg"},{"range":{"end":{"character":9999,"line":670},"start":{"line":646,"character":0}},"containerName":"main::","kind":12,"children":[{"kind":13,"containerName":"load_configs","localvar":"my","definition":"my","line":647,"name":"$self"},{"line":648,"definition":"my","name":"$configsfile","kind":13,"containerName":"load_configs","localvar":"my"},{"name":"$self","line":648,"containerName":"load_configs","kind":13},{"localvar":"my","kind":13,"containerName":"load_configs","name":"$clargs","line":649,"definition":"my"},{"name":"$self","containerName":"load_configs","line":649,"kind":13},{"name":"$configsfile","containerName":"load_configs","line":651,"kind":13},{"name":"$self","kind":13,"line":654,"containerName":"load_configs"},{"name":"$self","line":654,"kind":13,"containerName":"load_configs"},{"name":"$self","line":655,"containerName":"load_configs","kind":13},{"line":655,"kind":13,"containerName":"load_configs","name":"$self"},{"name":"$self","containerName":"load_configs","line":656,"kind":13},{"name":"$msg","definition":"my","line":661,"localvar":"my","containerName":"load_configs","kind":13},{"kind":13,"line":662,"containerName":"load_configs","name":"$msg"},{"name":"$msg","line":663,"containerName":"load_configs","kind":13},{"containerName":"load_configs","line":663,"kind":13,"name":"$clargs"},{"containerName":"load_configs","line":664,"kind":13,"name":"$msg"},{"line":664,"kind":13,"containerName":"load_configs","name":"$DEFAULTS"},{"kind":13,"line":665,"containerName":"load_configs","name":"$msg"},{"name":"$msg","line":666,"containerName":"load_configs","kind":13},{"kind":13,"line":667,"containerName":"load_configs","name":"$msg"},{"kind":13,"containerName":"load_configs","localvar":"my","definition":"my","line":670,"name":"$config"},{"name":"$DEFAULTS","containerName":"load_configs","line":670,"kind":13}],"name":"load_configs","line":646,"definition":"sub"},{"name":"configsfile","kind":12,"line":648},{"name":"clargs","kind":12,"line":649},{"name":"configs","line":654,"kind":12},{"containerName":"File::read_config_file","line":654,"kind":12,"name":"Config"},{"line":654,"kind":12,"name":"configsfile"},{"name":"configs","line":655,"kind":12},{"line":655,"kind":12,"name":"globalchain"},{"kind":12,"line":655,"name":"configs"},{"kind":12,"line":655,"name":"globalchain"},{"kind":12,"line":656,"name":"configs"},{"line":656,"kind":12,"name":"globalchain"},{"kind":12,"line":663,"name":"Dumper"},{"line":664,"kind":12,"name":"Dumper"},{"line":666,"kind":12,"name":"carp"},{"name":"%self","containerName":null,"line":674,"kind":13},{"name":"configs","line":674,"kind":12},{"name":"$config","line":674,"containerName":null,"kind":13},{"name":"%clargs","kind":13,"line":675,"containerName":null},{"line":675,"containerName":null,"kind":13,"name":"$config"},{"line":676,"containerName":null,"kind":13,"name":"%clargs"},{"name":"$config","kind":13,"line":676,"containerName":null},{"containerName":null,"line":677,"kind":13,"name":"%self"},{"kind":12,"line":677,"name":"configs"},{"kind":13,"line":677,"containerName":null,"name":"$config"},{"name":"%DEFAULTS","containerName":null,"line":677,"kind":13},{"line":677,"containerName":null,"kind":13,"name":"$config"},{"name":"%self","line":680,"kind":13,"containerName":null},{"name":"configs","kind":12,"line":680},{"containerName":"main::","signature":{"label":"reverseMapHash()","documentation":" Special helper function for clean_ips_to_block()","parameters":[]},"kind":12,"children":[{"localvar":"my","kind":13,"containerName":"reverseMapHash","name":"$self","line":685,"definition":"my"},{"name":"$hash","line":686,"definition":"my","localvar":"my","kind":13,"containerName":"reverseMapHash"},{"definition":"my","line":690,"name":"$new_hash","kind":13,"containerName":"reverseMapHash","localvar":"my"},{"name":"$key","definition":"my","line":691,"localvar":"my","containerName":"reverseMapHash","kind":13},{"name":"$hash","containerName":"reverseMapHash","line":691,"kind":13}],"range":{"end":{"line":691,"character":9999},"start":{"character":0,"line":684}},"line":684,"detail":"()","definition":"sub","name":"reverseMapHash"},{"containerName":null,"line":692,"kind":13,"name":"%new_hash"},{"containerName":null,"line":692,"kind":13,"name":"%hash"},{"kind":13,"line":692,"containerName":null,"name":"$key"},{"name":"$new_hash","line":696,"containerName":null,"kind":13},{"line":701,"definition":"sub","detail":"()","name":"clean_ips_to_block_combined","containerName":"main::","signature":{"label":"clean_ips_to_block_combined()","documentation":" Description: Combines the IPs from regex from the log to be blocked and the IPs from the allow/deny lists into\n               one hash","parameters":[]},"kind":12,"children":[{"kind":13,"containerName":"clean_ips_to_block_combined","localvar":"my","definition":"my","line":702,"name":"$self"},{"line":703,"definition":"my","name":"$logobj","kind":13,"containerName":"clean_ips_to_block_combined","localvar":"my"},{"localvar":"my","kind":13,"containerName":"clean_ips_to_block_combined","name":"$TID","definition":"my","line":704},{"name":"tid","containerName":"clean_ips_to_block_combined","line":704,"kind":12},{"line":705,"containerName":"clean_ips_to_block_combined","kind":13,"name":"$TID"},{"name":"$TID","kind":13,"line":705,"containerName":"clean_ips_to_block_combined"},{"name":"$Data","kind":13,"line":707,"containerName":"clean_ips_to_block_combined"},{"name":"$Data","line":708,"containerName":"clean_ips_to_block_combined","kind":13}],"range":{"start":{"line":701,"character":0},"end":{"line":710,"character":9999}}},{"kind":12,"line":704,"name":"threads"},{"name":"Dumper","line":707,"containerName":"Terse","kind":12},{"line":708,"containerName":"Indent","kind":12,"name":"Dumper"},{"line":715,"definition":"sub","detail":"()","name":"clean_ips_to_block_allowdeny","signature":{"documentation":" Description: Returns the logobj with ips_to_block set with the IPs to block from the allow/deny lists\n   There is a lot of logging available in this sub.\n   This sub is called from review_log()","parameters":[],"label":"clean_ips_to_block_allowdeny()"},"containerName":"main::","kind":12,"children":[{"localvar":"my","kind":13,"containerName":"clean_ips_to_block_allowdeny","name":"$self","definition":"my","line":716},{"name":"$logobj","line":717,"definition":"my","localvar":"my","kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$TID","definition":"my","line":718,"localvar":"my","kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"kind":12,"line":718,"containerName":"clean_ips_to_block_allowdeny","name":"tid"},{"kind":13,"line":719,"containerName":"clean_ips_to_block_allowdeny","name":"$TID"},{"name":"$TID","kind":13,"line":719,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","line":721,"kind":13,"name":"$Data"},{"line":722,"kind":13,"containerName":"clean_ips_to_block_allowdeny","name":"$Data"},{"line":726,"definition":"my","name":"$allowdeny","kind":13,"containerName":"clean_ips_to_block_allowdeny","localvar":"my"},{"kind":13,"line":726,"containerName":"clean_ips_to_block_allowdeny","name":"$logobj"},{"name":"$self","kind":13,"line":726,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"localvar":"my","line":727,"definition":"my","name":"$logobj_allowlist"},{"line":727,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logobj"},{"name":"$self","kind":13,"line":727,"containerName":"clean_ips_to_block_allowdeny"},{"line":728,"definition":"my","name":"$logobj_denylist","containerName":"clean_ips_to_block_allowdeny","kind":13,"localvar":"my"},{"name":"$logobj","line":728,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"name":"$self","line":728,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"localvar":"my","containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$global_denylist","definition":"my","line":729},{"line":729,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$self"},{"name":"$global_allowlist","line":730,"definition":"my","localvar":"my","containerName":"clean_ips_to_block_allowdeny","kind":13},{"name":"$self","containerName":"clean_ips_to_block_allowdeny","line":730,"kind":13},{"definition":"my","line":732,"name":"$ips_to_block","kind":13,"containerName":"clean_ips_to_block_allowdeny","localvar":"my"},{"kind":13,"line":732,"containerName":"clean_ips_to_block_allowdeny","name":"$logobj"},{"line":735,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logobj_allowlist"},{"line":735,"kind":13,"containerName":"clean_ips_to_block_allowdeny","name":"$self"},{"name":"reverseMapHash","line":735,"kind":12,"containerName":"clean_ips_to_block_allowdeny"},{"line":735,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logobj_allowlist"},{"line":736,"kind":13,"containerName":"clean_ips_to_block_allowdeny","name":"$logobj_denylist"},{"name":"$self","kind":13,"line":736,"containerName":"clean_ips_to_block_allowdeny"},{"name":"reverseMapHash","kind":12,"line":736,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$logobj_denylist","kind":13,"line":736,"containerName":"clean_ips_to_block_allowdeny"},{"line":737,"kind":13,"containerName":"clean_ips_to_block_allowdeny","name":"$global_allowlist"},{"name":"$self","line":737,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"line":737,"kind":12,"containerName":"clean_ips_to_block_allowdeny","name":"reverseMapHash"},{"name":"$global_allowlist","containerName":"clean_ips_to_block_allowdeny","line":737,"kind":13},{"name":"$global_denylist","containerName":"clean_ips_to_block_allowdeny","line":738,"kind":13},{"containerName":"clean_ips_to_block_allowdeny","line":738,"kind":13,"name":"$self"},{"name":"reverseMapHash","kind":12,"line":738,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$global_denylist","kind":13,"line":738,"containerName":"clean_ips_to_block_allowdeny"},{"kind":13,"line":741,"containerName":"clean_ips_to_block_allowdeny","name":"$logger"},{"name":"info","line":741,"kind":12,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$logger","line":742,"kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"line":742,"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"debug"},{"containerName":"clean_ips_to_block_allowdeny","line":742,"kind":13,"name":"$logobj_allowlist"},{"name":"$logger","kind":13,"line":742,"containerName":"clean_ips_to_block_allowdeny"},{"kind":12,"line":742,"containerName":"clean_ips_to_block_allowdeny","name":"is_debug"},{"containerName":"clean_ips_to_block_allowdeny","line":743,"kind":13,"name":"$logger"},{"name":"debug","line":743,"containerName":"clean_ips_to_block_allowdeny","kind":12},{"name":"$logobj_denylist","line":743,"kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"line":743,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logger"},{"name":"is_debug","line":743,"containerName":"clean_ips_to_block_allowdeny","kind":12},{"kind":13,"line":744,"containerName":"clean_ips_to_block_allowdeny","name":"$logger"},{"kind":12,"line":744,"containerName":"clean_ips_to_block_allowdeny","name":"debug"},{"line":744,"kind":13,"containerName":"clean_ips_to_block_allowdeny","name":"$ips_to_block"},{"name":"$logger","containerName":"clean_ips_to_block_allowdeny","line":744,"kind":13},{"name":"is_debug","containerName":"clean_ips_to_block_allowdeny","line":744,"kind":12},{"line":745,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logger"},{"name":"debug","containerName":"clean_ips_to_block_allowdeny","line":745,"kind":12},{"name":"$global_allowlist","kind":13,"line":745,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$logger","kind":13,"line":745,"containerName":"clean_ips_to_block_allowdeny"},{"name":"is_debug","kind":12,"line":745,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$logger","line":746,"kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"name":"debug","line":746,"containerName":"clean_ips_to_block_allowdeny","kind":12},{"line":746,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$global_denylist"},{"line":746,"kind":13,"containerName":"clean_ips_to_block_allowdeny","name":"$logger"},{"name":"is_debug","line":746,"kind":12,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$allowlist","definition":"my","line":749,"localvar":"my","kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$global_allowlist","kind":13,"line":749,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$logobj_allowlist","line":749,"kind":13,"containerName":"clean_ips_to_block_allowdeny"}],"range":{"start":{"character":0,"line":715},"end":{"character":9999,"line":749}}},{"line":718,"kind":12,"name":"threads"},{"kind":12,"line":721,"containerName":"Terse","name":"Dumper"},{"name":"Dumper","line":722,"kind":12,"containerName":"Indent"},{"name":"allowdeny","line":726,"kind":12},{"name":"configs","line":726,"kind":12},{"name":"allowdeny","line":726,"kind":12},{"name":"allowlist","line":727,"kind":12},{"line":727,"kind":12,"name":"configs"},{"kind":12,"line":727,"name":"allowlist"},{"name":"denylist","kind":12,"line":728},{"kind":12,"line":728,"name":"configs"},{"line":728,"kind":12,"name":"denylist"},{"kind":12,"line":729,"name":"configs"},{"name":"denylist","kind":12,"line":729},{"line":730,"kind":12,"name":"configs"},{"line":730,"kind":12,"name":"allowlist"},{"kind":12,"line":732,"name":"ips_to_block"},{"name":"Dumper","line":742,"kind":12},{"line":743,"kind":12,"name":"Dumper"},{"kind":12,"line":744,"name":"Dumper"},{"line":745,"kind":12,"name":"Dumper"},{"name":"Dumper","kind":12,"line":746},{"kind":13,"containerName":null,"localvar":"my","definition":"my","line":750,"name":"%denylist"},{"name":"$global_denylist","kind":13,"line":750,"containerName":null},{"name":"$logobj_denylist","kind":13,"line":750,"containerName":null},{"name":"$logger","line":753,"kind":13,"containerName":null},{"line":753,"kind":12,"containerName":"main::","name":"debug"},{"line":753,"kind":12,"name":"Dumper"},{"containerName":null,"line":753,"kind":13,"name":"$allowlist"},{"line":753,"containerName":null,"kind":13,"name":"$logger"},{"line":753,"containerName":"main::","kind":12,"name":"is_debug"},{"name":"$logger","line":754,"kind":13,"containerName":null},{"name":"debug","line":754,"containerName":"main::","kind":12},{"name":"Dumper","line":754,"kind":12},{"line":754,"kind":13,"containerName":null,"name":"$denylist"},{"name":"$logger","containerName":null,"line":754,"kind":13},{"line":754,"kind":12,"containerName":"main::","name":"is_debug"},{"name":"%denylist","line":757,"containerName":null,"kind":13},{"kind":13,"line":757,"containerName":null,"name":"$denylist"},{"containerName":null,"line":757,"kind":13,"name":"$ips_to_block"},{"name":"$logger","kind":13,"line":760,"containerName":null},{"line":760,"containerName":"main::","kind":12,"name":"debug"},{"name":"Dumper","line":760,"kind":12},{"line":760,"containerName":null,"kind":13,"name":"$denylist"},{"name":"$logger","line":760,"kind":13,"containerName":null},{"line":760,"kind":12,"containerName":"main::","name":"is_debug"},{"name":"%allowdeny","line":764,"kind":13,"containerName":null},{"kind":13,"line":765,"containerName":null,"name":"%logobj"},{"name":"ips_to_block","line":765,"kind":12},{"line":765,"kind":13,"containerName":null,"name":"$denylist"},{"name":"$logger","containerName":null,"line":766,"kind":13},{"containerName":"main::","line":766,"kind":12,"name":"debug"},{"name":"Dumper","line":766,"kind":12},{"name":"%logobj","line":766,"kind":13,"containerName":null},{"name":"ips_to_block","kind":12,"line":766},{"name":"$logger","containerName":null,"line":767,"kind":13},{"name":"is_debug","line":767,"kind":12,"containerName":"main::"},{"name":"%logobj","line":768,"containerName":null,"kind":13},{"kind":13,"line":773,"containerName":null,"name":"%denylist"},{"kind":13,"line":773,"containerName":null,"name":"$allowlist"},{"line":774,"kind":13,"containerName":null,"name":"%logobj"},{"kind":12,"line":774,"name":"ips_to_block"},{"line":774,"containerName":null,"kind":13,"name":"$denylist"},{"containerName":null,"line":775,"kind":13,"name":"$logger"},{"line":775,"containerName":"main::","kind":12,"name":"debug"},{"line":775,"kind":12,"name":"Dumper"},{"name":"%logobj","containerName":null,"line":775,"kind":13},{"name":"ips_to_block","line":775,"kind":12},{"name":"$logger","line":776,"containerName":null,"kind":13},{"name":"is_debug","containerName":"main::","line":776,"kind":12},{"line":777,"containerName":null,"kind":13,"name":"$logobj"},{"definition":"sub","detail":"()","line":796,"name":"run_iptables","children":[{"line":797,"definition":"my","name":"$self","containerName":"run_iptables","kind":13,"localvar":"my"},{"name":"$args","line":797,"containerName":"run_iptables","kind":13},{"localvar":"my","kind":13,"containerName":"run_iptables","name":"@caller_lst","definition":"my","line":798},{"line":799,"kind":13,"containerName":"run_iptables","name":"$caller_lst"},{"kind":13,"line":799,"containerName":"run_iptables","name":"$IPTABLESRUNLINE"},{"containerName":"run_iptables","line":799,"kind":13,"name":"$IPTABLESRUNLINE"},{"line":800,"definition":"my","name":"$logmsg","containerName":"run_iptables","kind":13,"localvar":"my"},{"name":"@caller_lst","line":801,"kind":13,"containerName":"run_iptables"},{"line":806,"kind":13,"containerName":"run_iptables","name":"$logger"},{"kind":12,"line":806,"containerName":"run_iptables","name":"error"},{"kind":13,"line":806,"containerName":"run_iptables","name":"$logmsg"},{"containerName":"run_iptables","kind":13,"localvar":"my","line":808,"definition":"my","name":"$TID"},{"name":"tid","line":808,"kind":12,"containerName":"run_iptables"},{"name":"$TID","line":809,"kind":13,"containerName":"run_iptables"},{"name":"$TID","line":809,"kind":13,"containerName":"run_iptables"},{"line":812,"kind":13,"containerName":"run_iptables","name":"$args"},{"name":"$logger","kind":13,"line":812,"containerName":"run_iptables"},{"name":"error","kind":12,"line":812,"containerName":"run_iptables"},{"line":813,"kind":13,"containerName":"run_iptables","name":"$self"},{"name":"$logger","containerName":"run_iptables","line":813,"kind":13},{"containerName":"run_iptables","line":813,"kind":12,"name":"error"},{"line":815,"definition":"my","name":"$iptables","containerName":"run_iptables","kind":13,"localvar":"my"},{"name":"$self","line":815,"containerName":"run_iptables","kind":13},{"name":"$rule","definition":"my","line":816,"localvar":"my","containerName":"run_iptables","kind":13},{"line":816,"kind":13,"containerName":"run_iptables","name":"$args"},{"kind":13,"containerName":"run_iptables","localvar":"my","definition":"my","line":817,"name":"$options"},{"kind":13,"line":817,"containerName":"run_iptables","name":"$args"},{"name":"$logger","line":819,"kind":13,"containerName":"run_iptables"},{"name":"is_debug","containerName":"run_iptables","line":819,"kind":12},{"name":"$logger","line":820,"containerName":"run_iptables","kind":13},{"name":"debug","line":820,"kind":12,"containerName":"run_iptables"},{"kind":13,"line":821,"containerName":"run_iptables","name":"$args"},{"line":829,"kind":13,"containerName":"run_iptables","name":"$args"},{"name":"$allowdupes","line":830,"definition":"my","localvar":"my","containerName":"run_iptables","kind":13},{"name":"$args","line":830,"kind":13,"containerName":"run_iptables"},{"line":832,"containerName":"run_iptables","kind":13,"name":"$allowdupes"},{"name":"$logger","line":833,"kind":13,"containerName":"run_iptables"},{"containerName":"run_iptables","line":833,"kind":12,"name":"debug"},{"localvar":"my","kind":13,"containerName":"run_iptables","name":"$retval","line":834,"definition":"my"},{"line":834,"kind":13,"containerName":"run_iptables","name":"$self"},{"containerName":"run_iptables","line":834,"kind":12,"name":"check_if_rule_exists"},{"name":"$args","line":834,"kind":13,"containerName":"run_iptables"},{"line":835,"kind":13,"containerName":"run_iptables","name":"$retval"},{"localvar":"my","kind":13,"containerName":"run_iptables","name":"$logmsg","line":836,"definition":"my"},{"name":"$logmsg","containerName":"run_iptables","line":837,"kind":13},{"line":838,"containerName":"run_iptables","kind":13,"name":"$logger"},{"line":838,"kind":12,"containerName":"run_iptables","name":"debug"},{"line":838,"containerName":"run_iptables","kind":13,"name":"$logmsg"},{"name":"$retval","line":841,"containerName":"run_iptables","kind":13},{"containerName":"run_iptables","line":845,"kind":13,"name":"$logger"},{"line":845,"kind":12,"containerName":"run_iptables","name":"debug"},{"containerName":"run_iptables","line":846,"kind":13,"name":"$tracker"},{"containerName":"run_iptables","line":846,"kind":13,"name":"$rule"},{"name":"$retval","kind":13,"line":849,"containerName":"run_iptables"},{"line":850,"containerName":"run_iptables","kind":13,"name":"$logger"},{"name":"debug","line":850,"containerName":"run_iptables","kind":12},{"name":"$retval","kind":13,"line":852,"containerName":"run_iptables"},{"name":"$options","line":853,"kind":13,"containerName":"run_iptables"},{"name":"$logger","line":856,"kind":13,"containerName":"run_iptables"},{"containerName":"run_iptables","line":856,"kind":12,"name":"debug"},{"name":"$tracker","containerName":"run_iptables","line":859,"kind":13},{"line":859,"containerName":"run_iptables","kind":13,"name":"$rule"},{"kind":13,"line":861,"containerName":"run_iptables","name":"$retval"},{"name":"$logger","kind":13,"line":862,"containerName":"run_iptables"},{"name":"error","line":862,"containerName":"run_iptables","kind":12},{"line":865,"kind":13,"containerName":"run_iptables","name":"$retval"},{"localvar":"my","kind":13,"containerName":"run_iptables","name":"$logmsg","definition":"my","line":866},{"kind":13,"line":867,"containerName":"run_iptables","name":"$logmsg"},{"line":868,"containerName":"run_iptables","kind":13,"name":"$logger"},{"line":868,"kind":12,"containerName":"run_iptables","name":"error"},{"line":868,"kind":13,"containerName":"run_iptables","name":"$logmsg"},{"line":872,"containerName":"run_iptables","kind":13,"name":"$logger"},{"containerName":"run_iptables","line":872,"kind":12,"name":"error"},{"name":"$retval","line":872,"containerName":"run_iptables","kind":13},{"localvar":"my","containerName":"run_iptables","kind":13,"name":"$command","definition":"my","line":877},{"name":"$tracker","line":878,"containerName":"run_iptables","kind":13},{"name":"$rule","line":878,"containerName":"run_iptables","kind":13},{"kind":13,"line":879,"containerName":"run_iptables","name":"$self"},{"name":"$logger","kind":13,"line":880,"containerName":"run_iptables"},{"kind":12,"line":880,"containerName":"run_iptables","name":"debug"},{"name":"$output","definition":"my","line":881,"localvar":"my","containerName":"run_iptables","kind":13},{"name":"$logger","line":882,"kind":13,"containerName":"run_iptables"},{"containerName":"run_iptables","line":882,"kind":12,"name":"debug"},{"kind":13,"line":886,"containerName":"run_iptables","name":"$logger"},{"line":886,"kind":12,"containerName":"run_iptables","name":"info"},{"line":891,"kind":13,"containerName":"run_iptables","name":"$logger"},{"kind":12,"line":891,"containerName":"run_iptables","name":"error"}],"signature":{"parameters":[],"documentation":" Runs whatever parameters are passed to it against iptables\n  This is intended to be a one stop shop for running iptables out from a queue.\n  However, there are a few instances where it is called directly... especially when creating chains\n   This hopefully prevents excessive wait/locking on iptables\n   and helps to keep commands running in the order they are received.\n Arguments must be passed as a hash reference with (so far) the following keys:\n   rule:  The rule to run\n   options:  Any options to pass to iptables\n  Where it is ran like this:\n   iptables $options $rule 2>&1\n Future enhancement:\n   1. delete existing rule if it exists\n Take note this sub is intended (but not required) to be called from sub iptables_thread()\n  An error will happen if not called from sub iptables_thread(), but it will not stop the program\n  This is to encourage using the iptablesqueue_enqueue() sub instead of run_iptables() directly\n  So, to say this more clearly, if you want to run iptables commands, then call iptablesqueue_enqueue()","label":"run_iptables()"},"kind":12,"containerName":"main::","range":{"start":{"character":0,"line":796},"end":{"character":9999,"line":893}}},{"line":801,"kind":12,"name":"Dumper"},{"name":"threads","line":808,"kind":12},{"name":"rule","kind":12,"line":812},{"kind":12,"line":813,"name":"configs"},{"kind":12,"line":813,"name":"iptables"},{"name":"configs","line":815,"kind":12},{"name":"iptables","line":815,"kind":12},{"name":"rule","kind":12,"line":816},{"line":817,"kind":12,"name":"options"},{"name":"Dumper","line":821,"kind":12},{"name":"allowdupes","line":829,"kind":12},{"line":830,"kind":12,"name":"allowdupes"},{"name":"iptables_rules","kind":12,"line":846},{"kind":12,"line":859,"name":"chains_created"},{"name":"iptables_rules","line":878,"kind":12},{"line":879,"kind":12,"name":"configs"},{"name":"PRODMODE","line":879,"kind":12},{"children":[{"localvar":"my","containerName":"set_iptables_command","kind":13,"name":"$self","definition":"my","line":897},{"kind":13,"line":900,"containerName":"set_iptables_command","name":"$self"},{"line":901,"kind":13,"containerName":"set_iptables_command","name":"$self"},{"line":902,"kind":13,"containerName":"set_iptables_command","name":"$logger"},{"name":"info","line":902,"kind":12,"containerName":"set_iptables_command"}],"signature":{"label":"set_iptables_command()","parameters":[],"documentation":" Maybe an unnecessary sub but maybe some better checks down the road"},"containerName":"main::","kind":12,"range":{"end":{"character":9999,"line":904},"start":{"character":0,"line":896}},"detail":"()","definition":"sub","line":896,"name":"set_iptables_command"},{"name":"configs","line":900,"kind":12},{"name":"iptables","kind":12,"line":900},{"line":901,"kind":12,"name":"configs"},{"line":901,"kind":12,"name":"iptables"},{"line":908,"detail":"($self,$args)","definition":"sub","name":"check_if_rule_exists","kind":12,"signature":{"parameters":[{"label":"$self"},{"label":"$args"}],"documentation":"# Returns 0 if there is an unknown return value from running iptables\n#          Otherwise returns a string","label":"check_if_rule_exists($self,$args)"},"containerName":"main::","children":[{"localvar":"my","kind":13,"containerName":"check_if_rule_exists","name":"$self","line":909,"definition":"my"},{"containerName":"check_if_rule_exists","line":909,"kind":13,"name":"$args"},{"line":910,"definition":"my","name":"$TID","kind":13,"containerName":"check_if_rule_exists","localvar":"my"},{"name":"tid","kind":12,"line":910,"containerName":"check_if_rule_exists"},{"name":"$TID","containerName":"check_if_rule_exists","line":911,"kind":13},{"name":"$TID","line":911,"containerName":"check_if_rule_exists","kind":13},{"name":"$args","kind":13,"line":914,"containerName":"check_if_rule_exists"},{"name":"$self","containerName":"check_if_rule_exists","line":914,"kind":13},{"line":914,"kind":12,"containerName":"check_if_rule_exists","name":"log_and_return"},{"name":"$self","line":915,"containerName":"check_if_rule_exists","kind":13},{"name":"$logger","line":915,"containerName":"check_if_rule_exists","kind":13},{"kind":12,"line":915,"containerName":"check_if_rule_exists","name":"error"},{"definition":"my","line":917,"name":"$iptables","kind":13,"containerName":"check_if_rule_exists","localvar":"my"},{"name":"$self","kind":13,"line":917,"containerName":"check_if_rule_exists"},{"line":918,"definition":"my","name":"$rule","kind":13,"containerName":"check_if_rule_exists","localvar":"my"},{"containerName":"check_if_rule_exists","line":918,"kind":13,"name":"$args"},{"localvar":"my","kind":13,"containerName":"check_if_rule_exists","name":"$options","line":919,"definition":"my"},{"kind":13,"line":919,"containerName":"check_if_rule_exists","name":"$args"},{"containerName":"check_if_rule_exists","line":921,"kind":13,"name":"$tracker"},{"containerName":"check_if_rule_exists","line":921,"kind":13,"name":"$rule"},{"line":922,"kind":13,"containerName":"check_if_rule_exists","name":"$logger"},{"containerName":"check_if_rule_exists","line":922,"kind":12,"name":"debug"},{"line":926,"containerName":"check_if_rule_exists","kind":13,"name":"$tracker"},{"name":"$rule","line":926,"kind":13,"containerName":"check_if_rule_exists"},{"kind":13,"line":927,"containerName":"check_if_rule_exists","name":"$logger"},{"line":927,"kind":12,"containerName":"check_if_rule_exists","name":"debug"},{"name":"$options","containerName":"check_if_rule_exists","line":931,"kind":13},{"localvar":"my","kind":13,"containerName":"check_if_rule_exists","name":"$logmsg","definition":"my","line":932},{"line":933,"containerName":"check_if_rule_exists","kind":13,"name":"$logmsg"},{"name":"$logger","line":934,"kind":13,"containerName":"check_if_rule_exists"},{"line":934,"kind":12,"containerName":"check_if_rule_exists","name":"debug"},{"line":934,"containerName":"check_if_rule_exists","kind":13,"name":"$logmsg"},{"name":"$checkrule_result","definition":"my","line":938,"localvar":"my","containerName":"check_if_rule_exists","kind":13},{"containerName":"check_if_rule_exists","line":940,"kind":13,"name":"$logger"},{"line":940,"kind":12,"containerName":"check_if_rule_exists","name":"debug"},{"name":"$checkrule_result","line":944,"containerName":"check_if_rule_exists","kind":13},{"containerName":"check_if_rule_exists","line":945,"kind":13,"name":"$logger"},{"name":"debug","containerName":"check_if_rule_exists","line":945,"kind":12},{"line":946,"containerName":"check_if_rule_exists","kind":13,"name":"$logger"},{"name":"debug","line":946,"containerName":"check_if_rule_exists","kind":12},{"name":"$checkrule_result","kind":13,"line":950,"containerName":"check_if_rule_exists"},{"kind":13,"line":951,"containerName":"check_if_rule_exists","name":"$logger"},{"name":"debug","line":951,"kind":12,"containerName":"check_if_rule_exists"},{"line":952,"containerName":"check_if_rule_exists","kind":13,"name":"$logger"},{"name":"debug","kind":12,"line":952,"containerName":"check_if_rule_exists"},{"kind":13,"line":956,"containerName":"check_if_rule_exists","name":"$checkrule_result"},{"kind":13,"line":957,"containerName":"check_if_rule_exists","name":"$logger"},{"line":957,"containerName":"check_if_rule_exists","kind":12,"name":"debug"},{"name":"$logger","containerName":"check_if_rule_exists","line":958,"kind":13},{"line":958,"containerName":"check_if_rule_exists","kind":12,"name":"debug"},{"line":962,"containerName":"check_if_rule_exists","kind":13,"name":"$self"},{"kind":12,"line":962,"containerName":"check_if_rule_exists","name":"log_and_return"}],"range":{"start":{"line":908,"character":0},"end":{"character":9999,"line":963}}},{"kind":12,"line":910,"name":"threads"},{"line":914,"kind":12,"name":"rule"},{"name":"configs","line":915,"kind":12},{"line":915,"kind":12,"name":"iptables"},{"name":"configs","kind":12,"line":917},{"kind":12,"line":917,"name":"iptables"},{"kind":12,"line":918,"name":"rule"},{"name":"options","line":919,"kind":12},{"name":"chains_created","kind":12,"line":921},{"name":"iptables_rules","line":926,"kind":12},{"range":{"end":{"line":971,"character":9999},"start":{"line":965,"character":0}},"signature":{"label":"log_and_return($self,$error_message)","documentation":"","parameters":[{"label":"$self"},{"label":"$error_message"}]},"kind":12,"containerName":"main::","children":[{"definition":"my","line":966,"name":"$self","containerName":"log_and_return","kind":13,"localvar":"my"},{"name":"$error_message","kind":13,"line":966,"containerName":"log_and_return"},{"kind":13,"containerName":"log_and_return","localvar":"my","line":967,"definition":"my","name":"$TID"},{"name":"tid","containerName":"log_and_return","line":967,"kind":12},{"line":968,"containerName":"log_and_return","kind":13,"name":"$TID"},{"name":"$TID","containerName":"log_and_return","line":968,"kind":13},{"name":"$logger","line":969,"kind":13,"containerName":"log_and_return"},{"line":969,"containerName":"log_and_return","kind":12,"name":"error"},{"containerName":"log_and_return","line":969,"kind":13,"name":"$error_message"}],"name":"log_and_return","line":965,"detail":"($self,$error_message)","definition":"sub"},{"line":967,"kind":12,"name":"threads"},{"name":"add_global_chain","line":980,"definition":"sub","detail":"()","range":{"end":{"line":1008,"character":9999},"start":{"character":0,"line":980}},"containerName":"main::","signature":{"documentation":" Description: Creates the global chain and then adds a jump rule to the global chains.\n           With default values this means creating the global chain \"IPBLOCKER_glopbal\" and then\n           adding a jump rule to the INPUT, OUTPUT, and FORWARD tables to go to IPBLOCKER_global\n Dies if no chain prefix is set or if no global chains are set\n    Bassically, this dies if it is not called as class or correct configs are not set\n Returns 1 always","parameters":[],"label":"add_global_chain()"},"kind":12,"children":[{"name":"$self","line":981,"definition":"my","localvar":"my","containerName":"add_global_chain","kind":13},{"localvar":"my","kind":13,"containerName":"add_global_chain","name":"$TID","line":982,"definition":"my"},{"name":"tid","containerName":"add_global_chain","line":982,"kind":12},{"name":"$TID","line":983,"containerName":"add_global_chain","kind":13},{"name":"$TID","line":983,"kind":13,"containerName":"add_global_chain"},{"name":"$chain","line":985,"definition":"my","localvar":"my","kind":13,"containerName":"add_global_chain"},{"name":"$self","kind":13,"line":985,"containerName":"add_global_chain"},{"line":985,"kind":13,"containerName":"add_global_chain","name":"$logger"},{"name":"logdie","line":985,"containerName":"add_global_chain","kind":12},{"name":"$chain","containerName":"add_global_chain","line":986,"kind":13},{"name":"$chain","containerName":"add_global_chain","line":986,"kind":13},{"localvar":"my","kind":13,"containerName":"add_global_chain","name":"$globalchains_str","line":988,"definition":"my"},{"name":"$self","kind":13,"line":988,"containerName":"add_global_chain"},{"name":"$logger","containerName":"add_global_chain","line":988,"kind":13},{"line":988,"kind":12,"containerName":"add_global_chain","name":"logdie"},{"definition":"my","line":989,"name":"@globalchains","kind":13,"containerName":"add_global_chain","localvar":"my"},{"name":"$globalchains_str","line":989,"kind":13,"containerName":"add_global_chain"},{"name":"$logger","kind":13,"line":991,"containerName":"add_global_chain"},{"containerName":"add_global_chain","line":991,"kind":12,"name":"info"},{"kind":13,"containerName":"add_global_chain","localvar":"my","line":992,"definition":"my","name":"$args"},{"name":"$self","containerName":"add_global_chain","line":996,"kind":13},{"name":"iptablesqueue_enqueue","containerName":"add_global_chain","line":996,"kind":12},{"containerName":"add_global_chain","line":996,"kind":13,"name":"$args"},{"name":"$logger","containerName":"add_global_chain","line":998,"kind":13},{"line":998,"kind":12,"containerName":"add_global_chain","name":"info"},{"definition":"my","line":999,"name":"$table","containerName":"add_global_chain","kind":13,"localvar":"my"},{"kind":13,"line":999,"containerName":"add_global_chain","name":"@globalchains"},{"kind":13,"containerName":"add_global_chain","localvar":"my","definition":"my","line":1000,"name":"$args"},{"line":1004,"containerName":"add_global_chain","kind":13,"name":"$self"},{"containerName":"add_global_chain","line":1004,"kind":12,"name":"iptablesqueue_enqueue"},{"containerName":"add_global_chain","line":1004,"kind":13,"name":"$args"}]},{"name":"threads","line":982,"kind":12},{"name":"configs","line":985,"kind":12},{"line":985,"kind":12,"name":"chainprefix"},{"kind":12,"line":988,"name":"configs"},{"name":"globalchains","kind":12,"line":988},{"kind":12,"line":993,"name":"options"},{"line":994,"kind":12,"name":"rule"},{"name":"options","kind":12,"line":1001},{"kind":12,"line":1002,"name":"rule"},{"children":[{"name":"$self","line":1014,"definition":"my","localvar":"my","containerName":"iptablesqueue_enqueue","kind":13},{"line":1014,"containerName":"iptablesqueue_enqueue","kind":13,"name":"$args"},{"name":"$TID","line":1015,"definition":"my","localvar":"my","kind":13,"containerName":"iptablesqueue_enqueue"},{"line":1015,"kind":12,"containerName":"iptablesqueue_enqueue","name":"tid"},{"kind":13,"line":1016,"containerName":"iptablesqueue_enqueue","name":"$TID"},{"name":"$TID","containerName":"iptablesqueue_enqueue","line":1016,"kind":13},{"line":1018,"definition":"my","name":"$iptablesQueue_pending","kind":13,"containerName":"iptablesqueue_enqueue","localvar":"my"},{"line":1018,"containerName":"iptablesqueue_enqueue","kind":13,"name":"$IptablesQueue"},{"name":"pending","line":1018,"containerName":"iptablesqueue_enqueue","kind":12},{"name":"$iptablesQueue_pending","line":1019,"containerName":"iptablesqueue_enqueue","kind":13},{"kind":13,"containerName":"iptablesqueue_enqueue","localvar":"my","line":1020,"definition":"my","name":"$logmsg"},{"line":1021,"containerName":"iptablesqueue_enqueue","kind":13,"name":"$logmsg"},{"line":1022,"containerName":"iptablesqueue_enqueue","kind":13,"name":"$logger"},{"line":1022,"containerName":"iptablesqueue_enqueue","kind":12,"name":"info"},{"kind":13,"line":1022,"containerName":"iptablesqueue_enqueue","name":"$logmsg"},{"name":"$args","line":1025,"kind":13,"containerName":"iptablesqueue_enqueue"},{"kind":13,"line":1026,"containerName":"iptablesqueue_enqueue","name":"$logger"},{"containerName":"iptablesqueue_enqueue","line":1026,"kind":12,"name":"debug"},{"name":"$args","containerName":"iptablesqueue_enqueue","line":1026,"kind":13},{"name":"$logger","kind":13,"line":1026,"containerName":"iptablesqueue_enqueue"},{"name":"is_debug","line":1026,"kind":12,"containerName":"iptablesqueue_enqueue"},{"name":"$IptablesQueue","line":1027,"containerName":"iptablesqueue_enqueue","kind":13},{"name":"enqueue","kind":12,"line":1027,"containerName":"iptablesqueue_enqueue"},{"name":"$args","kind":13,"line":1027,"containerName":"iptablesqueue_enqueue"}],"kind":12,"signature":{"label":"iptablesqueue_enqueue()","parameters":[],"documentation":" Description: Queues items onto the iptables queue\n Returns 1 if queue is allowing enqueuing\n Returns 0 if queue is not allowing enqueuing"},"containerName":"main::","range":{"end":{"character":9999,"line":1029},"start":{"character":0,"line":1013}},"definition":"sub","detail":"()","line":1013,"name":"iptablesqueue_enqueue"},{"line":1015,"kind":12,"name":"threads"},{"name":"check_pending","line":1025,"kind":12},{"name":"Dumper","kind":12,"line":1026},{"name":"readlogfile","line":1036,"definition":"sub","detail":"($self,$logobj)","range":{"start":{"line":1036,"character":0},"end":{"line":1081,"character":9999}},"signature":{"label":"readlogfile($self,$logobj)","parameters":[{"label":"$self"},{"label":"$logobj"}],"documentation":" This function reads the log file into memory from the seek position (if it exists)\n The reading of a log file based on the seek position creates a big issue if the log file is rotated AND is larger than\n   the seek position\n   This is a tradeoff of reading the entire log file into memory and then grepping for the regexps\n Returns: $logobj"},"containerName":"main::","kind":12,"children":[{"line":1037,"definition":"my","name":"$self","containerName":"readlogfile","kind":13,"localvar":"my"},{"containerName":"readlogfile","line":1037,"kind":13,"name":"$logobj"},{"kind":13,"containerName":"readlogfile","localvar":"my","definition":"my","line":1038,"name":"$TID"},{"name":"tid","containerName":"readlogfile","line":1038,"kind":12},{"line":1039,"kind":13,"containerName":"readlogfile","name":"$TID"},{"name":"$TID","kind":13,"line":1039,"containerName":"readlogfile"},{"name":"$file","definition":"my","line":1042,"localvar":"my","kind":13,"containerName":"readlogfile"},{"name":"$logobj","line":1042,"containerName":"readlogfile","kind":13},{"name":"$file","line":1043,"containerName":"readlogfile","kind":13},{"name":"$logger","line":1043,"kind":13,"containerName":"readlogfile"},{"kind":12,"line":1043,"containerName":"readlogfile","name":"error"},{"name":"$logobj","line":1043,"containerName":"readlogfile","kind":13},{"name":"$logobj","containerName":"readlogfile","line":1046,"kind":13},{"line":1047,"containerName":"readlogfile","kind":13,"name":"$logobj"},{"name":"$file","line":1047,"kind":13,"containerName":"readlogfile"},{"name":"$logobj","containerName":"readlogfile","line":1047,"kind":13},{"name":"$logobj","line":1048,"kind":13,"containerName":"readlogfile"},{"containerName":"readlogfile","line":1048,"kind":13,"name":"$self"},{"containerName":"readlogfile","line":1049,"kind":13,"name":"$logobj"},{"name":"$logobj","line":1049,"containerName":"readlogfile","kind":13},{"line":1051,"containerName":"readlogfile","kind":13,"name":"$logger"},{"name":"debug","containerName":"readlogfile","line":1051,"kind":12},{"definition":"my","line":1057,"name":"$fh","containerName":"readlogfile","kind":13,"localvar":"my"},{"line":1057,"kind":13,"containerName":"readlogfile","name":"$file"},{"name":"$logger","line":1058,"kind":13,"containerName":"readlogfile"},{"line":1058,"kind":12,"containerName":"readlogfile","name":"error"},{"line":1059,"containerName":"readlogfile","kind":13,"name":"$logobj"},{"line":1061,"containerName":"readlogfile","kind":13,"name":"$fh"},{"name":"$logobj","line":1061,"containerName":"readlogfile","kind":13},{"name":"@logcontents","definition":"my","line":1062,"localvar":"my","kind":13,"containerName":"readlogfile"},{"name":"$fh","containerName":"readlogfile","line":1062,"kind":13},{"name":"$logobj","line":1063,"containerName":"readlogfile","kind":13},{"name":"$fh","line":1063,"containerName":"readlogfile","kind":13},{"name":"$fh","line":1064,"kind":13,"containerName":"readlogfile"},{"kind":13,"line":1066,"containerName":"readlogfile","name":"@logcontents"},{"line":1067,"containerName":"readlogfile","kind":13,"name":"$logger"},{"name":"debug","kind":12,"line":1067,"containerName":"readlogfile"},{"kind":13,"line":1067,"containerName":"readlogfile","name":"@logcontents"},{"name":"$logger","line":1070,"kind":13,"containerName":"readlogfile"},{"kind":12,"line":1070,"containerName":"readlogfile","name":"info"},{"name":"$logobj","line":1071,"containerName":"readlogfile","kind":13},{"name":"@logcontents","containerName":"readlogfile","line":1074,"kind":13},{"containerName":"readlogfile","line":1075,"kind":13,"name":"$logobj"},{"name":"@logcontents","containerName":"readlogfile","line":1075,"kind":13},{"name":"$logger","line":1077,"kind":13,"containerName":"readlogfile"},{"name":"debug","line":1077,"kind":12,"containerName":"readlogfile"},{"kind":13,"line":1077,"containerName":"readlogfile","name":"@logcontents"},{"containerName":"readlogfile","line":1078,"kind":13,"name":"$logger"},{"line":1078,"kind":12,"containerName":"readlogfile","name":"trace"},{"kind":13,"line":1078,"containerName":"readlogfile","name":"$logobj"},{"line":1078,"kind":13,"containerName":"readlogfile","name":"$logger"},{"name":"is_trace","line":1078,"containerName":"readlogfile","kind":12},{"line":1080,"containerName":"readlogfile","kind":13,"name":"$logobj"}]},{"kind":12,"line":1038,"name":"threads"},{"name":"file","line":1042,"kind":12},{"name":"seek","line":1046,"kind":12},{"line":1047,"kind":12,"name":"seek"},{"kind":12,"line":1047,"name":"seek"},{"name":"readentirefile","line":1048,"kind":12},{"line":1048,"kind":12,"name":"configs"},{"name":"readentirefile","kind":12,"line":1048},{"name":"seek","kind":12,"line":1049},{"line":1049,"kind":12,"name":"readentirefile"},{"line":1061,"kind":12,"name":"seek"},{"line":1063,"kind":12,"name":"seek"},{"kind":12,"line":1071,"name":"logcontents"},{"name":"logcontents","line":1075,"kind":12},{"line":1078,"kind":12,"name":"Dumper"},{"name":"logcontents","line":1078,"kind":12},{"detail":"($self,$log)","definition":"sub","line":1086,"name":"_grep_regexps","children":[{"name":"$self","definition":"my","line":1087,"localvar":"my","containerName":"_grep_regexps","kind":13},{"containerName":"_grep_regexps","line":1087,"kind":13,"name":"$log"},{"localvar":"my","containerName":"_grep_regexps","kind":13,"name":"$TID","definition":"my","line":1088},{"kind":12,"line":1088,"containerName":"_grep_regexps","name":"tid"},{"localvar":"my","containerName":"_grep_regexps","kind":13,"name":"$matches","definition":"my","line":1090},{"line":1091,"definition":"my","name":"@log_contents","kind":13,"containerName":"_grep_regexps","localvar":"my"},{"name":"$log","line":1091,"containerName":"_grep_regexps","kind":13}],"signature":{"label":"_grep_regexps($self,$log)","parameters":[{"label":"$self"},{"label":"$log"}],"documentation":" Description:  Using the logobj, this greps against the log contents for matching lines and then gets the\n               IP address on each line.\n Returns:  Hash reference of IP addresses with count of how many times the IP address was found"},"kind":12,"containerName":"main::","range":{"start":{"line":1086,"character":0},"end":{"line":1091,"character":9999}}},{"line":1088,"kind":12,"name":"threads"},{"kind":12,"line":1091,"name":"logcontents"},{"name":"@log_contents","line":1093,"containerName":null,"kind":13},{"line":1096,"definition":"my","name":"$regex","containerName":null,"kind":13,"localvar":"my"},{"name":"%log","containerName":null,"line":1096,"kind":13},{"name":"regexpdeny","line":1096,"kind":12},{"name":"$pattern","definition":"my","line":1097,"localvar":"my","containerName":null,"kind":13},{"containerName":null,"line":1097,"kind":13,"name":"%log"},{"line":1097,"kind":12,"name":"regexpdeny"},{"line":1097,"containerName":null,"kind":13,"name":"$regex"},{"name":"$logger","containerName":null,"line":1098,"kind":13},{"kind":12,"line":1098,"containerName":"main::","name":"debug"},{"name":"@current_matches","line":1100,"definition":"my","localvar":"my","containerName":null,"kind":13},{"kind":13,"line":1100,"containerName":null,"name":"@log_contents"},{"name":"$logger","containerName":null,"line":1101,"kind":13},{"name":"debug","containerName":"main::","line":1101,"kind":12},{"kind":12,"line":1101,"name":"Dumper"},{"name":"@current_matches","line":1101,"containerName":null,"kind":13},{"line":1101,"containerName":null,"kind":13,"name":"$logger"},{"name":"is_debug","line":1101,"kind":12,"containerName":"main::"},{"localvar":"my","containerName":null,"kind":13,"name":"$line","line":1103,"definition":"my"},{"name":"@current_matches","line":1103,"kind":13,"containerName":null},{"name":"$line","kind":13,"line":1104,"containerName":null},{"name":"$logger","line":1105,"kind":13,"containerName":null},{"name":"debug","line":1105,"kind":12,"containerName":"main::"},{"name":"$ip_address","definition":"my","line":1107,"localvar":"my","containerName":null,"kind":13},{"name":"$line","line":1107,"kind":13,"containerName":null},{"containerName":null,"line":1107,"kind":13,"name":"%line"},{"containerName":null,"line":1108,"kind":13,"name":"%matches"},{"name":"$ip_address","line":1108,"kind":13,"containerName":null},{"name":"$logger","kind":13,"line":1109,"containerName":null},{"name":"debug","line":1109,"containerName":"main::","kind":12},{"name":"$logger","line":1114,"containerName":null,"kind":13},{"name":"debug","containerName":"main::","line":1114,"kind":12},{"name":"Dumper","line":1114,"kind":12},{"name":"$matches","containerName":null,"line":1114,"kind":13},{"name":"$logger","containerName":null,"line":1114,"kind":13},{"name":"is_debug","kind":12,"line":1114,"containerName":"main::"},{"name":"$log_msg","definition":"my","line":1116,"localvar":"my","kind":13,"containerName":null},{"name":"$log_msg","line":1117,"containerName":null,"kind":13},{"line":1117,"kind":13,"containerName":null,"name":"$matches"},{"line":1118,"kind":13,"containerName":null,"name":"$logger"},{"name":"info","containerName":"main::","line":1118,"kind":12},{"name":"$log_msg","kind":13,"line":1118,"containerName":null},{"line":1120,"kind":13,"containerName":null,"name":"$matches"},{"name":"add_chain","definition":"sub","detail":"()","line":1124,"range":{"start":{"line":1124,"character":0},"end":{"character":9999,"line":1135}},"children":[{"kind":13,"containerName":"add_chain","localvar":"my","definition":"my","line":1125,"name":"$self"},{"name":"$chain","line":1125,"containerName":"add_chain","kind":13},{"kind":13,"containerName":"add_chain","localvar":"my","definition":"my","line":1126,"name":"$TID"},{"containerName":"add_chain","line":1126,"kind":12,"name":"tid"},{"containerName":"add_chain","line":1128,"kind":13,"name":"$logger"},{"containerName":"add_chain","line":1128,"kind":12,"name":"info"},{"line":1129,"definition":"my","name":"$rule","containerName":"add_chain","kind":13,"localvar":"my"},{"localvar":"my","containerName":"add_chain","kind":13,"name":"$options","line":1130,"definition":"my"},{"name":"$args","line":1131,"definition":"my","localvar":"my","containerName":"add_chain","kind":13},{"line":1131,"kind":13,"containerName":"add_chain","name":"$rule"},{"containerName":"add_chain","line":1131,"kind":13,"name":"$options"},{"line":1132,"containerName":"add_chain","kind":13,"name":"$self"},{"kind":12,"line":1132,"containerName":"add_chain","name":"iptablesqueue_enqueue"},{"kind":13,"line":1132,"containerName":"add_chain","name":"$args"},{"kind":13,"line":1133,"containerName":"add_chain","name":"$self"},{"name":"$chain","line":1133,"containerName":"add_chain","kind":13}],"signature":{"parameters":[],"documentation":" Description:  Adds the chain to iptables","label":"add_chain()"},"containerName":"main::","kind":12},{"name":"threads","kind":12,"line":1126},{"name":"rule","line":1131,"kind":12},{"name":"options","kind":12,"line":1131},{"name":"chains_created","kind":12,"line":1133},{"line":1144,"definition":"sub","detail":"()","name":"add_allowdeny_ips","containerName":"main::","signature":{"parameters":[],"documentation":" Description:  Adds the IPs to DROP or ACCEPT to the chain provided\n Returns:  1\n Requires: $args to be a hash reference with the following optional keys:\n  chain:  The chain to add the rules to.  If no chain provided then the default is ipblocker_global\n  allowlist:  An array of IPs to allow\n  denylist:  An array of IPs to deny\n  allowdenyorder:  The order to add the allow and deny rules","label":"add_allowdeny_ips()"},"kind":12,"children":[{"line":1145,"definition":"my","name":"$self","kind":13,"containerName":"add_allowdeny_ips","localvar":"my"},{"line":1145,"containerName":"add_allowdeny_ips","kind":13,"name":"$args"},{"line":1146,"definition":"my","name":"$TID","containerName":"add_allowdeny_ips","kind":13,"localvar":"my"},{"line":1146,"kind":12,"containerName":"add_allowdeny_ips","name":"tid"},{"line":1148,"kind":13,"containerName":"add_allowdeny_ips","name":"$args"},{"line":1149,"kind":13,"containerName":"add_allowdeny_ips","name":"$logger"},{"name":"error","line":1149,"kind":12,"containerName":"add_allowdeny_ips"},{"definition":"my","line":1152,"name":"$chain","kind":13,"containerName":"add_allowdeny_ips","localvar":"my"},{"line":1152,"kind":13,"containerName":"add_allowdeny_ips","name":"$args"},{"name":"%ip_rules","line":1154,"definition":"my","localvar":"my","kind":13,"containerName":"add_allowdeny_ips"},{"name":"$args","containerName":"add_allowdeny_ips","line":1155,"kind":13},{"name":"$args","kind":13,"line":1156,"containerName":"add_allowdeny_ips"},{"definition":"my","line":1159,"name":"@allowdenyorder","kind":13,"containerName":"add_allowdeny_ips","localvar":"my"},{"line":1160,"kind":13,"containerName":"add_allowdeny_ips","name":"$args"},{"containerName":"add_allowdeny_ips","line":1161,"kind":13,"name":"@allowdenyorder"},{"containerName":"add_allowdeny_ips","line":1164,"kind":13,"name":"$logger"},{"containerName":"add_allowdeny_ips","line":1164,"kind":12,"name":"debug"},{"name":"%ip_rules","line":1164,"containerName":"add_allowdeny_ips","kind":13},{"line":1164,"containerName":"add_allowdeny_ips","kind":13,"name":"$logger"},{"name":"is_debug","line":1164,"kind":12,"containerName":"add_allowdeny_ips"},{"line":1167,"definition":"my","name":"$action","kind":13,"containerName":"add_allowdeny_ips","localvar":"my"},{"name":"@allowdenyorder","kind":13,"line":1167,"containerName":"add_allowdeny_ips"},{"line":1168,"kind":13,"containerName":"add_allowdeny_ips","name":"$logger"},{"name":"debug","line":1168,"kind":12,"containerName":"add_allowdeny_ips"},{"name":"$chain","definition":"my","line":1170,"localvar":"my","containerName":"add_allowdeny_ips","kind":13},{"name":"$args","kind":13,"line":1170,"containerName":"add_allowdeny_ips"},{"containerName":"add_allowdeny_ips","kind":13,"localvar":"my","line":1171,"definition":"my","name":"$rule_action"},{"kind":13,"line":1171,"containerName":"add_allowdeny_ips","name":"$action"},{"containerName":"add_allowdeny_ips","kind":13,"localvar":"my","definition":"my","line":1172,"name":"$ip"},{"kind":13,"line":1172,"containerName":"add_allowdeny_ips","name":"$ip_rules"},{"containerName":"add_allowdeny_ips","line":1172,"kind":13,"name":"$action"},{"line":1173,"containerName":"add_allowdeny_ips","kind":13,"name":"$logger"},{"name":"debug","line":1173,"kind":12,"containerName":"add_allowdeny_ips"},{"localvar":"my","kind":13,"containerName":"add_allowdeny_ips","name":"$direction","line":1174,"definition":"my"},{"name":"$rule","line":1175,"definition":"my","localvar":"my","kind":13,"containerName":"add_allowdeny_ips"},{"line":1176,"definition":"my","name":"$args","containerName":"add_allowdeny_ips","kind":13,"localvar":"my"},{"line":1176,"kind":13,"containerName":"add_allowdeny_ips","name":"$rule"},{"kind":13,"line":1177,"containerName":"add_allowdeny_ips","name":"$logger"},{"name":"debug","line":1177,"kind":12,"containerName":"add_allowdeny_ips"},{"name":"$self","line":1178,"containerName":"add_allowdeny_ips","kind":13},{"name":"iptablesqueue_enqueue","line":1178,"kind":12,"containerName":"add_allowdeny_ips"},{"name":"$args","kind":13,"line":1178,"containerName":"add_allowdeny_ips"}],"range":{"start":{"line":1144,"character":0},"end":{"character":9999,"line":1181}}},{"line":1146,"kind":12,"name":"threads"},{"line":1152,"kind":12,"name":"chain"},{"name":"allow","line":1155,"kind":12},{"name":"allowlist","kind":12,"line":1155},{"kind":12,"line":1156,"name":"deny"},{"name":"denylist","line":1156,"kind":12},{"kind":12,"line":1160,"name":"allowdeny"},{"kind":12,"line":1164,"name":"Dumper"},{"kind":12,"line":1170,"name":"chain"},{"kind":12,"line":1176,"name":"rule"},{"line":1176,"kind":12,"name":"options"},{"name":"add_global_allow_deny_ips","detail":"()","definition":"sub","line":1188,"range":{"end":{"line":1194,"character":9999},"start":{"character":0,"line":1188}},"children":[{"line":1189,"definition":"my","name":"$self","kind":13,"containerName":"add_global_allow_deny_ips","localvar":"my"},{"localvar":"my","kind":13,"containerName":"add_global_allow_deny_ips","name":"$TID","line":1190,"definition":"my"},{"line":1190,"containerName":"add_global_allow_deny_ips","kind":12,"name":"tid"},{"name":"$logger","line":1192,"containerName":"add_global_allow_deny_ips","kind":13},{"name":"debug","line":1192,"kind":12,"containerName":"add_global_allow_deny_ips"},{"kind":13,"containerName":"add_global_allow_deny_ips","localvar":"my","definition":"my","line":1193,"name":"$chain"},{"name":"$self","line":1193,"kind":13,"containerName":"add_global_allow_deny_ips"},{"line":1194,"definition":"my","name":"@allowlist","kind":13,"containerName":"add_global_allow_deny_ips","localvar":"my"},{"containerName":"add_global_allow_deny_ips","line":1194,"kind":13,"name":"$self"},{"name":"$self","line":1194,"containerName":"add_global_allow_deny_ips","kind":13}],"containerName":"main::","signature":{"label":"add_global_allow_deny_ips()","parameters":[],"documentation":" Description:  Adds the IPs to block or accept from the configs global allowlist and global denylist to the global chain\n Returns:  1"},"kind":12},{"name":"threads","kind":12,"line":1190},{"line":1193,"kind":12,"name":"configs"},{"name":"chainprefix","line":1193,"kind":12},{"name":"configs","line":1194,"kind":12},{"kind":12,"line":1194,"name":"allowlist"},{"kind":12,"line":1194,"name":"configs"},{"name":"allowlist","line":1194,"kind":12},{"containerName":null,"kind":13,"localvar":"my","definition":"my","line":1195,"name":"@denylist"},{"kind":13,"line":1195,"containerName":null,"name":"%self"},{"name":"configs","kind":12,"line":1195},{"line":1195,"kind":12,"name":"denylist"},{"line":1195,"containerName":null,"kind":13,"name":"%self"},{"line":1195,"kind":12,"name":"configs"},{"name":"denylist","line":1195,"kind":12},{"containerName":null,"kind":13,"localvar":"my","line":1196,"definition":"my","name":"$allowdeny"},{"kind":13,"line":1196,"containerName":null,"name":"%self"},{"name":"configs","line":1196,"kind":12},{"name":"allowdeny","kind":12,"line":1196},{"containerName":null,"kind":13,"localvar":"my","definition":"my","line":1198,"name":"%args"},{"kind":12,"line":1199,"name":"chain"},{"kind":13,"line":1199,"containerName":null,"name":"$chain"},{"name":"allowlist","line":1200,"kind":12},{"name":"@allowlist","line":1200,"kind":13,"containerName":null},{"kind":12,"line":1201,"name":"denylist"},{"line":1201,"containerName":null,"kind":13,"name":"@denylist"},{"line":1202,"kind":12,"name":"allowdeny"},{"name":"$allowdeny","line":1203,"containerName":null,"kind":13},{"containerName":null,"line":1205,"kind":13,"name":"$logger"},{"containerName":"main::","line":1205,"kind":12,"name":"debug"},{"line":1205,"kind":12,"name":"Dumper"},{"name":"$args","line":1205,"containerName":null,"kind":13},{"name":"$logger","kind":13,"line":1205,"containerName":null},{"line":1205,"kind":12,"containerName":"main::","name":"is_debug"},{"kind":13,"line":1207,"containerName":null,"name":"$self"},{"name":"add_allowdeny_ips","containerName":"main::","line":1207,"kind":12},{"name":"$args","kind":13,"line":1207,"containerName":null},{"line":1210,"detail":"()","definition":"sub","name":"add_logger_allow_deny_ips","signature":{"label":"add_logger_allow_deny_ips()","documentation":"","parameters":[]},"containerName":"main::","kind":12,"children":[{"name":"$self","definition":"my","line":1211,"localvar":"my","containerName":"add_logger_allow_deny_ips","kind":13},{"name":"$logobj","line":1211,"kind":13,"containerName":"add_logger_allow_deny_ips"},{"line":1212,"definition":"my","name":"$TID","containerName":"add_logger_allow_deny_ips","kind":13,"localvar":"my"},{"name":"tid","line":1212,"kind":12,"containerName":"add_logger_allow_deny_ips"},{"kind":13,"line":1214,"containerName":"add_logger_allow_deny_ips","name":"$logger"},{"kind":12,"line":1214,"containerName":"add_logger_allow_deny_ips","name":"debug"},{"localvar":"my","containerName":"add_logger_allow_deny_ips","kind":13,"name":"$chain","line":1215,"definition":"my"},{"line":1215,"containerName":"add_logger_allow_deny_ips","kind":13,"name":"$self"},{"name":"$logobj","containerName":"add_logger_allow_deny_ips","line":1215,"kind":13},{"line":1216,"definition":"my","name":"@allowlist","kind":13,"containerName":"add_logger_allow_deny_ips","localvar":"my"},{"containerName":"add_logger_allow_deny_ips","line":1216,"kind":13,"name":"$logobj"},{"name":"$logobj","line":1216,"kind":13,"containerName":"add_logger_allow_deny_ips"}],"range":{"end":{"line":1216,"character":9999},"start":{"line":1210,"character":0}}},{"name":"threads","line":1212,"kind":12},{"name":"configs","kind":12,"line":1215},{"name":"chainprefix","line":1215,"kind":12},{"kind":12,"line":1215,"name":"chain"},{"name":"allowlist","line":1216,"kind":12},{"line":1216,"kind":12,"name":"allowlist"},{"name":"@denylist","line":1217,"definition":"my","localvar":"my","kind":13,"containerName":null},{"name":"%logobj","line":1217,"containerName":null,"kind":13},{"kind":12,"line":1217,"name":"denylist"},{"kind":13,"line":1217,"containerName":null,"name":"%logobj"},{"line":1217,"kind":12,"name":"denylist"},{"localvar":"my","kind":13,"containerName":null,"name":"$allowdeny","definition":"my","line":1218},{"name":"%logobj","containerName":null,"line":1218,"kind":13},{"line":1218,"kind":12,"name":"allowdeny"},{"localvar":"my","containerName":null,"kind":13,"name":"%args","definition":"my","line":1220},{"name":"chain","kind":12,"line":1221},{"containerName":null,"line":1221,"kind":13,"name":"$chain"},{"line":1222,"kind":12,"name":"allowlist"},{"containerName":null,"line":1222,"kind":13,"name":"@allowlist"},{"line":1223,"kind":12,"name":"denylist"},{"name":"@denylist","line":1223,"containerName":null,"kind":13},{"kind":12,"line":1224,"name":"allowdeny"},{"kind":13,"line":1225,"containerName":null,"name":"$allowdeny"},{"containerName":null,"line":1227,"kind":13,"name":"$logger"},{"line":1227,"containerName":"main::","kind":12,"name":"debug"},{"name":"Dumper","line":1227,"kind":12},{"name":"$args","line":1227,"containerName":null,"kind":13},{"name":"$logger","containerName":null,"line":1227,"kind":13},{"name":"is_debug","containerName":"main::","line":1227,"kind":12},{"kind":13,"line":1229,"containerName":null,"name":"$self"},{"name":"add_allowdeny_ips","kind":12,"line":1229,"containerName":"main::"},{"name":"$args","line":1229,"containerName":null,"kind":13},{"detail":"()","definition":"sub","line":1269,"name":"stop","children":[{"containerName":"stop","kind":13,"localvar":"my","line":1270,"definition":"my","name":"$self"},{"name":"$args","line":1270,"kind":13,"containerName":"stop"},{"definition":"my","line":1271,"name":"$TID","containerName":"stop","kind":13,"localvar":"my"},{"name":"tid","kind":12,"line":1271,"containerName":"stop"},{"kind":13,"line":1272,"containerName":"stop","name":"$TID"},{"name":"$TID","line":1272,"containerName":"stop","kind":13},{"name":"$logger","kind":13,"line":1273,"containerName":"stop"},{"name":"info","line":1273,"kind":12,"containerName":"stop"},{"localvar":"my","containerName":"stop","kind":13,"name":"$chains_created","line":1275,"definition":"my"},{"line":1275,"kind":13,"containerName":"stop","name":"$args"},{"line":1276,"kind":13,"containerName":"stop","name":"$logger"},{"line":1276,"kind":12,"containerName":"stop","name":"debug"},{"containerName":"stop","line":1276,"kind":13,"name":"$tracker"},{"name":"$logger","line":1276,"kind":13,"containerName":"stop"},{"kind":12,"line":1276,"containerName":"stop","name":"is_debug"},{"name":"$self","kind":13,"line":1279,"containerName":"stop"},{"kind":13,"line":1279,"containerName":"stop","name":"$chains_created"},{"containerName":"stop","line":1280,"kind":13,"name":"$logger"},{"name":"info","containerName":"stop","line":1280,"kind":12},{"name":"$chain","line":1281,"definition":"my","localvar":"my","kind":13,"containerName":"stop"},{"name":"$self","containerName":"stop","line":1281,"kind":13},{"line":1282,"kind":13,"containerName":"stop","name":"$logger"},{"line":1282,"kind":12,"containerName":"stop","name":"info"},{"name":"$IptablesQueue","kind":13,"line":1283,"containerName":"stop"},{"containerName":"stop","line":1283,"kind":12,"name":"enqueue"}],"signature":{"documentation":" sub add_global_allow_deny_ips {\n     my ($self) = @_;\n     my $TID = \"TID: \" . threads->tid;\n     $logger->debug(\"$TID|Adding global allow/deny IPs to global chains\");\n     my %ip_rules = (\n         allow => $self->{configs}->{allowlist} || {},\n         deny  => $self->{configs}->{denylist}  || {}\n     );\n     $logger->debug(\"$TID|IP rules: \" . Dumper(\\%ip_rules)) if $logger->is_debug();\n     foreach my $action (keys %ip_rules) {\n         my $chain = \"ipblocker_global\" . $action;\n         my $rule_action = $action eq 'allow' ? 'ACCEPT' : 'DROP';\n         foreach my $ruleorder (sort keys %{$ip_rules{$action}}) {\n             my $ip = $ip_rules{$action}{$ruleorder};\n             foreach my $direction ('-s', '-d') {\n                 # my $chain = $chain_prefix . ($direction eq '-s' ? '' : 'regex') . $action;\n                 my $rule = \"$chain $direction $ip -j $rule_action\";\n                 my $args = { rule => $rule, options => \"-w -A\" };\n                 $logger->debug(\"$TID|Adding >>-w -A $rule<< to iptables queue\");\n                 $self->iptablesqueue_enqueue($args);\n             }\n         }\n     }\n     return 1;\n }\n Stops the module\n  Future enhancements:\n   Clear the thread queues","parameters":[],"label":"stop()"},"containerName":"main::","kind":12,"range":{"end":{"line":1290,"character":9999},"start":{"character":0,"line":1269}}},{"name":"threads","line":1271,"kind":12},{"name":"chains_created","line":1275,"kind":12},{"kind":12,"line":1276,"name":"Dumper"},{"line":1279,"kind":12,"name":"chains_created"},{"line":1281,"kind":12,"name":"chains_created"},{"name":"options","line":1285,"kind":12},{"name":"rule","line":1286,"kind":12},{"name":"$logger","containerName":null,"line":1292,"kind":13},{"kind":12,"line":1292,"containerName":"main::","name":"info"},{"line":1295,"kind":13,"containerName":null,"name":"$logger"},{"kind":12,"line":1295,"containerName":"main::","name":"info"},{"line":1296,"kind":12,"name":"clear_queues"},{"name":"$logger","containerName":null,"line":1296,"kind":13},{"name":"error","line":1296,"containerName":"main::","kind":12},{"line":1297,"containerName":null,"kind":13,"name":"$logger"},{"name":"info","kind":12,"line":1297,"containerName":"main::"},{"kind":12,"line":1298,"name":"join_threads"},{"line":1298,"kind":13,"containerName":null,"name":"$logger"},{"name":"error","line":1298,"containerName":"main::","kind":12},{"name":"$logger","line":1300,"containerName":null,"kind":13},{"line":1300,"kind":12,"containerName":"main::","name":"info"},{"line":1301,"containerName":null,"kind":13,"name":"$lock_obj"},{"containerName":"main::","line":1301,"kind":12,"name":"release"},{"name":"$logger","line":1302,"containerName":null,"kind":13},{"kind":12,"line":1302,"containerName":"main::","name":"info"},{"name":"join_threads","line":1311,"detail":"()","definition":"sub","range":{"end":{"line":1317,"character":9999},"start":{"character":0,"line":1311}},"signature":{"label":"join_threads()","documentation":" Joins all threads\n   Simple sub but really needs some rework\n   If a thread is taking a while to join then it will block the other threads from joining\n   Some of the threads could be reading a log file and if the log file is large then it could take a while or\n   if the log file is causing soem kind of blocking for reading then it could take a while.\n   This may be an issue, if an example, if trying to read a file across NFS or SSHFS and there is a network issue.","parameters":[]},"kind":12,"containerName":"main::","children":[{"definition":"my","line":1312,"name":"$TID","containerName":"join_threads","kind":13,"localvar":"my"},{"kind":12,"line":1312,"containerName":"join_threads","name":"tid"},{"name":"$TID","containerName":"join_threads","line":1313,"kind":13},{"containerName":"join_threads","line":1313,"kind":13,"name":"$TID"},{"containerName":"join_threads","line":1314,"kind":13,"name":"$logger"},{"name":"debug","containerName":"join_threads","line":1314,"kind":12},{"line":1315,"kind":12,"containerName":"join_threads","name":"join"},{"name":"list","line":1315,"containerName":"join_threads","kind":12}]},{"line":1312,"kind":12,"name":"threads"},{"kind":12,"line":1315,"name":"threads"},{"range":{"start":{"line":1320,"character":0},"end":{"character":9999,"line":1340}},"children":[{"definition":"my","line":1321,"name":"$TID","kind":13,"containerName":"clear_queues","localvar":"my"},{"name":"tid","line":1321,"kind":12,"containerName":"clear_queues"},{"name":"$TID","kind":13,"line":1322,"containerName":"clear_queues"},{"line":1322,"kind":13,"containerName":"clear_queues","name":"$TID"},{"containerName":"clear_queues","line":1323,"kind":13,"name":"$logger"},{"name":"debug","line":1323,"containerName":"clear_queues","kind":12},{"containerName":"clear_queues","line":1324,"kind":13,"name":"$DataQueue"},{"name":"end","containerName":"clear_queues","line":1324,"kind":12},{"name":"$IptablesQueue","line":1325,"kind":13,"containerName":"clear_queues"},{"name":"end","line":1325,"kind":12,"containerName":"clear_queues"},{"name":"$DataQueue","containerName":"clear_queues","line":1326,"kind":13},{"line":1326,"containerName":"clear_queues","kind":12,"name":"pending"},{"name":"$IptablesQueue","kind":13,"line":1326,"containerName":"clear_queues"},{"name":"pending","kind":12,"line":1326,"containerName":"clear_queues"},{"name":"$DataQueue","line":1327,"kind":13,"containerName":"clear_queues"},{"name":"pending","line":1327,"kind":12,"containerName":"clear_queues"},{"name":"$logger","line":1327,"kind":13,"containerName":"clear_queues"},{"kind":12,"line":1327,"containerName":"clear_queues","name":"debug"},{"line":1328,"kind":13,"containerName":"clear_queues","name":"$IptablesQueue"},{"name":"pending","line":1328,"containerName":"clear_queues","kind":12},{"name":"$logger","line":1328,"kind":13,"containerName":"clear_queues"},{"line":1328,"kind":12,"containerName":"clear_queues","name":"debug"},{"containerName":"clear_queues","line":1332,"kind":13,"name":"$DataQueue"},{"containerName":"clear_queues","line":1332,"kind":12,"name":"pending"},{"name":"$IptablesQueue","line":1332,"containerName":"clear_queues","kind":13},{"line":1332,"containerName":"clear_queues","kind":12,"name":"pending"},{"kind":13,"line":1333,"containerName":"clear_queues","name":"$logger"},{"name":"error","kind":12,"line":1333,"containerName":"clear_queues"},{"line":1337,"containerName":"clear_queues","kind":13,"name":"$logger"},{"kind":12,"line":1337,"containerName":"clear_queues","name":"debug"}],"containerName":"main::","signature":{"label":"clear_queues()","parameters":[],"documentation":" Clears the queues"},"kind":12,"name":"clear_queues","definition":"sub","detail":"()","line":1320},{"kind":12,"line":1321,"name":"threads"},{"name":"reload","line":1342,"definition":"sub","detail":"()","range":{"start":{"character":0,"line":1342},"end":{"character":9999,"line":1369}},"kind":12,"signature":{"label":"reload()","parameters":[],"documentation":""},"containerName":"main::","children":[{"name":"$TID","line":1343,"definition":"my","localvar":"my","kind":13,"containerName":"reload"},{"line":1343,"containerName":"reload","kind":12,"name":"tid"},{"name":"$TID","line":1344,"kind":13,"containerName":"reload"},{"name":"$TID","kind":13,"line":1344,"containerName":"reload"},{"name":"$logger","containerName":"reload","line":1345,"kind":13},{"line":1345,"containerName":"reload","kind":12,"name":"info"}]},{"name":"threads","line":1343,"kind":12},{"line":1373,"definition":"sub","name":"SIG_INT","containerName":"main::","kind":12,"children":[{"containerName":"SIG_INT","line":1374,"kind":13,"name":"$logger"},{"containerName":"SIG_INT","line":1374,"kind":12,"name":"info"}],"range":{"start":{"line":1373,"character":0},"end":{"character":9999,"line":1377}}},{"range":{"start":{"character":0,"line":1381},"end":{"line":1384,"character":9999}},"containerName":"main::","kind":12,"children":[{"name":"$logger","line":1382,"kind":13,"containerName":"SIG_HUP"},{"line":1382,"kind":12,"containerName":"SIG_HUP","name":"info"}],"name":"SIG_HUP","line":1381,"definition":"sub"},{"line":1388,"definition":"sub","name":"SIG_TERM","containerName":"main::","kind":12,"children":[{"name":"$logger","line":1389,"kind":13,"containerName":"SIG_TERM"},{"name":"info","kind":12,"line":1389,"containerName":"SIG_TERM"}],"range":{"end":{"character":9999,"line":1391},"start":{"line":1388,"character":0}}},{"name":"SIG_QUIT","line":1395,"definition":"sub","range":{"end":{"line":1398,"character":9999},"start":{"character":0,"line":1395}},"containerName":"main::","kind":12,"children":[{"name":"$self","definition":"my","line":1396,"localvar":"my","containerName":"SIG_QUIT","kind":13}]},{"range":{"end":{"line":1407,"character":9999},"start":{"character":0,"line":1400}},"containerName":"main::","signature":{"documentation":"","parameters":[],"label":"set_signal_handler()"},"kind":12,"children":[{"name":"$logger","line":1401,"kind":13,"containerName":"set_signal_handler"},{"name":"info","containerName":"set_signal_handler","line":1401,"kind":12},{"name":"$SIG","line":1403,"containerName":"set_signal_handler","kind":13},{"kind":13,"line":1404,"containerName":"set_signal_handler","name":"$SIG"},{"name":"$SIG","line":1405,"containerName":"set_signal_handler","kind":13},{"name":"$SIG","line":1406,"kind":13,"containerName":"set_signal_handler"}],"name":"set_signal_handler","line":1400,"detail":"()","definition":"sub"},{"name":"INT","line":1403,"kind":12},{"kind":12,"line":1404,"name":"TERM"},{"line":1405,"kind":12,"name":"HUP"},{"kind":12,"line":1406,"name":"QUIT"}],"version":5}