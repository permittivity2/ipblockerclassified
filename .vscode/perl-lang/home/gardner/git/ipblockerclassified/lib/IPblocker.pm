{"version":5,"vars":[{"name":"POSIX","kind":2,"line":53,"containerName":""},{"line":54,"containerName":"","kind":2,"name":"strict"},{"name":"DateTime","line":55,"containerName":"","kind":2},{"name":"Basename","line":56,"containerName":"File","kind":2},{"name":"Util","line":57,"containerName":"List","kind":2},{"name":"strict","kind":2,"line":61,"containerName":""},{"name":"HiRes","line":62,"kind":2,"containerName":"Time"},{"line":68,"kind":2,"containerName":"Config","name":"File"},{"name":"Carp","line":69,"kind":2,"containerName":""},{"name":"Log4perl","containerName":"Log","line":70,"kind":2},{"line":71,"containerName":"Data","kind":2,"name":"Dumper"},{"name":"IPv6","line":72,"kind":2,"containerName":"Regexp"},{"line":73,"containerName":"LockFile","kind":2,"name":"Simple"},{"containerName":"File","line":74,"kind":2,"name":"Path"},{"line":75,"kind":2,"containerName":"Net::Ifconfig","name":"Wrapper"},{"name":"threads","line":78,"kind":2,"containerName":""},{"name":"Queue","line":81,"containerName":"Thread","kind":2},{"name":"$DataQueue","definition":"my","line":82,"localvar":"my","containerName":null,"kind":13},{"line":82,"kind":12,"containerName":"Queue","name":"Thread"},{"line":82,"kind":12,"containerName":"main::","name":"new"},{"name":"$LoggerTIDS","line":83,"definition":"my","localvar":"my","containerName":null,"kind":13},{"name":"$IptablesQueue","definition":"my","line":85,"localvar":"my","containerName":null,"kind":13},{"name":"Thread","line":85,"kind":12,"containerName":"Queue"},{"line":85,"containerName":"main::","kind":12,"name":"new"},{"definition":"my","line":86,"name":"$IptablesTIDS","kind":13,"containerName":null,"localvar":"my"},{"containerName":null,"line":89,"kind":13,"name":"$Data"},{"name":"Dumper","kind":12,"line":89,"containerName":"Sortkeys"},{"name":"$Data","kind":13,"line":90,"containerName":null},{"line":90,"containerName":"Indent","kind":12,"name":"Dumper"},{"name":"$logger","definition":"my","line":97,"localvar":"my","containerName":null,"kind":13},{"name":"$lock_obj","line":100,"definition":"my","localvar":"my","kind":13,"containerName":null},{"kind":13,"containerName":null,"localvar":"my","line":105,"definition":"my","name":"$REGEX_IPV4"},{"kind":13,"containerName":null,"localvar":"my","line":107,"definition":"my","name":"$REGEX_IPV6"},{"name":"$IPTABLESRUNLINE","line":108,"definition":"my","localvar":"my","containerName":null,"kind":13},{"name":"%DEFAULTS","definition":"my","line":112,"localvar":"my","kind":13,"containerName":null},{"line":113,"kind":12,"name":"allowdeny"},{"name":"allowlist","line":114,"kind":12},{"name":"configsfile","kind":12,"line":115},{"name":"cycles","line":116,"kind":12},{"kind":12,"line":116,"name":"LONG_MAX"},{"name":"cyclesleep","line":117,"kind":12},{"kind":12,"line":118,"name":"dumpconfigsandexit"},{"kind":12,"line":119,"name":"denylist"},{"kind":12,"line":120,"name":"forceremovelockfile"},{"name":"globalallowlist","line":121,"kind":12},{"name":"chainprefix","kind":12,"line":122},{"kind":12,"line":124,"name":"globalchains"},{"line":125,"kind":12,"name":"globaldenylist"},{"name":"globalregexallowlist","line":126,"kind":12},{"line":127,"kind":12,"name":"globalregexdenylist"},{"name":"ignoreinterfaceips","kind":12,"line":128},{"name":"iptables","line":129,"kind":12},{"kind":12,"line":130,"name":"lockfile"},{"name":"log4perlconf","kind":12,"line":131},{"kind":12,"line":132,"name":"loglevel"},{"line":136,"kind":12,"name":"logcontents"},{"line":137,"kind":12,"name":"logs_to_review"},{"name":"logwatch_interval","line":138,"kind":12},{"name":"prodmode","kind":12,"line":139},{"name":"queuechecktime","line":140,"kind":12},{"name":"queuecycles","kind":12,"line":141},{"name":"LONG_MAX","kind":12,"line":141},{"line":142,"kind":12,"name":"readentirefile"},{"line":151,"detail":"()","definition":"sub","name":"new","kind":12,"signature":{"label":"new()","documentation":"#### Subs below here #####\n Reads configs, logging configs, sets up logging, sets up a class and returns a blessed object\n   The sub go() is where the action starts","parameters":[]},"containerName":"main::","children":[{"line":152,"definition":"my","name":"$class","kind":13,"containerName":"new","localvar":"my"},{"localvar":"my","containerName":"new","kind":13,"name":"$args","line":153,"definition":"my"},{"name":"$args","line":155,"kind":13,"containerName":"new"},{"kind":13,"line":157,"containerName":"new","name":"$args"},{"kind":13,"line":159,"containerName":"new","name":"$args"},{"kind":13,"containerName":"new","localvar":"my","definition":"my","line":164,"name":"$configsfile"},{"name":"$args","line":164,"containerName":"new","kind":13},{"name":"$DEFAULTS","line":164,"kind":13,"containerName":"new"},{"kind":13,"containerName":"new","localvar":"my","definition":"my","line":166,"name":"$self"},{"containerName":"new","line":167,"kind":13,"name":"$configsfile"},{"name":"$args","line":168,"containerName":"new","kind":13},{"name":"$self","kind":13,"line":172,"containerName":"new"},{"kind":13,"line":172,"containerName":"new","name":"$class"},{"name":"$self","containerName":"new","line":176,"kind":13},{"containerName":"new","line":176,"kind":12,"name":"load_configs"},{"name":"$self","containerName":"new","line":178,"kind":13},{"line":180,"containerName":"new","kind":13,"name":"$self"},{"name":"$self","line":181,"kind":13,"containerName":"new"},{"name":"$self","line":182,"containerName":"new","kind":13},{"name":"$self","line":184,"containerName":"new","kind":13},{"name":"$logger","line":189,"kind":13,"containerName":"new"},{"line":189,"containerName":"new","kind":13,"name":"$self"},{"name":"setup_Logger","line":189,"containerName":"new","kind":12},{"line":190,"containerName":"new","kind":13,"name":"$logger"},{"name":"info","line":190,"containerName":"new","kind":12},{"containerName":"new","line":191,"kind":13,"name":"$logger"},{"containerName":"new","line":191,"kind":12,"name":"debug"},{"name":"$self","line":191,"containerName":"new","kind":13},{"line":191,"kind":13,"containerName":"new","name":"$logger"},{"name":"is_debug","line":191,"kind":12,"containerName":"new"},{"line":193,"kind":13,"containerName":"new","name":"$self"}],"range":{"end":{"character":9999,"line":194},"start":{"line":151,"character":0}}},{"name":"carp","line":156,"kind":12},{"name":"croak","line":160,"kind":12},{"name":"configsfile","kind":12,"line":164},{"kind":12,"line":164,"name":"configsfile"},{"kind":12,"line":167,"name":"configsfile"},{"kind":12,"line":168,"name":"clargs"},{"line":178,"kind":12,"name":"configs"},{"kind":12,"line":178,"name":"dumpconfigsandexit"},{"name":"configs","line":180,"kind":12},{"kind":12,"line":180,"name":"configsfile"},{"kind":12,"line":181,"name":"configs"},{"name":"globalchain","kind":12,"line":181},{"line":182,"kind":12,"name":"configs"},{"line":182,"kind":12,"name":"dumpconfigsandexit"},{"name":"recursiveHashPrint","kind":12,"line":184},{"name":"configs","kind":12,"line":184},{"name":"Dumper","kind":12,"line":191},{"range":{"start":{"line":197,"character":0},"end":{"character":9999,"line":208}},"kind":12,"signature":{"label":"recursiveHashPrint($ref,$prefix)","parameters":[{"label":"$ref"},{"label":"$prefix"}],"documentation":"# Recursive sub to print out a hash to STDOUT in a manner that matches \"use Config::File;\""},"containerName":"main::","children":[{"line":198,"definition":"my","name":"$ref","kind":13,"containerName":"recursiveHashPrint","localvar":"my"},{"kind":13,"line":198,"containerName":"recursiveHashPrint","name":"$prefix"},{"name":"$prefix","line":199,"kind":13,"containerName":"recursiveHashPrint"},{"line":199,"kind":13,"containerName":"recursiveHashPrint","name":"$prefix"},{"line":201,"kind":13,"containerName":"recursiveHashPrint","name":"$ref"},{"name":"$key","definition":"my","line":202,"localvar":"my","containerName":"recursiveHashPrint","kind":13},{"containerName":"recursiveHashPrint","line":202,"kind":13,"name":"$ref"},{"containerName":"recursiveHashPrint","kind":13,"localvar":"my","line":205,"definition":"my","name":"$new_prefix"},{"name":"$prefix","line":205,"containerName":"recursiveHashPrint","kind":13},{"containerName":"recursiveHashPrint","line":206,"kind":13,"name":"$ref"},{"name":"$key","kind":13,"line":206,"containerName":"recursiveHashPrint"},{"name":"$new_prefix","containerName":"recursiveHashPrint","line":206,"kind":13}],"name":"recursiveHashPrint","line":197,"detail":"($ref,$prefix)","definition":"sub"},{"kind":13,"line":209,"containerName":null,"name":"%ref"},{"line":212,"definition":"my","name":"$line","kind":13,"containerName":null,"localvar":"my"},{"name":"$ref","containerName":null,"line":212,"kind":13},{"name":"$line","line":213,"kind":13,"containerName":null},{"name":"$line","kind":13,"line":214,"containerName":null},{"line":215,"containerName":null,"kind":13,"name":"%line"},{"name":"$line","line":219,"definition":"my","localvar":"my","containerName":null,"kind":13},{"name":"$line","line":220,"kind":13,"containerName":null},{"line":221,"kind":13,"containerName":null,"name":"$line"},{"line":222,"containerName":null,"kind":13,"name":"$line"},{"range":{"start":{"line":226,"character":0},"end":{"character":9999,"line":267}},"children":[{"localvar":"my","kind":13,"containerName":"iptables_thread","name":"$self","definition":"my","line":227},{"kind":13,"containerName":"iptables_thread","localvar":"my","line":228,"definition":"my","name":"$TID"},{"line":228,"containerName":"iptables_thread","kind":12,"name":"tid"},{"line":229,"containerName":"iptables_thread","kind":13,"name":"$TID"},{"name":"$TID","kind":13,"line":229,"containerName":"iptables_thread"},{"line":231,"definition":"my","name":"$cyclesleep","kind":13,"containerName":"iptables_thread","localvar":"my"},{"line":231,"kind":13,"containerName":"iptables_thread","name":"$self"},{"definition":"my","line":232,"name":"$cycles","kind":13,"containerName":"iptables_thread","localvar":"my"},{"name":"$self","line":232,"containerName":"iptables_thread","kind":13},{"line":233,"definition":"my","name":"$logmsg","containerName":"iptables_thread","kind":13,"localvar":"my"},{"containerName":"iptables_thread","line":234,"kind":13,"name":"$logmsg"},{"name":"$logger","kind":13,"line":235,"containerName":"iptables_thread"},{"name":"info","line":235,"kind":12,"containerName":"iptables_thread"},{"line":235,"kind":13,"containerName":"iptables_thread","name":"$logmsg"},{"definition":"my","line":238,"name":"$iptablesQueue_pending","kind":13,"containerName":"iptables_thread","localvar":"my"},{"name":"$IptablesQueue","containerName":"iptables_thread","line":238,"kind":13},{"name":"pending","line":238,"containerName":"iptables_thread","kind":12},{"name":"$iptablesQueue_pending","containerName":"iptables_thread","line":239,"kind":13},{"localvar":"my","kind":13,"containerName":"iptables_thread","name":"$logmsg","line":240,"definition":"my"},{"line":241,"containerName":"iptables_thread","kind":13,"name":"$logmsg"},{"name":"$logger","containerName":"iptables_thread","line":242,"kind":13},{"name":"info","line":242,"kind":12,"containerName":"iptables_thread"},{"containerName":"iptables_thread","line":242,"kind":13,"name":"$logmsg"},{"name":"$iptablesQueue_pending","line":246,"containerName":"iptables_thread","kind":13},{"line":247,"containerName":"iptables_thread","kind":13,"name":"$logger"},{"name":"info","containerName":"iptables_thread","line":247,"kind":12},{"definition":"my","line":248,"name":"$data","kind":13,"containerName":"iptables_thread","localvar":"my"},{"kind":13,"line":248,"containerName":"iptables_thread","name":"$IptablesQueue"},{"containerName":"iptables_thread","line":248,"kind":12,"name":"dequeue"},{"kind":13,"line":249,"containerName":"iptables_thread","name":"$logger"},{"line":249,"containerName":"iptables_thread","kind":12,"name":"debug"},{"kind":13,"line":249,"containerName":"iptables_thread","name":"$data"},{"name":"$logger","line":249,"kind":13,"containerName":"iptables_thread"},{"line":249,"containerName":"iptables_thread","kind":12,"name":"is_debug"},{"name":"$self","line":250,"kind":13,"containerName":"iptables_thread"},{"name":"run_iptables","line":250,"kind":12,"containerName":"iptables_thread"},{"name":"$data","line":250,"containerName":"iptables_thread","kind":13},{"name":"$logger","kind":13,"line":250,"containerName":"iptables_thread"},{"name":"error","kind":12,"line":250,"containerName":"iptables_thread"},{"containerName":"iptables_thread","line":250,"kind":13,"name":"$data"},{"name":"$IPTABLESRUNLINE","containerName":"iptables_thread","line":251,"kind":13},{"name":"$IPTABLESRUNLINE","kind":13,"line":252,"containerName":"iptables_thread"},{"name":"$IPTABLESRUNLINE","kind":13,"line":252,"containerName":"iptables_thread"},{"kind":13,"line":254,"containerName":"iptables_thread","name":"$iptablesQueue_pending"},{"kind":13,"containerName":"iptables_thread","localvar":"my","line":256,"definition":"my","name":"$logmsg"},{"name":"$logmsg","containerName":"iptables_thread","line":257,"kind":13},{"name":"$cyclesleep","containerName":"iptables_thread","line":257,"kind":13},{"name":"$logmsg","containerName":"iptables_thread","line":258,"kind":13},{"name":"$logger","containerName":"iptables_thread","line":259,"kind":13},{"line":259,"kind":12,"containerName":"iptables_thread","name":"info"},{"kind":13,"line":259,"containerName":"iptables_thread","name":"$logmsg"},{"name":"$cyclesleep","kind":13,"line":260,"containerName":"iptables_thread"},{"kind":13,"line":263,"containerName":"iptables_thread","name":"$logger"},{"name":"error","containerName":"iptables_thread","line":263,"kind":12}],"signature":{"documentation":"","parameters":[],"label":"iptables_thread()"},"kind":12,"containerName":"main::","name":"iptables_thread","detail":"()","definition":"sub","line":226},{"line":228,"kind":12,"name":"threads"},{"name":"configs","line":231,"kind":12},{"line":231,"kind":12,"name":"queuechecktime"},{"line":232,"kind":12,"name":"configs"},{"name":"queuecycles","kind":12,"line":232},{"name":"Dumper","line":249,"kind":12},{"name":"Dumper","line":250,"kind":12},{"name":"usleep","line":260,"kind":12},{"detail":"()","definition":"sub","line":274,"name":"go","children":[{"localvar":"my","containerName":"go","kind":13,"name":"$self","definition":"my","line":275},{"localvar":"my","containerName":"go","kind":13,"name":"$start_time","definition":"my","line":276},{"name":"$self","containerName":"go","line":279,"kind":13},{"name":"$logger","kind":13,"line":280,"containerName":"go"},{"kind":12,"line":280,"containerName":"go","name":"error"},{"containerName":"go","line":285,"kind":13,"name":"$self"},{"name":"set_iptables_command","containerName":"go","line":285,"kind":12},{"containerName":"go","line":285,"kind":13,"name":"$logger"},{"name":"error","line":285,"containerName":"go","kind":12},{"name":"$self","kind":13,"line":286,"containerName":"go"},{"kind":12,"line":286,"containerName":"go","name":"set_signal_handler"},{"name":"$self","kind":13,"line":287,"containerName":"go"},{"name":"$self","kind":13,"line":287,"containerName":"go"},{"name":"$self","line":288,"containerName":"go","kind":13},{"kind":12,"line":288,"containerName":"go","name":"set_lockFile"},{"name":"$logger","line":288,"kind":13,"containerName":"go"},{"name":"logdie","line":288,"containerName":"go","kind":12},{"line":292,"definition":"my","name":"$iptables_thr","kind":13,"containerName":"go","localvar":"my"},{"line":292,"containerName":"go","kind":12,"name":"create"},{"name":"$self","kind":13,"line":292,"containerName":"go"},{"kind":13,"line":295,"containerName":"go","name":"$self"},{"name":"add_global_chain","line":295,"containerName":"go","kind":12},{"containerName":"go","line":298,"kind":13,"name":"$self"},{"name":"add_global_allow_deny_ips","containerName":"go","line":298,"kind":12},{"containerName":"go","line":302,"kind":13,"name":"$logger"},{"line":302,"containerName":"go","kind":12,"name":"logdie"},{"line":302,"kind":13,"containerName":"go","name":"$self"},{"name":"logger_thread","containerName":"go","line":302,"kind":12},{"containerName":"go","kind":13,"localvar":"my","line":313,"definition":"my","name":"$cycles"},{"kind":13,"line":313,"containerName":"go","name":"$self"},{"definition":"my","line":314,"name":"$cyclesleep","kind":13,"containerName":"go","localvar":"my"},{"name":"$self","line":314,"containerName":"go","kind":13},{"name":"$cycles","line":315,"containerName":"go","kind":13},{"name":"$cycles","line":316,"containerName":"go","kind":13},{"name":"$cyclesleep","containerName":"go","line":317,"kind":13},{"name":"$logmsg","definition":"my","line":318,"localvar":"my","containerName":"go","kind":13},{"name":"$logmsg","kind":13,"line":319,"containerName":"go"},{"line":319,"kind":13,"containerName":"go","name":"$cycles"},{"name":"$logmsg","line":320,"kind":13,"containerName":"go"},{"name":"$logmsg","kind":13,"line":321,"containerName":"go"},{"name":"$cyclesleep","containerName":"go","line":321,"kind":13},{"name":"$logmsg","line":322,"kind":13,"containerName":"go"},{"name":"$logger","line":323,"kind":13,"containerName":"go"},{"name":"trace","line":323,"containerName":"go","kind":12},{"containerName":"go","line":323,"kind":13,"name":"$logmsg"},{"kind":13,"line":323,"containerName":"go","name":"$logger"},{"name":"is_debug","kind":12,"line":323,"containerName":"go"},{"containerName":"go","kind":13,"localvar":"my","definition":"my","line":326,"name":"$runtime"},{"name":"$start_time","line":326,"kind":13,"containerName":"go"},{"kind":13,"line":327,"containerName":"go","name":"$logger"},{"name":"info","line":327,"containerName":"go","kind":12},{"kind":13,"line":328,"containerName":"go","name":"$self"},{"containerName":"go","line":328,"kind":12,"name":"stop"}],"kind":12,"signature":{"label":"go()","documentation":" Creates two initial threads:\n   One for iptables commands to run.\n   Another to watch the log files\n       This in turn creates a thread for each log file to watch\n Also starts running the DataQueue queue which handles the data","parameters":[]},"containerName":"main::","range":{"start":{"line":274,"character":0},"end":{"character":9999,"line":329}}},{"line":279,"kind":12,"name":"configs"},{"name":"logs_to_review","kind":12,"line":279},{"name":"configs","line":287,"kind":12},{"line":287,"kind":12,"name":"globalchain"},{"name":"configs","kind":12,"line":287},{"name":"chainprefix","line":287,"kind":12},{"name":"threads","kind":12,"line":292},{"name":"configs","kind":12,"line":313},{"kind":12,"line":313,"name":"cycles"},{"name":"configs","line":314,"kind":12},{"kind":12,"line":314,"name":"cyclesleep"},{"name":"usleep","kind":12,"line":317},{"range":{"start":{"line":333,"character":0},"end":{"character":9999,"line":361}},"signature":{"parameters":[],"documentation":" Description:  Adds IPs on the local interfaces to the global allowlist\n  This does not work becasue it onkly handles IPv4 addresses","label":"add_ifconfig_ips_to_allowlist()"},"kind":12,"containerName":"main::","children":[{"line":334,"definition":"my","name":"$self","containerName":"add_ifconfig_ips_to_allowlist","kind":13,"localvar":"my"}],"name":"add_ifconfig_ips_to_allowlist","line":333,"definition":"sub","detail":"()"},{"range":{"end":{"character":9999,"line":403},"start":{"character":0,"line":363}},"kind":12,"signature":{"label":"dataQueue_runner()","documentation":"","parameters":[]},"containerName":"main::","children":[{"containerName":"dataQueue_runner","kind":13,"localvar":"my","line":364,"definition":"my","name":"$self"},{"localvar":"my","kind":13,"containerName":"dataQueue_runner","name":"$TID","line":365,"definition":"my"},{"name":"tid","line":365,"containerName":"dataQueue_runner","kind":12},{"name":"$TID","containerName":"dataQueue_runner","line":366,"kind":13},{"line":366,"containerName":"dataQueue_runner","kind":13,"name":"$TID"},{"name":"$Data","kind":13,"line":368,"containerName":"dataQueue_runner"},{"line":369,"containerName":"dataQueue_runner","kind":13,"name":"$Data"},{"line":371,"containerName":"dataQueue_runner","kind":13,"name":"$logger"},{"name":"info","containerName":"dataQueue_runner","line":371,"kind":12},{"definition":"my","line":372,"name":"$queuechecktime","kind":13,"containerName":"dataQueue_runner","localvar":"my"},{"name":"$self","containerName":"dataQueue_runner","line":372,"kind":13},{"definition":"my","line":373,"name":"$queuecycles","kind":13,"containerName":"dataQueue_runner","localvar":"my"},{"name":"$self","kind":13,"line":373,"containerName":"dataQueue_runner"},{"name":"$dataqueue_pending","definition":"my","line":376,"localvar":"my","containerName":"dataQueue_runner","kind":13},{"name":"$DataQueue","kind":13,"line":376,"containerName":"dataQueue_runner"},{"line":376,"containerName":"dataQueue_runner","kind":12,"name":"pending"},{"name":"$dataqueue_pending","containerName":"dataQueue_runner","line":377,"kind":13},{"name":"$logger","line":378,"kind":13,"containerName":"dataQueue_runner"},{"kind":12,"line":378,"containerName":"dataQueue_runner","name":"info"},{"name":"$dataqueue_pending","kind":13,"line":382,"containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","line":383,"kind":13,"name":"$logger"},{"kind":12,"line":383,"containerName":"dataQueue_runner","name":"info"},{"name":"$data","line":384,"definition":"my","localvar":"my","containerName":"dataQueue_runner","kind":13},{"name":"$DataQueue","line":384,"kind":13,"containerName":"dataQueue_runner"},{"name":"dequeue","kind":12,"line":384,"containerName":"dataQueue_runner"},{"name":"$logger","line":386,"containerName":"dataQueue_runner","kind":13},{"name":"debug","kind":12,"line":386,"containerName":"dataQueue_runner"},{"kind":13,"line":386,"containerName":"dataQueue_runner","name":"$data"},{"name":"$logger","kind":13,"line":386,"containerName":"dataQueue_runner"},{"name":"is_debug","containerName":"dataQueue_runner","line":386,"kind":12},{"name":"$dataqueue_pending","line":388,"kind":13,"containerName":"dataQueue_runner"},{"kind":13,"containerName":"dataQueue_runner","localvar":"my","definition":"my","line":389,"name":"$logmsg"},{"line":390,"containerName":"dataQueue_runner","kind":13,"name":"$logmsg"},{"kind":13,"line":391,"containerName":"dataQueue_runner","name":"$logger"},{"kind":12,"line":391,"containerName":"dataQueue_runner","name":"info"},{"name":"$logmsg","line":391,"containerName":"dataQueue_runner","kind":13},{"name":"$queuecycles","line":392,"containerName":"dataQueue_runner","kind":13},{"containerName":"dataQueue_runner","line":393,"kind":13,"name":"$queuecycles"},{"name":"$queuechecktime","line":394,"kind":13,"containerName":"dataQueue_runner"},{"name":"$logger","line":397,"kind":13,"containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","line":397,"kind":12,"name":"error"},{"line":402,"kind":13,"containerName":"dataQueue_runner","name":"$logger"},{"line":402,"containerName":"dataQueue_runner","kind":12,"name":"info"}],"name":"dataQueue_runner","line":363,"detail":"()","definition":"sub"},{"kind":12,"line":365,"name":"threads"},{"name":"Dumper","line":368,"kind":12,"containerName":"Terse"},{"name":"Dumper","kind":12,"line":369,"containerName":"Indent"},{"name":"configs","line":372,"kind":12},{"kind":12,"line":372,"name":"queuechecktime"},{"kind":12,"line":373,"name":"configs"},{"name":"queuecycles","line":373,"kind":12},{"name":"Dumper","kind":12,"line":386},{"name":"setup_Logger","line":409,"detail":"()","definition":"sub","range":{"start":{"character":0,"line":409},"end":{"line":434,"character":9999}},"containerName":"main::","signature":{"parameters":[],"documentation":" Assumptions:\n   $self->{configs}->{log4perlconf} is set\n   $self->{configs}->{logwatch_interval} is set\n These assumptions *should* be true because this is called from new()","label":"setup_Logger()"},"kind":12,"children":[{"kind":13,"containerName":"setup_Logger","localvar":"my","definition":"my","line":410,"name":"$self"},{"kind":13,"containerName":"setup_Logger","localvar":"my","definition":"my","line":413,"name":"$log4perlconf"},{"containerName":"setup_Logger","line":413,"kind":13,"name":"$self"},{"localvar":"my","containerName":"setup_Logger","kind":13,"name":"$logwatch_interval","definition":"my","line":414},{"containerName":"setup_Logger","line":414,"kind":13,"name":"$self"},{"name":"init_and_watch","kind":12,"line":415,"containerName":"setup_Logger"},{"line":415,"kind":13,"containerName":"setup_Logger","name":"$log4perlconf"},{"line":415,"kind":13,"containerName":"setup_Logger","name":"$logwatch_interval"},{"name":"easy_init","kind":12,"line":419,"containerName":"setup_Logger"},{"containerName":"setup_Logger","line":419,"kind":13,"name":"$Log"},{"name":"$logger","line":421,"kind":13,"containerName":"setup_Logger"},{"line":422,"kind":13,"containerName":"setup_Logger","name":"$self"},{"containerName":"setup_Logger","line":423,"kind":13,"name":"$logger"},{"name":"level","line":423,"containerName":"setup_Logger","kind":12},{"name":"$self","containerName":"setup_Logger","line":423,"kind":13},{"name":"$logger","line":424,"kind":13,"containerName":"setup_Logger"},{"name":"info","line":424,"containerName":"setup_Logger","kind":12},{"name":"$logger","line":424,"containerName":"setup_Logger","kind":13},{"name":"level","kind":12,"line":424,"containerName":"setup_Logger"},{"line":431,"containerName":"setup_Logger","kind":13,"name":"$logger"},{"name":"info","containerName":"setup_Logger","line":431,"kind":12},{"kind":13,"line":433,"containerName":"setup_Logger","name":"$logger"}]},{"name":"configs","line":413,"kind":12},{"line":413,"kind":12,"name":"log4perlconf"},{"name":"configs","line":414,"kind":12},{"name":"logwatch_interval","kind":12,"line":414},{"name":"Log","kind":12,"line":415,"containerName":"Log4perl"},{"name":"carp","line":417,"kind":12},{"name":"carp","kind":12,"line":418},{"line":419,"kind":12,"containerName":"Log4perl","name":"Log"},{"name":"Log4perl","line":419,"containerName":"DEBUG","kind":12},{"name":"get_logger","kind":12,"line":421},{"line":421,"kind":12,"name":"croak"},{"kind":12,"line":422,"name":"configs"},{"name":"loglevel","kind":12,"line":422},{"name":"configs","line":423,"kind":12},{"name":"loglevel","kind":12,"line":423},{"name":"set_lockFile","line":438,"definition":"sub","detail":"()","range":{"end":{"line":480,"character":9999},"start":{"line":438,"character":0}},"containerName":"main::","signature":{"parameters":[],"documentation":" Set lock file\n   Returns 1 if lock file is set, otherwise returns 0","label":"set_lockFile()"},"kind":12,"children":[{"name":"$self","definition":"my","line":439,"localvar":"my","kind":13,"containerName":"set_lockFile"},{"name":"$self","containerName":"set_lockFile","line":441,"kind":13},{"kind":13,"line":442,"containerName":"set_lockFile","name":"$logger"},{"line":442,"kind":12,"containerName":"set_lockFile","name":"logdie"},{"line":445,"definition":"my","name":"$lockfile","kind":13,"containerName":"set_lockFile","localvar":"my"},{"containerName":"set_lockFile","line":445,"kind":13,"name":"$self"},{"containerName":"set_lockFile","kind":13,"localvar":"my","line":448,"definition":"my","name":"$lf"},{"name":"$self","kind":13,"line":448,"containerName":"set_lockFile"},{"name":"$logger","line":449,"containerName":"set_lockFile","kind":13},{"containerName":"set_lockFile","line":449,"kind":12,"name":"debug"},{"name":"$lf","kind":13,"line":451,"containerName":"set_lockFile"},{"kind":13,"line":452,"containerName":"set_lockFile","name":"$self"},{"line":453,"containerName":"set_lockFile","kind":13,"name":"$logger"},{"line":453,"kind":12,"containerName":"set_lockFile","name":"info"},{"name":"$lf","line":454,"containerName":"set_lockFile","kind":13},{"name":"$logger","line":454,"kind":13,"containerName":"set_lockFile"},{"name":"logdie","line":454,"containerName":"set_lockFile","kind":12},{"definition":"my","line":457,"name":"$fh","containerName":"set_lockFile","kind":13,"localvar":"my"},{"line":457,"containerName":"set_lockFile","kind":13,"name":"$lf"},{"line":457,"kind":13,"containerName":"set_lockFile","name":"$logger"},{"kind":12,"line":457,"containerName":"set_lockFile","name":"logdie"},{"containerName":"set_lockFile","kind":13,"localvar":"my","definition":"my","line":458,"name":"@contents"},{"containerName":"set_lockFile","line":458,"kind":13,"name":"$fh"},{"name":"$fh","containerName":"set_lockFile","line":459,"kind":13},{"name":"@contents","kind":13,"line":460,"containerName":"set_lockFile"},{"name":"$printable_contents","line":461,"definition":"my","localvar":"my","kind":13,"containerName":"set_lockFile"},{"kind":13,"line":461,"containerName":"set_lockFile","name":"@contents"},{"definition":"my","line":462,"name":"$logmsg","containerName":"set_lockFile","kind":13,"localvar":"my"},{"line":463,"kind":13,"containerName":"set_lockFile","name":"$logger"},{"kind":12,"line":463,"containerName":"set_lockFile","name":"info"},{"line":463,"containerName":"set_lockFile","kind":13,"name":"$logmsg"},{"name":"$lf","line":467,"containerName":"set_lockFile","kind":13},{"name":"$logger","line":467,"kind":13,"containerName":"set_lockFile"},{"name":"logdie","containerName":"set_lockFile","line":467,"kind":12},{"line":470,"kind":13,"containerName":"set_lockFile","name":"$self"},{"name":"make","containerName":"set_lockFile","line":470,"kind":12},{"name":"$logger","line":473,"containerName":"set_lockFile","kind":13},{"kind":12,"line":473,"containerName":"set_lockFile","name":"debug"},{"line":473,"kind":13,"containerName":"set_lockFile","name":"$self"},{"name":"$logger","line":473,"kind":13,"containerName":"set_lockFile"},{"line":473,"containerName":"set_lockFile","kind":12,"name":"is_debug"},{"line":474,"kind":13,"containerName":"set_lockFile","name":"$self"},{"name":"$self","kind":13,"line":474,"containerName":"set_lockFile"},{"name":"lock","kind":12,"line":474,"containerName":"set_lockFile"},{"name":"$lf","kind":13,"line":474,"containerName":"set_lockFile"},{"name":"$logger","kind":13,"line":475,"containerName":"set_lockFile"},{"name":"logdie","line":475,"kind":12,"containerName":"set_lockFile"},{"line":476,"kind":13,"containerName":"set_lockFile","name":"$lock_obj"},{"name":"$self","line":476,"kind":13,"containerName":"set_lockFile"},{"containerName":"set_lockFile","line":478,"kind":13,"name":"$logger"},{"name":"info","containerName":"set_lockFile","line":478,"kind":12}]},{"name":"configs","kind":12,"line":441},{"name":"lockfile","kind":12,"line":441},{"name":"configs","kind":12,"line":445},{"line":445,"kind":12,"name":"lockfile"},{"line":448,"kind":12,"name":"configs"},{"kind":12,"line":448,"name":"lockfile"},{"line":452,"kind":12,"name":"configs"},{"name":"forceremovelockfile","kind":12,"line":452},{"name":"lockmgr","line":470,"kind":12},{"line":470,"kind":12,"containerName":"Simple","name":"LockFile"},{"line":473,"kind":12,"name":"Dumper"},{"line":473,"kind":12,"name":"lockmgr"},{"kind":12,"line":474,"name":"lock"},{"line":474,"kind":12,"name":"lockmgr"},{"name":"lock","kind":12,"line":476},{"range":{"start":{"character":0,"line":484},"end":{"line":491,"character":9999}},"signature":{"label":"logger_thread()","parameters":[],"documentation":"# Description: Creates a thread for each log file to review\n# Returns 1 or dies if thread can not be created"},"kind":12,"containerName":"main::","children":[{"name":"$self","line":485,"definition":"my","localvar":"my","containerName":"logger_thread","kind":13},{"localvar":"my","containerName":"logger_thread","kind":13,"name":"$logstoreview","definition":"my","line":487},{"line":487,"containerName":"logger_thread","kind":13,"name":"$self"},{"name":"$logstoreview","line":488,"containerName":"logger_thread","kind":13},{"name":"$logtoreview","definition":"my","line":491,"localvar":"my","containerName":"logger_thread","kind":13},{"containerName":"logger_thread","line":491,"kind":13,"name":"$logstoreview"}],"name":"logger_thread","line":484,"definition":"sub","detail":"()"},{"kind":12,"line":487,"name":"configs"},{"name":"logs_to_review","kind":12,"line":487},{"containerName":null,"line":492,"kind":13,"name":"$logger"},{"line":492,"containerName":"main::","kind":12,"name":"info"},{"containerName":null,"kind":13,"localvar":"my","line":493,"definition":"my","name":"$logobj"},{"line":493,"kind":13,"containerName":null,"name":"%logstoreview"},{"kind":13,"line":493,"containerName":null,"name":"$logtoreview"},{"name":"%logobj","kind":13,"line":494,"containerName":null},{"line":494,"kind":12,"name":"chain"},{"kind":13,"line":494,"containerName":null,"name":"$logtoreview"},{"name":"$thr","line":496,"definition":"my","localvar":"my","kind":13,"containerName":null},{"kind":12,"line":496,"name":"threads"},{"name":"create","line":496,"containerName":"main::","kind":12},{"name":"review_log","kind":12,"line":496},{"line":496,"containerName":null,"kind":13,"name":"$self"},{"name":"$logobj","line":496,"kind":13,"containerName":null},{"line":496,"kind":13,"containerName":null,"name":"$logger"},{"name":"logdie","line":496,"kind":12,"containerName":"main::"},{"name":"$LoggerTIDS","line":497,"kind":13,"containerName":null},{"name":"$thr","line":497,"containerName":null,"kind":13},{"name":"tid","kind":12,"line":497,"containerName":"main::"},{"name":"$logger","line":498,"kind":13,"containerName":null},{"name":"debug","kind":12,"line":498,"containerName":"main::"},{"name":"$thr","kind":13,"line":498,"containerName":null},{"line":498,"containerName":"main::","kind":12,"name":"tid"},{"name":"$logger","kind":13,"line":498,"containerName":null},{"name":"is_debug","containerName":"main::","line":498,"kind":12},{"name":"$logger","line":499,"containerName":null,"kind":13},{"name":"debug","line":499,"containerName":"main::","kind":12},{"name":"$thr","line":499,"containerName":null,"kind":13},{"kind":12,"line":499,"containerName":"main::","name":"tid"},{"line":499,"kind":13,"containerName":null,"name":"$thr"},{"name":"is_running","line":499,"kind":12,"containerName":"main::"},{"line":499,"kind":13,"containerName":null,"name":"$logger"},{"kind":12,"line":499,"containerName":"main::","name":"is_debug"},{"line":509,"detail":"()","definition":"sub","name":"review_log","signature":{"label":"review_log()","documentation":" This is called as a thread and runs a loop to check the log file for new entries\n   Prior to checking the log file, it creates a chain for the log file and adds it to the global chain","parameters":[]},"kind":12,"containerName":"main::","children":[{"localvar":"my","containerName":"review_log","kind":13,"name":"$self","line":510,"definition":"my"},{"line":510,"kind":13,"containerName":"review_log","name":"$logobj"},{"kind":13,"containerName":"review_log","localvar":"my","line":511,"definition":"my","name":"$start_time"},{"name":"$logobj","containerName":"review_log","line":513,"kind":13},{"localvar":"my","containerName":"review_log","kind":13,"name":"$TID","definition":"my","line":514},{"name":"tid","line":514,"kind":12,"containerName":"review_log"},{"name":"$TID","line":515,"kind":13,"containerName":"review_log"},{"line":515,"containerName":"review_log","kind":13,"name":"$TID"},{"line":517,"definition":"my","name":"$chain","kind":13,"containerName":"review_log","localvar":"my"},{"name":"$self","containerName":"review_log","line":517,"kind":13},{"kind":13,"line":517,"containerName":"review_log","name":"$logobj"},{"line":519,"containerName":"review_log","kind":13,"name":"$logger"},{"containerName":"review_log","line":519,"kind":12,"name":"info"},{"line":520,"containerName":"review_log","kind":13,"name":"$logger"},{"name":"debug","kind":12,"line":520,"containerName":"review_log"},{"line":520,"containerName":"review_log","kind":13,"name":"$logobj"},{"name":"$logger","kind":13,"line":520,"containerName":"review_log"},{"name":"is_debug","kind":12,"line":520,"containerName":"review_log"},{"line":523,"kind":13,"containerName":"review_log","name":"$logobj"},{"line":523,"kind":13,"containerName":"review_log","name":"$self"},{"definition":"my","line":524,"name":"$cycles","kind":13,"containerName":"review_log","localvar":"my"},{"name":"$logobj","line":524,"containerName":"review_log","kind":13},{"kind":13,"line":525,"containerName":"review_log","name":"$logobj"},{"kind":13,"line":525,"containerName":"review_log","name":"$self"},{"definition":"my","line":526,"name":"$cyclesleep","kind":13,"containerName":"review_log","localvar":"my"},{"line":526,"kind":13,"containerName":"review_log","name":"$logobj"},{"kind":13,"containerName":"review_log","localvar":"my","line":527,"definition":"my","name":"$microcyclesleep"},{"name":"$cyclesleep","line":527,"kind":13,"containerName":"review_log"},{"containerName":"review_log","line":529,"kind":13,"name":"$logger"},{"name":"info","containerName":"review_log","line":529,"kind":12},{"containerName":"review_log","line":534,"kind":13,"name":"$logger"},{"containerName":"review_log","line":534,"kind":12,"name":"info"},{"name":"$self","kind":13,"line":535,"containerName":"review_log"},{"name":"add_chain","kind":12,"line":535,"containerName":"review_log"},{"name":"$chain","line":535,"containerName":"review_log","kind":13},{"definition":"my","line":537,"name":"$globalchain","containerName":"review_log","kind":13,"localvar":"my"},{"name":"$self","line":537,"containerName":"review_log","kind":13},{"name":"$args","definition":"my","line":538,"localvar":"my","kind":13,"containerName":"review_log"},{"line":542,"containerName":"review_log","kind":13,"name":"$logger"},{"line":542,"kind":12,"containerName":"review_log","name":"debug"},{"line":543,"kind":13,"containerName":"review_log","name":"$self"},{"kind":12,"line":543,"containerName":"review_log","name":"iptablesqueue_enqueue"},{"name":"$args","containerName":"review_log","line":543,"kind":13},{"line":546,"kind":13,"containerName":"review_log","name":"$self"},{"line":546,"kind":12,"containerName":"review_log","name":"add_logger_allow_deny_ips"},{"containerName":"review_log","line":546,"kind":13,"name":"$logobj"},{"localvar":"my","containerName":"review_log","kind":13,"name":"@directions","line":549,"definition":"my"},{"name":"$logobj","line":549,"kind":13,"containerName":"review_log"},{"name":"@directions","kind":13,"line":551,"containerName":"review_log"},{"kind":13,"line":552,"containerName":"review_log","name":"$logger"},{"name":"debug","line":552,"kind":12,"containerName":"review_log"},{"kind":13,"line":555,"containerName":"review_log","name":"$logger"},{"containerName":"review_log","line":555,"kind":12,"name":"warn"},{"line":556,"kind":13,"containerName":"review_log","name":"@directions"},{"line":558,"definition":"my","name":"@protocols","containerName":"review_log","kind":13,"localvar":"my"},{"name":"$logobj","line":558,"containerName":"review_log","kind":13},{"localvar":"my","containerName":"review_log","kind":13,"name":"$ports","definition":"my","line":560},{"line":560,"kind":13,"containerName":"review_log","name":"$logobj"},{"name":"$cycles","kind":13,"line":562,"containerName":"review_log"},{"name":"$start_loop_time","line":563,"definition":"my","localvar":"my","containerName":"review_log","kind":13},{"line":564,"containerName":"review_log","kind":13,"name":"$logger"},{"line":564,"containerName":"review_log","kind":12,"name":"info"},{"name":"$logobj","line":565,"kind":13,"containerName":"review_log"},{"name":"$self","containerName":"review_log","line":565,"kind":13},{"line":565,"kind":12,"containerName":"review_log","name":"readlogfile"},{"line":565,"containerName":"review_log","kind":13,"name":"$logobj"},{"name":"$logobj","kind":13,"line":566,"containerName":"review_log"},{"kind":13,"line":566,"containerName":"review_log","name":"$self"},{"containerName":"review_log","line":566,"kind":12,"name":"_grep_regexps"},{"name":"$logobj","line":566,"containerName":"review_log","kind":13},{"name":"$logobj","kind":13,"line":566,"containerName":"review_log"},{"kind":13,"line":567,"containerName":"review_log","name":"$logobj"},{"line":567,"kind":13,"containerName":"review_log","name":"$self"},{"line":567,"containerName":"review_log","kind":12,"name":"clean_ips_to_block_allowdeny"},{"name":"$logobj","kind":13,"line":567,"containerName":"review_log"},{"containerName":"review_log","line":570,"kind":13,"name":"$logger"},{"name":"debug","line":570,"kind":12,"containerName":"review_log"},{"kind":13,"line":570,"containerName":"review_log","name":"$logobj"},{"name":"$logger","containerName":"review_log","line":570,"kind":13},{"name":"is_debug","line":570,"containerName":"review_log","kind":12},{"kind":13,"containerName":"review_log","localvar":"my","definition":"my","line":572,"name":"@rules"},{"name":"$ip","definition":"my","line":573,"localvar":"my","kind":13,"containerName":"review_log"},{"line":573,"containerName":"review_log","kind":13,"name":"$logobj"},{"localvar":"my","containerName":"review_log","kind":13,"name":"$rule","line":574,"definition":"my"},{"name":"$logger","kind":13,"line":575,"containerName":"review_log"},{"name":"debug","line":575,"containerName":"review_log","kind":12},{"localvar":"my","kind":13,"containerName":"review_log","name":"$direction","definition":"my","line":576},{"kind":13,"line":576,"containerName":"review_log","name":"@directions"},{"name":"$rule","line":577,"containerName":"review_log","kind":13},{"containerName":"review_log","line":577,"kind":13,"name":"$direction"},{"name":"$rule","kind":13,"line":578,"containerName":"review_log"},{"line":578,"kind":13,"containerName":"review_log","name":"$direction"},{"name":"$logger","line":579,"kind":13,"containerName":"review_log"},{"line":579,"kind":12,"containerName":"review_log","name":"warn"},{"name":"$rule","containerName":"review_log","line":579,"kind":13},{"line":581,"definition":"my","name":"$protocol","kind":13,"containerName":"review_log","localvar":"my"},{"line":581,"containerName":"review_log","kind":13,"name":"$logobj"},{"name":"$rule","kind":13,"line":582,"containerName":"review_log"},{"name":"$rule","line":583,"containerName":"review_log","kind":13},{"name":"$logobj","line":583,"containerName":"review_log","kind":13},{"name":"$direction","line":583,"containerName":"review_log","kind":13},{"name":"$rule","line":584,"kind":13,"containerName":"review_log"},{"containerName":"review_log","line":584,"kind":13,"name":"$logobj"},{"name":"$direction","line":584,"kind":13,"containerName":"review_log"},{"line":585,"kind":13,"containerName":"review_log","name":"@rules"},{"name":"$rule","line":585,"kind":13,"containerName":"review_log"},{"name":"@rules","line":590,"containerName":"review_log","kind":13},{"name":"@rules","containerName":"review_log","line":590,"kind":13},{"name":"$rule","line":592,"definition":"my","localvar":"my","containerName":"review_log","kind":13},{"name":"@rules","line":592,"kind":13,"containerName":"review_log"},{"localvar":"my","containerName":"review_log","kind":13,"name":"$args","definition":"my","line":593},{"kind":13,"line":597,"containerName":"review_log","name":"$logger"},{"line":597,"kind":12,"containerName":"review_log","name":"debug"},{"containerName":"review_log","line":598,"kind":13,"name":"$self"},{"name":"iptablesqueue_enqueue","line":598,"containerName":"review_log","kind":12},{"name":"$args","kind":13,"line":598,"containerName":"review_log"},{"kind":13,"line":618,"containerName":"review_log","name":"$cycles"},{"line":619,"kind":13,"containerName":"review_log","name":"$logger"},{"name":"info","line":619,"containerName":"review_log","kind":12},{"line":620,"kind":13,"containerName":"review_log","name":"$microcyclesleep"}],"range":{"start":{"character":0,"line":509},"end":{"line":621,"character":9999}}},{"name":"threads","line":514,"kind":12},{"line":517,"kind":12,"name":"configs"},{"name":"chainprefix","line":517,"kind":12},{"kind":12,"line":517,"name":"chain"},{"name":"Dumper","line":520,"kind":12},{"name":"cycles","line":523,"kind":12},{"kind":12,"line":523,"name":"configs"},{"name":"cycles","kind":12,"line":523},{"name":"LONG_MAX","kind":12,"line":523},{"name":"cycles","kind":12,"line":524},{"name":"cyclesleep","line":525,"kind":12},{"kind":12,"line":525,"name":"configs"},{"line":525,"kind":12,"name":"cyclesleep"},{"kind":12,"line":526,"name":"cyclesleep"},{"name":"configs","line":537,"kind":12},{"kind":12,"line":537,"name":"globalchain"},{"name":"options","line":539,"kind":12},{"line":540,"kind":12,"name":"rule"},{"line":549,"kind":12,"name":"directions"},{"name":"any","kind":12,"line":551},{"line":558,"kind":12,"name":"protocols"},{"line":560,"kind":12,"name":"ports"},{"line":566,"kind":12,"name":"ips_to_block"},{"name":"logcontents","kind":12,"line":566},{"name":"Dumper","line":570,"kind":12},{"name":"ips_to_block","kind":12,"line":570},{"line":573,"kind":12,"name":"ips_to_block"},{"line":581,"kind":12,"name":"protocols"},{"line":583,"kind":12,"name":"ports"},{"line":584,"kind":12,"name":"ports"},{"name":"options","kind":12,"line":594},{"name":"rule","line":595,"kind":12},{"kind":12,"line":620,"name":"usleep"},{"line":623,"definition":"my","name":"$logmsg","containerName":null,"kind":13,"localvar":"my"},{"line":624,"kind":13,"containerName":null,"name":"$logmsg"},{"line":624,"containerName":null,"kind":13,"name":"$start_time"},{"name":"$logger","containerName":null,"line":625,"kind":13},{"kind":12,"line":625,"containerName":"main::","name":"info"},{"name":"iptables_ipblock_commands","line":631,"detail":"()","definition":"sub","range":{"end":{"character":9999,"line":655},"start":{"line":631,"character":0}},"signature":{"parameters":[],"documentation":" Description: takes the ips_to_block, ports, and protocols and creates the iptables commands to run\n Returns a hash of iptables commands to run","label":"iptables_ipblock_commands()"},"kind":12,"containerName":"main::","children":[{"definition":"my","line":632,"name":"$self","kind":13,"containerName":"iptables_ipblock_commands","localvar":"my"},{"localvar":"my","containerName":"iptables_ipblock_commands","kind":13,"name":"$logobj","line":633,"definition":"my"},{"line":635,"definition":"my","name":"$TID","kind":13,"containerName":"iptables_ipblock_commands","localvar":"my"},{"name":"tid","containerName":"iptables_ipblock_commands","line":635,"kind":12},{"kind":13,"line":636,"containerName":"iptables_ipblock_commands","name":"$TID"},{"name":"$TID","containerName":"iptables_ipblock_commands","line":636,"kind":13},{"containerName":"iptables_ipblock_commands","line":638,"kind":13,"name":"$logobj"},{"line":642,"definition":"my","name":"$iptables_commands","containerName":"iptables_ipblock_commands","kind":13,"localvar":"my"},{"name":"$ips_to_block","line":654,"definition":"my","localvar":"my","kind":13,"containerName":"iptables_ipblock_commands"},{"name":"$logobj","line":654,"containerName":"iptables_ipblock_commands","kind":13},{"name":"$chain","definition":"my","line":655,"localvar":"my","kind":13,"containerName":"iptables_ipblock_commands"},{"line":655,"kind":13,"containerName":"iptables_ipblock_commands","name":"$ips_to_block"}]},{"name":"threads","kind":12,"line":635},{"line":654,"kind":12,"name":"ips_to_block"},{"name":"$ip","definition":"my","line":656,"localvar":"my","containerName":null,"kind":13},{"name":"%ips_to_block","line":656,"containerName":null,"kind":13},{"containerName":null,"line":656,"kind":13,"name":"%chain"},{"line":657,"definition":"my","name":"$port","containerName":null,"kind":13,"localvar":"my"},{"name":"%ips_to_block","kind":13,"line":657,"containerName":null},{"kind":13,"line":657,"containerName":null,"name":"%chain"},{"name":"%ip","containerName":null,"line":657,"kind":13},{"name":"$protocol","line":658,"definition":"my","localvar":"my","kind":13,"containerName":null},{"kind":13,"line":658,"containerName":null,"name":"%ips_to_block"},{"kind":13,"line":658,"containerName":null,"name":"%chain"},{"name":"%ip","kind":13,"line":658,"containerName":null},{"name":"%port","line":658,"kind":13,"containerName":null},{"localvar":"my","containerName":null,"kind":13,"name":"$iptables_command","line":659,"definition":"my"},{"containerName":null,"line":659,"kind":13,"name":"%self"},{"name":"iptables_command","line":659,"kind":12},{"kind":13,"line":660,"containerName":null,"name":"$iptables_command"},{"containerName":null,"line":661,"kind":13,"name":"$iptables_command"},{"name":"$iptables_command","kind":13,"line":662,"containerName":null},{"line":663,"containerName":null,"kind":13,"name":"$iptables_command"},{"line":664,"kind":13,"containerName":null,"name":"%iptables_commands"},{"name":"%chain","line":664,"containerName":null,"kind":13},{"name":"%ip","line":664,"containerName":null,"kind":13},{"name":"%port","line":664,"containerName":null,"kind":13},{"containerName":null,"line":664,"kind":13,"name":"$protocol"},{"line":664,"kind":13,"containerName":null,"name":"$iptables_command"},{"name":"$logger","line":670,"kind":13,"containerName":null},{"name":"debug","line":670,"containerName":"main::","kind":12},{"line":670,"kind":12,"name":"Dumper"},{"name":"$iptables_commands","line":670,"containerName":null,"kind":13},{"name":"$logger","line":670,"containerName":null,"kind":13},{"containerName":"main::","line":670,"kind":12,"name":"is_debug"},{"name":"$iptables_commands","containerName":null,"line":672,"kind":13},{"children":[{"name":"$self","line":677,"definition":"my","localvar":"my","containerName":"load_configs","kind":13},{"containerName":"load_configs","kind":13,"localvar":"my","definition":"my","line":678,"name":"$configsfile"},{"name":"$self","line":678,"containerName":"load_configs","kind":13},{"localvar":"my","kind":13,"containerName":"load_configs","name":"$clargs","definition":"my","line":679},{"name":"$self","line":679,"kind":13,"containerName":"load_configs"},{"containerName":"load_configs","line":681,"kind":13,"name":"$configsfile"},{"name":"$self","containerName":"load_configs","line":684,"kind":13},{"line":684,"containerName":"load_configs","kind":13,"name":"$self"},{"line":685,"containerName":"load_configs","kind":13,"name":"$self"},{"name":"$self","kind":13,"line":685,"containerName":"load_configs"},{"kind":13,"line":686,"containerName":"load_configs","name":"$self"},{"localvar":"my","kind":13,"containerName":"load_configs","name":"$msg","line":691,"definition":"my"},{"line":692,"containerName":"load_configs","kind":13,"name":"$msg"},{"name":"$msg","containerName":"load_configs","line":693,"kind":13},{"line":693,"containerName":"load_configs","kind":13,"name":"$clargs"},{"containerName":"load_configs","line":694,"kind":13,"name":"$msg"},{"line":694,"kind":13,"containerName":"load_configs","name":"$DEFAULTS"},{"name":"$msg","line":695,"kind":13,"containerName":"load_configs"},{"line":696,"containerName":"load_configs","kind":13,"name":"$msg"},{"line":697,"kind":13,"containerName":"load_configs","name":"$msg"},{"name":"$config","definition":"my","line":700,"localvar":"my","kind":13,"containerName":"load_configs"},{"containerName":"load_configs","line":700,"kind":13,"name":"$DEFAULTS"}],"containerName":"main::","kind":12,"range":{"end":{"character":9999,"line":700},"start":{"line":676,"character":0}},"definition":"sub","line":676,"name":"load_configs"},{"name":"configsfile","kind":12,"line":678},{"kind":12,"line":679,"name":"clargs"},{"kind":12,"line":684,"name":"configs"},{"name":"Config","line":684,"kind":12,"containerName":"File::read_config_file"},{"name":"configsfile","line":684,"kind":12},{"name":"configs","kind":12,"line":685},{"line":685,"kind":12,"name":"globalchain"},{"name":"configs","line":685,"kind":12},{"name":"globalchain","kind":12,"line":685},{"line":686,"kind":12,"name":"configs"},{"name":"globalchain","line":686,"kind":12},{"line":693,"kind":12,"name":"Dumper"},{"name":"Dumper","kind":12,"line":694},{"name":"carp","line":696,"kind":12},{"name":"%self","line":704,"kind":13,"containerName":null},{"line":704,"kind":12,"name":"configs"},{"name":"$config","kind":13,"line":704,"containerName":null},{"kind":13,"line":705,"containerName":null,"name":"%clargs"},{"name":"$config","kind":13,"line":705,"containerName":null},{"name":"%clargs","containerName":null,"line":706,"kind":13},{"name":"$config","line":706,"kind":13,"containerName":null},{"name":"%self","containerName":null,"line":707,"kind":13},{"name":"configs","line":707,"kind":12},{"line":707,"kind":13,"containerName":null,"name":"$config"},{"name":"%DEFAULTS","line":707,"containerName":null,"kind":13},{"containerName":null,"line":707,"kind":13,"name":"$config"},{"name":"%self","kind":13,"line":710,"containerName":null},{"line":710,"kind":12,"name":"configs"},{"name":"reverseMapHash","line":714,"definition":"sub","detail":"()","range":{"end":{"line":721,"character":9999},"start":{"line":714,"character":0}},"signature":{"label":"reverseMapHash()","parameters":[],"documentation":" Special helper function for clean_ips_to_block()"},"containerName":"main::","kind":12,"children":[{"name":"$self","definition":"my","line":715,"localvar":"my","containerName":"reverseMapHash","kind":13},{"line":716,"definition":"my","name":"$hash","kind":13,"containerName":"reverseMapHash","localvar":"my"},{"line":720,"definition":"my","name":"$new_hash","containerName":"reverseMapHash","kind":13,"localvar":"my"},{"name":"$key","line":721,"definition":"my","localvar":"my","kind":13,"containerName":"reverseMapHash"},{"line":721,"kind":13,"containerName":"reverseMapHash","name":"$hash"}]},{"line":722,"kind":13,"containerName":null,"name":"%new_hash"},{"kind":13,"line":722,"containerName":null,"name":"%hash"},{"name":"$key","line":722,"containerName":null,"kind":13},{"kind":13,"line":726,"containerName":null,"name":"$new_hash"},{"name":"clean_ips_to_block_combined","definition":"sub","detail":"()","line":731,"range":{"start":{"character":0,"line":731},"end":{"line":740,"character":9999}},"children":[{"line":732,"definition":"my","name":"$self","containerName":"clean_ips_to_block_combined","kind":13,"localvar":"my"},{"localvar":"my","containerName":"clean_ips_to_block_combined","kind":13,"name":"$logobj","definition":"my","line":733},{"line":734,"definition":"my","name":"$TID","kind":13,"containerName":"clean_ips_to_block_combined","localvar":"my"},{"name":"tid","line":734,"containerName":"clean_ips_to_block_combined","kind":12},{"containerName":"clean_ips_to_block_combined","line":735,"kind":13,"name":"$TID"},{"line":735,"kind":13,"containerName":"clean_ips_to_block_combined","name":"$TID"},{"kind":13,"line":737,"containerName":"clean_ips_to_block_combined","name":"$Data"},{"line":738,"containerName":"clean_ips_to_block_combined","kind":13,"name":"$Data"}],"containerName":"main::","signature":{"documentation":" Description: Combines the IPs from regex from the log to be blocked and the IPs from the allow/deny lists into\n               one hash","parameters":[],"label":"clean_ips_to_block_combined()"},"kind":12},{"kind":12,"line":734,"name":"threads"},{"line":737,"containerName":"Terse","kind":12,"name":"Dumper"},{"line":738,"kind":12,"containerName":"Indent","name":"Dumper"},{"line":745,"definition":"sub","detail":"()","name":"clean_ips_to_block_allowdeny","containerName":"main::","signature":{"label":"clean_ips_to_block_allowdeny()","parameters":[],"documentation":" Description: Returns the logobj with ips_to_block set with the IPs to block from the allow/deny lists\n   There is a lot of logging available in this sub.\n   This sub is called from review_log()"},"kind":12,"children":[{"localvar":"my","containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$self","definition":"my","line":746},{"name":"$logobj","line":747,"definition":"my","localvar":"my","containerName":"clean_ips_to_block_allowdeny","kind":13},{"name":"$TID","line":748,"definition":"my","localvar":"my","kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","line":748,"kind":12,"name":"tid"},{"line":749,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$TID"},{"kind":13,"line":749,"containerName":"clean_ips_to_block_allowdeny","name":"$TID"},{"name":"$Data","line":751,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"name":"$Data","line":752,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"localvar":"my","kind":13,"containerName":"clean_ips_to_block_allowdeny","name":"$allowdeny","definition":"my","line":756},{"kind":13,"line":756,"containerName":"clean_ips_to_block_allowdeny","name":"$logobj"},{"name":"$self","kind":13,"line":756,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"localvar":"my","line":757,"definition":"my","name":"$logobj_allowlist"},{"kind":13,"line":757,"containerName":"clean_ips_to_block_allowdeny","name":"$logobj"},{"name":"$self","containerName":"clean_ips_to_block_allowdeny","line":757,"kind":13},{"name":"$logobj_denylist","definition":"my","line":758,"localvar":"my","kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$logobj","kind":13,"line":758,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$self","line":758,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"localvar":"my","definition":"my","line":759,"name":"$global_denylist"},{"name":"$self","containerName":"clean_ips_to_block_allowdeny","line":759,"kind":13},{"line":760,"definition":"my","name":"$global_allowlist","containerName":"clean_ips_to_block_allowdeny","kind":13,"localvar":"my"},{"name":"$self","kind":13,"line":760,"containerName":"clean_ips_to_block_allowdeny"},{"definition":"my","line":762,"name":"$ips_to_block","kind":13,"containerName":"clean_ips_to_block_allowdeny","localvar":"my"},{"name":"$logobj","line":762,"kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$logobj_allowlist","line":765,"kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"kind":13,"line":765,"containerName":"clean_ips_to_block_allowdeny","name":"$self"},{"line":765,"kind":12,"containerName":"clean_ips_to_block_allowdeny","name":"reverseMapHash"},{"name":"$logobj_allowlist","kind":13,"line":765,"containerName":"clean_ips_to_block_allowdeny"},{"line":766,"kind":13,"containerName":"clean_ips_to_block_allowdeny","name":"$logobj_denylist"},{"name":"$self","containerName":"clean_ips_to_block_allowdeny","line":766,"kind":13},{"line":766,"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"reverseMapHash"},{"line":766,"kind":13,"containerName":"clean_ips_to_block_allowdeny","name":"$logobj_denylist"},{"name":"$global_allowlist","line":767,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"name":"$self","containerName":"clean_ips_to_block_allowdeny","line":767,"kind":13},{"line":767,"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"reverseMapHash"},{"kind":13,"line":767,"containerName":"clean_ips_to_block_allowdeny","name":"$global_allowlist"},{"kind":13,"line":768,"containerName":"clean_ips_to_block_allowdeny","name":"$global_denylist"},{"name":"$self","line":768,"kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"name":"reverseMapHash","line":768,"containerName":"clean_ips_to_block_allowdeny","kind":12},{"name":"$global_denylist","line":768,"kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","line":771,"kind":13,"name":"$logger"},{"containerName":"clean_ips_to_block_allowdeny","line":771,"kind":12,"name":"info"},{"name":"$logger","kind":13,"line":772,"containerName":"clean_ips_to_block_allowdeny"},{"kind":12,"line":772,"containerName":"clean_ips_to_block_allowdeny","name":"debug"},{"name":"$logobj_allowlist","line":772,"kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"line":772,"kind":13,"containerName":"clean_ips_to_block_allowdeny","name":"$logger"},{"kind":12,"line":772,"containerName":"clean_ips_to_block_allowdeny","name":"is_debug"},{"containerName":"clean_ips_to_block_allowdeny","line":773,"kind":13,"name":"$logger"},{"name":"debug","kind":12,"line":773,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$logobj_denylist","kind":13,"line":773,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$logger","line":773,"kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"line":773,"kind":12,"containerName":"clean_ips_to_block_allowdeny","name":"is_debug"},{"line":774,"kind":13,"containerName":"clean_ips_to_block_allowdeny","name":"$logger"},{"name":"debug","kind":12,"line":774,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","line":774,"kind":13,"name":"$ips_to_block"},{"containerName":"clean_ips_to_block_allowdeny","line":774,"kind":13,"name":"$logger"},{"kind":12,"line":774,"containerName":"clean_ips_to_block_allowdeny","name":"is_debug"},{"name":"$logger","containerName":"clean_ips_to_block_allowdeny","line":775,"kind":13},{"name":"debug","kind":12,"line":775,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$global_allowlist","containerName":"clean_ips_to_block_allowdeny","line":775,"kind":13},{"name":"$logger","line":775,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"name":"is_debug","line":775,"kind":12,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$logger","line":776,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"containerName":"clean_ips_to_block_allowdeny","line":776,"kind":12,"name":"debug"},{"name":"$global_denylist","containerName":"clean_ips_to_block_allowdeny","line":776,"kind":13},{"kind":13,"line":776,"containerName":"clean_ips_to_block_allowdeny","name":"$logger"},{"name":"is_debug","kind":12,"line":776,"containerName":"clean_ips_to_block_allowdeny"},{"definition":"my","line":779,"name":"$allowlist","kind":13,"containerName":"clean_ips_to_block_allowdeny","localvar":"my"},{"name":"$global_allowlist","containerName":"clean_ips_to_block_allowdeny","line":779,"kind":13},{"name":"$logobj_allowlist","containerName":"clean_ips_to_block_allowdeny","line":779,"kind":13}],"range":{"start":{"line":745,"character":0},"end":{"line":779,"character":9999}}},{"kind":12,"line":748,"name":"threads"},{"name":"Dumper","kind":12,"line":751,"containerName":"Terse"},{"name":"Dumper","line":752,"containerName":"Indent","kind":12},{"name":"allowdeny","kind":12,"line":756},{"kind":12,"line":756,"name":"configs"},{"name":"allowdeny","line":756,"kind":12},{"line":757,"kind":12,"name":"allowlist"},{"name":"configs","line":757,"kind":12},{"name":"allowlist","kind":12,"line":757},{"line":758,"kind":12,"name":"denylist"},{"line":758,"kind":12,"name":"configs"},{"line":758,"kind":12,"name":"denylist"},{"name":"configs","line":759,"kind":12},{"line":759,"kind":12,"name":"denylist"},{"name":"configs","kind":12,"line":760},{"line":760,"kind":12,"name":"allowlist"},{"line":762,"kind":12,"name":"ips_to_block"},{"line":772,"kind":12,"name":"Dumper"},{"line":773,"kind":12,"name":"Dumper"},{"line":774,"kind":12,"name":"Dumper"},{"line":775,"kind":12,"name":"Dumper"},{"name":"Dumper","line":776,"kind":12},{"definition":"my","line":780,"name":"%denylist","kind":13,"containerName":null,"localvar":"my"},{"containerName":null,"line":780,"kind":13,"name":"$global_denylist"},{"containerName":null,"line":780,"kind":13,"name":"$logobj_denylist"},{"line":783,"kind":13,"containerName":null,"name":"$logger"},{"kind":12,"line":783,"containerName":"main::","name":"debug"},{"name":"Dumper","kind":12,"line":783},{"containerName":null,"line":783,"kind":13,"name":"$allowlist"},{"name":"$logger","kind":13,"line":783,"containerName":null},{"name":"is_debug","containerName":"main::","line":783,"kind":12},{"name":"$logger","containerName":null,"line":784,"kind":13},{"name":"debug","containerName":"main::","line":784,"kind":12},{"name":"Dumper","kind":12,"line":784},{"name":"$denylist","containerName":null,"line":784,"kind":13},{"kind":13,"line":784,"containerName":null,"name":"$logger"},{"kind":12,"line":784,"containerName":"main::","name":"is_debug"},{"line":787,"containerName":null,"kind":13,"name":"%denylist"},{"containerName":null,"line":787,"kind":13,"name":"$denylist"},{"containerName":null,"line":787,"kind":13,"name":"$ips_to_block"},{"name":"$logger","containerName":null,"line":790,"kind":13},{"kind":12,"line":790,"containerName":"main::","name":"debug"},{"kind":12,"line":790,"name":"Dumper"},{"name":"$denylist","line":790,"kind":13,"containerName":null},{"name":"$logger","line":790,"kind":13,"containerName":null},{"name":"is_debug","kind":12,"line":790,"containerName":"main::"},{"containerName":null,"line":794,"kind":13,"name":"%allowdeny"},{"line":795,"containerName":null,"kind":13,"name":"%logobj"},{"name":"ips_to_block","kind":12,"line":795},{"containerName":null,"line":795,"kind":13,"name":"$denylist"},{"kind":13,"line":796,"containerName":null,"name":"$logger"},{"name":"debug","containerName":"main::","line":796,"kind":12},{"line":796,"kind":12,"name":"Dumper"},{"name":"%logobj","kind":13,"line":796,"containerName":null},{"name":"ips_to_block","kind":12,"line":796},{"containerName":null,"line":797,"kind":13,"name":"$logger"},{"line":797,"containerName":"main::","kind":12,"name":"is_debug"},{"name":"%logobj","kind":13,"line":798,"containerName":null},{"containerName":null,"line":803,"kind":13,"name":"%denylist"},{"containerName":null,"line":803,"kind":13,"name":"$allowlist"},{"line":804,"kind":13,"containerName":null,"name":"%logobj"},{"name":"ips_to_block","kind":12,"line":804},{"kind":13,"line":804,"containerName":null,"name":"$denylist"},{"containerName":null,"line":805,"kind":13,"name":"$logger"},{"name":"debug","kind":12,"line":805,"containerName":"main::"},{"line":805,"kind":12,"name":"Dumper"},{"line":805,"kind":13,"containerName":null,"name":"%logobj"},{"name":"ips_to_block","kind":12,"line":805},{"containerName":null,"line":806,"kind":13,"name":"$logger"},{"name":"is_debug","line":806,"kind":12,"containerName":"main::"},{"kind":13,"line":807,"containerName":null,"name":"$logobj"},{"line":826,"detail":"()","definition":"sub","name":"run_iptables","signature":{"label":"run_iptables()","documentation":" Runs whatever parameters are passed to it against iptables\n  This is intended to be a one stop shop for running iptables out from a queue.\n  However, there are a few instances where it is called directly... especially when creating chains\n   This hopefully prevents excessive wait/locking on iptables\n   and helps to keep commands running in the order they are received.\n Arguments must be passed as a hash reference with (so far) the following keys:\n   rule:  The rule to run\n   options:  Any options to pass to iptables\n  Where it is ran like this:\n   iptables $options $rule 2>&1\n Future enhancement:\n   1. delete existing rule if it exists\n Take note this sub is intended (but not required) to be called from sub iptables_thread()\n  An error will happen if not called from sub iptables_thread(), but it will not stop the program\n  This is to encourage using the iptablesqueue_enqueue() sub instead of run_iptables() directly\n  So, top say this more clearly, if you want to run iptables commands, then call iptablesqueue_enqueue()","parameters":[]},"kind":12,"containerName":"main::","children":[{"name":"$self","definition":"my","line":827,"localvar":"my","kind":13,"containerName":"run_iptables"},{"kind":13,"line":827,"containerName":"run_iptables","name":"$args"},{"definition":"my","line":828,"name":"@caller_lst","containerName":"run_iptables","kind":13,"localvar":"my"},{"name":"$caller_lst","containerName":"run_iptables","line":829,"kind":13},{"name":"$IPTABLESRUNLINE","line":829,"containerName":"run_iptables","kind":13},{"line":829,"kind":13,"containerName":"run_iptables","name":"$IPTABLESRUNLINE"},{"name":"$logmsg","line":830,"definition":"my","localvar":"my","kind":13,"containerName":"run_iptables"},{"name":"@caller_lst","kind":13,"line":831,"containerName":"run_iptables"},{"name":"$logger","line":836,"kind":13,"containerName":"run_iptables"},{"name":"error","kind":12,"line":836,"containerName":"run_iptables"},{"name":"$logmsg","line":836,"kind":13,"containerName":"run_iptables"},{"name":"$TID","definition":"my","line":838,"localvar":"my","kind":13,"containerName":"run_iptables"},{"name":"tid","line":838,"kind":12,"containerName":"run_iptables"},{"line":839,"containerName":"run_iptables","kind":13,"name":"$TID"},{"line":839,"containerName":"run_iptables","kind":13,"name":"$TID"},{"line":842,"kind":13,"containerName":"run_iptables","name":"$args"},{"name":"$logger","containerName":"run_iptables","line":842,"kind":13},{"line":842,"kind":12,"containerName":"run_iptables","name":"error"},{"name":"$self","containerName":"run_iptables","line":843,"kind":13},{"name":"$logger","kind":13,"line":843,"containerName":"run_iptables"},{"line":843,"kind":12,"containerName":"run_iptables","name":"error"},{"line":845,"definition":"my","name":"$iptables","kind":13,"containerName":"run_iptables","localvar":"my"},{"name":"$self","line":845,"kind":13,"containerName":"run_iptables"},{"kind":13,"containerName":"run_iptables","localvar":"my","definition":"my","line":846,"name":"$rule"},{"name":"$args","kind":13,"line":846,"containerName":"run_iptables"},{"name":"$options","definition":"my","line":847,"localvar":"my","containerName":"run_iptables","kind":13},{"containerName":"run_iptables","line":847,"kind":13,"name":"$args"},{"name":"$logger","line":849,"kind":13,"containerName":"run_iptables"},{"name":"is_debug","kind":12,"line":849,"containerName":"run_iptables"},{"containerName":"run_iptables","line":850,"kind":13,"name":"$logger"},{"containerName":"run_iptables","line":850,"kind":12,"name":"debug"},{"kind":13,"line":851,"containerName":"run_iptables","name":"$args"},{"name":"$args","line":859,"kind":13,"containerName":"run_iptables"},{"line":860,"definition":"my","name":"$allowdupes","kind":13,"containerName":"run_iptables","localvar":"my"},{"containerName":"run_iptables","line":860,"kind":13,"name":"$args"},{"name":"$allowdupes","line":862,"kind":13,"containerName":"run_iptables"},{"name":"$logger","line":863,"containerName":"run_iptables","kind":13},{"name":"debug","containerName":"run_iptables","line":863,"kind":12},{"line":864,"definition":"my","name":"$retval","kind":13,"containerName":"run_iptables","localvar":"my"},{"line":864,"kind":13,"containerName":"run_iptables","name":"$self"},{"name":"check_if_rule_exists","containerName":"run_iptables","line":864,"kind":12},{"line":864,"kind":13,"containerName":"run_iptables","name":"$args"},{"containerName":"run_iptables","line":865,"kind":13,"name":"$retval"},{"name":"$logger","line":869,"containerName":"run_iptables","kind":13},{"name":"debug","kind":12,"line":869,"containerName":"run_iptables"},{"containerName":"run_iptables","line":872,"kind":13,"name":"$retval"},{"containerName":"run_iptables","line":873,"kind":13,"name":"$logger"},{"line":873,"kind":12,"containerName":"run_iptables","name":"debug"},{"name":"$retval","containerName":"run_iptables","line":875,"kind":13},{"name":"$options","containerName":"run_iptables","line":876,"kind":13},{"name":"$logger","containerName":"run_iptables","line":879,"kind":13},{"name":"debug","containerName":"run_iptables","line":879,"kind":12},{"line":882,"containerName":"run_iptables","kind":13,"name":"$self"},{"line":882,"kind":13,"containerName":"run_iptables","name":"$rule"},{"name":"$retval","line":884,"kind":13,"containerName":"run_iptables"},{"kind":13,"line":885,"containerName":"run_iptables","name":"$logger"},{"name":"error","line":885,"kind":12,"containerName":"run_iptables"},{"name":"$retval","kind":13,"line":888,"containerName":"run_iptables"},{"line":889,"containerName":"run_iptables","kind":13,"name":"$logger"},{"kind":12,"line":889,"containerName":"run_iptables","name":"error"},{"line":893,"containerName":"run_iptables","kind":13,"name":"$logger"},{"name":"error","line":893,"containerName":"run_iptables","kind":12},{"containerName":"run_iptables","line":893,"kind":13,"name":"$retval"},{"name":"$command","definition":"my","line":898,"localvar":"my","containerName":"run_iptables","kind":13},{"containerName":"run_iptables","line":899,"kind":13,"name":"$self"},{"kind":13,"line":900,"containerName":"run_iptables","name":"$logger"},{"name":"debug","kind":12,"line":900,"containerName":"run_iptables"},{"line":901,"definition":"my","name":"$output","containerName":"run_iptables","kind":13,"localvar":"my"},{"kind":13,"line":902,"containerName":"run_iptables","name":"$logger"},{"name":"debug","line":902,"containerName":"run_iptables","kind":12},{"line":906,"kind":13,"containerName":"run_iptables","name":"$logger"},{"containerName":"run_iptables","line":906,"kind":12,"name":"info"},{"name":"$logger","line":911,"kind":13,"containerName":"run_iptables"},{"name":"error","line":911,"kind":12,"containerName":"run_iptables"}],"range":{"start":{"line":826,"character":0},"end":{"line":913,"character":9999}}},{"name":"Dumper","line":831,"kind":12},{"name":"threads","kind":12,"line":838},{"name":"rule","kind":12,"line":842},{"kind":12,"line":843,"name":"configs"},{"name":"iptables","line":843,"kind":12},{"line":845,"kind":12,"name":"configs"},{"name":"iptables","line":845,"kind":12},{"name":"rule","line":846,"kind":12},{"name":"options","line":847,"kind":12},{"kind":12,"line":851,"name":"Dumper"},{"name":"allowdupes","line":859,"kind":12},{"name":"allowdupes","line":860,"kind":12},{"name":"chains_created","line":882,"kind":12},{"line":899,"kind":12,"name":"configs"},{"line":899,"kind":12,"name":"PRODMODE"},{"line":916,"definition":"sub","detail":"()","name":"set_iptables_command","signature":{"documentation":" Maybe an unnecessary sub but maybe some better checks down the road","parameters":[],"label":"set_iptables_command()"},"kind":12,"containerName":"main::","children":[{"name":"$self","definition":"my","line":917,"localvar":"my","containerName":"set_iptables_command","kind":13},{"name":"$self","containerName":"set_iptables_command","line":920,"kind":13},{"name":"$self","line":921,"containerName":"set_iptables_command","kind":13},{"name":"$logger","line":922,"kind":13,"containerName":"set_iptables_command"},{"name":"info","line":922,"kind":12,"containerName":"set_iptables_command"}],"range":{"end":{"character":9999,"line":924},"start":{"line":916,"character":0}}},{"line":920,"kind":12,"name":"configs"},{"name":"iptables","kind":12,"line":920},{"name":"configs","line":921,"kind":12},{"name":"iptables","kind":12,"line":921},{"range":{"start":{"line":928,"character":0},"end":{"character":9999,"line":973}},"children":[{"containerName":"check_if_rule_exists","kind":13,"localvar":"my","definition":"my","line":929,"name":"$self"},{"containerName":"check_if_rule_exists","line":929,"kind":13,"name":"$args"},{"definition":"my","line":930,"name":"$TID","kind":13,"containerName":"check_if_rule_exists","localvar":"my"},{"line":930,"kind":12,"containerName":"check_if_rule_exists","name":"tid"},{"line":931,"containerName":"check_if_rule_exists","kind":13,"name":"$TID"},{"name":"$TID","line":931,"kind":13,"containerName":"check_if_rule_exists"},{"name":"$args","line":934,"kind":13,"containerName":"check_if_rule_exists"},{"line":934,"containerName":"check_if_rule_exists","kind":13,"name":"$self"},{"name":"log_and_return","line":934,"containerName":"check_if_rule_exists","kind":12},{"name":"$self","kind":13,"line":935,"containerName":"check_if_rule_exists"},{"name":"$logger","kind":13,"line":935,"containerName":"check_if_rule_exists"},{"line":935,"containerName":"check_if_rule_exists","kind":12,"name":"error"},{"line":937,"definition":"my","name":"$iptables","kind":13,"containerName":"check_if_rule_exists","localvar":"my"},{"name":"$self","line":937,"kind":13,"containerName":"check_if_rule_exists"},{"localvar":"my","kind":13,"containerName":"check_if_rule_exists","name":"$rule","definition":"my","line":938},{"name":"$args","kind":13,"line":938,"containerName":"check_if_rule_exists"},{"definition":"my","line":939,"name":"$options","kind":13,"containerName":"check_if_rule_exists","localvar":"my"},{"name":"$args","line":939,"kind":13,"containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","line":941,"kind":13,"name":"$options"},{"localvar":"my","containerName":"check_if_rule_exists","kind":13,"name":"$logmsg","definition":"my","line":942},{"containerName":"check_if_rule_exists","line":943,"kind":13,"name":"$logmsg"},{"containerName":"check_if_rule_exists","line":944,"kind":13,"name":"$logger"},{"name":"debug","line":944,"kind":12,"containerName":"check_if_rule_exists"},{"kind":13,"line":944,"containerName":"check_if_rule_exists","name":"$logmsg"},{"name":"$checkrule_result","definition":"my","line":948,"localvar":"my","containerName":"check_if_rule_exists","kind":13},{"line":950,"kind":13,"containerName":"check_if_rule_exists","name":"$logger"},{"name":"debug","containerName":"check_if_rule_exists","line":950,"kind":12},{"name":"$checkrule_result","line":954,"containerName":"check_if_rule_exists","kind":13},{"line":955,"kind":13,"containerName":"check_if_rule_exists","name":"$logger"},{"kind":12,"line":955,"containerName":"check_if_rule_exists","name":"debug"},{"name":"$logger","line":956,"kind":13,"containerName":"check_if_rule_exists"},{"name":"debug","line":956,"kind":12,"containerName":"check_if_rule_exists"},{"line":960,"kind":13,"containerName":"check_if_rule_exists","name":"$checkrule_result"},{"name":"$logger","line":961,"kind":13,"containerName":"check_if_rule_exists"},{"name":"debug","line":961,"kind":12,"containerName":"check_if_rule_exists"},{"name":"$logger","kind":13,"line":962,"containerName":"check_if_rule_exists"},{"line":962,"kind":12,"containerName":"check_if_rule_exists","name":"debug"},{"name":"$checkrule_result","containerName":"check_if_rule_exists","line":966,"kind":13},{"name":"$logger","kind":13,"line":967,"containerName":"check_if_rule_exists"},{"name":"debug","containerName":"check_if_rule_exists","line":967,"kind":12},{"name":"$logger","kind":13,"line":968,"containerName":"check_if_rule_exists"},{"name":"debug","kind":12,"line":968,"containerName":"check_if_rule_exists"},{"line":972,"kind":13,"containerName":"check_if_rule_exists","name":"$self"},{"name":"log_and_return","line":972,"kind":12,"containerName":"check_if_rule_exists"}],"signature":{"label":"check_if_rule_exists($self,$args)","parameters":[{"label":"$self"},{"label":"$args"}],"documentation":"# Returns 0 if there is an unknown return value from running iptables\n#          Otherwise returns a string"},"kind":12,"containerName":"main::","name":"check_if_rule_exists","detail":"($self,$args)","definition":"sub","line":928},{"kind":12,"line":930,"name":"threads"},{"line":934,"kind":12,"name":"rule"},{"name":"configs","line":935,"kind":12},{"name":"iptables","line":935,"kind":12},{"name":"configs","kind":12,"line":937},{"name":"iptables","kind":12,"line":937},{"line":938,"kind":12,"name":"rule"},{"kind":12,"line":939,"name":"options"},{"containerName":"main::","signature":{"parameters":[{"label":"$self"},{"label":"$error_message"}],"documentation":"","label":"log_and_return($self,$error_message)"},"kind":12,"children":[{"definition":"my","line":976,"name":"$self","kind":13,"containerName":"log_and_return","localvar":"my"},{"line":976,"kind":13,"containerName":"log_and_return","name":"$error_message"},{"line":977,"definition":"my","name":"$TID","containerName":"log_and_return","kind":13,"localvar":"my"},{"kind":12,"line":977,"containerName":"log_and_return","name":"tid"},{"line":978,"kind":13,"containerName":"log_and_return","name":"$TID"},{"name":"$TID","line":978,"kind":13,"containerName":"log_and_return"},{"containerName":"log_and_return","line":979,"kind":13,"name":"$logger"},{"line":979,"containerName":"log_and_return","kind":12,"name":"error"},{"line":979,"kind":13,"containerName":"log_and_return","name":"$error_message"}],"range":{"start":{"character":0,"line":975},"end":{"character":9999,"line":981}},"line":975,"definition":"sub","detail":"($self,$error_message)","name":"log_and_return"},{"kind":12,"line":977,"name":"threads"},{"detail":"()","definition":"sub","line":990,"name":"add_global_chain","children":[{"line":991,"definition":"my","name":"$self","kind":13,"containerName":"add_global_chain","localvar":"my"},{"line":992,"definition":"my","name":"$TID","containerName":"add_global_chain","kind":13,"localvar":"my"},{"name":"tid","containerName":"add_global_chain","line":992,"kind":12},{"kind":13,"line":993,"containerName":"add_global_chain","name":"$TID"},{"kind":13,"line":993,"containerName":"add_global_chain","name":"$TID"},{"localvar":"my","kind":13,"containerName":"add_global_chain","name":"$chain","definition":"my","line":995},{"line":995,"kind":13,"containerName":"add_global_chain","name":"$self"},{"name":"$logger","containerName":"add_global_chain","line":995,"kind":13},{"line":995,"kind":12,"containerName":"add_global_chain","name":"logdie"},{"name":"$chain","line":996,"containerName":"add_global_chain","kind":13},{"line":996,"kind":13,"containerName":"add_global_chain","name":"$chain"},{"localvar":"my","containerName":"add_global_chain","kind":13,"name":"$globalchains_str","line":998,"definition":"my"},{"line":998,"containerName":"add_global_chain","kind":13,"name":"$self"},{"name":"$logger","line":998,"kind":13,"containerName":"add_global_chain"},{"kind":12,"line":998,"containerName":"add_global_chain","name":"logdie"},{"definition":"my","line":999,"name":"@globalchains","containerName":"add_global_chain","kind":13,"localvar":"my"},{"name":"$globalchains_str","line":999,"containerName":"add_global_chain","kind":13},{"name":"$logger","line":1001,"kind":13,"containerName":"add_global_chain"},{"name":"info","containerName":"add_global_chain","line":1001,"kind":12},{"definition":"my","line":1002,"name":"$args","containerName":"add_global_chain","kind":13,"localvar":"my"},{"name":"$self","containerName":"add_global_chain","line":1006,"kind":13},{"name":"iptablesqueue_enqueue","kind":12,"line":1006,"containerName":"add_global_chain"},{"kind":13,"line":1006,"containerName":"add_global_chain","name":"$args"},{"name":"$logger","containerName":"add_global_chain","line":1008,"kind":13},{"name":"info","kind":12,"line":1008,"containerName":"add_global_chain"},{"definition":"my","line":1009,"name":"$table","kind":13,"containerName":"add_global_chain","localvar":"my"},{"name":"@globalchains","line":1009,"containerName":"add_global_chain","kind":13},{"containerName":"add_global_chain","kind":13,"localvar":"my","definition":"my","line":1010,"name":"$args"},{"kind":13,"line":1014,"containerName":"add_global_chain","name":"$self"},{"line":1014,"kind":12,"containerName":"add_global_chain","name":"iptablesqueue_enqueue"},{"name":"$args","kind":13,"line":1014,"containerName":"add_global_chain"}],"kind":12,"signature":{"label":"add_global_chain()","documentation":" Description: Creates the global chain and then adds a jump rule to the global chains.\n           With default values this means creating the global chain \"IPBLOCKER_glopbal\" and then\n           adding a jump rule to the INPUT, OUTPUT, and FORWARD tables to go to IPBLOCKER_global\n Dies if no chain prefix is set or if no global chains are set\n    Bassically, this dies if it is not called as class or correct configs are not set\n Returns 1 always","parameters":[]},"containerName":"main::","range":{"start":{"line":990,"character":0},"end":{"line":1018,"character":9999}}},{"name":"threads","line":992,"kind":12},{"line":995,"kind":12,"name":"configs"},{"kind":12,"line":995,"name":"chainprefix"},{"name":"configs","line":998,"kind":12},{"kind":12,"line":998,"name":"globalchains"},{"kind":12,"line":1003,"name":"options"},{"name":"rule","line":1004,"kind":12},{"kind":12,"line":1011,"name":"options"},{"name":"rule","kind":12,"line":1012},{"range":{"end":{"line":1099,"character":9999},"start":{"line":1092,"character":0}},"signature":{"label":"iptablesqueue_enqueue()","parameters":[],"documentation":" # This is a one time event to add the global chains to the INPUT and OUTPUT chains\n #   This is only called once when the module is first run\n #   This is only called if the global rules do not exist\n sub add_global_chains_to_input_output() {\n     my $self = shift;\n     # The order in which the global chains are added to the default chains\n     my @allowdenyorder = qw / ipblocker_globalallow ipblocker_globaldeny /;\n     # User chains setup from config if that exists, otherwise set to default values\n     ## No checking of the chains to use as this is at user descretion\n     my @builtinchains = qw / INPUT OUTPUT FORWARD /;\n     if ( ref $self->{configs}->{globalchains} eq 'ARRAY' ) {\n         @builtinchains = @{ $self->{configs}->{globalchains} };\n     }\n     # if allow deny is set to Deny,Allow then change the order of the global chains\n     $self->{configs}->{allowdeny} ||= 'Allow,Deny';\n     @allowdenyorder = reverse @allowdenyorder if $self->{configs}->{allowdeny} eq 'Deny,Allow';\n     # Create new chains and new rules if they do not exist\n     for my $newchain (@allowdenyorder) {\n         # Enqueue new chain to be added to iptables\n         $IptablesQueue->enqueue(\n             {\n                 options => qq/-w -N/,\n                 rule    => qq/$newchain/\n             }\n         );\n         for my $builtinchain (@builtinchains) {\n             my $arguments = qq/$builtinchain -j $newchain/;\n             # Add new rule to the default chain\n             #   This will make the default chain jump to the new chain\n             # Example: iptables -w -A INPUT -j ipblocker_globalallow\n             $IptablesQueue->enqueue(\n                 {\n                     options        => qq/-w -A/,\n                     rule           => qq/$arguments/,\n                     allowdupes     => 0,\n                     deleteexisting => 1\n                 }\n             );\n         } ## end for my $builtinchain (@builtinchains)\n     } ## end for my $newchain (@allowdenyorder)\n     return 1;\n } ## end sub add_global_chains_to_input_output\n Create iptables chain\n sub create_iptables_chain() {\n     my ( $self, $name ) = @_;\n     my $TID = threads->tid;\n     $logger->info(\"TID: $TID|Trying to create iptables chain >>$name<<\");\n     # if ( $name =~\n     #     m/^(ipblocker_global|ipblocker_globalallow|ipblocker_globaldeny|ipblocker_globalregexdeny|ipblocker_globalregexallow)$/ )\n     # {\n     #     $logger->error(\"TID: $TID|Chain name >>$name<< is a reserved name and cannot be used\");\n     #     return 0;\n     # } ## end if ( $name =~ ...)\n     my $rule = \"$name\";\n     my $options = \"-w -N\";\n     my $args = { rule => $rule, options => $options };\n     # Never directly run \"run_iptables\" --- always add to the queue\n     $self->iptablesqueue_enqueue($args);\n     return 1;\n } ## end sub create_iptables_chain"},"kind":12,"containerName":"main::","children":[{"name":"$self","line":1093,"definition":"my","localvar":"my","containerName":"iptablesqueue_enqueue","kind":13},{"name":"$args","containerName":"iptablesqueue_enqueue","line":1093,"kind":13},{"kind":13,"containerName":"iptablesqueue_enqueue","localvar":"my","line":1094,"definition":"my","name":"$TID"},{"line":1094,"kind":12,"containerName":"iptablesqueue_enqueue","name":"tid"},{"name":"$TID","line":1095,"kind":13,"containerName":"iptablesqueue_enqueue"},{"containerName":"iptablesqueue_enqueue","line":1095,"kind":13,"name":"$TID"},{"name":"$logger","containerName":"iptablesqueue_enqueue","line":1096,"kind":13},{"name":"debug","kind":12,"line":1096,"containerName":"iptablesqueue_enqueue"},{"name":"$args","containerName":"iptablesqueue_enqueue","line":1096,"kind":13},{"kind":13,"line":1096,"containerName":"iptablesqueue_enqueue","name":"$logger"},{"name":"is_debug","line":1096,"kind":12,"containerName":"iptablesqueue_enqueue"},{"line":1097,"containerName":"iptablesqueue_enqueue","kind":13,"name":"$IptablesQueue"},{"kind":12,"line":1097,"containerName":"iptablesqueue_enqueue","name":"enqueue"},{"name":"$args","kind":13,"line":1097,"containerName":"iptablesqueue_enqueue"}],"name":"iptablesqueue_enqueue","line":1092,"detail":"()","definition":"sub"},{"kind":12,"line":1094,"name":"threads"},{"kind":12,"line":1096,"name":"Dumper"},{"range":{"end":{"character":9999,"line":1151},"start":{"character":0,"line":1106}},"containerName":"main::","signature":{"label":"readlogfile($self,$logobj)","documentation":" This function reads the log file into memory from the seek position (if it exists)\n The reading of a log file based on the seek position creates a big issue if the log file is rotated AND is larger than\n   the seek position\n   This is a tradeoff of reading the entire log file into memory and then grepping for the regexps\n Returns: $logobj","parameters":[{"label":"$self"},{"label":"$logobj"}]},"kind":12,"children":[{"name":"$self","definition":"my","line":1107,"localvar":"my","containerName":"readlogfile","kind":13},{"line":1107,"containerName":"readlogfile","kind":13,"name":"$logobj"},{"line":1108,"definition":"my","name":"$TID","containerName":"readlogfile","kind":13,"localvar":"my"},{"name":"tid","containerName":"readlogfile","line":1108,"kind":12},{"containerName":"readlogfile","line":1109,"kind":13,"name":"$TID"},{"kind":13,"line":1109,"containerName":"readlogfile","name":"$TID"},{"kind":13,"containerName":"readlogfile","localvar":"my","definition":"my","line":1112,"name":"$file"},{"kind":13,"line":1112,"containerName":"readlogfile","name":"$logobj"},{"name":"$file","containerName":"readlogfile","line":1113,"kind":13},{"name":"$logger","kind":13,"line":1113,"containerName":"readlogfile"},{"name":"error","containerName":"readlogfile","line":1113,"kind":12},{"name":"$logobj","line":1113,"kind":13,"containerName":"readlogfile"},{"line":1116,"containerName":"readlogfile","kind":13,"name":"$logobj"},{"name":"$logobj","line":1117,"kind":13,"containerName":"readlogfile"},{"kind":13,"line":1117,"containerName":"readlogfile","name":"$file"},{"name":"$logobj","containerName":"readlogfile","line":1117,"kind":13},{"name":"$logobj","line":1118,"kind":13,"containerName":"readlogfile"},{"name":"$self","line":1118,"kind":13,"containerName":"readlogfile"},{"containerName":"readlogfile","line":1119,"kind":13,"name":"$logobj"},{"name":"$logobj","containerName":"readlogfile","line":1119,"kind":13},{"name":"$logger","kind":13,"line":1121,"containerName":"readlogfile"},{"containerName":"readlogfile","line":1121,"kind":12,"name":"debug"},{"localvar":"my","kind":13,"containerName":"readlogfile","name":"$fh","line":1127,"definition":"my"},{"line":1127,"containerName":"readlogfile","kind":13,"name":"$file"},{"line":1128,"kind":13,"containerName":"readlogfile","name":"$logger"},{"name":"error","containerName":"readlogfile","line":1128,"kind":12},{"line":1129,"containerName":"readlogfile","kind":13,"name":"$logobj"},{"line":1131,"containerName":"readlogfile","kind":13,"name":"$fh"},{"name":"$logobj","line":1131,"kind":13,"containerName":"readlogfile"},{"line":1132,"definition":"my","name":"@logcontents","kind":13,"containerName":"readlogfile","localvar":"my"},{"name":"$fh","line":1132,"containerName":"readlogfile","kind":13},{"kind":13,"line":1133,"containerName":"readlogfile","name":"$logobj"},{"containerName":"readlogfile","line":1133,"kind":13,"name":"$fh"},{"name":"$fh","kind":13,"line":1134,"containerName":"readlogfile"},{"containerName":"readlogfile","line":1136,"kind":13,"name":"@logcontents"},{"name":"$logger","kind":13,"line":1137,"containerName":"readlogfile"},{"name":"info","containerName":"readlogfile","line":1137,"kind":12},{"containerName":"readlogfile","line":1138,"kind":13,"name":"$logobj"},{"kind":13,"line":1141,"containerName":"readlogfile","name":"$logger"},{"name":"debug","kind":12,"line":1141,"containerName":"readlogfile"},{"name":"@logcontents","line":1141,"kind":13,"containerName":"readlogfile"},{"kind":13,"line":1144,"containerName":"readlogfile","name":"@logcontents"},{"kind":13,"line":1145,"containerName":"readlogfile","name":"$logobj"},{"kind":13,"line":1145,"containerName":"readlogfile","name":"@logcontents"},{"name":"$logger","kind":13,"line":1147,"containerName":"readlogfile"},{"name":"debug","kind":12,"line":1147,"containerName":"readlogfile"},{"line":1147,"containerName":"readlogfile","kind":13,"name":"@logcontents"},{"name":"$logger","kind":13,"line":1148,"containerName":"readlogfile"},{"name":"trace","line":1148,"containerName":"readlogfile","kind":12},{"name":"$logobj","line":1148,"kind":13,"containerName":"readlogfile"},{"name":"$logger","kind":13,"line":1148,"containerName":"readlogfile"},{"kind":12,"line":1148,"containerName":"readlogfile","name":"is_trace"},{"line":1150,"containerName":"readlogfile","kind":13,"name":"$logobj"}],"name":"readlogfile","line":1106,"detail":"($self,$logobj)","definition":"sub"},{"name":"threads","line":1108,"kind":12},{"name":"file","line":1112,"kind":12},{"kind":12,"line":1116,"name":"seek"},{"line":1117,"kind":12,"name":"seek"},{"name":"seek","line":1117,"kind":12},{"kind":12,"line":1118,"name":"readentirefile"},{"name":"configs","kind":12,"line":1118},{"name":"readentirefile","kind":12,"line":1118},{"name":"seek","kind":12,"line":1119},{"kind":12,"line":1119,"name":"readentirefile"},{"kind":12,"line":1131,"name":"seek"},{"line":1133,"kind":12,"name":"seek"},{"name":"logcontents","kind":12,"line":1138},{"name":"logcontents","kind":12,"line":1145},{"line":1148,"kind":12,"name":"Dumper"},{"line":1148,"kind":12,"name":"logcontents"},{"name":"_grep_regexps","line":1175,"definition":"sub","detail":"($self,$log)","range":{"start":{"character":0,"line":1175},"end":{"character":9999,"line":1180}},"kind":12,"signature":{"parameters":[{"label":"$self"},{"label":"$log"}],"documentation":" # This greps for multiple regexps and returns the matchedlines from logobj->{logcontents}\n # Returns an array reference of matched lines\n sub _grep_regexp() {\n     my ( $self, $logobj, $regexps ) = @_;\n     my @matchedlines = ();\n     foreach my $regexp ( sort keys %{$regexps} ) {\n         # my $value = $regexps->{$regexp};\n         my $value = ${$regexps}{$regexp};\n         $logger->info(\"Grep'ing for >>$value<< in $logobj->{file} from byte position $logobj->{seek}\");\n         # @matchedlines = grep { /$value/ } @{ $logobj->{logcontents} };\n         push @matchedlines, grep { /$value/ } @{ $logobj->{logcontents} };\n         $logger->debug( \"Dumper of current matches: \" . Dumper(@matchedlines) ) if ( $logger->is_debug() );\n     } ## end foreach my $regexp ( sort keys...)\n     return \\@matchedlines;\n } ## end sub _grep_regexp\n Description:  Using the logobj, this greps against the log contents for matching lines and then gets the\n               IP address on each line.\n Returns:  Hash reference of IP addresses with count of how many times the IP address was found","label":"_grep_regexps($self,$log)"},"containerName":"main::","children":[{"localvar":"my","containerName":"_grep_regexps","kind":13,"name":"$self","definition":"my","line":1176},{"line":1176,"containerName":"_grep_regexps","kind":13,"name":"$log"},{"line":1177,"definition":"my","name":"$TID","kind":13,"containerName":"_grep_regexps","localvar":"my"},{"name":"tid","containerName":"_grep_regexps","line":1177,"kind":12},{"name":"$matches","line":1179,"definition":"my","localvar":"my","containerName":"_grep_regexps","kind":13},{"kind":13,"containerName":"_grep_regexps","localvar":"my","line":1180,"definition":"my","name":"@log_contents"},{"name":"$log","kind":13,"line":1180,"containerName":"_grep_regexps"}]},{"name":"threads","kind":12,"line":1177},{"name":"logcontents","kind":12,"line":1180},{"localvar":"my","containerName":null,"kind":13,"name":"$regex","line":1183,"definition":"my"},{"line":1183,"kind":13,"containerName":null,"name":"%log"},{"line":1183,"kind":12,"name":"regexpdeny"},{"localvar":"my","kind":13,"containerName":null,"name":"$pattern","definition":"my","line":1184},{"line":1184,"kind":13,"containerName":null,"name":"%log"},{"name":"regexpdeny","line":1184,"kind":12},{"line":1184,"kind":13,"containerName":null,"name":"$regex"},{"name":"$logger","kind":13,"line":1185,"containerName":null},{"name":"info","kind":12,"line":1185,"containerName":"main::"},{"kind":13,"containerName":null,"localvar":"my","definition":"my","line":1187,"name":"@current_matches"},{"line":1187,"containerName":null,"kind":13,"name":"@log_contents"},{"name":"$logger","kind":13,"line":1188,"containerName":null},{"line":1188,"kind":12,"containerName":"main::","name":"debug"},{"name":"Dumper","line":1188,"kind":12},{"line":1188,"containerName":null,"kind":13,"name":"@current_matches"},{"name":"$logger","line":1188,"containerName":null,"kind":13},{"containerName":"main::","line":1188,"kind":12,"name":"is_debug"},{"kind":13,"containerName":null,"localvar":"my","definition":"my","line":1190,"name":"$line"},{"line":1190,"kind":13,"containerName":null,"name":"@current_matches"},{"name":"$line","line":1191,"kind":13,"containerName":null},{"name":"$logger","containerName":null,"line":1192,"kind":13},{"name":"debug","containerName":"main::","line":1192,"kind":12},{"name":"$ip_address","line":1194,"definition":"my","localvar":"my","kind":13,"containerName":null},{"containerName":null,"line":1194,"kind":13,"name":"$line"},{"line":1194,"kind":13,"containerName":null,"name":"%line"},{"containerName":null,"line":1195,"kind":13,"name":"%matches"},{"line":1195,"kind":13,"containerName":null,"name":"$ip_address"},{"kind":13,"line":1196,"containerName":null,"name":"$logger"},{"line":1196,"containerName":"main::","kind":12,"name":"debug"},{"line":1201,"containerName":null,"kind":13,"name":"$logger"},{"name":"debug","containerName":"main::","line":1201,"kind":12},{"line":1201,"kind":12,"name":"Dumper"},{"line":1201,"kind":13,"containerName":null,"name":"$matches"},{"name":"$logger","line":1201,"kind":13,"containerName":null},{"line":1201,"kind":12,"containerName":"main::","name":"is_debug"},{"localvar":"my","containerName":null,"kind":13,"name":"$log_msg","definition":"my","line":1203},{"name":"$log_msg","kind":13,"line":1204,"containerName":null},{"name":"$matches","line":1204,"containerName":null,"kind":13},{"kind":13,"line":1205,"containerName":null,"name":"$logger"},{"name":"info","line":1205,"containerName":"main::","kind":12},{"containerName":null,"line":1205,"kind":13,"name":"$log_msg"},{"name":"$matches","line":1207,"kind":13,"containerName":null},{"signature":{"label":"add_chain()","documentation":"","parameters":[]},"containerName":"main::","kind":12,"children":[{"kind":13,"containerName":"add_chain","localvar":"my","definition":"my","line":1211,"name":"$self"},{"name":"$chain","containerName":"add_chain","line":1211,"kind":13},{"kind":13,"containerName":"add_chain","localvar":"my","line":1212,"definition":"my","name":"$TID"},{"kind":12,"line":1212,"containerName":"add_chain","name":"tid"},{"line":1214,"containerName":"add_chain","kind":13,"name":"$logger"},{"containerName":"add_chain","line":1214,"kind":12,"name":"info"},{"localvar":"my","kind":13,"containerName":"add_chain","name":"$rule","definition":"my","line":1215},{"definition":"my","line":1216,"name":"$options","containerName":"add_chain","kind":13,"localvar":"my"},{"containerName":"add_chain","kind":13,"localvar":"my","definition":"my","line":1217,"name":"$args"},{"name":"$rule","kind":13,"line":1217,"containerName":"add_chain"},{"line":1217,"kind":13,"containerName":"add_chain","name":"$options"},{"containerName":"add_chain","line":1218,"kind":13,"name":"$self"},{"name":"iptablesqueue_enqueue","kind":12,"line":1218,"containerName":"add_chain"},{"name":"$args","line":1218,"kind":13,"containerName":"add_chain"},{"containerName":"add_chain","line":1219,"kind":13,"name":"$self"},{"name":"$chain","kind":13,"line":1219,"containerName":"add_chain"}],"range":{"start":{"character":0,"line":1210},"end":{"line":1221,"character":9999}},"line":1210,"detail":"()","definition":"sub","name":"add_chain"},{"line":1212,"kind":12,"name":"threads"},{"name":"rule","line":1217,"kind":12},{"line":1217,"kind":12,"name":"options"},{"line":1219,"kind":12,"name":"chains_created"},{"name":"add_allowdeny_ips","definition":"sub","detail":"()","line":1230,"range":{"start":{"line":1230,"character":0},"end":{"character":9999,"line":1267}},"children":[{"containerName":"add_allowdeny_ips","kind":13,"localvar":"my","line":1231,"definition":"my","name":"$self"},{"name":"$args","line":1231,"containerName":"add_allowdeny_ips","kind":13},{"name":"$TID","line":1232,"definition":"my","localvar":"my","kind":13,"containerName":"add_allowdeny_ips"},{"name":"tid","line":1232,"kind":12,"containerName":"add_allowdeny_ips"},{"line":1234,"kind":13,"containerName":"add_allowdeny_ips","name":"$args"},{"containerName":"add_allowdeny_ips","line":1235,"kind":13,"name":"$logger"},{"kind":12,"line":1235,"containerName":"add_allowdeny_ips","name":"error"},{"name":"$chain","line":1238,"definition":"my","localvar":"my","kind":13,"containerName":"add_allowdeny_ips"},{"name":"$args","kind":13,"line":1238,"containerName":"add_allowdeny_ips"},{"localvar":"my","containerName":"add_allowdeny_ips","kind":13,"name":"%ip_rules","line":1240,"definition":"my"},{"line":1241,"containerName":"add_allowdeny_ips","kind":13,"name":"$args"},{"kind":13,"line":1242,"containerName":"add_allowdeny_ips","name":"$args"},{"definition":"my","line":1245,"name":"@allowdenyorder","kind":13,"containerName":"add_allowdeny_ips","localvar":"my"},{"name":"$args","kind":13,"line":1246,"containerName":"add_allowdeny_ips"},{"kind":13,"line":1247,"containerName":"add_allowdeny_ips","name":"@allowdenyorder"},{"name":"$logger","line":1250,"kind":13,"containerName":"add_allowdeny_ips"},{"name":"debug","containerName":"add_allowdeny_ips","line":1250,"kind":12},{"name":"%ip_rules","line":1250,"kind":13,"containerName":"add_allowdeny_ips"},{"line":1250,"kind":13,"containerName":"add_allowdeny_ips","name":"$logger"},{"containerName":"add_allowdeny_ips","line":1250,"kind":12,"name":"is_debug"},{"name":"$action","line":1253,"definition":"my","localvar":"my","kind":13,"containerName":"add_allowdeny_ips"},{"name":"@allowdenyorder","line":1253,"kind":13,"containerName":"add_allowdeny_ips"},{"name":"$logger","containerName":"add_allowdeny_ips","line":1254,"kind":13},{"kind":12,"line":1254,"containerName":"add_allowdeny_ips","name":"debug"},{"line":1256,"definition":"my","name":"$chain","containerName":"add_allowdeny_ips","kind":13,"localvar":"my"},{"name":"$args","kind":13,"line":1256,"containerName":"add_allowdeny_ips"},{"name":"$rule_action","definition":"my","line":1257,"localvar":"my","kind":13,"containerName":"add_allowdeny_ips"},{"name":"$action","line":1257,"containerName":"add_allowdeny_ips","kind":13},{"name":"$ip","line":1258,"definition":"my","localvar":"my","containerName":"add_allowdeny_ips","kind":13},{"name":"$ip_rules","containerName":"add_allowdeny_ips","line":1258,"kind":13},{"containerName":"add_allowdeny_ips","line":1258,"kind":13,"name":"$action"},{"line":1259,"kind":13,"containerName":"add_allowdeny_ips","name":"$logger"},{"kind":12,"line":1259,"containerName":"add_allowdeny_ips","name":"debug"},{"name":"$direction","definition":"my","line":1260,"localvar":"my","containerName":"add_allowdeny_ips","kind":13},{"localvar":"my","containerName":"add_allowdeny_ips","kind":13,"name":"$rule","line":1261,"definition":"my"},{"name":"$args","definition":"my","line":1262,"localvar":"my","kind":13,"containerName":"add_allowdeny_ips"},{"name":"$rule","line":1262,"containerName":"add_allowdeny_ips","kind":13},{"name":"$logger","line":1263,"kind":13,"containerName":"add_allowdeny_ips"},{"containerName":"add_allowdeny_ips","line":1263,"kind":12,"name":"debug"},{"kind":13,"line":1264,"containerName":"add_allowdeny_ips","name":"$self"},{"line":1264,"containerName":"add_allowdeny_ips","kind":12,"name":"iptablesqueue_enqueue"},{"name":"$args","line":1264,"kind":13,"containerName":"add_allowdeny_ips"}],"signature":{"documentation":" Description:  Adds the IPs to DROP or ACCEPT to the chain provided\n Returns:  1\n Requires: $args to be a hash reference with the following optional keys:\n  chain:  The chain to add the rules to.  If no chain provided then the default is ipblocker_global\n  allowlist:  An array of IPs to allow\n  denylist:  An array of IPs to deny\n  allowdenyorder:  The order to add the allow and deny rules","parameters":[],"label":"add_allowdeny_ips()"},"kind":12,"containerName":"main::"},{"kind":12,"line":1232,"name":"threads"},{"name":"chain","line":1238,"kind":12},{"line":1241,"kind":12,"name":"allow"},{"kind":12,"line":1241,"name":"allowlist"},{"line":1242,"kind":12,"name":"deny"},{"name":"denylist","kind":12,"line":1242},{"name":"allowdeny","kind":12,"line":1246},{"name":"Dumper","kind":12,"line":1250},{"name":"chain","line":1256,"kind":12},{"kind":12,"line":1262,"name":"rule"},{"kind":12,"line":1262,"name":"options"},{"line":1274,"detail":"()","definition":"sub","name":"add_global_allow_deny_ips","signature":{"documentation":" Description:  Adds the IPs to block or accept from the configs global allowlist and global denylist to the global chain\n Returns:  1","parameters":[],"label":"add_global_allow_deny_ips()"},"containerName":"main::","kind":12,"children":[{"name":"$self","definition":"my","line":1275,"localvar":"my","kind":13,"containerName":"add_global_allow_deny_ips"},{"line":1276,"definition":"my","name":"$TID","containerName":"add_global_allow_deny_ips","kind":13,"localvar":"my"},{"line":1276,"containerName":"add_global_allow_deny_ips","kind":12,"name":"tid"},{"line":1278,"kind":13,"containerName":"add_global_allow_deny_ips","name":"$logger"},{"name":"debug","containerName":"add_global_allow_deny_ips","line":1278,"kind":12},{"localvar":"my","kind":13,"containerName":"add_global_allow_deny_ips","name":"$chain","line":1279,"definition":"my"},{"line":1279,"kind":13,"containerName":"add_global_allow_deny_ips","name":"$self"},{"name":"@allowlist","definition":"my","line":1280,"localvar":"my","kind":13,"containerName":"add_global_allow_deny_ips"},{"name":"$self","line":1280,"kind":13,"containerName":"add_global_allow_deny_ips"},{"name":"$self","containerName":"add_global_allow_deny_ips","line":1280,"kind":13}],"range":{"start":{"line":1274,"character":0},"end":{"line":1280,"character":9999}}},{"line":1276,"kind":12,"name":"threads"},{"name":"configs","line":1279,"kind":12},{"name":"chainprefix","line":1279,"kind":12},{"line":1280,"kind":12,"name":"configs"},{"kind":12,"line":1280,"name":"allowlist"},{"kind":12,"line":1280,"name":"configs"},{"name":"allowlist","kind":12,"line":1280},{"kind":13,"containerName":null,"localvar":"my","definition":"my","line":1281,"name":"@denylist"},{"name":"%self","containerName":null,"line":1281,"kind":13},{"kind":12,"line":1281,"name":"configs"},{"kind":12,"line":1281,"name":"denylist"},{"name":"%self","line":1281,"kind":13,"containerName":null},{"line":1281,"kind":12,"name":"configs"},{"kind":12,"line":1281,"name":"denylist"},{"localvar":"my","kind":13,"containerName":null,"name":"$allowdeny","line":1282,"definition":"my"},{"kind":13,"line":1282,"containerName":null,"name":"%self"},{"name":"configs","kind":12,"line":1282},{"name":"allowdeny","line":1282,"kind":12},{"localvar":"my","containerName":null,"kind":13,"name":"%args","line":1284,"definition":"my"},{"name":"chain","kind":12,"line":1285},{"line":1285,"kind":13,"containerName":null,"name":"$chain"},{"kind":12,"line":1286,"name":"allowlist"},{"name":"@allowlist","line":1286,"containerName":null,"kind":13},{"kind":12,"line":1287,"name":"denylist"},{"containerName":null,"line":1287,"kind":13,"name":"@denylist"},{"line":1288,"kind":12,"name":"allowdeny"},{"name":"$allowdeny","line":1289,"kind":13,"containerName":null},{"name":"$logger","kind":13,"line":1291,"containerName":null},{"name":"debug","containerName":"main::","line":1291,"kind":12},{"name":"Dumper","line":1291,"kind":12},{"name":"$args","line":1291,"containerName":null,"kind":13},{"name":"$logger","containerName":null,"line":1291,"kind":13},{"name":"is_debug","line":1291,"containerName":"main::","kind":12},{"name":"$self","containerName":null,"line":1293,"kind":13},{"name":"add_allowdeny_ips","kind":12,"line":1293,"containerName":"main::"},{"name":"$args","kind":13,"line":1293,"containerName":null},{"kind":12,"signature":{"documentation":"","parameters":[],"label":"add_logger_allow_deny_ips()"},"containerName":"main::","children":[{"name":"$self","line":1297,"definition":"my","localvar":"my","kind":13,"containerName":"add_logger_allow_deny_ips"},{"name":"$logobj","line":1297,"kind":13,"containerName":"add_logger_allow_deny_ips"},{"name":"$TID","definition":"my","line":1298,"localvar":"my","containerName":"add_logger_allow_deny_ips","kind":13},{"name":"tid","line":1298,"containerName":"add_logger_allow_deny_ips","kind":12},{"name":"$logger","line":1300,"kind":13,"containerName":"add_logger_allow_deny_ips"},{"name":"debug","containerName":"add_logger_allow_deny_ips","line":1300,"kind":12},{"localvar":"my","kind":13,"containerName":"add_logger_allow_deny_ips","name":"$chain","definition":"my","line":1301},{"name":"$self","line":1301,"kind":13,"containerName":"add_logger_allow_deny_ips"},{"line":1301,"containerName":"add_logger_allow_deny_ips","kind":13,"name":"$logobj"},{"localvar":"my","kind":13,"containerName":"add_logger_allow_deny_ips","name":"@allowlist","line":1302,"definition":"my"},{"name":"$logobj","kind":13,"line":1302,"containerName":"add_logger_allow_deny_ips"},{"name":"$logobj","containerName":"add_logger_allow_deny_ips","line":1302,"kind":13}],"range":{"end":{"line":1302,"character":9999},"start":{"line":1296,"character":0}},"line":1296,"detail":"()","definition":"sub","name":"add_logger_allow_deny_ips"},{"kind":12,"line":1298,"name":"threads"},{"kind":12,"line":1301,"name":"configs"},{"line":1301,"kind":12,"name":"chainprefix"},{"name":"chain","line":1301,"kind":12},{"name":"allowlist","line":1302,"kind":12},{"name":"allowlist","kind":12,"line":1302},{"kind":13,"containerName":null,"localvar":"my","line":1303,"definition":"my","name":"@denylist"},{"name":"%logobj","containerName":null,"line":1303,"kind":13},{"name":"denylist","line":1303,"kind":12},{"kind":13,"line":1303,"containerName":null,"name":"%logobj"},{"name":"denylist","kind":12,"line":1303},{"localvar":"my","kind":13,"containerName":null,"name":"$allowdeny","definition":"my","line":1304},{"line":1304,"containerName":null,"kind":13,"name":"%logobj"},{"line":1304,"kind":12,"name":"allowdeny"},{"name":"%args","definition":"my","line":1306,"localvar":"my","kind":13,"containerName":null},{"name":"chain","line":1307,"kind":12},{"line":1307,"containerName":null,"kind":13,"name":"$chain"},{"line":1308,"kind":12,"name":"allowlist"},{"containerName":null,"line":1308,"kind":13,"name":"@allowlist"},{"name":"denylist","kind":12,"line":1309},{"line":1309,"containerName":null,"kind":13,"name":"@denylist"},{"kind":12,"line":1310,"name":"allowdeny"},{"line":1311,"containerName":null,"kind":13,"name":"$allowdeny"},{"name":"$logger","line":1313,"containerName":null,"kind":13},{"name":"debug","kind":12,"line":1313,"containerName":"main::"},{"name":"Dumper","kind":12,"line":1313},{"name":"$args","containerName":null,"line":1313,"kind":13},{"containerName":null,"line":1313,"kind":13,"name":"$logger"},{"line":1313,"containerName":"main::","kind":12,"name":"is_debug"},{"kind":13,"line":1315,"containerName":null,"name":"$self"},{"kind":12,"line":1315,"containerName":"main::","name":"add_allowdeny_ips"},{"containerName":null,"line":1315,"kind":13,"name":"$args"},{"line":1355,"definition":"sub","detail":"()","name":"stop","signature":{"parameters":[],"documentation":" sub add_global_allow_deny_ips {\n     my ($self) = @_;\n     my $TID = \"TID: \" . threads->tid;\n     $logger->debug(\"$TID|Adding global allow/deny IPs to global chains\");\n     my %ip_rules = (\n         allow => $self->{configs}->{allowlist} || {},\n         deny  => $self->{configs}->{denylist}  || {}\n     );\n     $logger->debug(\"$TID|IP rules: \" . Dumper(\\%ip_rules)) if $logger->is_debug();\n     foreach my $action (keys %ip_rules) {\n         my $chain = \"ipblocker_global\" . $action;\n         my $rule_action = $action eq 'allow' ? 'ACCEPT' : 'DROP';\n         foreach my $ruleorder (sort keys %{$ip_rules{$action}}) {\n             my $ip = $ip_rules{$action}{$ruleorder};\n             foreach my $direction ('-s', '-d') {\n                 # my $chain = $chain_prefix . ($direction eq '-s' ? '' : 'regex') . $action;\n                 my $rule = \"$chain $direction $ip -j $rule_action\";\n                 my $args = { rule => $rule, options => \"-w -A\" };\n                 $logger->debug(\"$TID|Adding >>-w -A $rule<< to iptables queue\");\n                 $self->iptablesqueue_enqueue($args);\n             }\n         }\n     }\n     return 1;\n }\n Stops the module\n  Future enhancements:\n   Clear the thread queues","label":"stop()"},"containerName":"main::","kind":12,"children":[{"localvar":"my","containerName":"stop","kind":13,"name":"$self","line":1356,"definition":"my"},{"containerName":"stop","line":1356,"kind":13,"name":"$args"},{"line":1357,"kind":13,"containerName":"stop","name":"$logger"},{"containerName":"stop","line":1357,"kind":12,"name":"info"},{"localvar":"my","kind":13,"containerName":"stop","name":"$chains_created","definition":"my","line":1359},{"name":"$args","kind":13,"line":1359,"containerName":"stop"},{"name":"$self","kind":13,"line":1362,"containerName":"stop"},{"line":1362,"containerName":"stop","kind":13,"name":"$chains_created"},{"name":"$logger","containerName":"stop","line":1363,"kind":13},{"line":1363,"containerName":"stop","kind":12,"name":"info"},{"name":"$chain","line":1364,"definition":"my","localvar":"my","kind":13,"containerName":"stop"},{"name":"$self","kind":13,"line":1364,"containerName":"stop"},{"line":1365,"kind":13,"containerName":"stop","name":"$logger"},{"name":"info","kind":12,"line":1365,"containerName":"stop"},{"line":1366,"kind":13,"containerName":"stop","name":"$IptablesQueue"},{"line":1366,"kind":12,"containerName":"stop","name":"enqueue"}],"range":{"end":{"character":9999,"line":1373},"start":{"line":1355,"character":0}}},{"name":"chains_created","kind":12,"line":1359},{"name":"chains_created","kind":12,"line":1362},{"kind":12,"line":1364,"name":"chains_created"},{"name":"options","line":1368,"kind":12},{"name":"rule","kind":12,"line":1369},{"name":"$logger","containerName":null,"line":1375,"kind":13},{"line":1375,"kind":12,"containerName":"main::","name":"info"},{"name":"$logger","line":1378,"kind":13,"containerName":null},{"line":1378,"kind":12,"containerName":"main::","name":"info"},{"name":"clear_queues","kind":12,"line":1379},{"line":1379,"containerName":null,"kind":13,"name":"$logger"},{"line":1379,"containerName":"main::","kind":12,"name":"error"},{"name":"$logger","line":1380,"kind":13,"containerName":null},{"name":"info","line":1380,"kind":12,"containerName":"main::"},{"kind":12,"line":1381,"name":"join_threads"},{"line":1381,"kind":13,"containerName":null,"name":"$logger"},{"line":1381,"containerName":"main::","kind":12,"name":"error"},{"name":"$logger","kind":13,"line":1383,"containerName":null},{"line":1383,"containerName":"main::","kind":12,"name":"info"},{"line":1384,"containerName":null,"kind":13,"name":"$lock_obj"},{"line":1384,"containerName":"main::","kind":12,"name":"release"},{"kind":13,"line":1385,"containerName":null,"name":"$logger"},{"name":"info","line":1385,"kind":12,"containerName":"main::"},{"range":{"start":{"character":0,"line":1394},"end":{"line":1398,"character":9999}},"signature":{"documentation":" Joins all threads\n   Simple sub but really needs some rework\n   If a thread is taking a while to join then it will block the other threads from joining\n   Some of the threads could be reading a log file and if the log file is large then it could take a while or\n   if the log file is causing soem kind of blocking for reading then it could take a while.\n   This may be an issue, if an example, if trying to read a file across NFS or SSHFS and there is a network issue.","parameters":[],"label":"join_threads()"},"containerName":"main::","kind":12,"children":[{"name":"$logger","kind":13,"line":1395,"containerName":"join_threads"},{"name":"debug","containerName":"join_threads","line":1395,"kind":12},{"line":1396,"kind":12,"containerName":"join_threads","name":"join"},{"containerName":"join_threads","line":1396,"kind":12,"name":"list"}],"name":"join_threads","line":1394,"definition":"sub","detail":"()"},{"line":1396,"kind":12,"name":"threads"},{"range":{"start":{"character":0,"line":1401},"end":{"character":9999,"line":1419}},"children":[{"line":1402,"containerName":"clear_queues","kind":13,"name":"$logger"},{"name":"debug","line":1402,"kind":12,"containerName":"clear_queues"},{"name":"$DataQueue","containerName":"clear_queues","line":1403,"kind":13},{"name":"end","line":1403,"kind":12,"containerName":"clear_queues"},{"name":"$IptablesQueue","line":1404,"kind":13,"containerName":"clear_queues"},{"line":1404,"kind":12,"containerName":"clear_queues","name":"end"},{"name":"$DataQueue","kind":13,"line":1405,"containerName":"clear_queues"},{"name":"pending","line":1405,"kind":12,"containerName":"clear_queues"},{"name":"$IptablesQueue","containerName":"clear_queues","line":1405,"kind":13},{"name":"pending","line":1405,"containerName":"clear_queues","kind":12},{"line":1406,"containerName":"clear_queues","kind":13,"name":"$DataQueue"},{"name":"pending","containerName":"clear_queues","line":1406,"kind":12},{"kind":13,"line":1406,"containerName":"clear_queues","name":"$logger"},{"line":1406,"kind":12,"containerName":"clear_queues","name":"debug"},{"name":"$IptablesQueue","line":1407,"kind":13,"containerName":"clear_queues"},{"kind":12,"line":1407,"containerName":"clear_queues","name":"pending"},{"kind":13,"line":1407,"containerName":"clear_queues","name":"$logger"},{"line":1407,"kind":12,"containerName":"clear_queues","name":"debug"},{"containerName":"clear_queues","line":1411,"kind":13,"name":"$DataQueue"},{"line":1411,"containerName":"clear_queues","kind":12,"name":"pending"},{"containerName":"clear_queues","line":1411,"kind":13,"name":"$IptablesQueue"},{"name":"pending","kind":12,"line":1411,"containerName":"clear_queues"},{"name":"$logger","line":1412,"kind":13,"containerName":"clear_queues"},{"containerName":"clear_queues","line":1412,"kind":12,"name":"error"},{"name":"$logger","containerName":"clear_queues","line":1416,"kind":13},{"line":1416,"kind":12,"containerName":"clear_queues","name":"debug"}],"containerName":"main::","signature":{"label":"clear_queues()","parameters":[],"documentation":" Clears the queues"},"kind":12,"name":"clear_queues","definition":"sub","detail":"()","line":1401},{"detail":"()","definition":"sub","line":1421,"name":"reload","children":[{"line":1422,"containerName":"reload","kind":13,"name":"$logger"},{"name":"info","line":1422,"kind":12,"containerName":"reload"}],"containerName":"main::","signature":{"label":"reload()","documentation":"","parameters":[]},"kind":12,"range":{"end":{"line":1446,"character":9999},"start":{"line":1421,"character":0}}},{"name":"SIG_INT","definition":"sub","line":1450,"range":{"start":{"character":0,"line":1450},"end":{"line":1454,"character":9999}},"children":[{"name":"$logger","containerName":"SIG_INT","line":1451,"kind":13},{"containerName":"SIG_INT","line":1451,"kind":12,"name":"info"}],"kind":12,"containerName":"main::"},{"children":[{"name":"$logger","containerName":"SIG_HUP","line":1459,"kind":13},{"line":1459,"containerName":"SIG_HUP","kind":12,"name":"info"}],"containerName":"main::","kind":12,"range":{"end":{"line":1461,"character":9999},"start":{"character":0,"line":1458}},"definition":"sub","line":1458,"name":"SIG_HUP"},{"line":1465,"definition":"sub","name":"SIG_TERM","kind":12,"containerName":"main::","children":[{"name":"$logger","line":1466,"kind":13,"containerName":"SIG_TERM"},{"name":"info","line":1466,"containerName":"SIG_TERM","kind":12}],"range":{"start":{"line":1465,"character":0},"end":{"character":9999,"line":1468}}},{"children":[{"name":"$self","definition":"my","line":1473,"localvar":"my","kind":13,"containerName":"SIG_QUIT"}],"kind":12,"containerName":"main::","range":{"end":{"line":1475,"character":9999},"start":{"line":1472,"character":0}},"definition":"sub","line":1472,"name":"SIG_QUIT"},{"definition":"sub","detail":"()","line":1477,"name":"set_signal_handler","children":[{"line":1478,"kind":13,"containerName":"set_signal_handler","name":"$logger"},{"containerName":"set_signal_handler","line":1478,"kind":12,"name":"info"},{"name":"$SIG","line":1480,"containerName":"set_signal_handler","kind":13},{"name":"$SIG","line":1481,"containerName":"set_signal_handler","kind":13},{"containerName":"set_signal_handler","line":1482,"kind":13,"name":"$SIG"},{"name":"$SIG","kind":13,"line":1483,"containerName":"set_signal_handler"}],"kind":12,"signature":{"parameters":[],"documentation":"","label":"set_signal_handler()"},"containerName":"main::","range":{"start":{"line":1477,"character":0},"end":{"line":1484,"character":9999}}},{"name":"INT","line":1480,"kind":12},{"name":"TERM","kind":12,"line":1481},{"kind":12,"line":1482,"name":"HUP"},{"name":"QUIT","line":1483,"kind":12}]}