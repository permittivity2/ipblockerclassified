{"vars":[{"name":"POSIX","kind":2,"line":53,"containerName":""},{"containerName":"","line":54,"kind":2,"name":"strict"},{"name":"DateTime","kind":2,"line":55,"containerName":""},{"containerName":"File","name":"Basename","line":56,"kind":2},{"kind":2,"line":60,"name":"strict","containerName":""},{"containerName":"Time","kind":2,"line":61,"name":"HiRes"},{"containerName":"Config","name":"File","line":67,"kind":2},{"name":"Carp","kind":2,"line":68,"containerName":""},{"kind":2,"line":69,"name":"Log4perl","containerName":"Log"},{"containerName":"Data","name":"Dumper","kind":2,"line":70},{"containerName":"Regexp","kind":2,"line":71,"name":"IPv6"},{"name":"Simple","kind":2,"line":72,"containerName":"LockFile"},{"containerName":"File","name":"Path","line":73,"kind":2},{"containerName":"Net::Ifconfig","kind":2,"line":74,"name":"Wrapper"},{"line":77,"kind":2,"name":"threads","containerName":""},{"name":"Queue","line":80,"kind":2,"containerName":"Thread"},{"line":81,"kind":13,"name":"$DataQueue","containerName":null,"definition":"my","localvar":"my"},{"name":"Thread","kind":12,"line":81,"containerName":"Queue"},{"containerName":"main::","name":"new","kind":12,"line":81},{"localvar":"my","definition":"my","containerName":null,"kind":13,"line":82,"name":"$LoggerTIDS"},{"localvar":"my","definition":"my","containerName":null,"kind":13,"line":85,"name":"$IptablesQueue"},{"containerName":"Queue","name":"Thread","kind":12,"line":85},{"containerName":"main::","name":"new","line":85,"kind":12},{"localvar":"my","definition":"my","containerName":null,"name":"$IptablesTIDS","line":86,"kind":13},{"name":"$Data","line":89,"kind":13,"containerName":null},{"line":89,"kind":12,"name":"Dumper","containerName":"Sortkeys"},{"name":"$Data","kind":13,"line":90,"containerName":null},{"containerName":"Indent","name":"Dumper","line":90,"kind":12},{"containerName":null,"name":"$logger","line":97,"kind":13,"localvar":"my","definition":"my"},{"containerName":null,"name":"$lock_obj","line":100,"kind":13,"localvar":"my","definition":"my"},{"containerName":null,"name":"$REGEX_IPV4","line":105,"kind":13,"localvar":"my","definition":"my"},{"localvar":"my","definition":"my","containerName":null,"kind":13,"line":107,"name":"$REGEX_IPV6"},{"localvar":"my","definition":"my","containerName":null,"line":108,"kind":13,"name":"$IPTABLESRUNLINE"},{"localvar":"my","definition":"my","containerName":null,"name":"%DEFAULTS","line":112,"kind":13},{"name":"allowdeny","kind":12,"line":113},{"name":"allowlist","line":114,"kind":12},{"name":"configsfile","line":115,"kind":12},{"name":"cycles","kind":12,"line":116},{"line":116,"kind":12,"name":"LONG_MAX"},{"line":117,"kind":12,"name":"cyclesleep"},{"name":"dumpconfigsandexit","kind":12,"line":118},{"line":119,"kind":12,"name":"denylist"},{"kind":12,"line":120,"name":"forceremovelockfile"},{"name":"globalallowlist","line":121,"kind":12},{"name":"globalchain","line":123,"kind":12},{"line":124,"kind":12,"name":"globalchains"},{"kind":12,"line":125,"name":"globaldenylist"},{"kind":12,"line":126,"name":"globalregexallowlist"},{"name":"globalregexdenylist","line":127,"kind":12},{"line":128,"kind":12,"name":"ignoreinterfaceips"},{"name":"iptables","line":129,"kind":12},{"name":"lockfile","line":130,"kind":12},{"kind":12,"line":131,"name":"log4perlconf"},{"line":132,"kind":12,"name":"loglevel"},{"line":136,"kind":12,"name":"logcontents"},{"kind":12,"line":137,"name":"logs_to_review"},{"line":138,"kind":12,"name":"logwatch_interval"},{"name":"prodmode","kind":12,"line":139},{"line":140,"kind":12,"name":"queuechecktime"},{"kind":12,"line":141,"name":"queuecycles"},{"name":"LONG_MAX","line":141,"kind":12},{"line":142,"kind":12,"name":"readentirefile"},{"range":{"start":{"character":0,"line":151},"end":{"line":194,"character":9999}},"detail":"()","containerName":"main::","line":151,"kind":12,"name":"new","children":[{"definition":"my","localvar":"my","name":"$class","line":152,"kind":13,"containerName":"new"},{"name":"$args","line":153,"kind":13,"containerName":"new","definition":"my","localvar":"my"},{"containerName":"new","kind":13,"line":155,"name":"$args"},{"containerName":"new","name":"$args","kind":13,"line":157},{"containerName":"new","line":159,"kind":13,"name":"$args"},{"localvar":"my","definition":"my","containerName":"new","name":"$configsfile","line":164,"kind":13},{"kind":13,"line":164,"name":"$args","containerName":"new"},{"name":"$DEFAULTS","kind":13,"line":164,"containerName":"new"},{"line":166,"kind":13,"name":"$self","containerName":"new","definition":"my","localvar":"my"},{"kind":13,"line":167,"name":"$configsfile","containerName":"new"},{"name":"$args","line":168,"kind":13,"containerName":"new"},{"line":172,"kind":13,"name":"$self","containerName":"new"},{"containerName":"new","kind":13,"line":172,"name":"$class"},{"containerName":"new","line":176,"kind":13,"name":"$self"},{"containerName":"new","name":"load_configs","line":176,"kind":12},{"containerName":"new","line":178,"kind":13,"name":"$self"},{"line":180,"kind":13,"name":"$self","containerName":"new"},{"name":"$self","kind":13,"line":181,"containerName":"new"},{"containerName":"new","name":"$self","line":182,"kind":13},{"containerName":"new","name":"$self","kind":13,"line":184},{"kind":13,"line":189,"name":"$logger","containerName":"new"},{"containerName":"new","line":189,"kind":13,"name":"$self"},{"containerName":"new","name":"setup_Logger","kind":12,"line":189},{"containerName":"new","kind":13,"line":190,"name":"$logger"},{"kind":12,"line":190,"name":"info","containerName":"new"},{"containerName":"new","name":"$logger","kind":13,"line":191},{"name":"debug","kind":12,"line":191,"containerName":"new"},{"name":"$self","line":191,"kind":13,"containerName":"new"},{"containerName":"new","name":"$logger","kind":13,"line":191},{"containerName":"new","name":"is_debug","kind":12,"line":191},{"containerName":"new","line":193,"kind":13,"name":"$self"}],"signature":{"parameters":[],"label":"new()","documentation":"#### Subs below here #####\n Reads configs, logging configs, sets up logging, sets up a class and returns a blessed object\n   The sub go() is where the action starts"},"definition":"sub"},{"name":"carp","line":156,"kind":12},{"kind":12,"line":160,"name":"croak"},{"kind":12,"line":164,"name":"configsfile"},{"line":164,"kind":12,"name":"configsfile"},{"kind":12,"line":167,"name":"configsfile"},{"kind":12,"line":168,"name":"clargs"},{"name":"configs","kind":12,"line":178},{"name":"dumpconfigsandexit","line":178,"kind":12},{"name":"configs","kind":12,"line":180},{"name":"configsfile","kind":12,"line":180},{"kind":12,"line":181,"name":"configs"},{"name":"globalchain","kind":12,"line":181},{"name":"configs","kind":12,"line":182},{"line":182,"kind":12,"name":"dumpconfigsandexit"},{"line":184,"kind":12,"name":"recursiveHashPrint"},{"name":"configs","kind":12,"line":184},{"line":191,"kind":12,"name":"Dumper"},{"containerName":"main::","range":{"end":{"character":9999,"line":208},"start":{"line":197,"character":0}},"detail":"($ref,$prefix)","name":"recursiveHashPrint","kind":12,"line":197,"signature":{"parameters":[{"label":"$ref"},{"label":"$prefix"}],"label":"recursiveHashPrint($ref,$prefix)","documentation":"# Recursive sub to print out a hash to STDOUT in a manner that matches \"use Config::File;\""},"children":[{"definition":"my","localvar":"my","name":"$ref","line":198,"kind":13,"containerName":"recursiveHashPrint"},{"containerName":"recursiveHashPrint","name":"$prefix","kind":13,"line":198},{"name":"$prefix","line":199,"kind":13,"containerName":"recursiveHashPrint"},{"containerName":"recursiveHashPrint","line":199,"kind":13,"name":"$prefix"},{"containerName":"recursiveHashPrint","kind":13,"line":201,"name":"$ref"},{"definition":"my","localvar":"my","line":202,"kind":13,"name":"$key","containerName":"recursiveHashPrint"},{"containerName":"recursiveHashPrint","kind":13,"line":202,"name":"$ref"},{"kind":13,"line":205,"name":"$new_prefix","containerName":"recursiveHashPrint","definition":"my","localvar":"my"},{"containerName":"recursiveHashPrint","name":"$prefix","kind":13,"line":205},{"containerName":"recursiveHashPrint","kind":13,"line":206,"name":"$ref"},{"name":"$key","line":206,"kind":13,"containerName":"recursiveHashPrint"},{"containerName":"recursiveHashPrint","line":206,"kind":13,"name":"$new_prefix"}],"definition":"sub"},{"name":"%ref","line":209,"kind":13,"containerName":null},{"localvar":"my","definition":"my","containerName":null,"name":"$line","line":212,"kind":13},{"name":"$ref","line":212,"kind":13,"containerName":null},{"name":"$line","line":213,"kind":13,"containerName":null},{"containerName":null,"kind":13,"line":214,"name":"$line"},{"kind":13,"line":215,"name":"%line","containerName":null},{"containerName":null,"kind":13,"line":219,"name":"$line","localvar":"my","definition":"my"},{"containerName":null,"kind":13,"line":220,"name":"$line"},{"kind":13,"line":221,"name":"$line","containerName":null},{"containerName":null,"name":"$line","line":222,"kind":13},{"children":[{"localvar":"my","definition":"my","containerName":"iptables_thread","kind":13,"line":227,"name":"$self"},{"definition":"my","localvar":"my","name":"$TID","line":228,"kind":13,"containerName":"iptables_thread"},{"name":"tid","line":228,"kind":12,"containerName":"iptables_thread"},{"line":229,"kind":13,"name":"$TID","containerName":"iptables_thread"},{"containerName":"iptables_thread","kind":13,"line":229,"name":"$TID"},{"line":231,"kind":13,"name":"$logger","containerName":"iptables_thread"},{"kind":12,"line":231,"name":"info","containerName":"iptables_thread"},{"localvar":"my","definition":"my","containerName":"iptables_thread","name":"$iptablesQueue_pending","kind":13,"line":234},{"kind":13,"line":234,"name":"$IptablesQueue","containerName":"iptables_thread"},{"line":234,"kind":12,"name":"pending","containerName":"iptables_thread"},{"containerName":"iptables_thread","line":235,"kind":13,"name":"$iptablesQueue_pending"},{"containerName":"iptables_thread","name":"$logmsg","line":236,"kind":13,"localvar":"my","definition":"my"},{"containerName":"iptables_thread","name":"$logmsg","kind":13,"line":237},{"containerName":"iptables_thread","name":"$logger","kind":13,"line":238},{"containerName":"iptables_thread","kind":12,"line":238,"name":"info"},{"line":238,"kind":13,"name":"$logmsg","containerName":"iptables_thread"},{"containerName":"iptables_thread","kind":13,"line":242,"name":"$iptablesQueue_pending"},{"containerName":"iptables_thread","name":"$logger","kind":13,"line":243},{"name":"info","line":243,"kind":12,"containerName":"iptables_thread"},{"name":"$data","kind":13,"line":244,"containerName":"iptables_thread","definition":"my","localvar":"my"},{"containerName":"iptables_thread","name":"$IptablesQueue","kind":13,"line":244},{"containerName":"iptables_thread","line":244,"kind":12,"name":"dequeue"},{"kind":13,"line":245,"name":"$logger","containerName":"iptables_thread"},{"kind":12,"line":245,"name":"debug","containerName":"iptables_thread"},{"containerName":"iptables_thread","kind":13,"line":245,"name":"$data"},{"name":"$logger","kind":13,"line":245,"containerName":"iptables_thread"},{"kind":12,"line":245,"name":"is_debug","containerName":"iptables_thread"},{"containerName":"iptables_thread","name":"$self","kind":13,"line":246},{"containerName":"iptables_thread","kind":12,"line":246,"name":"run_iptables"},{"kind":13,"line":246,"name":"$data","containerName":"iptables_thread"},{"name":"$logger","kind":13,"line":246,"containerName":"iptables_thread"},{"containerName":"iptables_thread","name":"error","line":246,"kind":12},{"containerName":"iptables_thread","kind":13,"line":246,"name":"$data"},{"containerName":"iptables_thread","kind":13,"line":247,"name":"$IPTABLESRUNLINE"},{"kind":13,"line":248,"name":"$IPTABLESRUNLINE","containerName":"iptables_thread"},{"line":248,"kind":13,"name":"$IPTABLESRUNLINE","containerName":"iptables_thread"},{"containerName":"iptables_thread","line":250,"kind":13,"name":"$iptablesQueue_pending"},{"containerName":"iptables_thread","kind":13,"line":251,"name":"$logger"},{"containerName":"iptables_thread","kind":12,"line":251,"name":"info"},{"kind":13,"line":255,"name":"$logger","containerName":"iptables_thread"},{"name":"error","line":255,"kind":12,"containerName":"iptables_thread"}],"signature":{"parameters":[],"label":"iptables_thread()","documentation":""},"definition":"sub","containerName":"main::","detail":"()","range":{"start":{"character":0,"line":226},"end":{"line":259,"character":9999}},"kind":12,"line":226,"name":"iptables_thread"},{"kind":12,"line":228,"name":"threads"},{"name":"Dumper","line":245,"kind":12},{"kind":12,"line":246,"name":"Dumper"},{"name":"go","kind":12,"line":266,"containerName":"main::","detail":"()","range":{"end":{"line":307,"character":9999},"start":{"line":266,"character":0}},"definition":"sub","signature":{"parameters":[],"documentation":" Creates two initial threads:\n   One for iptables commands to run.\n   Another to watch the log files\n       This in turn creates a thread for each log file to watch\n Also starts running the DataQueue queue which handles the data","label":"go()"},"children":[{"containerName":"go","name":"$self","kind":13,"line":267,"localvar":"my","definition":"my"},{"line":270,"kind":13,"name":"$self","containerName":"go"},{"containerName":"go","kind":13,"line":271,"name":"$logger"},{"line":271,"kind":12,"name":"error","containerName":"go"},{"containerName":"go","name":"$self","line":276,"kind":13},{"name":"$self","line":277,"kind":13,"containerName":"go"},{"name":"set_iptables_command","line":277,"kind":12,"containerName":"go"},{"kind":13,"line":277,"name":"$logger","containerName":"go"},{"containerName":"go","kind":12,"line":277,"name":"error"},{"containerName":"go","name":"$self","kind":13,"line":278},{"containerName":"go","name":"set_signal_handler","line":278,"kind":12},{"containerName":"go","kind":13,"line":279,"name":"$self"},{"containerName":"go","kind":12,"line":279,"name":"set_lockFile"},{"containerName":"go","name":"$logger","kind":13,"line":279},{"line":279,"kind":12,"name":"logdie","containerName":"go"},{"line":283,"kind":13,"name":"$iptables_thr","containerName":"go","definition":"my","localvar":"my"},{"kind":12,"line":283,"name":"create","containerName":"go"},{"containerName":"go","name":"$self","line":283,"kind":13},{"containerName":"go","line":286,"kind":13,"name":"$self"},{"line":286,"kind":12,"name":"create_iptables_chain","containerName":"go"},{"name":"$self","line":286,"kind":13,"containerName":"go"},{"containerName":"go","name":"$logger","line":287,"kind":13},{"name":"logdie","line":287,"kind":12,"containerName":"go"},{"line":294,"kind":13,"name":"$self","containerName":"go"},{"name":"add_global_allow_deny_ips","line":294,"kind":12,"containerName":"go"},{"containerName":"go","kind":13,"line":298,"name":"$logger"},{"line":298,"kind":12,"name":"logdie","containerName":"go"},{"line":298,"kind":13,"name":"$self","containerName":"go"},{"line":298,"kind":12,"name":"logger_thread","containerName":"go"},{"containerName":"go","name":"$self","line":306,"kind":13},{"containerName":"go","kind":12,"line":306,"name":"dataQueue_runner"}]},{"name":"configs","line":270,"kind":12},{"kind":12,"line":270,"name":"logs_to_review"},{"name":"run_iptables_line","kind":12,"line":276},{"name":"threads","line":283,"kind":12},{"name":"configs","kind":12,"line":286},{"line":286,"kind":12,"name":"globalchain"},{"containerName":"main::","detail":"()","range":{"end":{"character":9999,"line":339},"start":{"character":0,"line":311}},"line":311,"kind":12,"name":"add_ifconfig_ips_to_allowlist","children":[{"localvar":"my","definition":"my","containerName":"add_ifconfig_ips_to_allowlist","line":312,"kind":13,"name":"$self"}],"signature":{"parameters":[],"documentation":" Description:  Adds IPs on the local interfaces to the global allowlist\n  This does not work becasue it onkly handles IPv4 addresses","label":"add_ifconfig_ips_to_allowlist()"},"definition":"sub"},{"definition":"sub","signature":{"parameters":[],"label":"dataQueue_runner()","documentation":""},"children":[{"containerName":"dataQueue_runner","kind":13,"line":342,"name":"$self","localvar":"my","definition":"my"},{"definition":"my","localvar":"my","kind":13,"line":343,"name":"$TID","containerName":"dataQueue_runner"},{"name":"tid","kind":12,"line":343,"containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","name":"$TID","line":344,"kind":13},{"containerName":"dataQueue_runner","line":344,"kind":13,"name":"$TID"},{"containerName":"dataQueue_runner","line":346,"kind":13,"name":"$Data"},{"kind":13,"line":347,"name":"$Data","containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","line":349,"kind":13,"name":"$logger"},{"kind":12,"line":349,"name":"info","containerName":"dataQueue_runner"},{"name":"$queuechecktime","kind":13,"line":350,"containerName":"dataQueue_runner","definition":"my","localvar":"my"},{"containerName":"dataQueue_runner","name":"$self","line":350,"kind":13},{"name":"$queuecycles","line":351,"kind":13,"containerName":"dataQueue_runner","definition":"my","localvar":"my"},{"containerName":"dataQueue_runner","kind":13,"line":351,"name":"$self"},{"localvar":"my","definition":"my","containerName":"dataQueue_runner","kind":13,"line":354,"name":"$dataqueue_pending"},{"containerName":"dataQueue_runner","name":"$DataQueue","line":354,"kind":13},{"containerName":"dataQueue_runner","kind":12,"line":354,"name":"pending"},{"line":355,"kind":13,"name":"$dataqueue_pending","containerName":"dataQueue_runner"},{"name":"$logger","line":356,"kind":13,"containerName":"dataQueue_runner"},{"kind":12,"line":356,"name":"info","containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","name":"$dataqueue_pending","line":360,"kind":13},{"containerName":"dataQueue_runner","name":"$logger","line":361,"kind":13},{"containerName":"dataQueue_runner","kind":12,"line":361,"name":"info"},{"definition":"my","localvar":"my","line":362,"kind":13,"name":"$data","containerName":"dataQueue_runner"},{"line":362,"kind":13,"name":"$DataQueue","containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","name":"dequeue","line":362,"kind":12},{"kind":13,"line":364,"name":"$logger","containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","kind":12,"line":364,"name":"debug"},{"name":"$data","kind":13,"line":364,"containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","line":364,"kind":13,"name":"$logger"},{"kind":12,"line":364,"name":"is_debug","containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","name":"$dataqueue_pending","kind":13,"line":366},{"name":"$logmsg","kind":13,"line":367,"containerName":"dataQueue_runner","definition":"my","localvar":"my"},{"name":"$logmsg","line":368,"kind":13,"containerName":"dataQueue_runner"},{"kind":13,"line":369,"name":"$logger","containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","kind":12,"line":369,"name":"info"},{"line":369,"kind":13,"name":"$logmsg","containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","line":370,"kind":13,"name":"$queuecycles"},{"kind":13,"line":371,"name":"$queuecycles","containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","name":"$queuechecktime","line":372,"kind":13},{"containerName":"dataQueue_runner","name":"$logger","kind":13,"line":375},{"name":"error","kind":12,"line":375,"containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","kind":13,"line":380,"name":"$logger"},{"containerName":"dataQueue_runner","name":"info","kind":12,"line":380}],"name":"dataQueue_runner","line":341,"kind":12,"range":{"start":{"line":341,"character":0},"end":{"line":381,"character":9999}},"detail":"()","containerName":"main::"},{"line":343,"kind":12,"name":"threads"},{"name":"Dumper","kind":12,"line":346,"containerName":"Terse"},{"containerName":"Indent","line":347,"kind":12,"name":"Dumper"},{"name":"configs","kind":12,"line":350},{"line":350,"kind":12,"name":"queuechecktime"},{"name":"configs","line":351,"kind":12},{"kind":12,"line":351,"name":"queuecycles"},{"kind":12,"line":364,"name":"Dumper"},{"definition":"sub","children":[{"name":"$self","kind":13,"line":388,"containerName":"setup_Logger","definition":"my","localvar":"my"},{"definition":"my","localvar":"my","name":"$log4perlconf","line":391,"kind":13,"containerName":"setup_Logger"},{"name":"$self","kind":13,"line":391,"containerName":"setup_Logger"},{"kind":13,"line":392,"name":"$logwatch_interval","containerName":"setup_Logger","definition":"my","localvar":"my"},{"line":392,"kind":13,"name":"$self","containerName":"setup_Logger"},{"kind":12,"line":393,"name":"init_and_watch","containerName":"setup_Logger"},{"name":"$log4perlconf","kind":13,"line":393,"containerName":"setup_Logger"},{"containerName":"setup_Logger","name":"$logwatch_interval","kind":13,"line":393},{"containerName":"setup_Logger","kind":12,"line":397,"name":"easy_init"},{"containerName":"setup_Logger","line":397,"kind":13,"name":"$Log"},{"kind":13,"line":399,"name":"$logger","containerName":"setup_Logger"},{"line":400,"kind":13,"name":"$self","containerName":"setup_Logger"},{"containerName":"setup_Logger","name":"$logger","kind":13,"line":401},{"containerName":"setup_Logger","line":401,"kind":12,"name":"level"},{"name":"$self","kind":13,"line":401,"containerName":"setup_Logger"},{"name":"$logger","kind":13,"line":402,"containerName":"setup_Logger"},{"containerName":"setup_Logger","name":"info","kind":12,"line":402},{"containerName":"setup_Logger","name":"$logger","kind":13,"line":402},{"line":402,"kind":12,"name":"level","containerName":"setup_Logger"},{"containerName":"setup_Logger","name":"$logger","kind":13,"line":409},{"containerName":"setup_Logger","kind":12,"line":409,"name":"info"},{"name":"$logger","line":411,"kind":13,"containerName":"setup_Logger"}],"signature":{"documentation":" Assumptions:\n   $self->{configs}->{log4perlconf} is set\n   $self->{configs}->{logwatch_interval} is set\n These assumptions *should* be true because this is called from new()","label":"setup_Logger()","parameters":[]},"line":387,"kind":12,"name":"setup_Logger","detail":"()","range":{"end":{"line":412,"character":9999},"start":{"line":387,"character":0}},"containerName":"main::"},{"kind":12,"line":391,"name":"configs"},{"name":"log4perlconf","kind":12,"line":391},{"name":"configs","line":392,"kind":12},{"line":392,"kind":12,"name":"logwatch_interval"},{"containerName":"Log4perl","name":"Log","kind":12,"line":393},{"line":395,"kind":12,"name":"carp"},{"kind":12,"line":396,"name":"carp"},{"name":"Log","kind":12,"line":397,"containerName":"Log4perl"},{"containerName":"DEBUG","name":"Log4perl","line":397,"kind":12},{"name":"get_logger","line":399,"kind":12},{"name":"croak","line":399,"kind":12},{"kind":12,"line":400,"name":"configs"},{"line":400,"kind":12,"name":"loglevel"},{"name":"configs","line":401,"kind":12},{"line":401,"kind":12,"name":"loglevel"},{"name":"set_lockFile","line":416,"kind":12,"range":{"end":{"character":9999,"line":458},"start":{"character":0,"line":416}},"detail":"()","containerName":"main::","definition":"sub","signature":{"parameters":[],"documentation":" Set lock file\n   Returns 1 if lock file is set, otherwise returns 0","label":"set_lockFile()"},"children":[{"line":417,"kind":13,"name":"$self","containerName":"set_lockFile","definition":"my","localvar":"my"},{"line":419,"kind":13,"name":"$self","containerName":"set_lockFile"},{"name":"$logger","kind":13,"line":420,"containerName":"set_lockFile"},{"name":"logdie","line":420,"kind":12,"containerName":"set_lockFile"},{"localvar":"my","definition":"my","containerName":"set_lockFile","name":"$lockfile","line":423,"kind":13},{"containerName":"set_lockFile","name":"$self","kind":13,"line":423},{"containerName":"set_lockFile","name":"$lf","line":426,"kind":13,"localvar":"my","definition":"my"},{"kind":13,"line":426,"name":"$self","containerName":"set_lockFile"},{"name":"$logger","line":427,"kind":13,"containerName":"set_lockFile"},{"name":"debug","line":427,"kind":12,"containerName":"set_lockFile"},{"containerName":"set_lockFile","name":"$lf","line":429,"kind":13},{"containerName":"set_lockFile","name":"$self","line":430,"kind":13},{"containerName":"set_lockFile","name":"$logger","line":431,"kind":13},{"containerName":"set_lockFile","name":"info","kind":12,"line":431},{"kind":13,"line":432,"name":"$lf","containerName":"set_lockFile"},{"name":"$logger","line":432,"kind":13,"containerName":"set_lockFile"},{"name":"logdie","line":432,"kind":12,"containerName":"set_lockFile"},{"definition":"my","localvar":"my","line":435,"kind":13,"name":"$fh","containerName":"set_lockFile"},{"containerName":"set_lockFile","name":"$lf","line":435,"kind":13},{"containerName":"set_lockFile","name":"$logger","kind":13,"line":435},{"name":"logdie","line":435,"kind":12,"containerName":"set_lockFile"},{"definition":"my","localvar":"my","name":"@contents","line":436,"kind":13,"containerName":"set_lockFile"},{"containerName":"set_lockFile","line":436,"kind":13,"name":"$fh"},{"containerName":"set_lockFile","name":"$fh","line":437,"kind":13},{"containerName":"set_lockFile","name":"@contents","kind":13,"line":438},{"definition":"my","localvar":"my","kind":13,"line":439,"name":"$printable_contents","containerName":"set_lockFile"},{"containerName":"set_lockFile","name":"@contents","kind":13,"line":439},{"definition":"my","localvar":"my","line":440,"kind":13,"name":"$logmsg","containerName":"set_lockFile"},{"kind":13,"line":441,"name":"$logger","containerName":"set_lockFile"},{"kind":12,"line":441,"name":"info","containerName":"set_lockFile"},{"name":"$logmsg","kind":13,"line":441,"containerName":"set_lockFile"},{"containerName":"set_lockFile","name":"$lf","kind":13,"line":445},{"containerName":"set_lockFile","line":445,"kind":13,"name":"$logger"},{"containerName":"set_lockFile","name":"logdie","line":445,"kind":12},{"line":448,"kind":13,"name":"$self","containerName":"set_lockFile"},{"kind":12,"line":448,"name":"make","containerName":"set_lockFile"},{"name":"$logger","line":451,"kind":13,"containerName":"set_lockFile"},{"line":451,"kind":12,"name":"debug","containerName":"set_lockFile"},{"containerName":"set_lockFile","name":"$self","line":451,"kind":13},{"containerName":"set_lockFile","kind":13,"line":451,"name":"$logger"},{"name":"is_debug","line":451,"kind":12,"containerName":"set_lockFile"},{"kind":13,"line":452,"name":"$self","containerName":"set_lockFile"},{"kind":13,"line":452,"name":"$self","containerName":"set_lockFile"},{"line":452,"kind":12,"name":"lock","containerName":"set_lockFile"},{"containerName":"set_lockFile","name":"$lf","kind":13,"line":452},{"kind":13,"line":453,"name":"$logger","containerName":"set_lockFile"},{"name":"logdie","line":453,"kind":12,"containerName":"set_lockFile"},{"containerName":"set_lockFile","kind":13,"line":454,"name":"$lock_obj"},{"name":"$self","line":454,"kind":13,"containerName":"set_lockFile"},{"containerName":"set_lockFile","kind":13,"line":456,"name":"$logger"},{"kind":12,"line":456,"name":"info","containerName":"set_lockFile"}]},{"name":"configs","kind":12,"line":419},{"line":419,"kind":12,"name":"lockfile"},{"line":423,"kind":12,"name":"configs"},{"kind":12,"line":423,"name":"lockfile"},{"name":"configs","kind":12,"line":426},{"kind":12,"line":426,"name":"lockfile"},{"name":"configs","kind":12,"line":430},{"name":"forceremovelockfile","line":430,"kind":12},{"line":448,"kind":12,"name":"lockmgr"},{"containerName":"Simple","name":"LockFile","line":448,"kind":12},{"line":451,"kind":12,"name":"Dumper"},{"kind":12,"line":451,"name":"lockmgr"},{"name":"lock","kind":12,"line":452},{"kind":12,"line":452,"name":"lockmgr"},{"kind":12,"line":454,"name":"lock"},{"name":"logger_thread","kind":12,"line":462,"containerName":"main::","range":{"start":{"character":0,"line":462},"end":{"character":9999,"line":469}},"detail":"()","definition":"sub","signature":{"parameters":[],"label":"logger_thread()","documentation":"# Description: Creates a thread for each log file to review\n# Returns 1 or dies if thread can not be created"},"children":[{"definition":"my","localvar":"my","line":463,"kind":13,"name":"$self","containerName":"logger_thread"},{"localvar":"my","definition":"my","containerName":"logger_thread","name":"$logstoreview","kind":13,"line":465},{"name":"$self","kind":13,"line":465,"containerName":"logger_thread"},{"containerName":"logger_thread","name":"$logstoreview","line":466,"kind":13},{"containerName":"logger_thread","name":"$logtoreview","kind":13,"line":469,"localvar":"my","definition":"my"},{"containerName":"logger_thread","name":"$logstoreview","kind":13,"line":469}]},{"name":"configs","line":465,"kind":12},{"name":"logs_to_review","kind":12,"line":465},{"containerName":null,"kind":13,"line":470,"name":"$logger"},{"containerName":"main::","name":"info","line":470,"kind":12},{"localvar":"my","definition":"my","containerName":null,"name":"$logobj","line":471,"kind":13},{"line":471,"kind":13,"name":"%logstoreview","containerName":null},{"name":"$logtoreview","kind":13,"line":471,"containerName":null},{"containerName":null,"line":472,"kind":13,"name":"%logobj"},{"kind":12,"line":472,"name":"chain"},{"containerName":null,"name":"$logtoreview","line":472,"kind":13},{"kind":13,"line":474,"name":"$thr","containerName":null,"definition":"my","localvar":"my"},{"name":"threads","kind":12,"line":474},{"containerName":"main::","line":474,"kind":12,"name":"create"},{"kind":12,"line":474,"name":"review_log"},{"containerName":null,"line":474,"kind":13,"name":"$self"},{"containerName":null,"name":"$logobj","line":474,"kind":13},{"name":"$logger","kind":13,"line":474,"containerName":null},{"line":474,"kind":12,"name":"logdie","containerName":"main::"},{"line":475,"kind":13,"name":"$LoggerTIDS","containerName":null},{"containerName":null,"name":"$thr","kind":13,"line":475},{"kind":12,"line":475,"name":"tid","containerName":"main::"},{"name":"$logger","kind":13,"line":476,"containerName":null},{"name":"debug","line":476,"kind":12,"containerName":"main::"},{"kind":13,"line":476,"name":"$thr","containerName":null},{"containerName":"main::","name":"tid","kind":12,"line":476},{"containerName":null,"line":476,"kind":13,"name":"$logger"},{"line":476,"kind":12,"name":"is_debug","containerName":"main::"},{"containerName":null,"kind":13,"line":477,"name":"$logger"},{"containerName":"main::","name":"debug","line":477,"kind":12},{"containerName":null,"kind":13,"line":477,"name":"$thr"},{"name":"tid","line":477,"kind":12,"containerName":"main::"},{"containerName":null,"name":"$thr","line":477,"kind":13},{"containerName":"main::","name":"is_running","kind":12,"line":477},{"containerName":null,"name":"$logger","line":477,"kind":13},{"containerName":"main::","name":"is_debug","kind":12,"line":477},{"children":[{"definition":"my","localvar":"my","name":"$self","kind":13,"line":488,"containerName":"review_log"},{"name":"$logobj","line":488,"kind":13,"containerName":"review_log"},{"containerName":"review_log","line":490,"kind":13,"name":"$logobj"},{"containerName":"review_log","kind":13,"line":491,"name":"$TID","localvar":"my","definition":"my"},{"containerName":"review_log","line":491,"kind":12,"name":"tid"},{"kind":13,"line":492,"name":"$TID","containerName":"review_log"},{"containerName":"review_log","line":492,"kind":13,"name":"$TID"},{"line":494,"kind":13,"name":"$logger","containerName":"review_log"},{"line":494,"kind":12,"name":"debug","containerName":"review_log"},{"name":"$logobj","kind":13,"line":494,"containerName":"review_log"},{"containerName":"review_log","name":"$logger","line":494,"kind":13},{"name":"is_debug","kind":12,"line":494,"containerName":"review_log"},{"name":"$logobj","kind":13,"line":497,"containerName":"review_log"},{"name":"$self","line":497,"kind":13,"containerName":"review_log"},{"definition":"my","localvar":"my","name":"$cycles","line":498,"kind":13,"containerName":"review_log"},{"containerName":"review_log","name":"$logobj","line":498,"kind":13},{"name":"$logobj","kind":13,"line":499,"containerName":"review_log"},{"containerName":"review_log","name":"$self","kind":13,"line":499},{"containerName":"review_log","kind":13,"line":500,"name":"$cyclesleep","localvar":"my","definition":"my"},{"containerName":"review_log","kind":13,"line":500,"name":"$logobj"},{"line":501,"kind":13,"name":"$cyclesleep","containerName":"review_log"},{"kind":13,"line":501,"name":"$cyclesleep","containerName":"review_log"},{"containerName":"review_log","kind":13,"line":503,"name":"$logger"},{"containerName":"review_log","name":"info","kind":12,"line":503},{"containerName":"review_log","name":"$chain","line":510,"kind":13,"localvar":"my","definition":"my"},{"containerName":"review_log","name":"$logobj","kind":13,"line":510},{"name":"$logger","kind":13,"line":511,"containerName":"review_log"},{"containerName":"review_log","kind":12,"line":511,"name":"info"},{"name":"$self","kind":13,"line":512,"containerName":"review_log"},{"kind":12,"line":512,"name":"create_iptables_chain","containerName":"review_log"},{"containerName":"review_log","line":512,"kind":13,"name":"$chain"},{"containerName":"review_log","kind":13,"line":515,"name":"$logger"},{"kind":12,"line":515,"name":"info","containerName":"review_log"},{"definition":"my","localvar":"my","name":"$table","kind":13,"line":516,"containerName":"review_log"},{"name":"$args","kind":13,"line":517,"containerName":"review_log","definition":"my","localvar":"my"},{"name":"$logger","kind":13,"line":521,"containerName":"review_log"},{"containerName":"review_log","kind":12,"line":521,"name":"info"},{"line":522,"kind":13,"name":"$self","containerName":"review_log"},{"containerName":"review_log","kind":12,"line":522,"name":"iptablesqueue_enqueue"},{"name":"$args","line":522,"kind":13,"containerName":"review_log"},{"containerName":"review_log","line":525,"kind":13,"name":"$cycles"},{"containerName":"review_log","kind":13,"line":526,"name":"$logger"},{"name":"info","line":526,"kind":12,"containerName":"review_log"},{"containerName":"review_log","name":"$logobj","kind":13,"line":527},{"containerName":"review_log","kind":13,"line":527,"name":"$self"},{"containerName":"review_log","line":527,"kind":12,"name":"readlogfile"},{"containerName":"review_log","kind":13,"line":527,"name":"$logobj"},{"name":"$logobj","line":528,"kind":13,"containerName":"review_log"},{"containerName":"review_log","name":"$self","kind":13,"line":528},{"containerName":"review_log","name":"_grep_regexps","kind":12,"line":528},{"line":528,"kind":13,"name":"$logobj","containerName":"review_log"},{"line":528,"kind":13,"name":"$logobj","containerName":"review_log"},{"containerName":"review_log","line":529,"kind":13,"name":"$logobj"},{"line":529,"kind":13,"name":"$self","containerName":"review_log"},{"containerName":"review_log","name":"clean_ips_to_block_allowdeny","line":529,"kind":12},{"containerName":"review_log","name":"$logobj","line":529,"kind":13},{"containerName":"review_log","kind":13,"line":539,"name":"$ip","localvar":"my","definition":"my"},{"name":"$logobj","kind":13,"line":539,"containerName":"review_log"},{"name":"$logger","kind":13,"line":540,"containerName":"review_log"},{"kind":12,"line":540,"name":"info","containerName":"review_log"},{"definition":"my","localvar":"my","line":541,"kind":13,"name":"$args","containerName":"review_log"},{"name":"$logger","line":545,"kind":13,"containerName":"review_log"},{"containerName":"review_log","kind":12,"line":545,"name":"debug"},{"name":"$self","kind":13,"line":546,"containerName":"review_log"},{"name":"iptablesqueue_enqueue","kind":12,"line":546,"containerName":"review_log"},{"containerName":"review_log","kind":13,"line":546,"name":"$args"},{"localvar":"my","definition":"my","containerName":"review_log","name":"$args","line":548,"kind":13},{"kind":13,"line":552,"name":"$logger","containerName":"review_log"},{"name":"debug","line":552,"kind":12,"containerName":"review_log"},{"line":553,"kind":13,"name":"$self","containerName":"review_log"},{"name":"iptablesqueue_enqueue","kind":12,"line":553,"containerName":"review_log"},{"line":553,"kind":13,"name":"$args","containerName":"review_log"},{"containerName":"review_log","name":"$cycles","kind":13,"line":556},{"containerName":"review_log","kind":13,"line":557,"name":"$logger"},{"name":"info","line":557,"kind":12,"containerName":"review_log"},{"containerName":"review_log","line":558,"kind":13,"name":"$cyclesleep"}],"signature":{"label":"review_log()","documentation":" This is called as a thread and runs a loop to check the log file for new entries\n   Prior to checking the log file, it creates a chain for the log file and adds it to the global chain","parameters":[]},"definition":"sub","detail":"()","range":{"end":{"character":9999,"line":559},"start":{"character":0,"line":487}},"containerName":"main::","line":487,"kind":12,"name":"review_log"},{"line":491,"kind":12,"name":"threads"},{"kind":12,"line":494,"name":"Dumper"},{"name":"cycles","kind":12,"line":497},{"name":"configs","kind":12,"line":497},{"line":497,"kind":12,"name":"cycles"},{"name":"LONG_MAX","line":497,"kind":12},{"line":498,"kind":12,"name":"cycles"},{"line":499,"kind":12,"name":"cyclesleep"},{"name":"configs","line":499,"kind":12},{"line":499,"kind":12,"name":"cyclesleep"},{"name":"cyclesleep","line":500,"kind":12},{"kind":12,"line":510,"name":"chain"},{"name":"options","line":518,"kind":12},{"name":"rule","kind":12,"line":519},{"name":"ips_to_block","line":528,"kind":12},{"name":"logcontents","kind":12,"line":528},{"line":539,"kind":12,"name":"ips_to_block"},{"kind":12,"line":542,"name":"options"},{"kind":12,"line":543,"name":"rule"},{"name":"options","line":549,"kind":12},{"line":550,"kind":12,"name":"rule"},{"name":"usleep","kind":12,"line":558},{"containerName":null,"name":"$logger","line":561,"kind":13},{"kind":12,"line":561,"name":"info","containerName":"main::"},{"children":[{"name":"$self","kind":13,"line":568,"containerName":"iptables_ipblock_commands","definition":"my","localvar":"my"},{"definition":"my","localvar":"my","name":"$logobj","kind":13,"line":569,"containerName":"iptables_ipblock_commands"},{"line":571,"kind":13,"name":"$TID","containerName":"iptables_ipblock_commands","definition":"my","localvar":"my"},{"name":"tid","line":571,"kind":12,"containerName":"iptables_ipblock_commands"},{"containerName":"iptables_ipblock_commands","line":572,"kind":13,"name":"$TID"},{"containerName":"iptables_ipblock_commands","line":572,"kind":13,"name":"$TID"},{"containerName":"iptables_ipblock_commands","kind":13,"line":574,"name":"$logobj"},{"definition":"my","localvar":"my","name":"$iptables_commands","line":578,"kind":13,"containerName":"iptables_ipblock_commands"},{"localvar":"my","definition":"my","containerName":"iptables_ipblock_commands","line":590,"kind":13,"name":"$ips_to_block"},{"containerName":"iptables_ipblock_commands","name":"$logobj","line":590,"kind":13},{"localvar":"my","definition":"my","containerName":"iptables_ipblock_commands","line":591,"kind":13,"name":"$chain"},{"containerName":"iptables_ipblock_commands","name":"$ips_to_block","line":591,"kind":13}],"signature":{"label":"iptables_ipblock_commands()","documentation":" Description: takes the ips_to_block, ports, and protocols and creates the iptables commands to run\n Returns a hash of iptables commands to run","parameters":[]},"definition":"sub","range":{"end":{"character":9999,"line":591},"start":{"line":567,"character":0}},"detail":"()","containerName":"main::","kind":12,"line":567,"name":"iptables_ipblock_commands"},{"line":571,"kind":12,"name":"threads"},{"line":590,"kind":12,"name":"ips_to_block"},{"containerName":null,"name":"$ip","line":592,"kind":13,"localvar":"my","definition":"my"},{"kind":13,"line":592,"name":"%ips_to_block","containerName":null},{"kind":13,"line":592,"name":"%chain","containerName":null},{"definition":"my","localvar":"my","line":593,"kind":13,"name":"$port","containerName":null},{"name":"%ips_to_block","line":593,"kind":13,"containerName":null},{"containerName":null,"line":593,"kind":13,"name":"%chain"},{"line":593,"kind":13,"name":"%ip","containerName":null},{"line":594,"kind":13,"name":"$protocol","containerName":null,"definition":"my","localvar":"my"},{"containerName":null,"kind":13,"line":594,"name":"%ips_to_block"},{"containerName":null,"name":"%chain","line":594,"kind":13},{"name":"%ip","line":594,"kind":13,"containerName":null},{"kind":13,"line":594,"name":"%port","containerName":null},{"localvar":"my","definition":"my","containerName":null,"name":"$iptables_command","kind":13,"line":595},{"containerName":null,"name":"%self","kind":13,"line":595},{"name":"iptables_command","line":595,"kind":12},{"kind":13,"line":596,"name":"$iptables_command","containerName":null},{"name":"$iptables_command","kind":13,"line":597,"containerName":null},{"containerName":null,"line":598,"kind":13,"name":"$iptables_command"},{"name":"$iptables_command","kind":13,"line":599,"containerName":null},{"line":600,"kind":13,"name":"%iptables_commands","containerName":null},{"name":"%chain","line":600,"kind":13,"containerName":null},{"name":"%ip","line":600,"kind":13,"containerName":null},{"kind":13,"line":600,"name":"%port","containerName":null},{"kind":13,"line":600,"name":"$protocol","containerName":null},{"containerName":null,"kind":13,"line":600,"name":"$iptables_command"},{"kind":13,"line":606,"name":"$logger","containerName":null},{"containerName":"main::","name":"debug","line":606,"kind":12},{"line":606,"kind":12,"name":"Dumper"},{"name":"$iptables_commands","kind":13,"line":606,"containerName":null},{"containerName":null,"kind":13,"line":606,"name":"$logger"},{"containerName":"main::","line":606,"kind":12,"name":"is_debug"},{"name":"$iptables_commands","kind":13,"line":608,"containerName":null},{"definition":"sub","children":[{"localvar":"my","definition":"my","containerName":"load_configs","kind":13,"line":613,"name":"$self"},{"kind":13,"line":614,"name":"$configsfile","containerName":"load_configs","definition":"my","localvar":"my"},{"kind":13,"line":614,"name":"$self","containerName":"load_configs"},{"definition":"my","localvar":"my","name":"$clargs","line":615,"kind":13,"containerName":"load_configs"},{"containerName":"load_configs","kind":13,"line":615,"name":"$self"},{"name":"$configsfile","line":617,"kind":13,"containerName":"load_configs"},{"line":620,"kind":13,"name":"$self","containerName":"load_configs"},{"containerName":"load_configs","kind":13,"line":620,"name":"$self"},{"containerName":"load_configs","name":"$self","kind":13,"line":621},{"name":"$self","line":621,"kind":13,"containerName":"load_configs"},{"containerName":"load_configs","name":"$self","kind":13,"line":622},{"containerName":"load_configs","name":"$msg","kind":13,"line":627,"localvar":"my","definition":"my"},{"name":"$msg","line":628,"kind":13,"containerName":"load_configs"},{"containerName":"load_configs","line":629,"kind":13,"name":"$msg"},{"name":"$clargs","kind":13,"line":629,"containerName":"load_configs"},{"name":"$msg","line":630,"kind":13,"containerName":"load_configs"},{"containerName":"load_configs","name":"$DEFAULTS","kind":13,"line":630},{"containerName":"load_configs","line":631,"kind":13,"name":"$msg"},{"kind":13,"line":632,"name":"$msg","containerName":"load_configs"},{"name":"$msg","kind":13,"line":633,"containerName":"load_configs"},{"containerName":"load_configs","kind":13,"line":636,"name":"$config","localvar":"my","definition":"my"},{"kind":13,"line":636,"name":"$DEFAULTS","containerName":"load_configs"}],"line":612,"kind":12,"name":"load_configs","containerName":"main::","range":{"start":{"character":0,"line":612},"end":{"line":636,"character":9999}}},{"name":"configsfile","kind":12,"line":614},{"line":615,"kind":12,"name":"clargs"},{"name":"configs","line":620,"kind":12},{"name":"Config","line":620,"kind":12,"containerName":"File::read_config_file"},{"line":620,"kind":12,"name":"configsfile"},{"line":621,"kind":12,"name":"configs"},{"line":621,"kind":12,"name":"globalchain"},{"name":"configs","kind":12,"line":621},{"name":"globalchain","kind":12,"line":621},{"kind":12,"line":622,"name":"configs"},{"kind":12,"line":622,"name":"globalchain"},{"line":629,"kind":12,"name":"Dumper"},{"name":"Dumper","kind":12,"line":630},{"name":"carp","kind":12,"line":632},{"containerName":null,"name":"%self","line":640,"kind":13},{"kind":12,"line":640,"name":"configs"},{"containerName":null,"kind":13,"line":640,"name":"$config"},{"containerName":null,"line":641,"kind":13,"name":"%clargs"},{"name":"$config","kind":13,"line":641,"containerName":null},{"containerName":null,"name":"%clargs","line":642,"kind":13},{"line":642,"kind":13,"name":"$config","containerName":null},{"containerName":null,"kind":13,"line":643,"name":"%self"},{"name":"configs","line":643,"kind":12},{"containerName":null,"line":643,"kind":13,"name":"$config"},{"containerName":null,"name":"%DEFAULTS","kind":13,"line":643},{"containerName":null,"kind":13,"line":643,"name":"$config"},{"name":"%self","kind":13,"line":646,"containerName":null},{"name":"configs","kind":12,"line":646},{"detail":"()","range":{"start":{"line":650,"character":0},"end":{"line":657,"character":9999}},"containerName":"main::","line":650,"kind":12,"name":"reverseMapHash","children":[{"containerName":"reverseMapHash","kind":13,"line":651,"name":"$self","localvar":"my","definition":"my"},{"containerName":"reverseMapHash","name":"$hash","kind":13,"line":652,"localvar":"my","definition":"my"},{"definition":"my","localvar":"my","line":656,"kind":13,"name":"$new_hash","containerName":"reverseMapHash"},{"definition":"my","localvar":"my","name":"$key","line":657,"kind":13,"containerName":"reverseMapHash"},{"containerName":"reverseMapHash","line":657,"kind":13,"name":"$hash"}],"signature":{"label":"reverseMapHash()","documentation":" Special helper function for clean_ips_to_block()","parameters":[]},"definition":"sub"},{"name":"%new_hash","line":658,"kind":13,"containerName":null},{"containerName":null,"line":658,"kind":13,"name":"%hash"},{"containerName":null,"line":658,"kind":13,"name":"$key"},{"containerName":null,"kind":13,"line":662,"name":"$new_hash"},{"definition":"sub","signature":{"documentation":" Description: Combines the IPs from regex from the log to be blocked and the IPs from the allow/deny lists into\n               one hash","label":"clean_ips_to_block_combined()","parameters":[]},"children":[{"containerName":"clean_ips_to_block_combined","kind":13,"line":668,"name":"$self","localvar":"my","definition":"my"},{"localvar":"my","definition":"my","containerName":"clean_ips_to_block_combined","name":"$logobj","line":669,"kind":13},{"name":"$TID","kind":13,"line":670,"containerName":"clean_ips_to_block_combined","definition":"my","localvar":"my"},{"kind":12,"line":670,"name":"tid","containerName":"clean_ips_to_block_combined"},{"containerName":"clean_ips_to_block_combined","name":"$TID","kind":13,"line":671},{"line":671,"kind":13,"name":"$TID","containerName":"clean_ips_to_block_combined"},{"containerName":"clean_ips_to_block_combined","name":"$Data","kind":13,"line":673},{"kind":13,"line":674,"name":"$Data","containerName":"clean_ips_to_block_combined"}],"name":"clean_ips_to_block_combined","line":667,"kind":12,"range":{"start":{"line":667,"character":0},"end":{"character":9999,"line":676}},"detail":"()","containerName":"main::"},{"kind":12,"line":670,"name":"threads"},{"name":"Dumper","line":673,"kind":12,"containerName":"Terse"},{"name":"Dumper","line":674,"kind":12,"containerName":"Indent"},{"children":[{"definition":"my","localvar":"my","kind":13,"line":682,"name":"$self","containerName":"clean_ips_to_block_allowdeny"},{"definition":"my","localvar":"my","kind":13,"line":683,"name":"$logobj","containerName":"clean_ips_to_block_allowdeny"},{"localvar":"my","definition":"my","containerName":"clean_ips_to_block_allowdeny","kind":13,"line":684,"name":"$TID"},{"containerName":"clean_ips_to_block_allowdeny","name":"tid","kind":12,"line":684},{"name":"$TID","kind":13,"line":685,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$TID","kind":13,"line":685,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$Data","kind":13,"line":687,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$Data","kind":13,"line":688,"containerName":"clean_ips_to_block_allowdeny"},{"kind":13,"line":692,"name":"$allowdeny","containerName":"clean_ips_to_block_allowdeny","definition":"my","localvar":"my"},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"line":692,"name":"$logobj"},{"containerName":"clean_ips_to_block_allowdeny","name":"$self","line":692,"kind":13},{"definition":"my","localvar":"my","name":"$logobj_allowlist","line":693,"kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"kind":13,"line":693,"name":"$logobj","containerName":"clean_ips_to_block_allowdeny"},{"name":"$self","line":693,"kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","line":694,"kind":13,"name":"$logobj_denylist","localvar":"my","definition":"my"},{"name":"$logobj","kind":13,"line":694,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","name":"$self","line":694,"kind":13},{"containerName":"clean_ips_to_block_allowdeny","name":"$global_denylist","line":695,"kind":13,"localvar":"my","definition":"my"},{"containerName":"clean_ips_to_block_allowdeny","name":"$self","kind":13,"line":695},{"definition":"my","localvar":"my","name":"$global_allowlist","line":696,"kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"name":"$self","kind":13,"line":696,"containerName":"clean_ips_to_block_allowdeny"},{"definition":"my","localvar":"my","name":"$ips_to_block","kind":13,"line":698,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"line":698,"name":"$logobj"},{"containerName":"clean_ips_to_block_allowdeny","name":"$logobj_allowlist","kind":13,"line":701},{"kind":13,"line":701,"name":"$self","containerName":"clean_ips_to_block_allowdeny"},{"name":"reverseMapHash","kind":12,"line":701,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","name":"$logobj_allowlist","line":701,"kind":13},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"line":702,"name":"$logobj_denylist"},{"containerName":"clean_ips_to_block_allowdeny","name":"$self","line":702,"kind":13},{"containerName":"clean_ips_to_block_allowdeny","name":"reverseMapHash","line":702,"kind":12},{"containerName":"clean_ips_to_block_allowdeny","line":702,"kind":13,"name":"$logobj_denylist"},{"line":703,"kind":13,"name":"$global_allowlist","containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","line":703,"kind":13,"name":"$self"},{"containerName":"clean_ips_to_block_allowdeny","kind":12,"line":703,"name":"reverseMapHash"},{"containerName":"clean_ips_to_block_allowdeny","name":"$global_allowlist","kind":13,"line":703},{"kind":13,"line":704,"name":"$global_denylist","containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","name":"$self","line":704,"kind":13},{"containerName":"clean_ips_to_block_allowdeny","name":"reverseMapHash","line":704,"kind":12},{"line":704,"kind":13,"name":"$global_denylist","containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","line":707,"kind":13,"name":"$logger"},{"containerName":"clean_ips_to_block_allowdeny","name":"info","kind":12,"line":707},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"line":708,"name":"$logger"},{"kind":12,"line":708,"name":"debug","containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","name":"$logobj_allowlist","line":708,"kind":13},{"containerName":"clean_ips_to_block_allowdeny","name":"$logger","kind":13,"line":708},{"containerName":"clean_ips_to_block_allowdeny","name":"is_debug","kind":12,"line":708},{"containerName":"clean_ips_to_block_allowdeny","name":"$logger","kind":13,"line":709},{"kind":12,"line":709,"name":"debug","containerName":"clean_ips_to_block_allowdeny"},{"line":709,"kind":13,"name":"$logobj_denylist","containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","name":"$logger","kind":13,"line":709},{"containerName":"clean_ips_to_block_allowdeny","line":709,"kind":12,"name":"is_debug"},{"containerName":"clean_ips_to_block_allowdeny","name":"$logger","line":710,"kind":13},{"containerName":"clean_ips_to_block_allowdeny","name":"debug","line":710,"kind":12},{"containerName":"clean_ips_to_block_allowdeny","line":710,"kind":13,"name":"$ips_to_block"},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"line":710,"name":"$logger"},{"name":"is_debug","line":710,"kind":12,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","name":"$logger","line":711,"kind":13},{"containerName":"clean_ips_to_block_allowdeny","name":"debug","line":711,"kind":12},{"name":"$global_allowlist","kind":13,"line":711,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"line":711,"name":"$logger"},{"containerName":"clean_ips_to_block_allowdeny","kind":12,"line":711,"name":"is_debug"},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"line":712,"name":"$logger"},{"kind":12,"line":712,"name":"debug","containerName":"clean_ips_to_block_allowdeny"},{"kind":13,"line":712,"name":"$global_denylist","containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","name":"$logger","kind":13,"line":712},{"kind":12,"line":712,"name":"is_debug","containerName":"clean_ips_to_block_allowdeny"},{"localvar":"my","definition":"my","containerName":"clean_ips_to_block_allowdeny","name":"$allowlist","line":715,"kind":13},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"line":715,"name":"$global_allowlist"},{"line":715,"kind":13,"name":"$logobj_allowlist","containerName":"clean_ips_to_block_allowdeny"}],"signature":{"documentation":" Description: Returns the logobj with ips_to_block set with the IPs to block from the allow/deny lists\n   There is a lot of logging available in this sub.\n   This sub is called from review_log()","label":"clean_ips_to_block_allowdeny()","parameters":[]},"definition":"sub","containerName":"main::","detail":"()","range":{"start":{"character":0,"line":681},"end":{"line":715,"character":9999}},"kind":12,"line":681,"name":"clean_ips_to_block_allowdeny"},{"line":684,"kind":12,"name":"threads"},{"containerName":"Terse","name":"Dumper","kind":12,"line":687},{"containerName":"Indent","name":"Dumper","line":688,"kind":12},{"line":692,"kind":12,"name":"allowdeny"},{"name":"configs","line":692,"kind":12},{"kind":12,"line":692,"name":"allowdeny"},{"line":693,"kind":12,"name":"allowlist"},{"name":"configs","kind":12,"line":693},{"name":"allowlist","kind":12,"line":693},{"name":"denylist","kind":12,"line":694},{"kind":12,"line":694,"name":"configs"},{"line":694,"kind":12,"name":"denylist"},{"name":"configs","kind":12,"line":695},{"name":"denylist","kind":12,"line":695},{"line":696,"kind":12,"name":"configs"},{"line":696,"kind":12,"name":"allowlist"},{"name":"ips_to_block","kind":12,"line":698},{"line":708,"kind":12,"name":"Dumper"},{"kind":12,"line":709,"name":"Dumper"},{"name":"Dumper","line":710,"kind":12},{"name":"Dumper","line":711,"kind":12},{"name":"Dumper","line":712,"kind":12},{"localvar":"my","definition":"my","containerName":null,"line":716,"kind":13,"name":"%denylist"},{"containerName":null,"name":"$global_denylist","kind":13,"line":716},{"name":"$logobj_denylist","line":716,"kind":13,"containerName":null},{"line":719,"kind":13,"name":"$logger","containerName":null},{"line":719,"kind":12,"name":"debug","containerName":"main::"},{"name":"Dumper","kind":12,"line":719},{"kind":13,"line":719,"name":"$allowlist","containerName":null},{"kind":13,"line":719,"name":"$logger","containerName":null},{"containerName":"main::","name":"is_debug","kind":12,"line":719},{"name":"$logger","kind":13,"line":720,"containerName":null},{"containerName":"main::","kind":12,"line":720,"name":"debug"},{"name":"Dumper","kind":12,"line":720},{"containerName":null,"name":"$denylist","line":720,"kind":13},{"name":"$logger","kind":13,"line":720,"containerName":null},{"containerName":"main::","line":720,"kind":12,"name":"is_debug"},{"name":"%denylist","line":723,"kind":13,"containerName":null},{"name":"$denylist","line":723,"kind":13,"containerName":null},{"containerName":null,"name":"$ips_to_block","line":723,"kind":13},{"line":726,"kind":13,"name":"$logger","containerName":null},{"containerName":"main::","name":"debug","kind":12,"line":726},{"kind":12,"line":726,"name":"Dumper"},{"containerName":null,"name":"$denylist","kind":13,"line":726},{"containerName":null,"name":"$logger","line":726,"kind":13},{"line":726,"kind":12,"name":"is_debug","containerName":"main::"},{"name":"%allowdeny","line":730,"kind":13,"containerName":null},{"containerName":null,"name":"%logobj","kind":13,"line":731},{"name":"ips_to_block","kind":12,"line":731},{"kind":13,"line":731,"name":"$denylist","containerName":null},{"name":"%logobj","line":732,"kind":13,"containerName":null},{"line":737,"kind":13,"name":"%denylist","containerName":null},{"kind":13,"line":737,"name":"$allowlist","containerName":null},{"containerName":null,"name":"%logobj","kind":13,"line":738},{"kind":12,"line":738,"name":"ips_to_block"},{"name":"$denylist","line":738,"kind":13,"containerName":null},{"name":"$logobj","kind":13,"line":739,"containerName":null},{"signature":{"label":"run_iptables()","documentation":" Runs whatever parameters are passed to it against iptables\n  This is intended to be a one stop shop for running iptables out from a queue.\n  However, there are a few instances where it is called directly... especially when creating chains\n   This hopefully prevents excessive wait/locking on iptables\n   and helps to keep commands running in the order they are received.\n Arguments must be passed as a hash reference with (so far) the following keys:\n   rule:  The rule to run\n   options:  Any options to pass to iptables\n  Where it is ran like this:\n   iptables $options $rule 2>&1\n Future enhancement:\n   1. delete existing rule if it exists\n Take note this sub is intended (but not required) to be called from sub iptables_thread()\n  An error will happen if not called from sub iptables_thread(), but it will not stop the program\n  This is to encourage using the iptablesqueue_enqueue() sub instead of run_iptables() directly\n  So, top say this more clearly, if you want to run iptables commands, then call iptablesqueue_enqueue()","parameters":[]},"children":[{"localvar":"my","definition":"my","containerName":"run_iptables","name":"$self","line":759,"kind":13},{"containerName":"run_iptables","name":"$args","kind":13,"line":759},{"localvar":"my","definition":"my","containerName":"run_iptables","line":760,"kind":13,"name":"@caller_lst"},{"containerName":"run_iptables","kind":13,"line":761,"name":"$caller_lst"},{"name":"$IPTABLESRUNLINE","line":761,"kind":13,"containerName":"run_iptables"},{"containerName":"run_iptables","name":"$IPTABLESRUNLINE","line":761,"kind":13},{"definition":"my","localvar":"my","name":"$logmsg","kind":13,"line":762,"containerName":"run_iptables"},{"name":"@caller_lst","kind":13,"line":763,"containerName":"run_iptables"},{"kind":13,"line":768,"name":"$logger","containerName":"run_iptables"},{"line":768,"kind":12,"name":"error","containerName":"run_iptables"},{"name":"$logmsg","line":768,"kind":13,"containerName":"run_iptables"},{"definition":"my","localvar":"my","line":770,"kind":13,"name":"$TID","containerName":"run_iptables"},{"containerName":"run_iptables","name":"tid","line":770,"kind":12},{"containerName":"run_iptables","name":"$TID","kind":13,"line":771},{"name":"$TID","kind":13,"line":771,"containerName":"run_iptables"},{"name":"$args","kind":13,"line":774,"containerName":"run_iptables"},{"containerName":"run_iptables","kind":13,"line":774,"name":"$logger"},{"containerName":"run_iptables","name":"error","line":774,"kind":12},{"containerName":"run_iptables","name":"$self","line":775,"kind":13},{"containerName":"run_iptables","line":775,"kind":13,"name":"$logger"},{"name":"error","kind":12,"line":775,"containerName":"run_iptables"},{"definition":"my","localvar":"my","name":"$iptables","line":777,"kind":13,"containerName":"run_iptables"},{"line":777,"kind":13,"name":"$self","containerName":"run_iptables"},{"definition":"my","localvar":"my","kind":13,"line":778,"name":"$rule","containerName":"run_iptables"},{"containerName":"run_iptables","name":"$args","line":778,"kind":13},{"containerName":"run_iptables","kind":13,"line":779,"name":"$options","localvar":"my","definition":"my"},{"name":"$args","line":779,"kind":13,"containerName":"run_iptables"},{"name":"$logger","kind":13,"line":781,"containerName":"run_iptables"},{"line":781,"kind":12,"name":"is_debug","containerName":"run_iptables"},{"kind":13,"line":782,"name":"$logger","containerName":"run_iptables"},{"line":782,"kind":12,"name":"debug","containerName":"run_iptables"},{"kind":13,"line":783,"name":"$args","containerName":"run_iptables"},{"containerName":"run_iptables","line":791,"kind":13,"name":"$args"},{"localvar":"my","definition":"my","containerName":"run_iptables","name":"$allowdupes","kind":13,"line":792},{"containerName":"run_iptables","kind":13,"line":792,"name":"$args"},{"containerName":"run_iptables","name":"$allowdupes","kind":13,"line":794},{"name":"$logger","kind":13,"line":795,"containerName":"run_iptables"},{"name":"debug","line":795,"kind":12,"containerName":"run_iptables"},{"definition":"my","localvar":"my","line":796,"kind":13,"name":"$retval","containerName":"run_iptables"},{"containerName":"run_iptables","line":796,"kind":13,"name":"$self"},{"containerName":"run_iptables","kind":12,"line":796,"name":"check_if_rule_exists"},{"line":796,"kind":13,"name":"$args","containerName":"run_iptables"},{"name":"$retval","line":797,"kind":13,"containerName":"run_iptables"},{"name":"$logger","kind":13,"line":801,"containerName":"run_iptables"},{"containerName":"run_iptables","kind":12,"line":801,"name":"debug"},{"name":"$retval","kind":13,"line":804,"containerName":"run_iptables"},{"containerName":"run_iptables","kind":13,"line":805,"name":"$logger"},{"line":805,"kind":12,"name":"debug","containerName":"run_iptables"},{"line":807,"kind":13,"name":"$retval","containerName":"run_iptables"},{"containerName":"run_iptables","line":808,"kind":13,"name":"$options"},{"containerName":"run_iptables","name":"$logger","kind":13,"line":811},{"kind":12,"line":811,"name":"debug","containerName":"run_iptables"},{"containerName":"run_iptables","name":"$self","kind":13,"line":814},{"kind":13,"line":814,"name":"$rule","containerName":"run_iptables"},{"name":"$retval","line":816,"kind":13,"containerName":"run_iptables"},{"kind":13,"line":817,"name":"$logger","containerName":"run_iptables"},{"containerName":"run_iptables","kind":12,"line":817,"name":"error"},{"containerName":"run_iptables","kind":13,"line":820,"name":"$retval"},{"line":821,"kind":13,"name":"$logger","containerName":"run_iptables"},{"line":821,"kind":12,"name":"error","containerName":"run_iptables"},{"containerName":"run_iptables","line":825,"kind":13,"name":"$logger"},{"kind":12,"line":825,"name":"error","containerName":"run_iptables"},{"containerName":"run_iptables","kind":13,"line":825,"name":"$retval"},{"localvar":"my","definition":"my","containerName":"run_iptables","line":830,"kind":13,"name":"$command"},{"line":831,"kind":13,"name":"$self","containerName":"run_iptables"},{"name":"$logger","line":832,"kind":13,"containerName":"run_iptables"},{"containerName":"run_iptables","line":832,"kind":12,"name":"debug"},{"definition":"my","localvar":"my","name":"$output","line":833,"kind":13,"containerName":"run_iptables"},{"containerName":"run_iptables","name":"$logger","kind":13,"line":834},{"containerName":"run_iptables","kind":12,"line":834,"name":"debug"},{"name":"$logger","line":838,"kind":13,"containerName":"run_iptables"},{"name":"info","line":838,"kind":12,"containerName":"run_iptables"},{"containerName":"run_iptables","name":"$logger","kind":13,"line":843},{"containerName":"run_iptables","name":"error","line":843,"kind":12}],"definition":"sub","containerName":"main::","detail":"()","range":{"start":{"character":0,"line":758},"end":{"character":9999,"line":845}},"name":"run_iptables","line":758,"kind":12},{"name":"Dumper","line":763,"kind":12},{"kind":12,"line":770,"name":"threads"},{"name":"rule","line":774,"kind":12},{"name":"configs","kind":12,"line":775},{"line":775,"kind":12,"name":"iptables"},{"name":"configs","kind":12,"line":777},{"kind":12,"line":777,"name":"iptables"},{"name":"rule","kind":12,"line":778},{"name":"options","line":779,"kind":12},{"name":"Dumper","kind":12,"line":783},{"kind":12,"line":791,"name":"allowdupes"},{"kind":12,"line":792,"name":"allowdupes"},{"line":814,"kind":12,"name":"chains_created"},{"name":"configs","kind":12,"line":831},{"name":"PRODMODE","line":831,"kind":12},{"children":[{"containerName":"set_iptables_command","name":"$self","kind":13,"line":849,"localvar":"my","definition":"my"},{"containerName":"set_iptables_command","name":"$self","line":852,"kind":13},{"kind":13,"line":853,"name":"$self","containerName":"set_iptables_command"},{"containerName":"set_iptables_command","line":854,"kind":13,"name":"$logger"},{"containerName":"set_iptables_command","line":854,"kind":12,"name":"info"}],"signature":{"parameters":[],"documentation":" Maybe an unnecessary sub but maybe some better checks down the road","label":"set_iptables_command()"},"definition":"sub","detail":"()","range":{"start":{"line":848,"character":0},"end":{"line":856,"character":9999}},"containerName":"main::","kind":12,"line":848,"name":"set_iptables_command"},{"line":852,"kind":12,"name":"configs"},{"name":"iptables","kind":12,"line":852},{"name":"configs","kind":12,"line":853},{"kind":12,"line":853,"name":"iptables"},{"signature":{"parameters":[{"label":"$self"},{"label":"$args"}],"label":"check_if_rule_exists($self,$args)","documentation":"# Returns 0 if there is an unknown return value from running iptables\n#          Otherwise returns a string"},"children":[{"localvar":"my","definition":"my","containerName":"check_if_rule_exists","name":"$self","line":861,"kind":13},{"name":"$args","line":861,"kind":13,"containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","kind":13,"line":862,"name":"$TID","localvar":"my","definition":"my"},{"containerName":"check_if_rule_exists","name":"tid","kind":12,"line":862},{"containerName":"check_if_rule_exists","line":863,"kind":13,"name":"$TID"},{"containerName":"check_if_rule_exists","name":"$TID","line":863,"kind":13},{"kind":13,"line":866,"name":"$args","containerName":"check_if_rule_exists"},{"name":"$self","kind":13,"line":866,"containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","line":866,"kind":12,"name":"log_and_return"},{"kind":13,"line":867,"name":"$self","containerName":"check_if_rule_exists"},{"name":"$logger","line":867,"kind":13,"containerName":"check_if_rule_exists"},{"name":"error","kind":12,"line":867,"containerName":"check_if_rule_exists"},{"definition":"my","localvar":"my","name":"$iptables","kind":13,"line":869,"containerName":"check_if_rule_exists"},{"line":869,"kind":13,"name":"$self","containerName":"check_if_rule_exists"},{"localvar":"my","definition":"my","containerName":"check_if_rule_exists","kind":13,"line":870,"name":"$rule"},{"line":870,"kind":13,"name":"$args","containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","kind":13,"line":871,"name":"$options","localvar":"my","definition":"my"},{"name":"$args","kind":13,"line":871,"containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","name":"$options","line":873,"kind":13},{"name":"$logmsg","line":874,"kind":13,"containerName":"check_if_rule_exists","definition":"my","localvar":"my"},{"line":875,"kind":13,"name":"$logmsg","containerName":"check_if_rule_exists"},{"line":876,"kind":13,"name":"$logger","containerName":"check_if_rule_exists"},{"kind":12,"line":876,"name":"debug","containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","line":876,"kind":13,"name":"$logmsg"},{"localvar":"my","definition":"my","containerName":"check_if_rule_exists","kind":13,"line":880,"name":"$checkrule_result"},{"containerName":"check_if_rule_exists","name":"$logger","line":882,"kind":13},{"name":"debug","kind":12,"line":882,"containerName":"check_if_rule_exists"},{"name":"$checkrule_result","line":886,"kind":13,"containerName":"check_if_rule_exists"},{"line":887,"kind":13,"name":"$logger","containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","name":"debug","line":887,"kind":12},{"containerName":"check_if_rule_exists","name":"$logger","line":888,"kind":13},{"containerName":"check_if_rule_exists","name":"debug","line":888,"kind":12},{"containerName":"check_if_rule_exists","name":"$checkrule_result","line":892,"kind":13},{"containerName":"check_if_rule_exists","name":"$logger","line":893,"kind":13},{"kind":12,"line":893,"name":"debug","containerName":"check_if_rule_exists"},{"name":"$logger","kind":13,"line":894,"containerName":"check_if_rule_exists"},{"kind":12,"line":894,"name":"debug","containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","name":"$checkrule_result","line":898,"kind":13},{"line":899,"kind":13,"name":"$logger","containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","kind":12,"line":899,"name":"debug"},{"containerName":"check_if_rule_exists","line":900,"kind":13,"name":"$logger"},{"containerName":"check_if_rule_exists","kind":12,"line":900,"name":"debug"},{"containerName":"check_if_rule_exists","name":"$self","line":904,"kind":13},{"containerName":"check_if_rule_exists","name":"log_and_return","kind":12,"line":904}],"definition":"sub","containerName":"main::","range":{"start":{"line":860,"character":0},"end":{"character":9999,"line":905}},"detail":"($self,$args)","name":"check_if_rule_exists","kind":12,"line":860},{"kind":12,"line":862,"name":"threads"},{"kind":12,"line":866,"name":"rule"},{"name":"configs","line":867,"kind":12},{"name":"iptables","kind":12,"line":867},{"name":"configs","line":869,"kind":12},{"kind":12,"line":869,"name":"iptables"},{"name":"rule","kind":12,"line":870},{"name":"options","line":871,"kind":12},{"definition":"sub","signature":{"label":"log_and_return($self,$error_message)","documentation":"","parameters":[{"label":"$self"},{"label":"$error_message"}]},"children":[{"name":"$self","line":908,"kind":13,"containerName":"log_and_return","definition":"my","localvar":"my"},{"kind":13,"line":908,"name":"$error_message","containerName":"log_and_return"},{"line":909,"kind":13,"name":"$TID","containerName":"log_and_return","definition":"my","localvar":"my"},{"name":"tid","line":909,"kind":12,"containerName":"log_and_return"},{"name":"$TID","kind":13,"line":910,"containerName":"log_and_return"},{"name":"$TID","line":910,"kind":13,"containerName":"log_and_return"},{"kind":13,"line":911,"name":"$logger","containerName":"log_and_return"},{"containerName":"log_and_return","line":911,"kind":12,"name":"error"},{"line":911,"kind":13,"name":"$error_message","containerName":"log_and_return"}],"name":"log_and_return","line":907,"kind":12,"range":{"end":{"character":9999,"line":913},"start":{"line":907,"character":0}},"detail":"($self,$error_message)","containerName":"main::"},{"kind":12,"line":909,"name":"threads"},{"range":{"end":{"line":929,"character":9999},"start":{"character":0,"line":918}},"detail":"()","containerName":"main::","kind":12,"line":918,"name":"add_global_chains_to_input_output","children":[{"kind":13,"line":919,"name":"$self","containerName":"add_global_chains_to_input_output","definition":"my","localvar":"my"},{"localvar":"my","definition":"my","containerName":"add_global_chains_to_input_output","kind":13,"line":922,"name":"@allowdenyorder"},{"localvar":"my","definition":"my","containerName":"add_global_chains_to_input_output","name":"@builtinchains","line":926,"kind":13},{"containerName":"add_global_chains_to_input_output","name":"$self","line":927,"kind":13},{"containerName":"add_global_chains_to_input_output","name":"@builtinchains","line":928,"kind":13},{"containerName":"add_global_chains_to_input_output","line":928,"kind":13,"name":"$self"}],"signature":{"label":"add_global_chains_to_input_output()","documentation":" This is a one time event to add the global chains to the INPUT and OUTPUT chains\n   This is only called once when the module is first run\n   This is only called if the global rules do not exist","parameters":[]},"definition":"sub"},{"name":"configs","kind":12,"line":927},{"name":"globalchains","kind":12,"line":927},{"name":"configs","line":928,"kind":12},{"line":928,"kind":12,"name":"globalchains"},{"kind":13,"line":932,"name":"%self","containerName":null},{"line":932,"kind":12,"name":"configs"},{"name":"allowdeny","line":932,"kind":12},{"name":"@allowdenyorder","kind":13,"line":933,"containerName":null},{"kind":13,"line":933,"name":"@allowdenyorder","containerName":null},{"containerName":null,"line":933,"kind":13,"name":"%self"},{"name":"configs","line":933,"kind":12},{"name":"allowdeny","kind":12,"line":933},{"containerName":null,"name":"$newchain","line":936,"kind":13,"localvar":"my","definition":"my"},{"containerName":null,"name":"@allowdenyorder","line":936,"kind":13},{"containerName":null,"line":939,"kind":13,"name":"$IptablesQueue"},{"name":"enqueue","line":939,"kind":12,"containerName":"main::"},{"name":"options","kind":12,"line":941},{"name":"rule","line":942,"kind":12},{"kind":13,"line":946,"name":"$builtinchain","containerName":null,"definition":"my","localvar":"my"},{"containerName":null,"name":"@builtinchains","kind":13,"line":946},{"definition":"my","localvar":"my","line":947,"kind":13,"name":"$arguments","containerName":null},{"name":"$IptablesQueue","kind":13,"line":952,"containerName":null},{"name":"enqueue","line":952,"kind":12,"containerName":"main::"},{"kind":12,"line":954,"name":"options"},{"line":955,"kind":12,"name":"rule"},{"name":"allowdupes","kind":12,"line":956},{"name":"deleteexisting","line":957,"kind":12},{"containerName":"main::","detail":"()","range":{"start":{"line":968,"character":0},"end":{"line":985,"character":9999}},"name":"create_iptables_chain","kind":12,"line":968,"signature":{"documentation":" Create iptables chain","label":"create_iptables_chain()","parameters":[]},"children":[{"containerName":"create_iptables_chain","name":"$self","line":969,"kind":13,"localvar":"my","definition":"my"},{"name":"$name","line":969,"kind":13,"containerName":"create_iptables_chain"},{"localvar":"my","definition":"my","containerName":"create_iptables_chain","line":970,"kind":13,"name":"$TID"},{"containerName":"create_iptables_chain","kind":12,"line":970,"name":"tid"},{"line":972,"kind":13,"name":"$logger","containerName":"create_iptables_chain"},{"kind":12,"line":972,"name":"info","containerName":"create_iptables_chain"},{"name":"$rule","line":979,"kind":13,"containerName":"create_iptables_chain","definition":"my","localvar":"my"},{"kind":13,"line":980,"name":"$options","containerName":"create_iptables_chain","definition":"my","localvar":"my"},{"localvar":"my","definition":"my","containerName":"create_iptables_chain","name":"$args","line":981,"kind":13},{"containerName":"create_iptables_chain","kind":13,"line":981,"name":"$rule"},{"line":981,"kind":13,"name":"$options","containerName":"create_iptables_chain"},{"line":983,"kind":13,"name":"$self","containerName":"create_iptables_chain"},{"name":"iptablesqueue_enqueue","kind":12,"line":983,"containerName":"create_iptables_chain"},{"name":"$args","line":983,"kind":13,"containerName":"create_iptables_chain"}],"definition":"sub"},{"kind":12,"line":970,"name":"threads"},{"name":"rule","kind":12,"line":981},{"line":981,"kind":12,"name":"options"},{"containerName":"main::","detail":"()","range":{"start":{"character":0,"line":987},"end":{"character":9999,"line":1002}},"line":987,"kind":12,"name":"iptablesqueue_enqueue","children":[{"definition":"my","localvar":"my","name":"$self","kind":13,"line":988,"containerName":"iptablesqueue_enqueue"},{"containerName":"iptablesqueue_enqueue","name":"$args","line":988,"kind":13},{"definition":"my","localvar":"my","line":989,"kind":13,"name":"$TID","containerName":"iptablesqueue_enqueue"},{"line":989,"kind":12,"name":"tid","containerName":"iptablesqueue_enqueue"},{"kind":13,"line":990,"name":"$TID","containerName":"iptablesqueue_enqueue"},{"containerName":"iptablesqueue_enqueue","line":990,"kind":13,"name":"$TID"},{"line":991,"kind":13,"name":"$logger","containerName":"iptablesqueue_enqueue"},{"name":"is_debug","kind":12,"line":991,"containerName":"iptablesqueue_enqueue"},{"line":992,"kind":13,"name":"$lastqitem","containerName":"iptablesqueue_enqueue","definition":"my","localvar":"my"},{"containerName":"iptablesqueue_enqueue","kind":13,"line":992,"name":"$IptablesQueue"},{"kind":12,"line":992,"name":"peek","containerName":"iptablesqueue_enqueue"},{"containerName":"iptablesqueue_enqueue","kind":13,"line":993,"name":"$logger"},{"containerName":"iptablesqueue_enqueue","name":"debug","kind":12,"line":993},{"containerName":"iptablesqueue_enqueue","kind":13,"line":993,"name":"$lastqitem"},{"containerName":"iptablesqueue_enqueue","kind":13,"line":994,"name":"$logger"},{"containerName":"iptablesqueue_enqueue","name":"debug","kind":12,"line":994},{"kind":13,"line":994,"name":"$args","containerName":"iptablesqueue_enqueue"},{"containerName":"iptablesqueue_enqueue","name":"$IptablesQueue","line":996,"kind":13},{"containerName":"iptablesqueue_enqueue","name":"enqueue","line":996,"kind":12},{"containerName":"iptablesqueue_enqueue","name":"$args","kind":13,"line":996},{"containerName":"iptablesqueue_enqueue","name":"$logger","line":997,"kind":13},{"containerName":"iptablesqueue_enqueue","kind":12,"line":997,"name":"is_debug"},{"name":"$lastqitem","line":998,"kind":13,"containerName":"iptablesqueue_enqueue","definition":"my","localvar":"my"},{"kind":13,"line":998,"name":"$IptablesQueue","containerName":"iptablesqueue_enqueue"},{"line":998,"kind":12,"name":"peek","containerName":"iptablesqueue_enqueue"},{"name":"$logger","kind":13,"line":999,"containerName":"iptablesqueue_enqueue"},{"containerName":"iptablesqueue_enqueue","name":"debug","line":999,"kind":12},{"name":"$lastqitem","line":999,"kind":13,"containerName":"iptablesqueue_enqueue"}],"signature":{"parameters":[],"label":"iptablesqueue_enqueue()","documentation":""},"definition":"sub"},{"line":989,"kind":12,"name":"threads"},{"name":"Dumper","line":993,"kind":12},{"kind":12,"line":994,"name":"Dumper"},{"kind":12,"line":999,"name":"Dumper"},{"containerName":"main::","range":{"end":{"character":9999,"line":1054},"start":{"line":1009,"character":0}},"detail":"($self,$logobj)","kind":12,"line":1009,"name":"readlogfile","children":[{"definition":"my","localvar":"my","name":"$self","line":1010,"kind":13,"containerName":"readlogfile"},{"containerName":"readlogfile","kind":13,"line":1010,"name":"$logobj"},{"line":1011,"kind":13,"name":"$TID","containerName":"readlogfile","definition":"my","localvar":"my"},{"name":"tid","line":1011,"kind":12,"containerName":"readlogfile"},{"line":1012,"kind":13,"name":"$TID","containerName":"readlogfile"},{"containerName":"readlogfile","line":1012,"kind":13,"name":"$TID"},{"containerName":"readlogfile","name":"$file","kind":13,"line":1015,"localvar":"my","definition":"my"},{"kind":13,"line":1015,"name":"$logobj","containerName":"readlogfile"},{"containerName":"readlogfile","kind":13,"line":1016,"name":"$file"},{"containerName":"readlogfile","kind":13,"line":1016,"name":"$logger"},{"containerName":"readlogfile","line":1016,"kind":12,"name":"error"},{"containerName":"readlogfile","name":"$logobj","line":1016,"kind":13},{"kind":13,"line":1019,"name":"$logobj","containerName":"readlogfile"},{"containerName":"readlogfile","line":1020,"kind":13,"name":"$logobj"},{"containerName":"readlogfile","line":1020,"kind":13,"name":"$file"},{"name":"$logobj","line":1020,"kind":13,"containerName":"readlogfile"},{"containerName":"readlogfile","name":"$logobj","kind":13,"line":1021},{"containerName":"readlogfile","kind":13,"line":1021,"name":"$self"},{"containerName":"readlogfile","name":"$logobj","line":1022,"kind":13},{"name":"$logobj","kind":13,"line":1022,"containerName":"readlogfile"},{"containerName":"readlogfile","name":"$logger","kind":13,"line":1024},{"kind":12,"line":1024,"name":"debug","containerName":"readlogfile"},{"definition":"my","localvar":"my","name":"$fh","kind":13,"line":1030,"containerName":"readlogfile"},{"containerName":"readlogfile","kind":13,"line":1030,"name":"$file"},{"containerName":"readlogfile","name":"$logger","kind":13,"line":1031},{"containerName":"readlogfile","name":"error","line":1031,"kind":12},{"name":"$logobj","kind":13,"line":1032,"containerName":"readlogfile"},{"line":1034,"kind":13,"name":"$fh","containerName":"readlogfile"},{"name":"$logobj","line":1034,"kind":13,"containerName":"readlogfile"},{"containerName":"readlogfile","line":1035,"kind":13,"name":"@logcontents","localvar":"my","definition":"my"},{"name":"$fh","kind":13,"line":1035,"containerName":"readlogfile"},{"containerName":"readlogfile","line":1036,"kind":13,"name":"$logobj"},{"name":"$fh","line":1036,"kind":13,"containerName":"readlogfile"},{"containerName":"readlogfile","kind":13,"line":1037,"name":"$fh"},{"containerName":"readlogfile","name":"@logcontents","line":1039,"kind":13},{"containerName":"readlogfile","name":"$logger","line":1040,"kind":13},{"containerName":"readlogfile","line":1040,"kind":12,"name":"info"},{"name":"$logobj","kind":13,"line":1041,"containerName":"readlogfile"},{"containerName":"readlogfile","kind":13,"line":1044,"name":"$logger"},{"name":"debug","kind":12,"line":1044,"containerName":"readlogfile"},{"name":"@logcontents","line":1044,"kind":13,"containerName":"readlogfile"},{"containerName":"readlogfile","name":"@logcontents","line":1047,"kind":13},{"containerName":"readlogfile","name":"$logobj","line":1048,"kind":13},{"containerName":"readlogfile","line":1048,"kind":13,"name":"@logcontents"},{"name":"$logger","line":1050,"kind":13,"containerName":"readlogfile"},{"name":"debug","kind":12,"line":1050,"containerName":"readlogfile"},{"name":"@logcontents","kind":13,"line":1050,"containerName":"readlogfile"},{"containerName":"readlogfile","name":"$logger","kind":13,"line":1051},{"containerName":"readlogfile","name":"trace","line":1051,"kind":12},{"name":"$logobj","kind":13,"line":1051,"containerName":"readlogfile"},{"containerName":"readlogfile","line":1051,"kind":13,"name":"$logger"},{"kind":12,"line":1051,"name":"is_trace","containerName":"readlogfile"},{"name":"$logobj","line":1053,"kind":13,"containerName":"readlogfile"}],"signature":{"parameters":[{"label":"$self"},{"label":"$logobj"}],"documentation":" This function reads the log file into memory from the seek position (if it exists)\n The reading of a log file based on the seek position creates a big issue if the log file is rotated AND is larger than\n   the seek position\n   This is a tradeoff of reading the entire log file into memory and then grepping for the regexps\n Returns: $logobj","label":"readlogfile($self,$logobj)"},"definition":"sub"},{"name":"threads","line":1011,"kind":12},{"name":"file","kind":12,"line":1015},{"kind":12,"line":1019,"name":"seek"},{"name":"seek","kind":12,"line":1020},{"name":"seek","kind":12,"line":1020},{"kind":12,"line":1021,"name":"readentirefile"},{"line":1021,"kind":12,"name":"configs"},{"name":"readentirefile","line":1021,"kind":12},{"line":1022,"kind":12,"name":"seek"},{"line":1022,"kind":12,"name":"readentirefile"},{"name":"seek","line":1034,"kind":12},{"kind":12,"line":1036,"name":"seek"},{"kind":12,"line":1041,"name":"logcontents"},{"line":1048,"kind":12,"name":"logcontents"},{"line":1051,"kind":12,"name":"Dumper"},{"line":1051,"kind":12,"name":"logcontents"},{"definition":"sub","signature":{"parameters":[{"label":"$self"},{"label":"$log"}],"documentation":" # This greps for multiple regexps and returns the matchedlines from logobj->{logcontents}\n # Returns an array reference of matched lines\n sub _grep_regexp() {\n     my ( $self, $logobj, $regexps ) = @_;\n     my @matchedlines = ();\n     foreach my $regexp ( sort keys %{$regexps} ) {\n         # my $value = $regexps->{$regexp};\n         my $value = ${$regexps}{$regexp};\n         $logger->info(\"Grep'ing for >>$value<< in $logobj->{file} from byte position $logobj->{seek}\");\n         # @matchedlines = grep { /$value/ } @{ $logobj->{logcontents} };\n         push @matchedlines, grep { /$value/ } @{ $logobj->{logcontents} };\n         $logger->debug( \"Dumper of current matches: \" . Dumper(@matchedlines) ) if ( $logger->is_debug() );\n     } ## end foreach my $regexp ( sort keys...)\n     return \\@matchedlines;\n } ## end sub _grep_regexp\n Description:  Using the logobj, this greps against the log contents for matching lines and then gets the\n               IP address on each line.\n Returns:  Hash reference of IP addresses with count of how many times the IP address was found","label":"_grep_regexps($self,$log)"},"children":[{"localvar":"my","definition":"my","containerName":"_grep_regexps","name":"$self","kind":13,"line":1079},{"containerName":"_grep_regexps","name":"$log","kind":13,"line":1079},{"containerName":"_grep_regexps","name":"$TID","line":1080,"kind":13,"localvar":"my","definition":"my"},{"containerName":"_grep_regexps","name":"tid","kind":12,"line":1080},{"kind":13,"line":1082,"name":"$matches","containerName":"_grep_regexps","definition":"my","localvar":"my"},{"localvar":"my","definition":"my","containerName":"_grep_regexps","name":"@log_contents","kind":13,"line":1083},{"containerName":"_grep_regexps","line":1083,"kind":13,"name":"$log"}],"name":"_grep_regexps","kind":12,"line":1078,"detail":"($self,$log)","range":{"end":{"line":1083,"character":9999},"start":{"line":1078,"character":0}},"containerName":"main::"},{"line":1080,"kind":12,"name":"threads"},{"line":1083,"kind":12,"name":"logcontents"},{"name":"$regex","line":1086,"kind":13,"containerName":null,"definition":"my","localvar":"my"},{"name":"%log","line":1086,"kind":13,"containerName":null},{"name":"regexpdeny","kind":12,"line":1086},{"definition":"my","localvar":"my","name":"$pattern","line":1087,"kind":13,"containerName":null},{"kind":13,"line":1087,"name":"%log","containerName":null},{"line":1087,"kind":12,"name":"regexpdeny"},{"containerName":null,"line":1087,"kind":13,"name":"$regex"},{"containerName":null,"kind":13,"line":1088,"name":"$logger"},{"containerName":"main::","name":"info","kind":12,"line":1088},{"containerName":null,"name":"@current_matches","kind":13,"line":1090,"localvar":"my","definition":"my"},{"name":"@log_contents","kind":13,"line":1090,"containerName":null},{"containerName":null,"line":1091,"kind":13,"name":"$logger"},{"containerName":"main::","name":"debug","line":1091,"kind":12},{"name":"Dumper","line":1091,"kind":12},{"name":"@current_matches","kind":13,"line":1091,"containerName":null},{"kind":13,"line":1091,"name":"$logger","containerName":null},{"name":"is_debug","kind":12,"line":1091,"containerName":"main::"},{"localvar":"my","definition":"my","containerName":null,"name":"$line","kind":13,"line":1093},{"containerName":null,"kind":13,"line":1093,"name":"@current_matches"},{"name":"$line","kind":13,"line":1094,"containerName":null},{"name":"$logger","kind":13,"line":1095,"containerName":null},{"containerName":"main::","line":1095,"kind":12,"name":"debug"},{"kind":13,"line":1097,"name":"$ip_address","containerName":null,"definition":"my","localvar":"my"},{"kind":13,"line":1097,"name":"$line","containerName":null},{"containerName":null,"line":1097,"kind":13,"name":"%line"},{"containerName":null,"kind":13,"line":1098,"name":"%matches"},{"name":"$ip_address","line":1098,"kind":13,"containerName":null},{"containerName":null,"line":1099,"kind":13,"name":"$logger"},{"line":1099,"kind":12,"name":"debug","containerName":"main::"},{"containerName":null,"name":"$logger","kind":13,"line":1104},{"containerName":"main::","line":1104,"kind":12,"name":"debug"},{"kind":12,"line":1104,"name":"Dumper"},{"containerName":null,"name":"$matches","kind":13,"line":1104},{"name":"$logger","kind":13,"line":1104,"containerName":null},{"containerName":"main::","kind":12,"line":1104,"name":"is_debug"},{"definition":"my","localvar":"my","name":"$log_msg","line":1106,"kind":13,"containerName":null},{"name":"$log_msg","kind":13,"line":1107,"containerName":null},{"containerName":null,"kind":13,"line":1107,"name":"$matches"},{"name":"$logger","kind":13,"line":1108,"containerName":null},{"kind":12,"line":1108,"name":"info","containerName":"main::"},{"name":"$log_msg","kind":13,"line":1108,"containerName":null},{"name":"$matches","kind":13,"line":1110,"containerName":null},{"line":1113,"kind":12,"name":"add_chain","range":{"end":{"character":9999,"line":1123},"start":{"line":1113,"character":0}},"detail":"()","containerName":"main::","definition":"sub","children":[{"definition":"my","localvar":"my","line":1114,"kind":13,"name":"$self","containerName":"add_chain"},{"containerName":"add_chain","name":"$chain","kind":13,"line":1114},{"definition":"my","localvar":"my","name":"$TID","kind":13,"line":1115,"containerName":"add_chain"},{"containerName":"add_chain","kind":12,"line":1115,"name":"tid"},{"line":1117,"kind":13,"name":"$logger","containerName":"add_chain"},{"name":"info","kind":12,"line":1117,"containerName":"add_chain"},{"line":1118,"kind":13,"name":"$rule","containerName":"add_chain","definition":"my","localvar":"my"},{"localvar":"my","definition":"my","containerName":"add_chain","name":"$options","kind":13,"line":1119},{"definition":"my","localvar":"my","name":"$args","line":1120,"kind":13,"containerName":"add_chain"},{"containerName":"add_chain","name":"$rule","kind":13,"line":1120},{"containerName":"add_chain","kind":13,"line":1120,"name":"$options"},{"containerName":"add_chain","kind":13,"line":1121,"name":"$self"},{"kind":12,"line":1121,"name":"iptablesqueue_enqueue","containerName":"add_chain"},{"line":1121,"kind":13,"name":"$args","containerName":"add_chain"}],"signature":{"parameters":[],"label":"add_chain()","documentation":""}},{"name":"threads","line":1115,"kind":12},{"name":"rule","line":1120,"kind":12},{"name":"options","line":1120,"kind":12},{"children":[{"line":1133,"kind":13,"name":"$self","containerName":"add_allowdeny_ips","definition":"my","localvar":"my"},{"containerName":"add_allowdeny_ips","kind":13,"line":1133,"name":"$args"},{"name":"$TID","line":1134,"kind":13,"containerName":"add_allowdeny_ips","definition":"my","localvar":"my"},{"containerName":"add_allowdeny_ips","name":"tid","line":1134,"kind":12},{"name":"$args","kind":13,"line":1136,"containerName":"add_allowdeny_ips"},{"containerName":"add_allowdeny_ips","name":"$logger","kind":13,"line":1137},{"name":"error","kind":12,"line":1137,"containerName":"add_allowdeny_ips"},{"name":"%ip_rules","kind":13,"line":1141,"containerName":"add_allowdeny_ips","definition":"my","localvar":"my"},{"name":"$args","line":1142,"kind":13,"containerName":"add_allowdeny_ips"},{"line":1143,"kind":13,"name":"$args","containerName":"add_allowdeny_ips"},{"containerName":"add_allowdeny_ips","kind":13,"line":1146,"name":"$logger"},{"name":"debug","line":1146,"kind":12,"containerName":"add_allowdeny_ips"},{"containerName":"add_allowdeny_ips","line":1146,"kind":13,"name":"%ip_rules"},{"name":"$logger","kind":13,"line":1146,"containerName":"add_allowdeny_ips"},{"name":"is_debug","kind":12,"line":1146,"containerName":"add_allowdeny_ips"},{"containerName":"add_allowdeny_ips","kind":13,"line":1148,"name":"$action","localvar":"my","definition":"my"},{"name":"%ip_rules","kind":13,"line":1148,"containerName":"add_allowdeny_ips"},{"containerName":"add_allowdeny_ips","kind":13,"line":1150,"name":"$chain","localvar":"my","definition":"my"},{"name":"$args","line":1150,"kind":13,"containerName":"add_allowdeny_ips"},{"containerName":"add_allowdeny_ips","line":1150,"kind":13,"name":"$action"},{"containerName":"add_allowdeny_ips","name":"$rule_action","kind":13,"line":1151,"localvar":"my","definition":"my"},{"containerName":"add_allowdeny_ips","line":1151,"kind":13,"name":"$action"},{"containerName":"add_allowdeny_ips","kind":13,"line":1152,"name":"$ruleorder","localvar":"my","definition":"my"},{"containerName":"add_allowdeny_ips","name":"$ip_rules","kind":13,"line":1152},{"containerName":"add_allowdeny_ips","name":"$action","kind":13,"line":1152},{"containerName":"add_allowdeny_ips","kind":13,"line":1153,"name":"$ip","localvar":"my","definition":"my"},{"containerName":"add_allowdeny_ips","kind":13,"line":1153,"name":"$ip_rules"},{"line":1153,"kind":13,"name":"$action","containerName":"add_allowdeny_ips"},{"containerName":"add_allowdeny_ips","line":1153,"kind":13,"name":"$ruleorder"},{"definition":"my","localvar":"my","kind":13,"line":1154,"name":"$direction","containerName":"add_allowdeny_ips"},{"definition":"my","localvar":"my","kind":13,"line":1156,"name":"$rule","containerName":"add_allowdeny_ips"},{"name":"$args","line":1157,"kind":13,"containerName":"add_allowdeny_ips","definition":"my","localvar":"my"},{"name":"$rule","kind":13,"line":1157,"containerName":"add_allowdeny_ips"},{"containerName":"add_allowdeny_ips","line":1159,"kind":13,"name":"$logger"},{"containerName":"add_allowdeny_ips","kind":12,"line":1159,"name":"debug"},{"containerName":"add_allowdeny_ips","name":"$self","line":1160,"kind":13},{"kind":12,"line":1160,"name":"iptablesqueue_enqueue","containerName":"add_allowdeny_ips"},{"containerName":"add_allowdeny_ips","name":"$args","line":1160,"kind":13}],"signature":{"parameters":[],"label":"add_allowdeny_ips()","documentation":" Description:  Adds the IPs to block or accept from the configs allowlist and denylist\n Returns:  1\n Requires: $args to be a hash reference with the following optional keys:\n  chain:  The chain to add the rules to\n  allowlist:  An array reference of IPs to allow\n  denylist:  An array reference of IPs to deny\n  allowdenyorder:  The order to add the allow and deny rules"},"definition":"sub","containerName":"main::","range":{"start":{"line":1132,"character":0},"end":{"line":1163,"character":9999}},"detail":"()","line":1132,"kind":12,"name":"add_allowdeny_ips"},{"name":"threads","kind":12,"line":1134},{"kind":12,"line":1142,"name":"allow"},{"name":"allowlist","line":1142,"kind":12},{"line":1143,"kind":12,"name":"deny"},{"name":"denylist","kind":12,"line":1143},{"kind":12,"line":1146,"name":"Dumper"},{"line":1150,"kind":12,"name":"chain"},{"line":1157,"kind":12,"name":"rule"},{"kind":12,"line":1157,"name":"options"},{"kind":12,"line":1172,"name":"add_global_allow_deny_ips","detail":"($self)","range":{"end":{"character":9999,"line":1198},"start":{"character":0,"line":1172}},"containerName":"main::","definition":"sub","children":[{"name":"$self","kind":13,"line":1173,"containerName":"add_global_allow_deny_ips","definition":"my","localvar":"my"},{"definition":"my","localvar":"my","name":"$TID","kind":13,"line":1174,"containerName":"add_global_allow_deny_ips"},{"kind":12,"line":1174,"name":"tid","containerName":"add_global_allow_deny_ips"},{"containerName":"add_global_allow_deny_ips","name":"$logger","line":1175,"kind":13},{"containerName":"add_global_allow_deny_ips","name":"debug","line":1175,"kind":12},{"localvar":"my","definition":"my","containerName":"add_global_allow_deny_ips","line":1177,"kind":13,"name":"%ip_rules"},{"kind":13,"line":1178,"name":"$self","containerName":"add_global_allow_deny_ips"},{"line":1179,"kind":13,"name":"$self","containerName":"add_global_allow_deny_ips"},{"containerName":"add_global_allow_deny_ips","line":1182,"kind":13,"name":"$logger"},{"containerName":"add_global_allow_deny_ips","name":"debug","kind":12,"line":1182},{"containerName":"add_global_allow_deny_ips","name":"%ip_rules","kind":13,"line":1182},{"name":"$logger","kind":13,"line":1182,"containerName":"add_global_allow_deny_ips"},{"name":"is_debug","kind":12,"line":1182,"containerName":"add_global_allow_deny_ips"},{"containerName":"add_global_allow_deny_ips","kind":13,"line":1184,"name":"$action","localvar":"my","definition":"my"},{"containerName":"add_global_allow_deny_ips","name":"%ip_rules","kind":13,"line":1184},{"localvar":"my","definition":"my","containerName":"add_global_allow_deny_ips","kind":13,"line":1185,"name":"$chain"},{"containerName":"add_global_allow_deny_ips","name":"$action","line":1185,"kind":13},{"localvar":"my","definition":"my","containerName":"add_global_allow_deny_ips","name":"$rule_action","kind":13,"line":1186},{"line":1186,"kind":13,"name":"$action","containerName":"add_global_allow_deny_ips"},{"containerName":"add_global_allow_deny_ips","line":1187,"kind":13,"name":"$ruleorder","localvar":"my","definition":"my"},{"containerName":"add_global_allow_deny_ips","kind":13,"line":1187,"name":"$ip_rules"},{"kind":13,"line":1187,"name":"$action","containerName":"add_global_allow_deny_ips"},{"definition":"my","localvar":"my","line":1188,"kind":13,"name":"$ip","containerName":"add_global_allow_deny_ips"},{"line":1188,"kind":13,"name":"$ip_rules","containerName":"add_global_allow_deny_ips"},{"name":"$action","line":1188,"kind":13,"containerName":"add_global_allow_deny_ips"},{"name":"$ruleorder","line":1188,"kind":13,"containerName":"add_global_allow_deny_ips"},{"definition":"my","localvar":"my","kind":13,"line":1189,"name":"$direction","containerName":"add_global_allow_deny_ips"},{"kind":13,"line":1191,"name":"$rule","containerName":"add_global_allow_deny_ips","definition":"my","localvar":"my"},{"containerName":"add_global_allow_deny_ips","name":"$args","line":1192,"kind":13,"localvar":"my","definition":"my"},{"containerName":"add_global_allow_deny_ips","name":"$rule","kind":13,"line":1192},{"kind":13,"line":1194,"name":"$logger","containerName":"add_global_allow_deny_ips"},{"containerName":"add_global_allow_deny_ips","name":"debug","line":1194,"kind":12},{"containerName":"add_global_allow_deny_ips","name":"$self","kind":13,"line":1195},{"kind":12,"line":1195,"name":"iptablesqueue_enqueue","containerName":"add_global_allow_deny_ips"},{"line":1195,"kind":13,"name":"$args","containerName":"add_global_allow_deny_ips"}],"signature":{"documentation":" Description:  Adds the IPs to block or accept from the configs globalallow and globaldeny\n Returns:  1","label":"add_global_allow_deny_ips($self)","parameters":[{"label":"$self"}]}},{"line":1174,"kind":12,"name":"threads"},{"name":"allow","kind":12,"line":1178},{"name":"configs","line":1178,"kind":12},{"name":"allowlist","line":1178,"kind":12},{"kind":12,"line":1179,"name":"deny"},{"name":"configs","kind":12,"line":1179},{"name":"denylist","kind":12,"line":1179},{"line":1182,"kind":12,"name":"Dumper"},{"name":"rule","kind":12,"line":1192},{"name":"options","line":1192,"kind":12},{"definition":"sub","signature":{"parameters":[],"documentation":" Stops the module\n  Future enhancements:\n   Clear the thread queues","label":"stop()"},"children":[{"definition":"my","localvar":"my","name":"$self","kind":13,"line":1207,"containerName":"stop"},{"kind":13,"line":1208,"name":"$logger","containerName":"stop"},{"containerName":"stop","name":"info","line":1208,"kind":12},{"kind":13,"line":1211,"name":"$self","containerName":"stop"},{"containerName":"stop","name":"$logger","kind":13,"line":1212},{"containerName":"stop","name":"info","line":1212,"kind":12},{"containerName":"stop","name":"$chain","kind":13,"line":1213,"localvar":"my","definition":"my"},{"name":"$self","line":1213,"kind":13,"containerName":"stop"},{"kind":13,"line":1214,"name":"$logger","containerName":"stop"},{"containerName":"stop","line":1214,"kind":12,"name":"info"},{"containerName":"stop","kind":13,"line":1215,"name":"$IptablesQueue"},{"name":"enqueue","kind":12,"line":1215,"containerName":"stop"}],"name":"stop","kind":12,"line":1206,"detail":"()","range":{"end":{"character":9999,"line":1222},"start":{"character":0,"line":1206}},"containerName":"main::"},{"name":"chains_created","kind":12,"line":1211},{"name":"chains_created","kind":12,"line":1213},{"name":"options","kind":12,"line":1217},{"name":"rule","line":1218,"kind":12},{"containerName":null,"kind":13,"line":1224,"name":"$logger"},{"kind":12,"line":1224,"name":"info","containerName":"main::"},{"name":"$logger","line":1227,"kind":13,"containerName":null},{"kind":12,"line":1227,"name":"info","containerName":"main::"},{"name":"clear_queues","line":1228,"kind":12},{"line":1228,"kind":13,"name":"$logger","containerName":null},{"containerName":"main::","kind":12,"line":1228,"name":"error"},{"kind":13,"line":1229,"name":"$logger","containerName":null},{"name":"info","line":1229,"kind":12,"containerName":"main::"},{"line":1230,"kind":12,"name":"join_threads"},{"line":1230,"kind":13,"name":"$logger","containerName":null},{"containerName":"main::","kind":12,"line":1230,"name":"error"},{"containerName":null,"name":"$logger","kind":13,"line":1232},{"kind":12,"line":1232,"name":"info","containerName":"main::"},{"name":"$lock_obj","kind":13,"line":1233,"containerName":null},{"line":1233,"kind":12,"name":"release","containerName":"main::"},{"name":"$logger","kind":13,"line":1234,"containerName":null},{"containerName":"main::","name":"info","line":1234,"kind":12},{"signature":{"documentation":" Joins all threads\n   Simple sub but really needs some rework\n   If a thread is taking a while to join then it will block the other threads from joining\n   Some of the threads could be reading a log file and if the log file is large then it could take a while or\n   if the log file is causing soem kind of blocking for reading then it could take a while.\n   This may be an issue, if an example, if trying to read a file across NFS or SSHFS and there is a network issue.","label":"join_threads()","parameters":[]},"children":[{"containerName":"join_threads","name":"$logger","line":1244,"kind":13},{"name":"debug","line":1244,"kind":12,"containerName":"join_threads"},{"line":1245,"kind":12,"name":"join","containerName":"join_threads"},{"containerName":"join_threads","line":1245,"kind":12,"name":"list"}],"definition":"sub","containerName":"main::","detail":"()","range":{"end":{"line":1247,"character":9999},"start":{"character":0,"line":1243}},"name":"join_threads","kind":12,"line":1243},{"line":1245,"kind":12,"name":"threads"},{"detail":"()","range":{"start":{"line":1250,"character":0},"end":{"line":1268,"character":9999}},"containerName":"main::","name":"clear_queues","line":1250,"kind":12,"signature":{"parameters":[],"documentation":" Clears the queues","label":"clear_queues()"},"children":[{"containerName":"clear_queues","name":"$logger","kind":13,"line":1251},{"containerName":"clear_queues","name":"debug","kind":12,"line":1251},{"containerName":"clear_queues","name":"$DataQueue","line":1252,"kind":13},{"containerName":"clear_queues","name":"end","kind":12,"line":1252},{"containerName":"clear_queues","name":"$IptablesQueue","kind":13,"line":1253},{"name":"end","line":1253,"kind":12,"containerName":"clear_queues"},{"kind":13,"line":1254,"name":"$DataQueue","containerName":"clear_queues"},{"name":"pending","line":1254,"kind":12,"containerName":"clear_queues"},{"containerName":"clear_queues","name":"$IptablesQueue","kind":13,"line":1254},{"line":1254,"kind":12,"name":"pending","containerName":"clear_queues"},{"containerName":"clear_queues","name":"$DataQueue","line":1255,"kind":13},{"containerName":"clear_queues","name":"pending","kind":12,"line":1255},{"containerName":"clear_queues","kind":13,"line":1255,"name":"$logger"},{"kind":12,"line":1255,"name":"debug","containerName":"clear_queues"},{"name":"$IptablesQueue","kind":13,"line":1256,"containerName":"clear_queues"},{"line":1256,"kind":12,"name":"pending","containerName":"clear_queues"},{"name":"$logger","kind":13,"line":1256,"containerName":"clear_queues"},{"kind":12,"line":1256,"name":"debug","containerName":"clear_queues"},{"line":1260,"kind":13,"name":"$DataQueue","containerName":"clear_queues"},{"kind":12,"line":1260,"name":"pending","containerName":"clear_queues"},{"containerName":"clear_queues","line":1260,"kind":13,"name":"$IptablesQueue"},{"containerName":"clear_queues","line":1260,"kind":12,"name":"pending"},{"containerName":"clear_queues","name":"$logger","line":1261,"kind":13},{"name":"error","line":1261,"kind":12,"containerName":"clear_queues"},{"line":1265,"kind":13,"name":"$logger","containerName":"clear_queues"},{"containerName":"clear_queues","line":1265,"kind":12,"name":"debug"}],"definition":"sub"},{"name":"reload","kind":12,"line":1270,"detail":"()","range":{"end":{"line":1295,"character":9999},"start":{"character":0,"line":1270}},"containerName":"main::","definition":"sub","signature":{"parameters":[],"label":"reload()","documentation":""},"children":[{"name":"$logger","kind":13,"line":1271,"containerName":"reload"},{"containerName":"reload","kind":12,"line":1271,"name":"info"}]},{"children":[{"kind":13,"line":1300,"name":"$logger","containerName":"SIG_INT"},{"line":1300,"kind":12,"name":"info","containerName":"SIG_INT"}],"definition":"sub","range":{"end":{"character":9999,"line":1303},"start":{"character":0,"line":1299}},"containerName":"main::","name":"SIG_INT","line":1299,"kind":12},{"range":{"end":{"line":1310,"character":9999},"start":{"line":1307,"character":0}},"containerName":"main::","name":"SIG_HUP","line":1307,"kind":12,"children":[{"containerName":"SIG_HUP","name":"$logger","line":1308,"kind":13},{"line":1308,"kind":12,"name":"info","containerName":"SIG_HUP"}],"definition":"sub"},{"definition":"sub","children":[{"containerName":"SIG_TERM","kind":13,"line":1315,"name":"$logger"},{"containerName":"SIG_TERM","name":"info","kind":12,"line":1315}],"name":"SIG_TERM","line":1314,"kind":12,"range":{"end":{"line":1317,"character":9999},"start":{"character":0,"line":1314}},"containerName":"main::"},{"definition":"sub","children":[{"line":1322,"kind":13,"name":"$self","containerName":"SIG_QUIT","definition":"my","localvar":"my"}],"name":"SIG_QUIT","kind":12,"line":1321,"containerName":"main::","range":{"start":{"line":1321,"character":0},"end":{"character":9999,"line":1324}}},{"children":[{"name":"$logger","kind":13,"line":1327,"containerName":"set_signal_handler"},{"kind":12,"line":1327,"name":"info","containerName":"set_signal_handler"},{"name":"$SIG","kind":13,"line":1329,"containerName":"set_signal_handler"},{"name":"$SIG","line":1330,"kind":13,"containerName":"set_signal_handler"},{"name":"$SIG","kind":13,"line":1331,"containerName":"set_signal_handler"},{"containerName":"set_signal_handler","name":"$SIG","line":1332,"kind":13}],"signature":{"parameters":[],"documentation":"","label":"set_signal_handler()"},"definition":"sub","containerName":"main::","range":{"start":{"character":0,"line":1326},"end":{"character":9999,"line":1333}},"detail":"()","kind":12,"line":1326,"name":"set_signal_handler"},{"name":"INT","kind":12,"line":1329},{"name":"TERM","line":1330,"kind":12},{"name":"HUP","kind":12,"line":1331},{"kind":12,"line":1332,"name":"QUIT"}],"version":5}