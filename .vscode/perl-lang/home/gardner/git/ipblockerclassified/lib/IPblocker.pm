{"version":5,"vars":[{"kind":2,"name":"POSIX","containerName":"","line":36},{"name":"strict","containerName":"","line":37,"kind":2},{"line":38,"containerName":"","name":"DateTime","kind":2},{"line":39,"containerName":"File","name":"Basename","kind":2},{"kind":2,"line":40,"containerName":"List","name":"Util"},{"kind":2,"line":44,"containerName":"","name":"strict"},{"containerName":"Time","line":45,"name":"HiRes","kind":2},{"kind":2,"containerName":"Config","line":51,"name":"File"},{"kind":2,"line":52,"containerName":"","name":"Carp"},{"kind":2,"containerName":"Log","line":53,"name":"Log4perl"},{"containerName":"Log","line":54,"name":"Any","kind":2},{"kind":2,"containerName":"Data","line":55,"name":"Dumper"},{"name":"IPv6","containerName":"Regexp","line":56,"kind":2},{"line":57,"containerName":"LockFile","name":"Simple","kind":2},{"line":58,"containerName":"File","name":"Path","kind":2},{"kind":2,"line":59,"containerName":"Net::Ifconfig","name":"Wrapper"},{"kind":2,"name":"threads","line":62,"containerName":""},{"kind":2,"name":"Queue","containerName":"Thread","line":65},{"kind":13,"containerName":null,"line":66,"name":"$DataQueue","definition":"my","localvar":"my"},{"containerName":"Queue","line":66,"name":"Thread","kind":12},{"line":66,"containerName":"main::","name":"new","kind":12},{"localvar":"my","line":67,"containerName":null,"name":"$LoggerTIDS","definition":"my","kind":13},{"line":70,"containerName":null,"definition":"my","name":"$IptablesQueue","localvar":"my","kind":13},{"name":"Thread","containerName":"Queue","line":70,"kind":12},{"containerName":"main::","line":70,"name":"new","kind":12},{"containerName":null,"line":71,"definition":"my","name":"$IptablesTIDS","localvar":"my","kind":13},{"containerName":null,"line":74,"name":"$Data","kind":13},{"kind":12,"containerName":"Sortkeys","line":74,"name":"Dumper"},{"line":75,"containerName":null,"name":"$Data","kind":13},{"line":75,"containerName":"Indent","name":"Dumper","kind":12},{"localvar":"my","containerName":null,"line":82,"name":"$logger","definition":"my","kind":13},{"localvar":"my","line":85,"containerName":null,"definition":"my","name":"$lock_obj","kind":13},{"kind":13,"localvar":"my","line":90,"containerName":null,"definition":"my","name":"$REGEX_IPV4"},{"kind":13,"name":"$REGEX_IPV6","definition":"my","containerName":null,"line":91,"localvar":"my"},{"kind":13,"name":"$IPTABLESRUNLINE","definition":"my","line":92,"containerName":null,"localvar":"my"},{"line":96,"containerName":"main::","definition":"our","name":"%tracker","kind":13},{"kind":13,"localvar":"my","definition":"my","name":"%DEFAULTS","line":97,"containerName":null},{"kind":12,"line":98,"name":"allowdeny"},{"line":99,"name":"allowlist","kind":12},{"kind":12,"line":100,"name":"configsfile"},{"name":"cycles","line":101,"kind":12},{"name":"LONG_MAX","line":101,"kind":12},{"line":102,"name":"cyclesleep","kind":12},{"name":"dumpconfigsandexit","line":103,"kind":12},{"line":104,"name":"denylist","kind":12},{"kind":12,"line":105,"name":"forceremovelockfile"},{"name":"globalallowlist","line":106,"kind":12},{"line":107,"name":"chainprefix","kind":12},{"line":108,"name":"globalchains","kind":12},{"kind":12,"name":"globaldenylist","line":109},{"name":"globalregexallowlist","line":110,"kind":12},{"kind":12,"name":"globalregexdenylist","line":111},{"line":112,"name":"ignoreinterfaceips","kind":12},{"kind":12,"line":113,"name":"iptables"},{"name":"lockfile","line":114,"kind":12},{"name":"log4perlconf","line":115,"kind":12},{"kind":12,"name":"loglevel","line":116},{"name":"logcontents","line":120,"kind":12},{"name":"logs_to_review","line":121,"kind":12},{"kind":12,"name":"logwatch_interval","line":122},{"kind":12,"name":"prodmode","line":123},{"kind":12,"line":124,"name":"queuechecktime"},{"name":"queuecycles","line":125,"kind":12},{"name":"LONG_MAX","line":125,"kind":12},{"kind":12,"line":126,"name":"readentirefile"},{"signature":{"parameters":[],"label":"new()","documentation":"#### Subs below here #####\n Reads configs, logging configs, sets up logging, sets up a class and returns a blessed object\n   The sub go() is where the action starts"},"kind":12,"containerName":"main::","range":{"start":{"line":134,"character":0},"end":{"line":177,"character":9999}},"line":134,"name":"new","definition":"sub","children":[{"kind":13,"containerName":"new","line":135,"definition":"my","name":"$class","localvar":"my"},{"kind":13,"localvar":"my","containerName":"new","line":136,"definition":"my","name":"$args"},{"kind":13,"name":"$args","containerName":"new","line":138},{"kind":13,"line":140,"containerName":"new","name":"$args"},{"containerName":"new","line":142,"name":"$args","kind":13},{"kind":13,"localvar":"my","name":"$configsfile","definition":"my","containerName":"new","line":147},{"name":"$args","containerName":"new","line":147,"kind":13},{"kind":13,"containerName":"new","line":147,"name":"$DEFAULTS"},{"kind":13,"localvar":"my","name":"$self","definition":"my","containerName":"new","line":149},{"containerName":"new","line":150,"name":"$configsfile","kind":13},{"kind":13,"line":151,"containerName":"new","name":"$args"},{"kind":13,"containerName":"new","line":155,"name":"$self"},{"kind":13,"line":155,"containerName":"new","name":"$class"},{"kind":13,"name":"$self","line":159,"containerName":"new"},{"kind":12,"line":159,"containerName":"new","name":"load_configs"},{"kind":13,"containerName":"new","line":161,"name":"$self"},{"containerName":"new","line":163,"name":"$self","kind":13},{"name":"$self","line":164,"containerName":"new","kind":13},{"kind":13,"line":165,"containerName":"new","name":"$self"},{"kind":13,"line":167,"containerName":"new","name":"$self"},{"line":172,"containerName":"new","name":"$logger","kind":13},{"kind":13,"line":172,"containerName":"new","name":"$self"},{"kind":12,"name":"setup_Logger","line":172,"containerName":"new"},{"kind":13,"name":"$logger","containerName":"new","line":173},{"name":"info","containerName":"new","line":173,"kind":12},{"kind":13,"name":"$logger","containerName":"new","line":174},{"kind":12,"containerName":"new","line":174,"name":"debug"},{"name":"$self","line":174,"containerName":"new","kind":13},{"kind":13,"name":"$logger","containerName":"new","line":174},{"name":"is_debug","containerName":"new","line":174,"kind":12},{"kind":13,"line":176,"containerName":"new","name":"$self"}],"detail":"()"},{"kind":12,"line":139,"name":"carp"},{"name":"croak","line":143,"kind":12},{"kind":12,"name":"configsfile","line":147},{"name":"configsfile","line":147,"kind":12},{"kind":12,"line":150,"name":"configsfile"},{"name":"clargs","line":151,"kind":12},{"kind":12,"line":161,"name":"configs"},{"kind":12,"line":161,"name":"dumpconfigsandexit"},{"line":163,"name":"configs","kind":12},{"kind":12,"line":163,"name":"configsfile"},{"kind":12,"name":"configs","line":164},{"kind":12,"line":164,"name":"globalchain"},{"name":"configs","line":165,"kind":12},{"kind":12,"name":"dumpconfigsandexit","line":165},{"line":167,"name":"recursiveHashPrint","kind":12},{"kind":12,"name":"configs","line":167},{"line":174,"name":"Dumper","kind":12},{"name":"recursiveHashPrint","definition":"sub","containerName":"main::","range":{"end":{"line":191,"character":9999},"start":{"line":180,"character":0}},"line":180,"signature":{"documentation":"# Recursive sub to print out a hash to STDOUT in a manner that matches \"use Config::File;\"","parameters":[{"label":"$ref"},{"label":"$prefix"}],"label":"recursiveHashPrint($ref,$prefix)"},"kind":12,"detail":"($ref,$prefix)","children":[{"kind":13,"localvar":"my","name":"$ref","definition":"my","containerName":"recursiveHashPrint","line":181},{"containerName":"recursiveHashPrint","line":181,"name":"$prefix","kind":13},{"kind":13,"name":"$prefix","line":182,"containerName":"recursiveHashPrint"},{"kind":13,"containerName":"recursiveHashPrint","line":182,"name":"$prefix"},{"containerName":"recursiveHashPrint","line":184,"name":"$ref","kind":13},{"localvar":"my","definition":"my","name":"$key","line":185,"containerName":"recursiveHashPrint","kind":13},{"name":"$ref","line":185,"containerName":"recursiveHashPrint","kind":13},{"kind":13,"localvar":"my","name":"$new_prefix","definition":"my","containerName":"recursiveHashPrint","line":188},{"kind":13,"name":"$prefix","containerName":"recursiveHashPrint","line":188},{"kind":13,"containerName":"recursiveHashPrint","line":189,"name":"$ref"},{"line":189,"containerName":"recursiveHashPrint","name":"$key","kind":13},{"name":"$new_prefix","line":189,"containerName":"recursiveHashPrint","kind":13}]},{"kind":13,"name":"%ref","containerName":null,"line":192},{"localvar":"my","containerName":null,"line":195,"definition":"my","name":"$line","kind":13},{"kind":13,"containerName":null,"line":195,"name":"$ref"},{"name":"$line","line":196,"containerName":null,"kind":13},{"kind":13,"name":"$line","line":197,"containerName":null},{"kind":13,"name":"%line","line":198,"containerName":null},{"containerName":null,"line":202,"definition":"my","name":"$line","localvar":"my","kind":13},{"kind":13,"line":203,"containerName":null,"name":"$line"},{"containerName":null,"line":204,"name":"$line","kind":13},{"kind":13,"containerName":null,"line":205,"name":"$line"},{"definition":"sub","name":"iptables_thread","range":{"start":{"line":209,"character":0},"end":{"character":9999,"line":251}},"line":209,"containerName":"main::","signature":{"parameters":[],"label":"iptables_thread()","documentation":""},"kind":12,"detail":"()","children":[{"localvar":"my","name":"$self","definition":"my","containerName":"iptables_thread","line":210,"kind":13},{"definition":"my","name":"$TID","line":211,"containerName":"iptables_thread","localvar":"my","kind":13},{"kind":12,"name":"tid","line":211,"containerName":"iptables_thread"},{"name":"$TID","containerName":"iptables_thread","line":212,"kind":13},{"line":212,"containerName":"iptables_thread","name":"$TID","kind":13},{"name":"$cyclesleep","definition":"my","line":214,"containerName":"iptables_thread","localvar":"my","kind":13},{"kind":13,"line":214,"containerName":"iptables_thread","name":"$self"},{"kind":13,"containerName":"iptables_thread","line":215,"definition":"my","name":"$cycles","localvar":"my"},{"kind":13,"containerName":"iptables_thread","line":215,"name":"$self"},{"kind":13,"localvar":"my","name":"$logmsg","definition":"my","line":216,"containerName":"iptables_thread"},{"kind":13,"name":"$logmsg","containerName":"iptables_thread","line":217},{"kind":13,"containerName":"iptables_thread","line":218,"name":"$logger"},{"containerName":"iptables_thread","line":218,"name":"info","kind":12},{"kind":13,"line":218,"containerName":"iptables_thread","name":"$logmsg"},{"kind":13,"localvar":"my","line":221,"containerName":"iptables_thread","definition":"my","name":"$iptablesQueue_pending"},{"kind":13,"containerName":"iptables_thread","line":221,"name":"$IptablesQueue"},{"kind":12,"name":"pending","line":221,"containerName":"iptables_thread"},{"kind":13,"line":222,"containerName":"iptables_thread","name":"$iptablesQueue_pending"},{"kind":13,"containerName":"iptables_thread","line":223,"name":"$logmsg","definition":"my","localvar":"my"},{"kind":13,"containerName":"iptables_thread","line":224,"name":"$logmsg"},{"kind":13,"line":225,"containerName":"iptables_thread","name":"$logger"},{"name":"info","line":225,"containerName":"iptables_thread","kind":12},{"line":225,"containerName":"iptables_thread","name":"$logmsg","kind":13},{"name":"$iptablesQueue_pending","line":229,"containerName":"iptables_thread","kind":13},{"containerName":"iptables_thread","line":230,"name":"$logger","kind":13},{"kind":12,"containerName":"iptables_thread","line":230,"name":"info"},{"name":"$data","definition":"my","containerName":"iptables_thread","line":231,"localvar":"my","kind":13},{"kind":13,"name":"$IptablesQueue","containerName":"iptables_thread","line":231},{"line":231,"containerName":"iptables_thread","name":"dequeue","kind":12},{"kind":13,"containerName":"iptables_thread","line":232,"name":"$logger"},{"kind":12,"name":"debug","line":232,"containerName":"iptables_thread"},{"line":232,"containerName":"iptables_thread","name":"$data","kind":13},{"name":"$logger","containerName":"iptables_thread","line":232,"kind":13},{"name":"is_debug","line":232,"containerName":"iptables_thread","kind":12},{"line":233,"containerName":"iptables_thread","name":"$self","kind":13},{"containerName":"iptables_thread","line":233,"name":"run_iptables","kind":12},{"kind":13,"line":233,"containerName":"iptables_thread","name":"$data"},{"line":233,"containerName":"iptables_thread","name":"$logger","kind":13},{"kind":12,"containerName":"iptables_thread","line":233,"name":"error"},{"kind":13,"name":"$data","containerName":"iptables_thread","line":233},{"line":234,"containerName":"iptables_thread","name":"$IPTABLESRUNLINE","kind":13},{"containerName":"iptables_thread","line":235,"name":"$IPTABLESRUNLINE","kind":13},{"kind":13,"name":"$IPTABLESRUNLINE","line":235,"containerName":"iptables_thread"},{"kind":13,"containerName":"iptables_thread","line":237,"name":"$iptablesQueue_pending"},{"containerName":"iptables_thread","line":240,"definition":"my","name":"$logmsg","localvar":"my","kind":13},{"line":241,"containerName":"iptables_thread","name":"$logmsg","kind":13},{"kind":13,"name":"$cyclesleep","line":241,"containerName":"iptables_thread"},{"containerName":"iptables_thread","line":242,"name":"$logmsg","kind":13},{"name":"$logger","line":243,"containerName":"iptables_thread","kind":13},{"name":"info","line":243,"containerName":"iptables_thread","kind":12},{"kind":13,"line":243,"containerName":"iptables_thread","name":"$logmsg"},{"kind":13,"containerName":"iptables_thread","line":244,"name":"$cyclesleep"},{"name":"$logger","containerName":"iptables_thread","line":247,"kind":13},{"name":"error","containerName":"iptables_thread","line":247,"kind":12}]},{"name":"threads","line":211,"kind":12},{"name":"configs","line":214,"kind":12},{"kind":12,"name":"queuechecktime","line":214},{"line":215,"name":"configs","kind":12},{"line":215,"name":"queuecycles","kind":12},{"name":"Dumper","line":232,"kind":12},{"line":233,"name":"Dumper","kind":12},{"kind":12,"name":"usleep","line":244},{"signature":{"label":"go()","parameters":[],"documentation":" Creates two initial threads:\n   One for iptables commands to run.\n   Another to watch the log files\n       This in turn creates a thread for each log file to watch\n Also starts running the DataQueue queue which handles the data"},"kind":12,"range":{"start":{"character":0,"line":258},"end":{"character":9999,"line":314}},"containerName":"main::","line":258,"name":"go","definition":"sub","children":[{"kind":13,"localvar":"my","line":259,"containerName":"go","definition":"my","name":"$self"},{"kind":13,"containerName":"go","line":260,"definition":"my","name":"$start_time","localvar":"my"},{"kind":13,"line":263,"containerName":"go","name":"$self"},{"kind":13,"name":"$logger","line":264,"containerName":"go"},{"kind":12,"name":"error","containerName":"go","line":264},{"kind":13,"name":"$self","line":269,"containerName":"go"},{"line":269,"containerName":"go","name":"set_iptables_command","kind":12},{"name":"$logger","containerName":"go","line":269,"kind":13},{"name":"error","containerName":"go","line":269,"kind":12},{"containerName":"go","line":270,"name":"$self","kind":13},{"kind":12,"name":"set_signal_handler","line":270,"containerName":"go"},{"kind":13,"line":271,"containerName":"go","name":"$self"},{"name":"$self","containerName":"go","line":271,"kind":13},{"kind":13,"name":"$self","line":272,"containerName":"go"},{"kind":12,"containerName":"go","line":272,"name":"set_lockFile"},{"name":"$logger","containerName":"go","line":272,"kind":13},{"line":272,"containerName":"go","name":"logdie","kind":12},{"line":277,"containerName":"go","name":"$iptables_thr","definition":"my","localvar":"my","kind":13},{"name":"create","containerName":"go","line":277,"kind":12},{"containerName":"go","line":277,"name":"$self","kind":13},{"name":"$self","containerName":"go","line":280,"kind":13},{"kind":12,"line":280,"containerName":"go","name":"add_global_chain"},{"name":"$self","line":283,"containerName":"go","kind":13},{"name":"add_global_allow_deny_ips","line":283,"containerName":"go","kind":12},{"line":287,"containerName":"go","name":"$logger","kind":13},{"containerName":"go","line":287,"name":"logdie","kind":12},{"name":"$self","line":287,"containerName":"go","kind":13},{"kind":12,"name":"logger_thread","containerName":"go","line":287},{"localvar":"my","definition":"my","name":"$cycles","containerName":"go","line":297,"kind":13},{"name":"$self","containerName":"go","line":297,"kind":13},{"kind":13,"localvar":"my","line":298,"containerName":"go","name":"$cyclesleep","definition":"my"},{"name":"$self","containerName":"go","line":298,"kind":13},{"kind":13,"name":"$cycles","containerName":"go","line":299},{"containerName":"go","line":300,"name":"$cycles","kind":13},{"kind":13,"containerName":"go","line":301,"name":"$cyclesleep"},{"localvar":"my","name":"$logmsg","definition":"my","containerName":"go","line":302,"kind":13},{"line":303,"containerName":"go","name":"$logmsg","kind":13},{"name":"$cycles","line":303,"containerName":"go","kind":13},{"kind":13,"name":"$logmsg","line":304,"containerName":"go"},{"kind":13,"name":"$logmsg","containerName":"go","line":305},{"kind":13,"name":"$cyclesleep","line":305,"containerName":"go"},{"kind":13,"name":"$logmsg","line":306,"containerName":"go"},{"kind":13,"name":"$logger","line":307,"containerName":"go"},{"name":"trace","line":307,"containerName":"go","kind":12},{"containerName":"go","line":307,"name":"$logmsg","kind":13},{"name":"$logger","line":307,"containerName":"go","kind":13},{"kind":12,"name":"is_debug","line":307,"containerName":"go"},{"kind":13,"localvar":"my","name":"$runtime","definition":"my","line":310,"containerName":"go"},{"kind":13,"name":"$start_time","containerName":"go","line":310},{"line":311,"containerName":"go","name":"$runtime","kind":13},{"kind":13,"name":"$runtime","line":311,"containerName":"go"},{"kind":13,"name":"$logger","line":312,"containerName":"go"},{"kind":12,"line":312,"containerName":"go","name":"info"},{"name":"$self","containerName":"go","line":313,"kind":13},{"kind":12,"name":"stop","line":313,"containerName":"go"}],"detail":"()"},{"kind":12,"name":"configs","line":263},{"kind":12,"name":"logs_to_review","line":263},{"name":"configs","line":271,"kind":12},{"line":271,"name":"globalchain","kind":12},{"kind":12,"name":"configs","line":271},{"name":"chainprefix","line":271,"kind":12},{"name":"threads","line":277,"kind":12},{"kind":12,"line":297,"name":"configs"},{"kind":12,"name":"cycles","line":297},{"line":298,"name":"configs","kind":12},{"name":"cyclesleep","line":298,"kind":12},{"kind":12,"name":"usleep","line":301},{"children":[{"definition":"my","name":"$self","line":319,"containerName":"add_ifconfig_ips_to_allowlist","localvar":"my","kind":13}],"detail":"()","range":{"start":{"character":0,"line":318},"end":{"line":346,"character":9999}},"containerName":"main::","line":318,"definition":"sub","name":"add_ifconfig_ips_to_allowlist","kind":12,"signature":{"parameters":[],"label":"add_ifconfig_ips_to_allowlist()","documentation":" Description:  Adds IPs on the local interfaces to the global allowlist\n  This does not work becasue it only handles IPv4 addresses and other issues"}},{"detail":"()","children":[{"line":349,"containerName":"dataQueue_runner","name":"$self","definition":"my","localvar":"my","kind":13},{"kind":13,"name":"$TID","definition":"my","line":350,"containerName":"dataQueue_runner","localvar":"my"},{"containerName":"dataQueue_runner","line":350,"name":"tid","kind":12},{"name":"$TID","containerName":"dataQueue_runner","line":351,"kind":13},{"line":351,"containerName":"dataQueue_runner","name":"$TID","kind":13},{"containerName":"dataQueue_runner","line":353,"name":"$Data","kind":13},{"name":"$Data","line":354,"containerName":"dataQueue_runner","kind":13},{"kind":13,"containerName":"dataQueue_runner","line":356,"name":"$logger"},{"kind":12,"name":"info","containerName":"dataQueue_runner","line":356},{"definition":"my","name":"$queuechecktime","line":357,"containerName":"dataQueue_runner","localvar":"my","kind":13},{"name":"$self","containerName":"dataQueue_runner","line":357,"kind":13},{"localvar":"my","containerName":"dataQueue_runner","line":358,"definition":"my","name":"$queuecycles","kind":13},{"containerName":"dataQueue_runner","line":358,"name":"$self","kind":13},{"kind":13,"localvar":"my","name":"$dataqueue_pending","definition":"my","containerName":"dataQueue_runner","line":361},{"kind":13,"name":"$DataQueue","containerName":"dataQueue_runner","line":361},{"kind":12,"containerName":"dataQueue_runner","line":361,"name":"pending"},{"name":"$dataqueue_pending","line":362,"containerName":"dataQueue_runner","kind":13},{"kind":13,"name":"$logger","containerName":"dataQueue_runner","line":363},{"kind":12,"line":363,"containerName":"dataQueue_runner","name":"info"},{"kind":13,"name":"$dataqueue_pending","containerName":"dataQueue_runner","line":367},{"name":"$logger","containerName":"dataQueue_runner","line":368,"kind":13},{"name":"info","containerName":"dataQueue_runner","line":368,"kind":12},{"kind":13,"containerName":"dataQueue_runner","line":369,"name":"$data","definition":"my","localvar":"my"},{"kind":13,"name":"$DataQueue","containerName":"dataQueue_runner","line":369},{"kind":12,"name":"dequeue","line":369,"containerName":"dataQueue_runner"},{"kind":13,"name":"$logger","containerName":"dataQueue_runner","line":371},{"line":371,"containerName":"dataQueue_runner","name":"debug","kind":12},{"kind":13,"name":"$data","containerName":"dataQueue_runner","line":371},{"kind":13,"name":"$logger","line":371,"containerName":"dataQueue_runner"},{"line":371,"containerName":"dataQueue_runner","name":"is_debug","kind":12},{"kind":13,"line":373,"containerName":"dataQueue_runner","name":"$dataqueue_pending"},{"kind":13,"containerName":"dataQueue_runner","line":374,"name":"$logmsg","definition":"my","localvar":"my"},{"kind":13,"name":"$logmsg","containerName":"dataQueue_runner","line":375},{"kind":13,"name":"$logger","line":376,"containerName":"dataQueue_runner"},{"kind":12,"name":"info","containerName":"dataQueue_runner","line":376},{"kind":13,"name":"$logmsg","line":376,"containerName":"dataQueue_runner"},{"line":377,"containerName":"dataQueue_runner","name":"$queuecycles","kind":13},{"containerName":"dataQueue_runner","line":378,"name":"$queuecycles","kind":13},{"kind":13,"line":379,"containerName":"dataQueue_runner","name":"$queuechecktime"},{"containerName":"dataQueue_runner","line":382,"name":"$logger","kind":13},{"containerName":"dataQueue_runner","line":382,"name":"error","kind":12},{"line":387,"containerName":"dataQueue_runner","name":"$logger","kind":13},{"kind":12,"line":387,"containerName":"dataQueue_runner","name":"info"}],"signature":{"documentation":"","label":"dataQueue_runner()","parameters":[]},"kind":12,"definition":"sub","name":"dataQueue_runner","line":348,"range":{"start":{"character":0,"line":348},"end":{"character":9999,"line":388}},"containerName":"main::"},{"kind":12,"name":"threads","line":350},{"kind":12,"line":353,"containerName":"Terse","name":"Dumper"},{"name":"Dumper","containerName":"Indent","line":354,"kind":12},{"name":"configs","line":357,"kind":12},{"kind":12,"line":357,"name":"queuechecktime"},{"kind":12,"line":358,"name":"configs"},{"line":358,"name":"queuecycles","kind":12},{"kind":12,"name":"Dumper","line":371},{"children":[{"kind":13,"line":395,"containerName":"setup_Logger","definition":"my","name":"$self","localvar":"my"},{"localvar":"my","line":398,"containerName":"setup_Logger","name":"$log4perlconf","definition":"my","kind":13},{"containerName":"setup_Logger","line":398,"name":"$self","kind":13},{"kind":13,"localvar":"my","line":399,"containerName":"setup_Logger","name":"$logwatch_interval","definition":"my"},{"kind":13,"containerName":"setup_Logger","line":399,"name":"$self"},{"line":400,"containerName":"setup_Logger","name":"init_and_watch","kind":12},{"kind":13,"line":400,"containerName":"setup_Logger","name":"$log4perlconf"},{"kind":13,"containerName":"setup_Logger","line":400,"name":"$logwatch_interval"},{"name":"easy_init","line":404,"containerName":"setup_Logger","kind":12},{"kind":13,"name":"$Log","containerName":"setup_Logger","line":404},{"kind":13,"name":"$logger","line":406,"containerName":"setup_Logger"},{"kind":13,"line":407,"containerName":"setup_Logger","name":"$self"},{"kind":13,"name":"$logger","containerName":"setup_Logger","line":408},{"name":"level","line":408,"containerName":"setup_Logger","kind":12},{"kind":13,"containerName":"setup_Logger","line":408,"name":"$self"},{"name":"$logger","containerName":"setup_Logger","line":409,"kind":13},{"name":"info","line":409,"containerName":"setup_Logger","kind":12},{"kind":13,"name":"$logger","containerName":"setup_Logger","line":409},{"line":409,"containerName":"setup_Logger","name":"level","kind":12},{"kind":13,"line":416,"containerName":"setup_Logger","name":"$logger"},{"name":"info","containerName":"setup_Logger","line":416,"kind":12},{"kind":13,"line":418,"containerName":"setup_Logger","name":"$logger"}],"detail":"()","range":{"end":{"character":9999,"line":419},"start":{"line":394,"character":0}},"line":394,"containerName":"main::","name":"setup_Logger","definition":"sub","signature":{"parameters":[],"label":"setup_Logger()","documentation":" Assumptions:\n   $self->{configs}->{log4perlconf} is set\n   $self->{configs}->{logwatch_interval} is set\n These assumptions *should* be true because this is called from new()"},"kind":12},{"name":"configs","line":398,"kind":12},{"kind":12,"line":398,"name":"log4perlconf"},{"line":399,"name":"configs","kind":12},{"name":"logwatch_interval","line":399,"kind":12},{"name":"Log","line":400,"containerName":"Log4perl","kind":12},{"kind":12,"name":"carp","line":402},{"kind":12,"name":"carp","line":403},{"containerName":"Log4perl","line":404,"name":"Log","kind":12},{"name":"Log4perl","line":404,"containerName":"DEBUG","kind":12},{"name":"get_logger","line":406,"kind":12},{"line":406,"name":"croak","kind":12},{"kind":12,"line":407,"name":"configs"},{"kind":12,"line":407,"name":"loglevel"},{"kind":12,"line":408,"name":"configs"},{"kind":12,"line":408,"name":"loglevel"},{"children":[{"localvar":"my","containerName":"set_lockFile","line":424,"name":"$self","definition":"my","kind":13},{"name":"$self","containerName":"set_lockFile","line":426,"kind":13},{"name":"$logger","line":427,"containerName":"set_lockFile","kind":13},{"name":"logdie","containerName":"set_lockFile","line":427,"kind":12},{"kind":13,"containerName":"set_lockFile","line":430,"name":"$lockfile","definition":"my","localvar":"my"},{"kind":13,"line":430,"containerName":"set_lockFile","name":"$self"},{"kind":13,"name":"$lf","definition":"my","containerName":"set_lockFile","line":433,"localvar":"my"},{"name":"$self","containerName":"set_lockFile","line":433,"kind":13},{"line":434,"containerName":"set_lockFile","name":"$logger","kind":13},{"kind":12,"name":"debug","containerName":"set_lockFile","line":434},{"kind":13,"line":436,"containerName":"set_lockFile","name":"$lf"},{"name":"$self","containerName":"set_lockFile","line":437,"kind":13},{"kind":13,"containerName":"set_lockFile","line":438,"name":"$logger"},{"kind":12,"line":438,"containerName":"set_lockFile","name":"info"},{"kind":13,"containerName":"set_lockFile","line":439,"name":"$lf"},{"kind":13,"name":"$logger","line":439,"containerName":"set_lockFile"},{"name":"logdie","line":439,"containerName":"set_lockFile","kind":12},{"name":"$fh","definition":"my","containerName":"set_lockFile","line":442,"localvar":"my","kind":13},{"containerName":"set_lockFile","line":442,"name":"$lf","kind":13},{"kind":13,"containerName":"set_lockFile","line":442,"name":"$logger"},{"containerName":"set_lockFile","line":442,"name":"logdie","kind":12},{"kind":13,"localvar":"my","definition":"my","name":"@contents","containerName":"set_lockFile","line":443},{"kind":13,"line":443,"containerName":"set_lockFile","name":"$fh"},{"kind":13,"containerName":"set_lockFile","line":444,"name":"$fh"},{"name":"@contents","line":445,"containerName":"set_lockFile","kind":13},{"kind":13,"line":446,"containerName":"set_lockFile","name":"$printable_contents","definition":"my","localvar":"my"},{"kind":13,"containerName":"set_lockFile","line":446,"name":"@contents"},{"localvar":"my","containerName":"set_lockFile","line":447,"name":"$logmsg","definition":"my","kind":13},{"name":"$logger","containerName":"set_lockFile","line":448,"kind":13},{"containerName":"set_lockFile","line":448,"name":"info","kind":12},{"kind":13,"line":448,"containerName":"set_lockFile","name":"$logmsg"},{"kind":13,"containerName":"set_lockFile","line":452,"name":"$lf"},{"kind":13,"containerName":"set_lockFile","line":452,"name":"$logger"},{"kind":12,"containerName":"set_lockFile","line":452,"name":"logdie"},{"containerName":"set_lockFile","line":455,"name":"$self","kind":13},{"name":"make","containerName":"set_lockFile","line":455,"kind":12},{"kind":13,"name":"$logger","containerName":"set_lockFile","line":458},{"kind":12,"line":458,"containerName":"set_lockFile","name":"debug"},{"containerName":"set_lockFile","line":458,"name":"$self","kind":13},{"name":"$logger","line":458,"containerName":"set_lockFile","kind":13},{"kind":12,"line":458,"containerName":"set_lockFile","name":"is_debug"},{"kind":13,"name":"$self","containerName":"set_lockFile","line":459},{"name":"$self","containerName":"set_lockFile","line":459,"kind":13},{"containerName":"set_lockFile","line":459,"name":"lock","kind":12},{"containerName":"set_lockFile","line":459,"name":"$lf","kind":13},{"name":"$logger","line":460,"containerName":"set_lockFile","kind":13},{"name":"logdie","containerName":"set_lockFile","line":460,"kind":12},{"kind":13,"line":461,"containerName":"set_lockFile","name":"$lock_obj"},{"name":"$self","containerName":"set_lockFile","line":461,"kind":13},{"containerName":"set_lockFile","line":463,"name":"$logger","kind":13},{"name":"info","line":463,"containerName":"set_lockFile","kind":12}],"detail":"()","signature":{"label":"set_lockFile()","parameters":[],"documentation":" Set lock file\n   Returns 1 if lock file is set, otherwise returns 0"},"kind":12,"line":423,"range":{"end":{"character":9999,"line":465},"start":{"line":423,"character":0}},"containerName":"main::","definition":"sub","name":"set_lockFile"},{"name":"configs","line":426,"kind":12},{"name":"lockfile","line":426,"kind":12},{"kind":12,"name":"configs","line":430},{"line":430,"name":"lockfile","kind":12},{"name":"configs","line":433,"kind":12},{"name":"lockfile","line":433,"kind":12},{"kind":12,"line":437,"name":"configs"},{"name":"forceremovelockfile","line":437,"kind":12},{"line":455,"name":"lockmgr","kind":12},{"kind":12,"name":"LockFile","containerName":"Simple","line":455},{"kind":12,"line":458,"name":"Dumper"},{"kind":12,"name":"lockmgr","line":458},{"kind":12,"line":459,"name":"lock"},{"kind":12,"line":459,"name":"lockmgr"},{"kind":12,"name":"lock","line":461},{"definition":"sub","name":"logger_thread","line":469,"range":{"end":{"character":9999,"line":476},"start":{"line":469,"character":0}},"containerName":"main::","kind":12,"signature":{"documentation":"# Description: Creates a thread for each log file to review\n# Returns 1 or dies if thread can not be created","parameters":[],"label":"logger_thread()"},"detail":"()","children":[{"localvar":"my","containerName":"logger_thread","line":470,"name":"$self","definition":"my","kind":13},{"kind":13,"localvar":"my","containerName":"logger_thread","line":472,"definition":"my","name":"$logstoreview"},{"name":"$self","containerName":"logger_thread","line":472,"kind":13},{"line":473,"containerName":"logger_thread","name":"$logstoreview","kind":13},{"localvar":"my","name":"$logtoreview","definition":"my","containerName":"logger_thread","line":476,"kind":13},{"name":"$logstoreview","containerName":"logger_thread","line":476,"kind":13}]},{"kind":12,"line":472,"name":"configs"},{"kind":12,"name":"logs_to_review","line":472},{"containerName":null,"line":477,"name":"$logger","kind":13},{"kind":12,"name":"info","line":477,"containerName":"main::"},{"kind":13,"containerName":null,"line":478,"name":"$logobj","definition":"my","localvar":"my"},{"kind":13,"name":"%logstoreview","containerName":null,"line":478},{"containerName":null,"line":478,"name":"$logtoreview","kind":13},{"name":"%logobj","containerName":null,"line":479,"kind":13},{"kind":12,"name":"chain","line":479},{"kind":13,"containerName":null,"line":479,"name":"$logtoreview"},{"kind":13,"containerName":null,"line":481,"definition":"my","name":"$thr","localvar":"my"},{"kind":12,"line":481,"name":"threads"},{"kind":12,"line":481,"containerName":"main::","name":"create"},{"kind":12,"line":481,"name":"review_log"},{"kind":13,"name":"$self","containerName":null,"line":481},{"name":"$logobj","containerName":null,"line":481,"kind":13},{"kind":13,"containerName":null,"line":481,"name":"$logger"},{"line":481,"containerName":"main::","name":"logdie","kind":12},{"containerName":null,"line":482,"name":"$LoggerTIDS","kind":13},{"containerName":null,"line":482,"name":"$thr","kind":13},{"kind":12,"line":482,"containerName":"main::","name":"tid"},{"kind":13,"line":483,"containerName":null,"name":"$logger"},{"kind":12,"name":"debug","containerName":"main::","line":483},{"kind":13,"containerName":null,"line":483,"name":"$thr"},{"kind":12,"line":483,"containerName":"main::","name":"tid"},{"name":"$logger","line":483,"containerName":null,"kind":13},{"kind":12,"name":"is_debug","containerName":"main::","line":483},{"kind":13,"name":"$logger","line":484,"containerName":null},{"kind":12,"name":"debug","line":484,"containerName":"main::"},{"kind":13,"name":"$thr","containerName":null,"line":484},{"kind":12,"name":"tid","line":484,"containerName":"main::"},{"kind":13,"containerName":null,"line":484,"name":"$thr"},{"name":"is_running","containerName":"main::","line":484,"kind":12},{"name":"$logger","containerName":null,"line":484,"kind":13},{"kind":12,"line":484,"containerName":"main::","name":"is_debug"},{"signature":{"parameters":[],"label":"prepare_directions()","documentation":""},"kind":12,"line":492,"range":{"start":{"line":492,"character":0},"end":{"character":9999,"line":503}},"containerName":"main::","name":"prepare_directions","definition":"sub","children":[{"kind":13,"name":"$self","definition":"my","containerName":"prepare_directions","line":493,"localvar":"my"},{"kind":13,"line":493,"containerName":"prepare_directions","name":"$logobj"},{"localvar":"my","definition":"my","name":"$TID","containerName":"prepare_directions","line":494,"kind":13},{"line":494,"containerName":"prepare_directions","name":"tid","kind":12},{"line":495,"containerName":"prepare_directions","name":"$TID","kind":13},{"kind":13,"name":"$TID","containerName":"prepare_directions","line":495},{"kind":13,"definition":"my","name":"@directions","containerName":"prepare_directions","line":497,"localvar":"my"},{"line":497,"containerName":"prepare_directions","name":"$logobj","kind":13},{"name":"$logobj","line":497,"containerName":"prepare_directions","kind":13},{"name":"@directions","containerName":"prepare_directions","line":498,"kind":13},{"line":498,"containerName":"prepare_directions","name":"@directions","kind":13},{"name":"@directions","containerName":"prepare_directions","line":499,"kind":13},{"kind":13,"name":"@directions","containerName":"prepare_directions","line":499},{"kind":13,"line":500,"containerName":"prepare_directions","name":"@directions"},{"kind":13,"name":"@directions","containerName":"prepare_directions","line":500},{"kind":13,"name":"@directions","line":501,"containerName":"prepare_directions"},{"containerName":"prepare_directions","line":501,"name":"@directions","kind":13},{"line":502,"containerName":"prepare_directions","name":"@directions","kind":13}],"detail":"()"},{"kind":12,"line":494,"name":"threads"},{"kind":12,"name":"directions","line":497},{"line":497,"name":"directions","kind":12},{"kind":12,"name":"any","line":500},{"definition":"sub","name":"review_log","containerName":"main::","range":{"start":{"line":507,"character":0},"end":{"line":622,"character":9999}},"line":507,"signature":{"label":"review_log()","parameters":[],"documentation":" This is called as a thread and runs a loop to check the log file for new entries\n   Prior to checking the log file, it creates a chain for the log file and adds it to the global chain"},"kind":12,"detail":"()","children":[{"kind":13,"definition":"my","name":"$self","containerName":"review_log","line":508,"localvar":"my"},{"name":"$logobj","line":508,"containerName":"review_log","kind":13},{"definition":"my","name":"$TID","line":509,"containerName":"review_log","localvar":"my","kind":13},{"name":"tid","line":509,"containerName":"review_log","kind":12},{"name":"$TID","line":510,"containerName":"review_log","kind":13},{"kind":13,"name":"$TID","containerName":"review_log","line":510},{"kind":13,"localvar":"my","line":511,"containerName":"review_log","name":"$start_time","definition":"my"},{"containerName":"review_log","line":513,"name":"$logobj","kind":13},{"definition":"my","name":"$chain","containerName":"review_log","line":514,"localvar":"my","kind":13},{"kind":13,"line":514,"containerName":"review_log","name":"$self"},{"name":"$logobj","containerName":"review_log","line":514,"kind":13},{"kind":13,"name":"$logger","line":515,"containerName":"review_log"},{"line":515,"containerName":"review_log","name":"info","kind":12},{"kind":13,"name":"$logger","line":516,"containerName":"review_log"},{"name":"debug","containerName":"review_log","line":516,"kind":12},{"name":"$logobj","containerName":"review_log","line":516,"kind":13},{"kind":13,"name":"$logger","containerName":"review_log","line":516},{"kind":12,"containerName":"review_log","line":516,"name":"is_debug"},{"line":519,"containerName":"review_log","name":"$cycles","definition":"my","localvar":"my","kind":13},{"kind":13,"containerName":"review_log","line":519,"name":"$logobj"},{"kind":13,"line":520,"containerName":"review_log","name":"$cyclesleep","definition":"my","localvar":"my"},{"kind":13,"line":520,"containerName":"review_log","name":"$logobj"},{"kind":13,"name":"$microcyclesleep","definition":"my","line":521,"containerName":"review_log","localvar":"my"},{"kind":13,"containerName":"review_log","line":521,"name":"$cyclesleep"},{"name":"$logger","containerName":"review_log","line":523,"kind":13},{"kind":12,"containerName":"review_log","line":523,"name":"info"},{"line":528,"containerName":"review_log","name":"$logger","kind":13},{"line":528,"containerName":"review_log","name":"info","kind":12},{"kind":13,"containerName":"review_log","line":529,"name":"$self"},{"kind":12,"name":"add_chain","containerName":"review_log","line":529},{"name":"$chain","line":529,"containerName":"review_log","kind":13},{"kind":13,"localvar":"my","line":532,"containerName":"review_log","definition":"my","name":"$globalchain"},{"name":"$self","containerName":"review_log","line":532,"kind":13},{"kind":13,"name":"$logger","line":533,"containerName":"review_log"},{"name":"debug","containerName":"review_log","line":533,"kind":12},{"containerName":"review_log","line":534,"name":"$self","kind":13},{"kind":12,"name":"iptablesqueue_enqueue","line":534,"containerName":"review_log"},{"line":536,"containerName":"review_log","name":"$self","kind":13},{"containerName":"review_log","line":536,"name":"add_logger_allow_deny_ips","kind":12},{"kind":13,"containerName":"review_log","line":536,"name":"$logobj"},{"kind":13,"name":"@directions","definition":"my","containerName":"review_log","line":539,"localvar":"my"},{"kind":13,"containerName":"review_log","line":539,"name":"$self"},{"kind":12,"name":"prepare_directions","containerName":"review_log","line":539},{"kind":13,"containerName":"review_log","line":539,"name":"$logobj"},{"kind":13,"definition":"my","name":"@protocols","containerName":"review_log","line":540,"localvar":"my"},{"containerName":"review_log","line":540,"name":"$logobj","kind":13},{"name":"$logobj","containerName":"review_log","line":540,"kind":13},{"localvar":"my","definition":"my","name":"$ports","containerName":"review_log","line":541,"kind":13},{"name":"$logobj","containerName":"review_log","line":541,"kind":13},{"name":"$cycles","line":543,"containerName":"review_log","kind":13},{"localvar":"my","containerName":"review_log","line":544,"definition":"my","name":"$start_loop_time","kind":13},{"containerName":"review_log","line":545,"name":"$logger","kind":13},{"line":545,"containerName":"review_log","name":"info","kind":12},{"kind":13,"name":"$logobj","containerName":"review_log","line":546},{"line":546,"containerName":"review_log","name":"$self","kind":13},{"kind":12,"name":"readlogfile","line":546,"containerName":"review_log"},{"name":"$logobj","line":546,"containerName":"review_log","kind":13},{"kind":13,"line":547,"containerName":"review_log","name":"$logobj"},{"containerName":"review_log","line":547,"name":"$self","kind":13},{"name":"_grep_regexps","line":547,"containerName":"review_log","kind":12},{"kind":13,"line":547,"containerName":"review_log","name":"$logobj"},{"name":"$logobj","containerName":"review_log","line":547,"kind":13},{"kind":13,"name":"$logger","containerName":"review_log","line":551},{"line":551,"containerName":"review_log","name":"debug","kind":12},{"kind":13,"line":551,"containerName":"review_log","name":"$logobj"},{"kind":13,"line":552,"containerName":"review_log","name":"$logger"},{"line":552,"containerName":"review_log","name":"is_debug","kind":12},{"definition":"my","name":"@rules","line":554,"containerName":"review_log","localvar":"my","kind":13},{"name":"$ip","definition":"my","line":555,"containerName":"review_log","localvar":"my","kind":13},{"name":"$logobj","containerName":"review_log","line":555,"kind":13},{"kind":13,"containerName":"review_log","line":556,"name":"$logger"},{"kind":12,"name":"debug","line":556,"containerName":"review_log"},{"kind":13,"localvar":"my","name":"$direction","definition":"my","containerName":"review_log","line":558},{"line":558,"containerName":"review_log","name":"@directions","kind":13},{"kind":13,"definition":"my","name":"$direction_switch","containerName":"review_log","line":559,"localvar":"my"},{"kind":13,"name":"$direction","containerName":"review_log","line":559},{"localvar":"my","containerName":"review_log","line":560,"definition":"my","name":"$randval","kind":13},{"line":561,"containerName":"review_log","name":"$direction_switch","kind":13},{"name":"$direction","line":561,"containerName":"review_log","kind":13},{"name":"$logger","containerName":"review_log","line":562,"kind":13},{"kind":12,"name":"info","containerName":"review_log","line":562},{"localvar":"my","name":"$base_rule","definition":"my","containerName":"review_log","line":563,"kind":13},{"name":"$logger","line":564,"containerName":"review_log","kind":13},{"containerName":"review_log","line":564,"name":"debug","kind":12},{"kind":13,"name":"@protocols","containerName":"review_log","line":566},{"kind":13,"definition":"my","name":"$protocol","line":567,"containerName":"review_log","localvar":"my"},{"kind":13,"name":"@protocols","containerName":"review_log","line":567},{"kind":13,"localvar":"my","containerName":"review_log","line":568,"name":"$rule","definition":"my"},{"kind":13,"name":"$base_rule","containerName":"review_log","line":568},{"kind":13,"name":"$logger","containerName":"review_log","line":569},{"kind":12,"name":"debug","containerName":"review_log","line":569},{"containerName":"review_log","line":570,"name":"$logobj","kind":13},{"kind":13,"name":"$rule","containerName":"review_log","line":574},{"name":"$logger","containerName":"review_log","line":576,"kind":13},{"kind":12,"containerName":"review_log","line":576,"name":"debug"},{"kind":13,"containerName":"review_log","line":577,"name":"@rules"},{"kind":13,"containerName":"review_log","line":581,"name":"$logger"},{"name":"debug","containerName":"review_log","line":581,"kind":12},{"name":"@rules","line":582,"containerName":"review_log","kind":13},{"name":"$logger","containerName":"review_log","line":587,"kind":13},{"kind":12,"name":"debug","containerName":"review_log","line":587},{"line":587,"containerName":"review_log","name":"@rules","kind":13},{"kind":13,"containerName":"review_log","line":588,"name":"$logger"},{"kind":12,"name":"is_debug","containerName":"review_log","line":588},{"localvar":"my","containerName":"review_log","line":589,"name":"$eject","definition":"my","kind":13},{"kind":13,"name":"$rule","definition":"my","line":590,"containerName":"review_log","localvar":"my"},{"name":"@rules","line":590,"containerName":"review_log","kind":13},{"kind":13,"name":"$tracker","containerName":"review_log","line":591},{"containerName":"review_log","line":592,"name":"$logger","kind":13},{"name":"debug","line":592,"containerName":"review_log","kind":12},{"kind":13,"localvar":"my","definition":"my","name":"$args","line":595,"containerName":"review_log"},{"kind":13,"name":"$logger","line":599,"containerName":"review_log"},{"name":"debug","containerName":"review_log","line":599,"kind":12},{"name":"$tracker","line":600,"containerName":"review_log","kind":13},{"kind":13,"containerName":"review_log","line":603,"name":"$self"},{"kind":12,"containerName":"review_log","line":603,"name":"iptablesqueue_enqueue"},{"line":603,"containerName":"review_log","name":"$args","kind":13},{"kind":13,"name":"$eject","containerName":"review_log","line":603},{"kind":13,"containerName":"review_log","line":606,"name":"$logmsg","definition":"my","localvar":"my"},{"containerName":"review_log","line":607,"name":"$eject","kind":13},{"kind":13,"name":"$logger","containerName":"review_log","line":607},{"kind":12,"name":"info","line":607,"containerName":"review_log"},{"kind":13,"containerName":"review_log","line":607,"name":"$logmsg"},{"kind":13,"containerName":"review_log","line":609,"name":"$logobj"},{"kind":13,"name":"$self","line":613,"containerName":"review_log"},{"kind":12,"name":"iptablesqueue_enqueue","containerName":"review_log","line":613},{"localvar":"my","name":"$timediff","definition":"my","containerName":"review_log","line":615,"kind":13},{"name":"$start_loop_time","line":615,"containerName":"review_log","kind":13},{"containerName":"review_log","line":616,"name":"$timediff","kind":13},{"kind":13,"containerName":"review_log","line":616,"name":"$timediff"},{"kind":13,"name":"$logger","line":617,"containerName":"review_log"},{"line":617,"containerName":"review_log","name":"info","kind":12},{"name":"$cycles","line":619,"containerName":"review_log","kind":13},{"name":"$logger","line":620,"containerName":"review_log","kind":13},{"kind":12,"name":"info","containerName":"review_log","line":620},{"line":621,"containerName":"review_log","name":"$microcyclesleep","kind":13}]},{"name":"threads","line":509,"kind":12},{"kind":12,"name":"configs","line":514},{"name":"chainprefix","line":514,"kind":12},{"kind":12,"line":514,"name":"chain"},{"kind":12,"line":516,"name":"Dumper"},{"line":519,"name":"cycles","kind":12},{"kind":12,"name":"LONG_MAX","line":519},{"name":"cyclesleep","line":520,"kind":12},{"line":532,"name":"configs","kind":12},{"kind":12,"line":532,"name":"globalchain"},{"kind":12,"name":"options","line":534},{"kind":12,"line":534,"name":"rule"},{"name":"protocols","line":540,"kind":12},{"name":"protocols","line":540,"kind":12},{"kind":12,"name":"ports","line":541},{"kind":12,"line":547,"name":"ips_to_block"},{"name":"logcontents","line":547,"kind":12},{"kind":12,"line":551,"name":"Dumper"},{"name":"ips_to_block","line":551,"kind":12},{"kind":12,"name":"ips_to_block","line":555},{"kind":12,"name":"ports","line":570},{"line":587,"name":"Dumper","kind":12},{"name":"iptables_rules","line":591,"kind":12},{"name":"options","line":596,"kind":12},{"kind":12,"name":"rule","line":597},{"name":"iptables_rules","line":600,"kind":12},{"name":"ips_to_block","line":609,"kind":12},{"line":613,"name":"check_pending","kind":12},{"line":621,"name":"usleep","kind":12},{"containerName":null,"line":624,"definition":"my","name":"$runtime","localvar":"my","kind":13},{"kind":13,"name":"$start_time","containerName":null,"line":624},{"name":"$runtime","containerName":null,"line":625,"kind":13},{"name":"$runtime","containerName":null,"line":625,"kind":13},{"definition":"my","name":"$cycles_completed","containerName":null,"line":626,"localvar":"my","kind":13},{"kind":13,"name":"%logobj","containerName":null,"line":626},{"name":"cycles","line":626,"kind":12},{"kind":13,"name":"$cycles","line":626,"containerName":null},{"localvar":"my","name":"$logmsg","definition":"my","containerName":null,"line":627,"kind":13},{"name":"$logmsg","line":628,"containerName":null,"kind":13},{"containerName":null,"line":629,"name":"$logger","kind":13},{"kind":12,"name":"info","containerName":"main::","line":629},{"line":629,"containerName":null,"name":"$logmsg","kind":13},{"children":[{"kind":13,"localvar":"my","containerName":"load_configs","line":635,"name":"$self","definition":"my"},{"localvar":"my","line":636,"containerName":"load_configs","definition":"my","name":"$configsfile","kind":13},{"kind":13,"containerName":"load_configs","line":636,"name":"$self"},{"definition":"my","name":"$clargs","line":637,"containerName":"load_configs","localvar":"my","kind":13},{"name":"$self","line":637,"containerName":"load_configs","kind":13},{"kind":13,"containerName":"load_configs","line":639,"name":"$configsfile"},{"containerName":"load_configs","line":642,"name":"$self","kind":13},{"line":642,"containerName":"load_configs","name":"$self","kind":13},{"kind":13,"containerName":"load_configs","line":643,"name":"$self"},{"kind":13,"line":643,"containerName":"load_configs","name":"$self"},{"kind":13,"name":"$self","line":644,"containerName":"load_configs"},{"line":649,"containerName":"load_configs","definition":"my","name":"$msg","localvar":"my","kind":13},{"kind":13,"line":650,"containerName":"load_configs","name":"$msg"},{"containerName":"load_configs","line":651,"name":"$msg","kind":13},{"name":"$clargs","line":651,"containerName":"load_configs","kind":13},{"name":"$msg","line":652,"containerName":"load_configs","kind":13},{"name":"$DEFAULTS","line":652,"containerName":"load_configs","kind":13},{"kind":13,"containerName":"load_configs","line":653,"name":"$msg"},{"kind":13,"name":"$msg","containerName":"load_configs","line":654},{"kind":13,"line":655,"containerName":"load_configs","name":"$msg"},{"localvar":"my","containerName":"load_configs","line":658,"definition":"my","name":"$config","kind":13},{"kind":13,"containerName":"load_configs","line":658,"name":"$DEFAULTS"}],"line":634,"range":{"end":{"line":658,"character":9999},"start":{"character":0,"line":634}},"containerName":"main::","name":"load_configs","definition":"sub","kind":12},{"name":"configsfile","line":636,"kind":12},{"kind":12,"name":"clargs","line":637},{"name":"configs","line":642,"kind":12},{"name":"Config","containerName":"File::read_config_file","line":642,"kind":12},{"kind":12,"line":642,"name":"configsfile"},{"name":"configs","line":643,"kind":12},{"name":"globalchain","line":643,"kind":12},{"name":"configs","line":643,"kind":12},{"kind":12,"line":643,"name":"globalchain"},{"name":"configs","line":644,"kind":12},{"kind":12,"line":644,"name":"globalchain"},{"name":"Dumper","line":651,"kind":12},{"kind":12,"name":"Dumper","line":652},{"kind":12,"name":"carp","line":654},{"line":662,"containerName":null,"name":"%self","kind":13},{"line":662,"name":"configs","kind":12},{"kind":13,"line":662,"containerName":null,"name":"$config"},{"line":663,"containerName":null,"name":"%clargs","kind":13},{"name":"$config","containerName":null,"line":663,"kind":13},{"kind":13,"containerName":null,"line":664,"name":"%clargs"},{"containerName":null,"line":664,"name":"$config","kind":13},{"line":665,"containerName":null,"name":"%self","kind":13},{"line":665,"name":"configs","kind":12},{"kind":13,"name":"$config","line":665,"containerName":null},{"kind":13,"name":"%DEFAULTS","containerName":null,"line":665},{"containerName":null,"line":665,"name":"$config","kind":13},{"kind":13,"line":668,"containerName":null,"name":"%self"},{"line":668,"name":"configs","kind":12},{"line":672,"range":{"start":{"character":0,"line":672},"end":{"character":9999,"line":679}},"containerName":"main::","name":"reverseMapHash","definition":"sub","signature":{"parameters":[],"label":"reverseMapHash()","documentation":" Special helper function for clean_ips_to_block()"},"kind":12,"children":[{"localvar":"my","definition":"my","name":"$self","line":673,"containerName":"reverseMapHash","kind":13},{"kind":13,"name":"$hash","definition":"my","line":674,"containerName":"reverseMapHash","localvar":"my"},{"line":678,"containerName":"reverseMapHash","name":"$new_hash","definition":"my","localvar":"my","kind":13},{"kind":13,"definition":"my","name":"$key","line":679,"containerName":"reverseMapHash","localvar":"my"},{"containerName":"reverseMapHash","line":679,"name":"$hash","kind":13}],"detail":"()"},{"line":680,"containerName":null,"name":"%new_hash","kind":13},{"kind":13,"line":680,"containerName":null,"name":"%hash"},{"kind":13,"name":"$key","line":680,"containerName":null},{"kind":13,"containerName":null,"line":684,"name":"$new_hash"},{"kind":12,"signature":{"parameters":[],"label":"clean_ips_to_block_combined()","documentation":" Description: Combines the IPs from regex from the log to be blocked and the IPs from the allow/deny lists into\n               one hash"},"line":689,"range":{"start":{"character":0,"line":689},"end":{"character":9999,"line":698}},"containerName":"main::","definition":"sub","name":"clean_ips_to_block_combined","children":[{"line":690,"containerName":"clean_ips_to_block_combined","name":"$self","definition":"my","localvar":"my","kind":13},{"kind":13,"definition":"my","name":"$logobj","containerName":"clean_ips_to_block_combined","line":691,"localvar":"my"},{"kind":13,"name":"$TID","definition":"my","line":692,"containerName":"clean_ips_to_block_combined","localvar":"my"},{"name":"tid","containerName":"clean_ips_to_block_combined","line":692,"kind":12},{"name":"$TID","containerName":"clean_ips_to_block_combined","line":693,"kind":13},{"kind":13,"containerName":"clean_ips_to_block_combined","line":693,"name":"$TID"},{"kind":13,"name":"$Data","line":695,"containerName":"clean_ips_to_block_combined"},{"containerName":"clean_ips_to_block_combined","line":696,"name":"$Data","kind":13}],"detail":"()"},{"kind":12,"name":"threads","line":692},{"name":"Dumper","line":695,"containerName":"Terse","kind":12},{"kind":12,"line":696,"containerName":"Indent","name":"Dumper"},{"detail":"()","children":[{"kind":13,"name":"$self","definition":"my","containerName":"clean_ips_to_block_allowdeny","line":704,"localvar":"my"},{"kind":13,"localvar":"my","line":705,"containerName":"clean_ips_to_block_allowdeny","definition":"my","name":"$logobj"},{"kind":13,"definition":"my","name":"$TID","containerName":"clean_ips_to_block_allowdeny","line":706,"localvar":"my"},{"kind":12,"line":706,"containerName":"clean_ips_to_block_allowdeny","name":"tid"},{"kind":13,"name":"$TID","line":707,"containerName":"clean_ips_to_block_allowdeny"},{"kind":13,"containerName":"clean_ips_to_block_allowdeny","line":707,"name":"$TID"},{"name":"$Data","line":709,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"kind":13,"name":"$Data","line":710,"containerName":"clean_ips_to_block_allowdeny"},{"kind":13,"localvar":"my","definition":"my","name":"$allowdeny","containerName":"clean_ips_to_block_allowdeny","line":714},{"line":714,"containerName":"clean_ips_to_block_allowdeny","name":"$logobj","kind":13},{"kind":13,"name":"$self","containerName":"clean_ips_to_block_allowdeny","line":714},{"kind":13,"line":715,"containerName":"clean_ips_to_block_allowdeny","definition":"my","name":"$logobj_allowlist","localvar":"my"},{"name":"$logobj","line":715,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"containerName":"clean_ips_to_block_allowdeny","line":715,"name":"$self","kind":13},{"localvar":"my","name":"$logobj_denylist","definition":"my","containerName":"clean_ips_to_block_allowdeny","line":716,"kind":13},{"containerName":"clean_ips_to_block_allowdeny","line":716,"name":"$logobj","kind":13},{"containerName":"clean_ips_to_block_allowdeny","line":716,"name":"$self","kind":13},{"localvar":"my","name":"$global_denylist","definition":"my","containerName":"clean_ips_to_block_allowdeny","line":717,"kind":13},{"name":"$self","containerName":"clean_ips_to_block_allowdeny","line":717,"kind":13},{"localvar":"my","containerName":"clean_ips_to_block_allowdeny","line":718,"definition":"my","name":"$global_allowlist","kind":13},{"kind":13,"name":"$self","containerName":"clean_ips_to_block_allowdeny","line":718},{"kind":13,"localvar":"my","definition":"my","name":"$ips_to_block","containerName":"clean_ips_to_block_allowdeny","line":720},{"kind":13,"line":720,"containerName":"clean_ips_to_block_allowdeny","name":"$logobj"},{"kind":13,"name":"$logobj_allowlist","containerName":"clean_ips_to_block_allowdeny","line":723},{"name":"$self","containerName":"clean_ips_to_block_allowdeny","line":723,"kind":13},{"kind":12,"containerName":"clean_ips_to_block_allowdeny","line":723,"name":"reverseMapHash"},{"kind":13,"containerName":"clean_ips_to_block_allowdeny","line":723,"name":"$logobj_allowlist"},{"name":"$logobj_denylist","containerName":"clean_ips_to_block_allowdeny","line":724,"kind":13},{"kind":13,"line":724,"containerName":"clean_ips_to_block_allowdeny","name":"$self"},{"kind":12,"name":"reverseMapHash","line":724,"containerName":"clean_ips_to_block_allowdeny"},{"kind":13,"containerName":"clean_ips_to_block_allowdeny","line":724,"name":"$logobj_denylist"},{"kind":13,"name":"$global_allowlist","line":725,"containerName":"clean_ips_to_block_allowdeny"},{"kind":13,"containerName":"clean_ips_to_block_allowdeny","line":725,"name":"$self"},{"name":"reverseMapHash","containerName":"clean_ips_to_block_allowdeny","line":725,"kind":12},{"name":"$global_allowlist","containerName":"clean_ips_to_block_allowdeny","line":725,"kind":13},{"name":"$global_denylist","line":726,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"name":"$self","line":726,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"kind":12,"line":726,"containerName":"clean_ips_to_block_allowdeny","name":"reverseMapHash"},{"containerName":"clean_ips_to_block_allowdeny","line":726,"name":"$global_denylist","kind":13},{"containerName":"clean_ips_to_block_allowdeny","line":729,"name":"$logger","kind":13},{"kind":12,"name":"info","containerName":"clean_ips_to_block_allowdeny","line":729},{"kind":13,"containerName":"clean_ips_to_block_allowdeny","line":730,"name":"$logger"},{"name":"debug","line":730,"containerName":"clean_ips_to_block_allowdeny","kind":12},{"kind":13,"name":"$logobj_allowlist","line":730,"containerName":"clean_ips_to_block_allowdeny"},{"kind":13,"name":"$logger","line":730,"containerName":"clean_ips_to_block_allowdeny"},{"name":"is_debug","containerName":"clean_ips_to_block_allowdeny","line":730,"kind":12},{"containerName":"clean_ips_to_block_allowdeny","line":731,"name":"$logger","kind":13},{"containerName":"clean_ips_to_block_allowdeny","line":731,"name":"debug","kind":12},{"name":"$logobj_denylist","line":731,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"kind":13,"line":731,"containerName":"clean_ips_to_block_allowdeny","name":"$logger"},{"name":"is_debug","containerName":"clean_ips_to_block_allowdeny","line":731,"kind":12},{"kind":13,"line":732,"containerName":"clean_ips_to_block_allowdeny","name":"$logger"},{"line":732,"containerName":"clean_ips_to_block_allowdeny","name":"debug","kind":12},{"kind":13,"name":"$ips_to_block","containerName":"clean_ips_to_block_allowdeny","line":732},{"kind":13,"line":732,"containerName":"clean_ips_to_block_allowdeny","name":"$logger"},{"kind":12,"containerName":"clean_ips_to_block_allowdeny","line":732,"name":"is_debug"},{"line":733,"containerName":"clean_ips_to_block_allowdeny","name":"$logger","kind":13},{"line":733,"containerName":"clean_ips_to_block_allowdeny","name":"debug","kind":12},{"kind":13,"name":"$global_allowlist","containerName":"clean_ips_to_block_allowdeny","line":733},{"line":733,"containerName":"clean_ips_to_block_allowdeny","name":"$logger","kind":13},{"kind":12,"name":"is_debug","containerName":"clean_ips_to_block_allowdeny","line":733},{"kind":13,"name":"$logger","containerName":"clean_ips_to_block_allowdeny","line":734},{"containerName":"clean_ips_to_block_allowdeny","line":734,"name":"debug","kind":12},{"kind":13,"containerName":"clean_ips_to_block_allowdeny","line":734,"name":"$global_denylist"},{"containerName":"clean_ips_to_block_allowdeny","line":734,"name":"$logger","kind":13},{"kind":12,"name":"is_debug","containerName":"clean_ips_to_block_allowdeny","line":734},{"kind":13,"line":737,"containerName":"clean_ips_to_block_allowdeny","name":"$allowlist","definition":"my","localvar":"my"},{"name":"$global_allowlist","line":737,"containerName":"clean_ips_to_block_allowdeny","kind":13},{"kind":13,"name":"$logobj_allowlist","line":737,"containerName":"clean_ips_to_block_allowdeny"}],"name":"clean_ips_to_block_allowdeny","definition":"sub","containerName":"main::","range":{"end":{"line":737,"character":9999},"start":{"character":0,"line":703}},"line":703,"kind":12,"signature":{"documentation":" Description: Returns the logobj with ips_to_block set with the IPs to block from the allow/deny lists\n   There is a lot of logging available in this sub.\n   This sub is called from review_log()","parameters":[],"label":"clean_ips_to_block_allowdeny()"}},{"name":"threads","line":706,"kind":12},{"line":709,"containerName":"Terse","name":"Dumper","kind":12},{"name":"Dumper","line":710,"containerName":"Indent","kind":12},{"kind":12,"name":"allowdeny","line":714},{"name":"configs","line":714,"kind":12},{"kind":12,"name":"allowdeny","line":714},{"kind":12,"name":"allowlist","line":715},{"kind":12,"name":"configs","line":715},{"kind":12,"name":"allowlist","line":715},{"name":"denylist","line":716,"kind":12},{"kind":12,"name":"configs","line":716},{"kind":12,"line":716,"name":"denylist"},{"name":"configs","line":717,"kind":12},{"name":"denylist","line":717,"kind":12},{"line":718,"name":"configs","kind":12},{"kind":12,"line":718,"name":"allowlist"},{"kind":12,"name":"ips_to_block","line":720},{"name":"Dumper","line":730,"kind":12},{"line":731,"name":"Dumper","kind":12},{"kind":12,"line":732,"name":"Dumper"},{"line":733,"name":"Dumper","kind":12},{"name":"Dumper","line":734,"kind":12},{"containerName":null,"line":738,"name":"%denylist","definition":"my","localvar":"my","kind":13},{"kind":13,"containerName":null,"line":738,"name":"$global_denylist"},{"kind":13,"name":"$logobj_denylist","line":738,"containerName":null},{"line":741,"containerName":null,"name":"$logger","kind":13},{"name":"debug","containerName":"main::","line":741,"kind":12},{"kind":12,"name":"Dumper","line":741},{"kind":13,"containerName":null,"line":741,"name":"$allowlist"},{"kind":13,"name":"$logger","line":741,"containerName":null},{"name":"is_debug","line":741,"containerName":"main::","kind":12},{"kind":13,"name":"$logger","line":742,"containerName":null},{"kind":12,"name":"debug","line":742,"containerName":"main::"},{"kind":12,"line":742,"name":"Dumper"},{"name":"$denylist","line":742,"containerName":null,"kind":13},{"name":"$logger","containerName":null,"line":742,"kind":13},{"kind":12,"line":742,"containerName":"main::","name":"is_debug"},{"name":"%denylist","line":745,"containerName":null,"kind":13},{"kind":13,"name":"$denylist","containerName":null,"line":745},{"containerName":null,"line":745,"name":"$ips_to_block","kind":13},{"containerName":null,"line":748,"name":"$logger","kind":13},{"name":"debug","containerName":"main::","line":748,"kind":12},{"name":"Dumper","line":748,"kind":12},{"name":"$denylist","containerName":null,"line":748,"kind":13},{"name":"$logger","line":748,"containerName":null,"kind":13},{"line":748,"containerName":"main::","name":"is_debug","kind":12},{"name":"%allowdeny","containerName":null,"line":752,"kind":13},{"line":753,"containerName":null,"name":"%logobj","kind":13},{"name":"ips_to_block","line":753,"kind":12},{"name":"$denylist","containerName":null,"line":753,"kind":13},{"kind":13,"containerName":null,"line":754,"name":"$logger"},{"kind":12,"name":"debug","containerName":"main::","line":754},{"kind":12,"line":754,"name":"Dumper"},{"line":754,"containerName":null,"name":"%logobj","kind":13},{"kind":12,"name":"ips_to_block","line":754},{"kind":13,"containerName":null,"line":755,"name":"$logger"},{"containerName":"main::","line":755,"name":"is_debug","kind":12},{"kind":13,"name":"%logobj","line":756,"containerName":null},{"line":761,"containerName":null,"name":"%denylist","kind":13},{"name":"$allowlist","line":761,"containerName":null,"kind":13},{"name":"%logobj","line":762,"containerName":null,"kind":13},{"kind":12,"line":762,"name":"ips_to_block"},{"line":762,"containerName":null,"name":"$denylist","kind":13},{"kind":13,"name":"$logger","line":763,"containerName":null},{"kind":12,"name":"debug","containerName":"main::","line":763},{"name":"Dumper","line":763,"kind":12},{"containerName":null,"line":763,"name":"%logobj","kind":13},{"kind":12,"name":"ips_to_block","line":763},{"kind":13,"containerName":null,"line":764,"name":"$logger"},{"kind":12,"name":"is_debug","line":764,"containerName":"main::"},{"kind":13,"name":"$logobj","line":765,"containerName":null},{"children":[{"localvar":"my","line":785,"containerName":"run_iptables","name":"$self","definition":"my","kind":13},{"name":"$args","containerName":"run_iptables","line":785,"kind":13},{"kind":13,"line":786,"containerName":"run_iptables","definition":"my","name":"@caller_lst","localvar":"my"},{"kind":13,"line":787,"containerName":"run_iptables","name":"$caller_lst"},{"kind":13,"containerName":"run_iptables","line":787,"name":"$IPTABLESRUNLINE"},{"line":787,"containerName":"run_iptables","name":"$IPTABLESRUNLINE","kind":13},{"kind":13,"localvar":"my","definition":"my","name":"$logmsg","containerName":"run_iptables","line":788},{"containerName":"run_iptables","line":791,"name":"@caller_lst","kind":13},{"kind":13,"name":"$logger","line":796,"containerName":"run_iptables"},{"containerName":"run_iptables","line":796,"name":"error","kind":12},{"kind":13,"containerName":"run_iptables","line":796,"name":"$logmsg"},{"kind":13,"containerName":"run_iptables","line":798,"definition":"my","name":"$TID","localvar":"my"},{"kind":12,"line":798,"containerName":"run_iptables","name":"tid"},{"name":"$TID","line":799,"containerName":"run_iptables","kind":13},{"kind":13,"name":"$TID","containerName":"run_iptables","line":799},{"kind":13,"name":"$args","containerName":"run_iptables","line":802},{"kind":13,"name":"$logger","line":802,"containerName":"run_iptables"},{"kind":12,"name":"error","line":802,"containerName":"run_iptables"},{"kind":13,"line":803,"containerName":"run_iptables","name":"$self"},{"line":803,"containerName":"run_iptables","name":"$logger","kind":13},{"kind":12,"containerName":"run_iptables","line":803,"name":"error"},{"kind":13,"definition":"my","name":"$iptables","line":805,"containerName":"run_iptables","localvar":"my"},{"kind":13,"line":805,"containerName":"run_iptables","name":"$self"},{"kind":13,"containerName":"run_iptables","line":806,"definition":"my","name":"$rule","localvar":"my"},{"line":806,"containerName":"run_iptables","name":"$args","kind":13},{"kind":13,"line":807,"containerName":"run_iptables","name":"$options","definition":"my","localvar":"my"},{"containerName":"run_iptables","line":807,"name":"$args","kind":13},{"kind":13,"containerName":"run_iptables","line":809,"name":"$logger"},{"name":"is_debug","line":809,"containerName":"run_iptables","kind":12},{"kind":13,"line":810,"containerName":"run_iptables","name":"$logger"},{"name":"debug","line":810,"containerName":"run_iptables","kind":12},{"kind":13,"name":"$args","line":811,"containerName":"run_iptables"},{"kind":13,"line":819,"containerName":"run_iptables","name":"$args"},{"kind":13,"localvar":"my","definition":"my","name":"$allowdupes","containerName":"run_iptables","line":820},{"kind":13,"name":"$args","containerName":"run_iptables","line":820},{"containerName":"run_iptables","line":822,"name":"$allowdupes","kind":13},{"kind":13,"containerName":"run_iptables","line":823,"name":"$logger"},{"kind":12,"line":823,"containerName":"run_iptables","name":"debug"},{"definition":"my","name":"$retval","line":824,"containerName":"run_iptables","localvar":"my","kind":13},{"line":824,"containerName":"run_iptables","name":"$self","kind":13},{"kind":12,"line":824,"containerName":"run_iptables","name":"check_if_rule_exists"},{"containerName":"run_iptables","line":824,"name":"$args","kind":13},{"kind":13,"containerName":"run_iptables","line":825,"name":"$retval"},{"kind":13,"localvar":"my","line":826,"containerName":"run_iptables","name":"$logmsg","definition":"my"},{"name":"$logmsg","line":827,"containerName":"run_iptables","kind":13},{"kind":13,"containerName":"run_iptables","line":828,"name":"$logger"},{"name":"debug","line":828,"containerName":"run_iptables","kind":12},{"kind":13,"containerName":"run_iptables","line":828,"name":"$logmsg"},{"kind":13,"line":831,"containerName":"run_iptables","name":"$retval"},{"kind":13,"name":"$logger","line":835,"containerName":"run_iptables"},{"name":"debug","line":835,"containerName":"run_iptables","kind":12},{"kind":13,"name":"$tracker","containerName":"run_iptables","line":836},{"kind":13,"line":836,"containerName":"run_iptables","name":"$rule"},{"line":839,"containerName":"run_iptables","name":"$retval","kind":13},{"containerName":"run_iptables","line":840,"name":"$logger","kind":13},{"kind":12,"name":"debug","containerName":"run_iptables","line":840},{"kind":13,"containerName":"run_iptables","line":842,"name":"$retval"},{"kind":13,"name":"$options","line":843,"containerName":"run_iptables"},{"name":"$logger","containerName":"run_iptables","line":846,"kind":13},{"name":"debug","line":846,"containerName":"run_iptables","kind":12},{"name":"$tracker","line":849,"containerName":"run_iptables","kind":13},{"kind":13,"line":849,"containerName":"run_iptables","name":"$rule"},{"kind":13,"line":851,"containerName":"run_iptables","name":"$retval"},{"name":"$logger","containerName":"run_iptables","line":852,"kind":13},{"kind":12,"name":"error","containerName":"run_iptables","line":852},{"kind":13,"containerName":"run_iptables","line":855,"name":"$retval"},{"kind":13,"localvar":"my","line":856,"containerName":"run_iptables","name":"$logmsg","definition":"my"},{"kind":13,"name":"$logmsg","line":857,"containerName":"run_iptables"},{"kind":13,"containerName":"run_iptables","line":858,"name":"$logger"},{"name":"error","containerName":"run_iptables","line":858,"kind":12},{"kind":13,"line":858,"containerName":"run_iptables","name":"$logmsg"},{"line":862,"containerName":"run_iptables","name":"$logger","kind":13},{"name":"error","containerName":"run_iptables","line":862,"kind":12},{"kind":13,"line":862,"containerName":"run_iptables","name":"$retval"},{"kind":13,"name":"$command","definition":"my","containerName":"run_iptables","line":867,"localvar":"my"},{"name":"$tracker","line":868,"containerName":"run_iptables","kind":13},{"containerName":"run_iptables","line":868,"name":"$rule","kind":13},{"name":"$self","containerName":"run_iptables","line":869,"kind":13},{"kind":13,"containerName":"run_iptables","line":870,"name":"$logger"},{"name":"debug","line":870,"containerName":"run_iptables","kind":12},{"definition":"my","name":"$output","line":871,"containerName":"run_iptables","localvar":"my","kind":13},{"kind":13,"containerName":"run_iptables","line":872,"name":"$logger"},{"kind":12,"containerName":"run_iptables","line":872,"name":"debug"},{"line":876,"containerName":"run_iptables","name":"$logger","kind":13},{"kind":12,"line":876,"containerName":"run_iptables","name":"info"},{"name":"$logger","containerName":"run_iptables","line":881,"kind":13},{"kind":12,"containerName":"run_iptables","line":881,"name":"error"}],"detail":"()","range":{"end":{"character":9999,"line":883},"start":{"character":0,"line":784}},"containerName":"main::","line":784,"definition":"sub","name":"run_iptables","signature":{"documentation":" Runs whatever parameters are passed to it against iptables\n  This is intended to be a one stop shop for running iptables out from a queue.\n  However, there are a few instances where it is called directly... especially when creating chains\n   This hopefully prevents excessive wait/locking on iptables\n   and helps to keep commands running in the order they are received.\n Arguments must be passed as a hash reference with (so far) the following keys:\n   rule:  The rule to run\n   options:  Any options to pass to iptables\n  Where it is ran like this:\n   iptables $options $rule 2>&1\n Future enhancement:\n   1. delete existing rule if it exists\n Take note this sub is intended (but not required) to be called from sub iptables_thread()\n  An error will happen if not called from sub iptables_thread(), but it will not stop the program\n  This is to encourage using the iptablesqueue_enqueue() sub instead of run_iptables() directly\n  So, to say this more clearly, if you want to run iptables commands, then call iptablesqueue_enqueue()","label":"run_iptables()","parameters":[]},"kind":12},{"kind":12,"line":791,"name":"Dumper"},{"line":798,"name":"threads","kind":12},{"line":802,"name":"rule","kind":12},{"name":"configs","line":803,"kind":12},{"kind":12,"name":"iptables","line":803},{"line":805,"name":"configs","kind":12},{"name":"iptables","line":805,"kind":12},{"kind":12,"line":806,"name":"rule"},{"line":807,"name":"options","kind":12},{"kind":12,"name":"Dumper","line":811},{"kind":12,"name":"allowdupes","line":819},{"kind":12,"name":"allowdupes","line":820},{"name":"iptables_rules","line":836,"kind":12},{"name":"chains_created","line":849,"kind":12},{"kind":12,"line":868,"name":"iptables_rules"},{"line":869,"name":"configs","kind":12},{"line":869,"name":"PRODMODE","kind":12},{"detail":"()","children":[{"kind":13,"name":"$self","definition":"my","line":887,"containerName":"set_iptables_command","localvar":"my"},{"name":"$self","containerName":"set_iptables_command","line":890,"kind":13},{"kind":13,"name":"$self","line":891,"containerName":"set_iptables_command"},{"kind":13,"line":892,"containerName":"set_iptables_command","name":"$logger"},{"kind":12,"name":"info","containerName":"set_iptables_command","line":892}],"signature":{"parameters":[],"label":"set_iptables_command()","documentation":" Maybe an unnecessary sub but maybe some better checks down the road"},"kind":12,"name":"set_iptables_command","definition":"sub","range":{"end":{"character":9999,"line":894},"start":{"line":886,"character":0}},"containerName":"main::","line":886},{"kind":12,"name":"configs","line":890},{"kind":12,"name":"iptables","line":890},{"kind":12,"name":"configs","line":891},{"name":"iptables","line":891,"kind":12},{"signature":{"documentation":"# Returns 0 if there is an unknown return value from running iptables\n#          Otherwise returns a string","parameters":[{"label":"$self"},{"label":"$args"}],"label":"check_if_rule_exists($self,$args)"},"kind":12,"line":898,"range":{"start":{"character":0,"line":898},"end":{"line":953,"character":9999}},"containerName":"main::","definition":"sub","name":"check_if_rule_exists","children":[{"localvar":"my","line":899,"containerName":"check_if_rule_exists","definition":"my","name":"$self","kind":13},{"name":"$args","containerName":"check_if_rule_exists","line":899,"kind":13},{"line":900,"containerName":"check_if_rule_exists","definition":"my","name":"$TID","localvar":"my","kind":13},{"line":900,"containerName":"check_if_rule_exists","name":"tid","kind":12},{"name":"$TID","line":901,"containerName":"check_if_rule_exists","kind":13},{"line":901,"containerName":"check_if_rule_exists","name":"$TID","kind":13},{"name":"$args","containerName":"check_if_rule_exists","line":904,"kind":13},{"kind":13,"line":904,"containerName":"check_if_rule_exists","name":"$self"},{"containerName":"check_if_rule_exists","line":904,"name":"log_and_return","kind":12},{"kind":13,"name":"$self","line":905,"containerName":"check_if_rule_exists"},{"kind":13,"containerName":"check_if_rule_exists","line":905,"name":"$logger"},{"kind":12,"line":905,"containerName":"check_if_rule_exists","name":"error"},{"kind":13,"localvar":"my","definition":"my","name":"$iptables","line":907,"containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","line":907,"name":"$self","kind":13},{"line":908,"containerName":"check_if_rule_exists","definition":"my","name":"$rule","localvar":"my","kind":13},{"kind":13,"name":"$args","containerName":"check_if_rule_exists","line":908},{"localvar":"my","name":"$options","definition":"my","containerName":"check_if_rule_exists","line":909,"kind":13},{"kind":13,"name":"$args","line":909,"containerName":"check_if_rule_exists"},{"kind":13,"name":"$tracker","containerName":"check_if_rule_exists","line":911},{"kind":13,"containerName":"check_if_rule_exists","line":911,"name":"$rule"},{"kind":13,"name":"$logger","containerName":"check_if_rule_exists","line":912},{"kind":12,"name":"debug","line":912,"containerName":"check_if_rule_exists"},{"kind":13,"name":"$tracker","line":916,"containerName":"check_if_rule_exists"},{"kind":13,"containerName":"check_if_rule_exists","line":916,"name":"$rule"},{"kind":13,"name":"$logger","containerName":"check_if_rule_exists","line":917},{"kind":12,"name":"debug","containerName":"check_if_rule_exists","line":917},{"kind":13,"name":"$options","containerName":"check_if_rule_exists","line":921},{"localvar":"my","definition":"my","name":"$logmsg","containerName":"check_if_rule_exists","line":922,"kind":13},{"kind":13,"name":"$logmsg","line":923,"containerName":"check_if_rule_exists"},{"kind":13,"name":"$logger","line":924,"containerName":"check_if_rule_exists"},{"line":924,"containerName":"check_if_rule_exists","name":"debug","kind":12},{"line":924,"containerName":"check_if_rule_exists","name":"$logmsg","kind":13},{"kind":13,"containerName":"check_if_rule_exists","line":928,"name":"$checkrule_result","definition":"my","localvar":"my"},{"kind":13,"containerName":"check_if_rule_exists","line":930,"name":"$logger"},{"kind":12,"containerName":"check_if_rule_exists","line":930,"name":"debug"},{"kind":13,"containerName":"check_if_rule_exists","line":934,"name":"$checkrule_result"},{"containerName":"check_if_rule_exists","line":935,"name":"$logger","kind":13},{"kind":12,"line":935,"containerName":"check_if_rule_exists","name":"debug"},{"kind":13,"containerName":"check_if_rule_exists","line":936,"name":"$logger"},{"name":"debug","containerName":"check_if_rule_exists","line":936,"kind":12},{"kind":13,"line":940,"containerName":"check_if_rule_exists","name":"$checkrule_result"},{"kind":13,"line":941,"containerName":"check_if_rule_exists","name":"$logger"},{"kind":12,"containerName":"check_if_rule_exists","line":941,"name":"debug"},{"name":"$logger","line":942,"containerName":"check_if_rule_exists","kind":13},{"kind":12,"containerName":"check_if_rule_exists","line":942,"name":"debug"},{"line":946,"containerName":"check_if_rule_exists","name":"$checkrule_result","kind":13},{"kind":13,"line":947,"containerName":"check_if_rule_exists","name":"$logger"},{"kind":12,"line":947,"containerName":"check_if_rule_exists","name":"debug"},{"name":"$logger","line":948,"containerName":"check_if_rule_exists","kind":13},{"kind":12,"name":"debug","line":948,"containerName":"check_if_rule_exists"},{"kind":13,"line":952,"containerName":"check_if_rule_exists","name":"$self"},{"name":"log_and_return","containerName":"check_if_rule_exists","line":952,"kind":12}],"detail":"($self,$args)"},{"kind":12,"name":"threads","line":900},{"name":"rule","line":904,"kind":12},{"kind":12,"line":905,"name":"configs"},{"line":905,"name":"iptables","kind":12},{"name":"configs","line":907,"kind":12},{"line":907,"name":"iptables","kind":12},{"kind":12,"name":"rule","line":908},{"kind":12,"line":909,"name":"options"},{"name":"chains_created","line":911,"kind":12},{"name":"iptables_rules","line":916,"kind":12},{"signature":{"documentation":"","parameters":[{"label":"$self"},{"label":"$error_message"}],"label":"log_and_return($self,$error_message)"},"kind":12,"definition":"sub","name":"log_and_return","range":{"end":{"character":9999,"line":961},"start":{"character":0,"line":955}},"line":955,"containerName":"main::","detail":"($self,$error_message)","children":[{"name":"$self","definition":"my","containerName":"log_and_return","line":956,"localvar":"my","kind":13},{"name":"$error_message","containerName":"log_and_return","line":956,"kind":13},{"localvar":"my","line":957,"containerName":"log_and_return","definition":"my","name":"$TID","kind":13},{"containerName":"log_and_return","line":957,"name":"tid","kind":12},{"name":"$TID","containerName":"log_and_return","line":958,"kind":13},{"kind":13,"name":"$TID","line":958,"containerName":"log_and_return"},{"line":959,"containerName":"log_and_return","name":"$logger","kind":13},{"kind":12,"containerName":"log_and_return","line":959,"name":"error"},{"name":"$error_message","containerName":"log_and_return","line":959,"kind":13}]},{"line":957,"name":"threads","kind":12},{"kind":12,"signature":{"label":"add_global_chain()","parameters":[],"documentation":" Description: Creates the global chain and then adds a jump rule to the global chains.\n           With default values this means creating the global chain \"IPBLOCKER_glopbal\" and then\n           adding a jump rule to the INPUT, OUTPUT, and FORWARD tables to go to IPBLOCKER_global\n Dies if no chain prefix is set or if no global chains are set\n    Bassically, this dies if it is not called as class or correct configs are not set\n Returns 1 always"},"containerName":"main::","range":{"end":{"character":9999,"line":997},"start":{"line":969,"character":0}},"line":969,"name":"add_global_chain","definition":"sub","children":[{"kind":13,"localvar":"my","line":970,"containerName":"add_global_chain","definition":"my","name":"$self"},{"containerName":"add_global_chain","line":971,"definition":"my","name":"$TID","localvar":"my","kind":13},{"containerName":"add_global_chain","line":971,"name":"tid","kind":12},{"name":"$TID","line":972,"containerName":"add_global_chain","kind":13},{"name":"$TID","line":972,"containerName":"add_global_chain","kind":13},{"kind":13,"containerName":"add_global_chain","line":974,"name":"$chain","definition":"my","localvar":"my"},{"line":974,"containerName":"add_global_chain","name":"$self","kind":13},{"kind":13,"name":"$logger","containerName":"add_global_chain","line":974},{"kind":12,"name":"logdie","containerName":"add_global_chain","line":974},{"kind":13,"line":975,"containerName":"add_global_chain","name":"$chain"},{"kind":13,"name":"$chain","containerName":"add_global_chain","line":975},{"localvar":"my","containerName":"add_global_chain","line":977,"definition":"my","name":"$globalchains_str","kind":13},{"line":977,"containerName":"add_global_chain","name":"$self","kind":13},{"name":"$logger","containerName":"add_global_chain","line":977,"kind":13},{"name":"logdie","line":977,"containerName":"add_global_chain","kind":12},{"localvar":"my","line":978,"containerName":"add_global_chain","definition":"my","name":"@globalchains","kind":13},{"kind":13,"line":978,"containerName":"add_global_chain","name":"$globalchains_str"},{"kind":13,"name":"$logger","line":980,"containerName":"add_global_chain"},{"kind":12,"name":"info","line":980,"containerName":"add_global_chain"},{"kind":13,"containerName":"add_global_chain","line":981,"name":"$args","definition":"my","localvar":"my"},{"kind":13,"containerName":"add_global_chain","line":985,"name":"$self"},{"containerName":"add_global_chain","line":985,"name":"iptablesqueue_enqueue","kind":12},{"name":"$args","line":985,"containerName":"add_global_chain","kind":13},{"kind":13,"name":"$logger","containerName":"add_global_chain","line":987},{"kind":12,"name":"info","line":987,"containerName":"add_global_chain"},{"kind":13,"line":988,"containerName":"add_global_chain","definition":"my","name":"$table","localvar":"my"},{"kind":13,"line":988,"containerName":"add_global_chain","name":"@globalchains"},{"kind":13,"definition":"my","name":"$args","line":989,"containerName":"add_global_chain","localvar":"my"},{"kind":13,"containerName":"add_global_chain","line":993,"name":"$self"},{"line":993,"containerName":"add_global_chain","name":"iptablesqueue_enqueue","kind":12},{"kind":13,"name":"$args","containerName":"add_global_chain","line":993}],"detail":"()"},{"line":971,"name":"threads","kind":12},{"line":974,"name":"configs","kind":12},{"name":"chainprefix","line":974,"kind":12},{"name":"configs","line":977,"kind":12},{"name":"globalchains","line":977,"kind":12},{"kind":12,"line":982,"name":"options"},{"kind":12,"line":983,"name":"rule"},{"line":990,"name":"options","kind":12},{"name":"rule","line":991,"kind":12},{"signature":{"label":"iptablesqueue_enqueue()","parameters":[],"documentation":" Description: Queues items onto the iptables queue\n Returns 1 if queue is allowing enqueuing\n Returns 0 if queue is not allowing enqueuing"},"kind":12,"name":"iptablesqueue_enqueue","definition":"sub","range":{"end":{"line":1018,"character":9999},"start":{"character":0,"line":1002}},"containerName":"main::","line":1002,"detail":"()","children":[{"line":1003,"containerName":"iptablesqueue_enqueue","definition":"my","name":"$self","localvar":"my","kind":13},{"containerName":"iptablesqueue_enqueue","line":1003,"name":"$args","kind":13},{"kind":13,"localvar":"my","definition":"my","name":"$TID","line":1004,"containerName":"iptablesqueue_enqueue"},{"name":"tid","line":1004,"containerName":"iptablesqueue_enqueue","kind":12},{"line":1005,"containerName":"iptablesqueue_enqueue","name":"$TID","kind":13},{"containerName":"iptablesqueue_enqueue","line":1005,"name":"$TID","kind":13},{"name":"$iptablesQueue_pending","definition":"my","containerName":"iptablesqueue_enqueue","line":1007,"localvar":"my","kind":13},{"kind":13,"containerName":"iptablesqueue_enqueue","line":1007,"name":"$IptablesQueue"},{"name":"pending","containerName":"iptablesqueue_enqueue","line":1007,"kind":12},{"name":"$iptablesQueue_pending","containerName":"iptablesqueue_enqueue","line":1008,"kind":13},{"line":1009,"containerName":"iptablesqueue_enqueue","definition":"my","name":"$logmsg","localvar":"my","kind":13},{"containerName":"iptablesqueue_enqueue","line":1010,"name":"$logmsg","kind":13},{"kind":13,"name":"$logger","line":1011,"containerName":"iptablesqueue_enqueue"},{"kind":12,"name":"info","containerName":"iptablesqueue_enqueue","line":1011},{"containerName":"iptablesqueue_enqueue","line":1011,"name":"$logmsg","kind":13},{"name":"$args","line":1014,"containerName":"iptablesqueue_enqueue","kind":13},{"name":"$logger","containerName":"iptablesqueue_enqueue","line":1015,"kind":13},{"name":"debug","line":1015,"containerName":"iptablesqueue_enqueue","kind":12},{"name":"$args","containerName":"iptablesqueue_enqueue","line":1015,"kind":13},{"kind":13,"line":1015,"containerName":"iptablesqueue_enqueue","name":"$logger"},{"name":"is_debug","containerName":"iptablesqueue_enqueue","line":1015,"kind":12},{"kind":13,"line":1016,"containerName":"iptablesqueue_enqueue","name":"$IptablesQueue"},{"containerName":"iptablesqueue_enqueue","line":1016,"name":"enqueue","kind":12},{"containerName":"iptablesqueue_enqueue","line":1016,"name":"$args","kind":13}]},{"kind":12,"line":1004,"name":"threads"},{"line":1014,"name":"check_pending","kind":12},{"kind":12,"name":"Dumper","line":1015},{"detail":"($self,$logobj)","children":[{"localvar":"my","containerName":"readlogfile","line":1026,"name":"$self","definition":"my","kind":13},{"name":"$logobj","containerName":"readlogfile","line":1026,"kind":13},{"localvar":"my","name":"$TID","definition":"my","containerName":"readlogfile","line":1027,"kind":13},{"line":1027,"containerName":"readlogfile","name":"tid","kind":12},{"line":1028,"containerName":"readlogfile","name":"$TID","kind":13},{"name":"$TID","line":1028,"containerName":"readlogfile","kind":13},{"localvar":"my","line":1031,"containerName":"readlogfile","name":"$file","definition":"my","kind":13},{"kind":13,"containerName":"readlogfile","line":1031,"name":"$logobj"},{"kind":13,"name":"$file","containerName":"readlogfile","line":1032},{"name":"$logger","line":1032,"containerName":"readlogfile","kind":13},{"kind":12,"name":"error","line":1032,"containerName":"readlogfile"},{"name":"$logobj","containerName":"readlogfile","line":1032,"kind":13},{"kind":13,"name":"$logobj","line":1035,"containerName":"readlogfile"},{"kind":13,"line":1036,"containerName":"readlogfile","name":"$logobj"},{"containerName":"readlogfile","line":1036,"name":"$file","kind":13},{"kind":13,"line":1036,"containerName":"readlogfile","name":"$logobj"},{"kind":13,"containerName":"readlogfile","line":1037,"name":"$logobj"},{"kind":13,"name":"$self","containerName":"readlogfile","line":1037},{"kind":13,"line":1038,"containerName":"readlogfile","name":"$logobj"},{"kind":13,"name":"$logobj","line":1038,"containerName":"readlogfile"},{"kind":13,"line":1040,"containerName":"readlogfile","name":"$logger"},{"kind":12,"containerName":"readlogfile","line":1040,"name":"debug"},{"name":"$fh","definition":"my","containerName":"readlogfile","line":1046,"localvar":"my","kind":13},{"name":"$file","containerName":"readlogfile","line":1046,"kind":13},{"containerName":"readlogfile","line":1047,"name":"$logger","kind":13},{"containerName":"readlogfile","line":1047,"name":"error","kind":12},{"kind":13,"line":1048,"containerName":"readlogfile","name":"$logobj"},{"line":1050,"containerName":"readlogfile","name":"$fh","kind":13},{"containerName":"readlogfile","line":1050,"name":"$logobj","kind":13},{"kind":13,"name":"@logcontents","definition":"my","containerName":"readlogfile","line":1051,"localvar":"my"},{"kind":13,"name":"$fh","line":1051,"containerName":"readlogfile"},{"name":"$logobj","containerName":"readlogfile","line":1052,"kind":13},{"kind":13,"name":"$fh","line":1052,"containerName":"readlogfile"},{"kind":13,"name":"$fh","line":1053,"containerName":"readlogfile"},{"kind":13,"line":1055,"containerName":"readlogfile","name":"@logcontents"},{"kind":13,"name":"$logger","line":1056,"containerName":"readlogfile"},{"kind":12,"name":"debug","line":1056,"containerName":"readlogfile"},{"kind":13,"containerName":"readlogfile","line":1056,"name":"@logcontents"},{"line":1059,"containerName":"readlogfile","name":"$logger","kind":13},{"kind":12,"line":1059,"containerName":"readlogfile","name":"info"},{"kind":13,"name":"$logobj","line":1060,"containerName":"readlogfile"},{"kind":13,"containerName":"readlogfile","line":1063,"name":"@logcontents"},{"containerName":"readlogfile","line":1064,"name":"$logobj","kind":13},{"kind":13,"name":"@logcontents","line":1064,"containerName":"readlogfile"},{"name":"$logger","line":1066,"containerName":"readlogfile","kind":13},{"name":"debug","containerName":"readlogfile","line":1066,"kind":12},{"kind":13,"name":"@logcontents","containerName":"readlogfile","line":1066},{"kind":13,"name":"$logger","containerName":"readlogfile","line":1067},{"line":1067,"containerName":"readlogfile","name":"trace","kind":12},{"kind":13,"line":1067,"containerName":"readlogfile","name":"$logobj"},{"containerName":"readlogfile","line":1067,"name":"$logger","kind":13},{"kind":12,"name":"is_trace","containerName":"readlogfile","line":1067},{"kind":13,"name":"$logobj","containerName":"readlogfile","line":1069}],"definition":"sub","name":"readlogfile","containerName":"main::","range":{"start":{"line":1025,"character":0},"end":{"character":9999,"line":1070}},"line":1025,"signature":{"parameters":[{"label":"$self"},{"label":"$logobj"}],"label":"readlogfile($self,$logobj)","documentation":" This function reads the log file into memory from the seek position (if it exists)\n The reading of a log file based on the seek position creates a big issue if the log file is rotated AND is larger than\n   the seek position\n   This is a tradeoff of reading the entire log file into memory and then grepping for the regexps\n Returns: $logobj"},"kind":12},{"line":1027,"name":"threads","kind":12},{"name":"file","line":1031,"kind":12},{"line":1035,"name":"seek","kind":12},{"line":1036,"name":"seek","kind":12},{"kind":12,"line":1036,"name":"seek"},{"kind":12,"line":1037,"name":"readentirefile"},{"kind":12,"name":"configs","line":1037},{"kind":12,"line":1037,"name":"readentirefile"},{"kind":12,"name":"seek","line":1038},{"name":"readentirefile","line":1038,"kind":12},{"kind":12,"line":1050,"name":"seek"},{"line":1052,"name":"seek","kind":12},{"name":"logcontents","line":1060,"kind":12},{"kind":12,"name":"logcontents","line":1064},{"kind":12,"name":"Dumper","line":1067},{"kind":12,"name":"logcontents","line":1067},{"detail":"($self,$log)","children":[{"kind":13,"localvar":"my","name":"$self","definition":"my","containerName":"_grep_regexps","line":1076},{"kind":13,"line":1076,"containerName":"_grep_regexps","name":"$log"},{"name":"$TID","definition":"my","containerName":"_grep_regexps","line":1077,"localvar":"my","kind":13},{"kind":12,"name":"tid","line":1077,"containerName":"_grep_regexps"},{"definition":"my","name":"$matches","containerName":"_grep_regexps","line":1079,"localvar":"my","kind":13},{"kind":13,"localvar":"my","name":"@log_contents","definition":"my","line":1080,"containerName":"_grep_regexps"},{"kind":13,"containerName":"_grep_regexps","line":1080,"name":"$log"}],"signature":{"parameters":[{"label":"$self"},{"label":"$log"}],"label":"_grep_regexps($self,$log)","documentation":" Description:  Using the logobj, this greps against the log contents for matching lines and then gets the\n               IP address on each line.\n Returns:  Hash reference of IP addresses with count of how many times the IP address was found"},"kind":12,"definition":"sub","name":"_grep_regexps","range":{"end":{"character":9999,"line":1080},"start":{"character":0,"line":1075}},"containerName":"main::","line":1075},{"name":"threads","line":1077,"kind":12},{"kind":12,"name":"logcontents","line":1080},{"kind":13,"containerName":null,"line":1082,"name":"@log_contents"},{"localvar":"my","containerName":null,"line":1085,"name":"$regex","definition":"my","kind":13},{"containerName":null,"line":1085,"name":"%log","kind":13},{"kind":12,"name":"regexpdeny","line":1085},{"localvar":"my","line":1086,"containerName":null,"definition":"my","name":"$pattern","kind":13},{"kind":13,"line":1086,"containerName":null,"name":"%log"},{"name":"regexpdeny","line":1086,"kind":12},{"kind":13,"line":1086,"containerName":null,"name":"$regex"},{"kind":13,"line":1087,"containerName":null,"name":"$logger"},{"kind":12,"name":"debug","containerName":"main::","line":1087},{"definition":"my","name":"@current_matches","containerName":null,"line":1089,"localvar":"my","kind":13},{"kind":13,"name":"@log_contents","containerName":null,"line":1089},{"kind":13,"name":"$logger","line":1090,"containerName":null},{"line":1090,"containerName":"main::","name":"debug","kind":12},{"name":"Dumper","line":1090,"kind":12},{"kind":13,"name":"@current_matches","line":1090,"containerName":null},{"kind":13,"containerName":null,"line":1090,"name":"$logger"},{"kind":12,"name":"is_debug","containerName":"main::","line":1090},{"kind":13,"definition":"my","name":"$line","line":1092,"containerName":null,"localvar":"my"},{"kind":13,"containerName":null,"line":1092,"name":"@current_matches"},{"containerName":null,"line":1093,"name":"$line","kind":13},{"containerName":null,"line":1094,"name":"$logger","kind":13},{"name":"debug","line":1094,"containerName":"main::","kind":12},{"line":1096,"containerName":null,"definition":"my","name":"$ip_address","localvar":"my","kind":13},{"line":1096,"containerName":null,"name":"$line","kind":13},{"line":1096,"containerName":null,"name":"%line","kind":13},{"name":"%matches","line":1097,"containerName":null,"kind":13},{"kind":13,"line":1097,"containerName":null,"name":"$ip_address"},{"name":"$logger","line":1098,"containerName":null,"kind":13},{"kind":12,"name":"debug","line":1098,"containerName":"main::"},{"name":"$logger","containerName":null,"line":1103,"kind":13},{"containerName":"main::","line":1103,"name":"debug","kind":12},{"kind":12,"line":1103,"name":"Dumper"},{"kind":13,"line":1103,"containerName":null,"name":"$matches"},{"name":"$logger","containerName":null,"line":1103,"kind":13},{"kind":12,"name":"is_debug","containerName":"main::","line":1103},{"name":"$log_msg","definition":"my","containerName":null,"line":1105,"localvar":"my","kind":13},{"name":"$log_msg","line":1106,"containerName":null,"kind":13},{"name":"$matches","line":1106,"containerName":null,"kind":13},{"kind":13,"containerName":null,"line":1107,"name":"$logger"},{"kind":12,"name":"info","containerName":"main::","line":1107},{"kind":13,"containerName":null,"line":1107,"name":"$log_msg"},{"kind":13,"name":"$matches","line":1109,"containerName":null},{"children":[{"kind":13,"localvar":"my","line":1114,"containerName":"add_chain","definition":"my","name":"$self"},{"name":"$chain","line":1114,"containerName":"add_chain","kind":13},{"kind":13,"line":1115,"containerName":"add_chain","definition":"my","name":"$TID","localvar":"my"},{"line":1115,"containerName":"add_chain","name":"tid","kind":12},{"kind":13,"line":1117,"containerName":"add_chain","name":"$logger"},{"kind":12,"line":1117,"containerName":"add_chain","name":"info"},{"containerName":"add_chain","line":1118,"name":"$rule","definition":"my","localvar":"my","kind":13},{"localvar":"my","containerName":"add_chain","line":1119,"definition":"my","name":"$options","kind":13},{"localvar":"my","definition":"my","name":"$args","containerName":"add_chain","line":1120,"kind":13},{"name":"$rule","line":1120,"containerName":"add_chain","kind":13},{"kind":13,"containerName":"add_chain","line":1120,"name":"$options"},{"line":1121,"containerName":"add_chain","name":"$self","kind":13},{"line":1121,"containerName":"add_chain","name":"iptablesqueue_enqueue","kind":12},{"kind":13,"line":1121,"containerName":"add_chain","name":"$args"},{"name":"$self","containerName":"add_chain","line":1122,"kind":13},{"kind":13,"name":"$chain","line":1122,"containerName":"add_chain"}],"detail":"()","line":1113,"range":{"end":{"line":1124,"character":9999},"start":{"character":0,"line":1113}},"containerName":"main::","name":"add_chain","definition":"sub","signature":{"documentation":" Description:  Adds the chain to iptables","parameters":[],"label":"add_chain()"},"kind":12},{"line":1115,"name":"threads","kind":12},{"name":"rule","line":1120,"kind":12},{"kind":12,"name":"options","line":1120},{"line":1122,"name":"chains_created","kind":12},{"line":1133,"range":{"start":{"line":1133,"character":0},"end":{"line":1171,"character":9999}},"containerName":"main::","definition":"sub","name":"add_allowdeny_ips","kind":12,"signature":{"parameters":[],"label":"add_allowdeny_ips()","documentation":" Description:  Adds the IPs to DROP or ACCEPT to the chain provided\n Returns:  1\n Requires: $args to be a hash reference with the following optional keys:\n  chain:  The chain to add the rules to.  If no chain provided then the default is ipblocker_global\n  allowlist:  An array of IPs to allow\n  denylist:  An array of IPs to deny\n  allowdenyorder:  The order to add the allow and deny rules"},"children":[{"kind":13,"localvar":"my","definition":"my","name":"$self","line":1134,"containerName":"add_allowdeny_ips"},{"containerName":"add_allowdeny_ips","line":1134,"name":"$args","kind":13},{"line":1135,"containerName":"add_allowdeny_ips","definition":"my","name":"$TID","localvar":"my","kind":13},{"line":1135,"containerName":"add_allowdeny_ips","name":"tid","kind":12},{"kind":13,"line":1137,"containerName":"add_allowdeny_ips","name":"$args"},{"kind":13,"name":"$logger","line":1138,"containerName":"add_allowdeny_ips"},{"line":1138,"containerName":"add_allowdeny_ips","name":"error","kind":12},{"kind":13,"containerName":"add_allowdeny_ips","line":1141,"name":"$chain","definition":"my","localvar":"my"},{"name":"$args","line":1141,"containerName":"add_allowdeny_ips","kind":13},{"kind":13,"localvar":"my","containerName":"add_allowdeny_ips","line":1143,"definition":"my","name":"%ip_rules"},{"kind":13,"line":1144,"containerName":"add_allowdeny_ips","name":"$args"},{"kind":13,"containerName":"add_allowdeny_ips","line":1145,"name":"$args"},{"kind":13,"containerName":"add_allowdeny_ips","line":1148,"definition":"my","name":"@allowdenyorder","localvar":"my"},{"kind":13,"name":"$args","containerName":"add_allowdeny_ips","line":1149},{"kind":13,"name":"@allowdenyorder","containerName":"add_allowdeny_ips","line":1150},{"kind":13,"line":1153,"containerName":"add_allowdeny_ips","name":"$logger"},{"kind":12,"line":1153,"containerName":"add_allowdeny_ips","name":"debug"},{"line":1153,"containerName":"add_allowdeny_ips","name":"%ip_rules","kind":13},{"kind":13,"containerName":"add_allowdeny_ips","line":1153,"name":"$logger"},{"name":"is_debug","line":1153,"containerName":"add_allowdeny_ips","kind":12},{"definition":"my","name":"$action","containerName":"add_allowdeny_ips","line":1156,"localvar":"my","kind":13},{"kind":13,"containerName":"add_allowdeny_ips","line":1156,"name":"@allowdenyorder"},{"name":"$logger","containerName":"add_allowdeny_ips","line":1157,"kind":13},{"kind":12,"line":1157,"containerName":"add_allowdeny_ips","name":"debug"},{"kind":13,"line":1160,"containerName":"add_allowdeny_ips","definition":"my","name":"$chain","localvar":"my"},{"containerName":"add_allowdeny_ips","line":1160,"name":"$args","kind":13},{"localvar":"my","containerName":"add_allowdeny_ips","line":1161,"definition":"my","name":"$rule_action","kind":13},{"kind":13,"containerName":"add_allowdeny_ips","line":1161,"name":"$action"},{"line":1162,"containerName":"add_allowdeny_ips","definition":"my","name":"$ip","localvar":"my","kind":13},{"kind":13,"name":"$ip_rules","line":1162,"containerName":"add_allowdeny_ips"},{"name":"$action","containerName":"add_allowdeny_ips","line":1162,"kind":13},{"kind":13,"containerName":"add_allowdeny_ips","line":1163,"name":"$logger"},{"kind":12,"line":1163,"containerName":"add_allowdeny_ips","name":"debug"},{"kind":13,"line":1164,"containerName":"add_allowdeny_ips","name":"$direction","definition":"my","localvar":"my"},{"kind":13,"containerName":"add_allowdeny_ips","line":1165,"name":"$rule","definition":"my","localvar":"my"},{"localvar":"my","definition":"my","name":"$args","line":1166,"containerName":"add_allowdeny_ips","kind":13},{"kind":13,"line":1166,"containerName":"add_allowdeny_ips","name":"$rule"},{"containerName":"add_allowdeny_ips","line":1167,"name":"$logger","kind":13},{"line":1167,"containerName":"add_allowdeny_ips","name":"debug","kind":12},{"kind":13,"line":1168,"containerName":"add_allowdeny_ips","name":"$self"},{"kind":12,"name":"iptablesqueue_enqueue","line":1168,"containerName":"add_allowdeny_ips"},{"name":"$args","line":1168,"containerName":"add_allowdeny_ips","kind":13}],"detail":"()"},{"kind":12,"name":"threads","line":1135},{"name":"chain","line":1141,"kind":12},{"kind":12,"name":"allow","line":1144},{"name":"allowlist","line":1144,"kind":12},{"kind":12,"name":"deny","line":1145},{"name":"denylist","line":1145,"kind":12},{"kind":12,"name":"allowdeny","line":1149},{"kind":12,"line":1153,"name":"Dumper"},{"line":1160,"name":"chain","kind":12},{"kind":12,"line":1166,"name":"rule"},{"kind":12,"name":"options","line":1166},{"children":[{"kind":13,"line":1179,"containerName":"add_global_allow_deny_ips","definition":"my","name":"$self","localvar":"my"},{"line":1180,"containerName":"add_global_allow_deny_ips","name":"$TID","definition":"my","localvar":"my","kind":13},{"line":1180,"containerName":"add_global_allow_deny_ips","name":"tid","kind":12},{"kind":13,"name":"$logger","containerName":"add_global_allow_deny_ips","line":1182},{"name":"debug","containerName":"add_global_allow_deny_ips","line":1182,"kind":12},{"containerName":"add_global_allow_deny_ips","line":1183,"name":"$chain","definition":"my","localvar":"my","kind":13},{"kind":13,"containerName":"add_global_allow_deny_ips","line":1183,"name":"$self"},{"localvar":"my","line":1184,"containerName":"add_global_allow_deny_ips","name":"@allowlist","definition":"my","kind":13},{"containerName":"add_global_allow_deny_ips","line":1184,"name":"$self","kind":13},{"kind":13,"line":1184,"containerName":"add_global_allow_deny_ips","name":"$self"}],"detail":"()","signature":{"parameters":[],"label":"add_global_allow_deny_ips()","documentation":" Description:  Adds the IPs to block or accept from the configs global allowlist and global denylist to the global chain\n Returns:  1"},"kind":12,"range":{"end":{"character":9999,"line":1184},"start":{"line":1178,"character":0}},"containerName":"main::","line":1178,"definition":"sub","name":"add_global_allow_deny_ips"},{"kind":12,"line":1180,"name":"threads"},{"line":1183,"name":"configs","kind":12},{"kind":12,"name":"chainprefix","line":1183},{"line":1184,"name":"configs","kind":12},{"line":1184,"name":"allowlist","kind":12},{"name":"configs","line":1184,"kind":12},{"kind":12,"name":"allowlist","line":1184},{"kind":13,"localvar":"my","definition":"my","name":"@denylist","line":1185,"containerName":null},{"line":1185,"containerName":null,"name":"%self","kind":13},{"kind":12,"line":1185,"name":"configs"},{"name":"denylist","line":1185,"kind":12},{"kind":13,"containerName":null,"line":1185,"name":"%self"},{"line":1185,"name":"configs","kind":12},{"kind":12,"name":"denylist","line":1185},{"localvar":"my","containerName":null,"line":1186,"definition":"my","name":"$allowdeny","kind":13},{"kind":13,"name":"%self","containerName":null,"line":1186},{"kind":12,"name":"configs","line":1186},{"kind":12,"name":"allowdeny","line":1186},{"localvar":"my","line":1188,"containerName":null,"name":"%args","definition":"my","kind":13},{"kind":12,"name":"chain","line":1189},{"kind":13,"line":1189,"containerName":null,"name":"$chain"},{"kind":12,"name":"allowlist","line":1190},{"name":"@allowlist","line":1190,"containerName":null,"kind":13},{"name":"denylist","line":1191,"kind":12},{"containerName":null,"line":1191,"name":"@denylist","kind":13},{"kind":12,"line":1192,"name":"allowdeny"},{"kind":13,"name":"$allowdeny","containerName":null,"line":1193},{"kind":13,"name":"$logger","line":1195,"containerName":null},{"line":1195,"containerName":"main::","name":"debug","kind":12},{"kind":12,"name":"Dumper","line":1195},{"kind":13,"name":"$args","line":1195,"containerName":null},{"kind":13,"containerName":null,"line":1195,"name":"$logger"},{"kind":12,"line":1195,"containerName":"main::","name":"is_debug"},{"name":"$self","line":1197,"containerName":null,"kind":13},{"kind":12,"line":1197,"containerName":"main::","name":"add_allowdeny_ips"},{"kind":13,"line":1197,"containerName":null,"name":"$args"},{"containerName":"main::","range":{"start":{"line":1200,"character":0},"end":{"character":9999,"line":1206}},"line":1200,"name":"add_logger_allow_deny_ips","definition":"sub","kind":12,"signature":{"documentation":"","label":"add_logger_allow_deny_ips()","parameters":[]},"children":[{"localvar":"my","definition":"my","name":"$self","containerName":"add_logger_allow_deny_ips","line":1201,"kind":13},{"name":"$logobj","line":1201,"containerName":"add_logger_allow_deny_ips","kind":13},{"line":1202,"containerName":"add_logger_allow_deny_ips","name":"$TID","definition":"my","localvar":"my","kind":13},{"containerName":"add_logger_allow_deny_ips","line":1202,"name":"tid","kind":12},{"name":"$logger","line":1204,"containerName":"add_logger_allow_deny_ips","kind":13},{"containerName":"add_logger_allow_deny_ips","line":1204,"name":"debug","kind":12},{"definition":"my","name":"$chain","containerName":"add_logger_allow_deny_ips","line":1205,"localvar":"my","kind":13},{"line":1205,"containerName":"add_logger_allow_deny_ips","name":"$self","kind":13},{"name":"$logobj","containerName":"add_logger_allow_deny_ips","line":1205,"kind":13},{"kind":13,"definition":"my","name":"@allowlist","containerName":"add_logger_allow_deny_ips","line":1206,"localvar":"my"},{"name":"$logobj","line":1206,"containerName":"add_logger_allow_deny_ips","kind":13},{"kind":13,"name":"$logobj","containerName":"add_logger_allow_deny_ips","line":1206}],"detail":"()"},{"kind":12,"name":"threads","line":1202},{"kind":12,"name":"configs","line":1205},{"kind":12,"line":1205,"name":"chainprefix"},{"kind":12,"name":"chain","line":1205},{"kind":12,"name":"allowlist","line":1206},{"kind":12,"line":1206,"name":"allowlist"},{"kind":13,"localvar":"my","containerName":null,"line":1207,"definition":"my","name":"@denylist"},{"kind":13,"line":1207,"containerName":null,"name":"%logobj"},{"kind":12,"name":"denylist","line":1207},{"name":"%logobj","containerName":null,"line":1207,"kind":13},{"kind":12,"line":1207,"name":"denylist"},{"name":"$allowdeny","definition":"my","line":1208,"containerName":null,"localvar":"my","kind":13},{"line":1208,"containerName":null,"name":"%logobj","kind":13},{"name":"allowdeny","line":1208,"kind":12},{"kind":13,"line":1210,"containerName":null,"name":"%args","definition":"my","localvar":"my"},{"name":"chain","line":1211,"kind":12},{"kind":13,"name":"$chain","line":1211,"containerName":null},{"kind":12,"name":"allowlist","line":1212},{"kind":13,"line":1212,"containerName":null,"name":"@allowlist"},{"line":1213,"name":"denylist","kind":12},{"name":"@denylist","line":1213,"containerName":null,"kind":13},{"name":"allowdeny","line":1214,"kind":12},{"kind":13,"name":"$allowdeny","containerName":null,"line":1215},{"kind":13,"containerName":null,"line":1217,"name":"$logger"},{"name":"debug","containerName":"main::","line":1217,"kind":12},{"name":"Dumper","line":1217,"kind":12},{"kind":13,"line":1217,"containerName":null,"name":"$args"},{"kind":13,"name":"$logger","containerName":null,"line":1217},{"kind":12,"name":"is_debug","line":1217,"containerName":"main::"},{"name":"$self","line":1219,"containerName":null,"kind":13},{"kind":12,"line":1219,"containerName":"main::","name":"add_allowdeny_ips"},{"kind":13,"name":"$args","containerName":null,"line":1219},{"signature":{"documentation":" sub add_global_allow_deny_ips {\n     my ($self) = @_;\n     my $TID = \"TID: \" . threads->tid;\n     $logger->debug(\"$TID|Adding global allow/deny IPs to global chains\");\n     my %ip_rules = (\n         allow => $self->{configs}->{allowlist} || {},\n         deny  => $self->{configs}->{denylist}  || {}\n     );\n     $logger->debug(\"$TID|IP rules: \" . Dumper(\\%ip_rules)) if $logger->is_debug();\n     foreach my $action (keys %ip_rules) {\n         my $chain = \"ipblocker_global\" . $action;\n         my $rule_action = $action eq 'allow' ? 'ACCEPT' : 'DROP';\n         foreach my $ruleorder (sort keys %{$ip_rules{$action}}) {\n             my $ip = $ip_rules{$action}{$ruleorder};\n             foreach my $direction ('-s', '-d') {\n                 # my $chain = $chain_prefix . ($direction eq '-s' ? '' : 'regex') . $action;\n                 my $rule = \"$chain $direction $ip -j $rule_action\";\n                 my $args = { rule => $rule, options => \"-w -A\" };\n                 $logger->debug(\"$TID|Adding >>-w -A $rule<< to iptables queue\");\n                 $self->iptablesqueue_enqueue($args);\n             }\n         }\n     }\n     return 1;\n }\n Stops the module\n  Future enhancements:\n   Clear the thread queues","parameters":[],"label":"stop()"},"kind":12,"range":{"end":{"character":9999,"line":1278},"start":{"line":1257,"character":0}},"containerName":"main::","line":1257,"name":"stop","definition":"sub","children":[{"name":"$self","definition":"my","containerName":"stop","line":1258,"localvar":"my","kind":13},{"kind":13,"name":"$args","line":1258,"containerName":"stop"},{"kind":13,"localvar":"my","definition":"my","name":"$TID","line":1259,"containerName":"stop"},{"kind":12,"name":"tid","line":1259,"containerName":"stop"},{"containerName":"stop","line":1260,"name":"$TID","kind":13},{"name":"$TID","line":1260,"containerName":"stop","kind":13},{"name":"$logger","containerName":"stop","line":1261,"kind":13},{"kind":12,"name":"info","containerName":"stop","line":1261},{"kind":13,"name":"$chains_created","definition":"my","containerName":"stop","line":1263,"localvar":"my"},{"name":"$args","containerName":"stop","line":1263,"kind":13},{"kind":13,"line":1264,"containerName":"stop","name":"$logger"},{"kind":12,"containerName":"stop","line":1264,"name":"debug"},{"containerName":"stop","line":1264,"name":"$tracker","kind":13},{"name":"$logger","line":1264,"containerName":"stop","kind":13},{"name":"is_debug","containerName":"stop","line":1264,"kind":12},{"containerName":"stop","line":1267,"name":"$self","kind":13},{"name":"$chains_created","line":1267,"containerName":"stop","kind":13},{"line":1268,"containerName":"stop","name":"$logger","kind":13},{"kind":12,"name":"info","line":1268,"containerName":"stop"},{"localvar":"my","name":"$chain","definition":"my","containerName":"stop","line":1269,"kind":13},{"kind":13,"containerName":"stop","line":1269,"name":"$self"},{"kind":13,"line":1270,"containerName":"stop","name":"$logger"},{"name":"info","line":1270,"containerName":"stop","kind":12},{"name":"$IptablesQueue","containerName":"stop","line":1271,"kind":13},{"kind":12,"containerName":"stop","line":1271,"name":"enqueue"}],"detail":"()"},{"kind":12,"line":1259,"name":"threads"},{"name":"chains_created","line":1263,"kind":12},{"kind":12,"line":1264,"name":"Dumper"},{"line":1267,"name":"chains_created","kind":12},{"line":1269,"name":"chains_created","kind":12},{"kind":12,"name":"options","line":1273},{"kind":12,"line":1274,"name":"rule"},{"kind":13,"line":1280,"containerName":null,"name":"$logger"},{"line":1280,"containerName":"main::","name":"info","kind":12},{"kind":13,"name":"$logger","containerName":null,"line":1283},{"kind":12,"name":"info","line":1283,"containerName":"main::"},{"line":1284,"name":"clear_queues","kind":12},{"kind":13,"name":"$logger","line":1284,"containerName":null},{"kind":12,"containerName":"main::","line":1284,"name":"error"},{"kind":13,"name":"$logger","containerName":null,"line":1285},{"kind":12,"line":1285,"containerName":"main::","name":"info"},{"line":1286,"name":"join_threads","kind":12},{"kind":13,"line":1286,"containerName":null,"name":"$logger"},{"line":1286,"containerName":"main::","name":"error","kind":12},{"kind":13,"name":"$logger","line":1288,"containerName":null},{"kind":12,"containerName":"main::","line":1288,"name":"info"},{"kind":13,"name":"$lock_obj","line":1289,"containerName":null},{"name":"release","line":1289,"containerName":"main::","kind":12},{"line":1290,"containerName":null,"name":"$logger","kind":13},{"kind":12,"line":1290,"containerName":"main::","name":"info"},{"detail":"()","children":[{"kind":13,"name":"$TID","definition":"my","containerName":"join_threads","line":1300,"localvar":"my"},{"kind":12,"line":1300,"containerName":"join_threads","name":"tid"},{"name":"$TID","line":1301,"containerName":"join_threads","kind":13},{"kind":13,"name":"$TID","line":1301,"containerName":"join_threads"},{"name":"$logger","line":1302,"containerName":"join_threads","kind":13},{"containerName":"join_threads","line":1302,"name":"debug","kind":12},{"kind":12,"name":"join","line":1303,"containerName":"join_threads"},{"kind":12,"line":1303,"containerName":"join_threads","name":"list"}],"kind":12,"signature":{"label":"join_threads()","parameters":[],"documentation":" Joins all threads\n   Simple sub but really needs some rework\n   If a thread is taking a while to join then it will block the other threads from joining\n   Some of the threads could be reading a log file and if the log file is large then it could take a while or\n   if the log file is causing soem kind of blocking for reading then it could take a while.\n   This may be an issue, if an example, if trying to read a file across NFS or SSHFS and there is a network issue."},"name":"join_threads","definition":"sub","range":{"start":{"line":1299,"character":0},"end":{"line":1305,"character":9999}},"containerName":"main::","line":1299},{"name":"threads","line":1300,"kind":12},{"line":1303,"name":"threads","kind":12},{"detail":"()","children":[{"containerName":"clear_queues","line":1309,"definition":"my","name":"$TID","localvar":"my","kind":13},{"name":"tid","line":1309,"containerName":"clear_queues","kind":12},{"kind":13,"name":"$TID","line":1310,"containerName":"clear_queues"},{"kind":13,"line":1310,"containerName":"clear_queues","name":"$TID"},{"name":"$logger","line":1311,"containerName":"clear_queues","kind":13},{"kind":12,"line":1311,"containerName":"clear_queues","name":"debug"},{"kind":13,"containerName":"clear_queues","line":1312,"name":"$DataQueue"},{"name":"end","line":1312,"containerName":"clear_queues","kind":12},{"name":"$IptablesQueue","containerName":"clear_queues","line":1313,"kind":13},{"kind":12,"line":1313,"containerName":"clear_queues","name":"end"},{"line":1314,"containerName":"clear_queues","name":"$DataQueue","kind":13},{"kind":12,"line":1314,"containerName":"clear_queues","name":"pending"},{"name":"$IptablesQueue","containerName":"clear_queues","line":1314,"kind":13},{"kind":12,"line":1314,"containerName":"clear_queues","name":"pending"},{"containerName":"clear_queues","line":1315,"name":"$DataQueue","kind":13},{"name":"pending","containerName":"clear_queues","line":1315,"kind":12},{"kind":13,"line":1315,"containerName":"clear_queues","name":"$logger"},{"name":"debug","line":1315,"containerName":"clear_queues","kind":12},{"line":1316,"containerName":"clear_queues","name":"$IptablesQueue","kind":13},{"kind":12,"name":"pending","line":1316,"containerName":"clear_queues"},{"name":"$logger","line":1316,"containerName":"clear_queues","kind":13},{"line":1316,"containerName":"clear_queues","name":"debug","kind":12},{"kind":13,"name":"$DataQueue","containerName":"clear_queues","line":1320},{"line":1320,"containerName":"clear_queues","name":"pending","kind":12},{"name":"$IptablesQueue","containerName":"clear_queues","line":1320,"kind":13},{"kind":12,"name":"pending","containerName":"clear_queues","line":1320},{"kind":13,"name":"$logger","line":1321,"containerName":"clear_queues"},{"name":"error","line":1321,"containerName":"clear_queues","kind":12},{"kind":13,"containerName":"clear_queues","line":1325,"name":"$logger"},{"containerName":"clear_queues","line":1325,"name":"debug","kind":12}],"name":"clear_queues","definition":"sub","line":1308,"range":{"start":{"character":0,"line":1308},"end":{"character":9999,"line":1328}},"containerName":"main::","signature":{"documentation":" Clears the queues","label":"clear_queues()","parameters":[]},"kind":12},{"kind":12,"name":"threads","line":1309},{"containerName":"main::","range":{"end":{"line":1357,"character":9999},"start":{"character":0,"line":1330}},"line":1330,"name":"reload","definition":"sub","signature":{"documentation":"","label":"reload()","parameters":[]},"kind":12,"children":[{"localvar":"my","line":1331,"containerName":"reload","name":"$TID","definition":"my","kind":13},{"kind":12,"containerName":"reload","line":1331,"name":"tid"},{"kind":13,"line":1332,"containerName":"reload","name":"$TID"},{"containerName":"reload","line":1332,"name":"$TID","kind":13},{"line":1333,"containerName":"reload","name":"$logger","kind":13},{"kind":12,"name":"info","line":1333,"containerName":"reload"}],"detail":"()"},{"kind":12,"name":"threads","line":1331},{"kind":12,"line":1361,"range":{"end":{"character":9999,"line":1365},"start":{"line":1361,"character":0}},"containerName":"main::","definition":"sub","name":"SIG_INT","children":[{"kind":13,"name":"$logger","line":1362,"containerName":"SIG_INT"},{"name":"info","line":1362,"containerName":"SIG_INT","kind":12}]},{"children":[{"name":"$logger","line":1370,"containerName":"SIG_HUP","kind":13},{"name":"info","line":1370,"containerName":"SIG_HUP","kind":12}],"kind":12,"range":{"start":{"character":0,"line":1369},"end":{"character":9999,"line":1372}},"line":1369,"containerName":"main::","definition":"sub","name":"SIG_HUP"},{"children":[{"line":1377,"containerName":"SIG_TERM","name":"$logger","kind":13},{"kind":12,"line":1377,"containerName":"SIG_TERM","name":"info"}],"line":1376,"range":{"end":{"line":1379,"character":9999},"start":{"character":0,"line":1376}},"containerName":"main::","name":"SIG_TERM","definition":"sub","kind":12},{"range":{"start":{"character":0,"line":1383},"end":{"character":9999,"line":1386}},"containerName":"main::","line":1383,"definition":"sub","name":"SIG_QUIT","kind":12,"children":[{"kind":13,"containerName":"SIG_QUIT","line":1384,"name":"$self","definition":"my","localvar":"my"}]},{"children":[{"kind":13,"name":"$logger","containerName":"set_signal_handler","line":1389},{"kind":12,"name":"info","line":1389,"containerName":"set_signal_handler"},{"kind":13,"name":"$SIG","containerName":"set_signal_handler","line":1391},{"kind":13,"name":"$SIG","line":1392,"containerName":"set_signal_handler"},{"kind":13,"name":"$SIG","line":1393,"containerName":"set_signal_handler"},{"line":1394,"containerName":"set_signal_handler","name":"$SIG","kind":13}],"detail":"()","range":{"end":{"character":9999,"line":1395},"start":{"character":0,"line":1388}},"line":1388,"containerName":"main::","definition":"sub","name":"set_signal_handler","signature":{"label":"set_signal_handler()","parameters":[],"documentation":""},"kind":12},{"line":1391,"name":"INT","kind":12},{"kind":12,"name":"TERM","line":1392},{"line":1393,"name":"HUP","kind":12},{"kind":12,"name":"QUIT","line":1394}]}