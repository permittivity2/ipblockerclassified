{"vars":[{"line":53,"kind":2,"name":"POSIX","containerName":""},{"containerName":"","kind":2,"name":"strict","line":54},{"line":55,"containerName":"","kind":2,"name":"DateTime"},{"line":56,"name":"Basename","kind":2,"containerName":"File"},{"kind":2,"name":"strict","containerName":"","line":60},{"name":"HiRes","kind":2,"containerName":"Time","line":61},{"line":67,"containerName":"Config","kind":2,"name":"File"},{"line":68,"containerName":"","kind":2,"name":"Carp"},{"containerName":"Log","kind":2,"name":"Log4perl","line":69},{"line":70,"containerName":"Data","kind":2,"name":"Dumper"},{"kind":2,"name":"IPv6","containerName":"Regexp","line":71},{"containerName":"LockFile","name":"Simple","kind":2,"line":72},{"containerName":"File","kind":2,"name":"Path","line":73},{"line":74,"containerName":"Net::Ifconfig","kind":2,"name":"Wrapper"},{"containerName":"","kind":2,"name":"threads","line":77},{"kind":2,"name":"Queue","containerName":"Thread","line":80},{"line":81,"definition":"my","name":"$DataQueue","kind":13,"containerName":null,"localvar":"my"},{"line":81,"name":"Thread","kind":12,"containerName":"Queue"},{"line":81,"name":"new","kind":12,"containerName":"main::"},{"localvar":"my","containerName":null,"line":82,"definition":"my","kind":13,"name":"$LoggerTIDS"},{"name":"$IptablesQueue","kind":13,"line":85,"definition":"my","localvar":"my","containerName":null},{"kind":12,"name":"Thread","containerName":"Queue","line":85},{"line":85,"containerName":"main::","kind":12,"name":"new"},{"kind":13,"name":"$IptablesTIDS","definition":"my","line":86,"containerName":null,"localvar":"my"},{"line":89,"kind":13,"name":"$Data","containerName":null},{"name":"Dumper","kind":12,"containerName":"Sortkeys","line":89},{"containerName":null,"kind":13,"name":"$Data","line":90},{"containerName":"Indent","kind":12,"name":"Dumper","line":90},{"containerName":null,"localvar":"my","name":"$logger","kind":13,"definition":"my","line":97},{"localvar":"my","containerName":null,"line":100,"definition":"my","name":"$lock_obj","kind":13},{"definition":"my","line":105,"kind":13,"name":"$REGEX_IPV4","containerName":null,"localvar":"my"},{"localvar":"my","containerName":null,"name":"$REGEX_IPV6","kind":13,"definition":"my","line":107},{"containerName":null,"localvar":"my","name":"%DEFAULTS","kind":13,"definition":"my","line":108},{"line":109,"kind":12,"name":"allowdeny"},{"line":110,"kind":12,"name":"allowlist"},{"kind":12,"name":"configsfile","line":111},{"line":112,"name":"cycles","kind":12},{"line":112,"kind":12,"name":"LONG_MAX"},{"line":113,"kind":12,"name":"cyclesleep"},{"line":114,"kind":12,"name":"dumpconfigsandexit"},{"name":"denylist","kind":12,"line":115},{"name":"forceremovelockfile","kind":12,"line":116},{"name":"globalallowlist","kind":12,"line":117},{"line":118,"name":"globalchain","kind":12},{"name":"globalchains","kind":12,"line":122},{"kind":12,"name":"globaldenylist","line":123},{"name":"globalregexallowlist","kind":12,"line":124},{"line":125,"kind":12,"name":"globalregexdenylist"},{"line":126,"name":"ignoreinterfaceips","kind":12},{"line":127,"name":"iptables","kind":12},{"name":"lockfile","kind":12,"line":128},{"line":129,"name":"log4perlconf","kind":12},{"line":130,"kind":12,"name":"loglevel"},{"line":134,"name":"logcontents","kind":12},{"line":135,"kind":12,"name":"logs_to_review"},{"line":136,"kind":12,"name":"logwatch_interval"},{"kind":12,"name":"prodmode","line":137},{"name":"queuechecktime","kind":12,"line":138},{"line":139,"kind":12,"name":"queuecycles"},{"line":139,"kind":12,"name":"LONG_MAX"},{"name":"readentirefile","kind":12,"line":140},{"line":149,"definition":"sub","detail":"()","kind":12,"name":"new","children":[{"name":"$class","kind":13,"line":150,"definition":"my","localvar":"my","containerName":"new"},{"definition":"my","line":151,"name":"$args","kind":13,"containerName":"new","localvar":"my"},{"name":"$args","kind":13,"containerName":"new","line":153},{"line":155,"containerName":"new","kind":13,"name":"$args"},{"line":157,"name":"$args","kind":13,"containerName":"new"},{"line":162,"definition":"my","name":"$configsfile","kind":13,"localvar":"my","containerName":"new"},{"line":162,"containerName":"new","kind":13,"name":"$args"},{"line":162,"kind":13,"name":"$DEFAULTS","containerName":"new"},{"containerName":"new","localvar":"my","line":164,"definition":"my","kind":13,"name":"$self"},{"line":165,"kind":13,"name":"$configsfile","containerName":"new"},{"containerName":"new","name":"$args","kind":13,"line":166},{"line":170,"containerName":"new","name":"$self","kind":13},{"containerName":"new","kind":13,"name":"$class","line":170},{"line":174,"containerName":"new","name":"$self","kind":13},{"kind":12,"name":"load_configs","containerName":"new","line":174},{"name":"$self","kind":13,"containerName":"new","line":176},{"kind":13,"name":"$self","containerName":"new","line":178},{"containerName":"new","name":"$self","kind":13,"line":179},{"line":180,"kind":13,"name":"$self","containerName":"new"},{"containerName":"new","kind":13,"name":"$self","line":182},{"line":187,"containerName":"new","kind":13,"name":"$logger"},{"containerName":"new","kind":13,"name":"$self","line":187},{"line":187,"name":"setup_Logger","kind":12,"containerName":"new"},{"line":188,"kind":13,"name":"$logger","containerName":"new"},{"kind":12,"name":"info","containerName":"new","line":188},{"line":189,"containerName":"new","kind":13,"name":"$logger"},{"name":"debug","kind":12,"containerName":"new","line":189},{"line":189,"name":"$self","kind":13,"containerName":"new"},{"line":189,"containerName":"new","name":"$logger","kind":13},{"kind":12,"name":"is_debug","containerName":"new","line":189},{"containerName":"new","kind":13,"name":"$self","line":191}],"range":{"start":{"line":149,"character":0},"end":{"character":9999,"line":192}},"signature":{"parameters":[],"label":"new()","documentation":"#### Subs below here #####\n Reads configs, logging configs, sets up logging, sets up a class and returns a blessed object\n   The sub go() is where the action starts"},"containerName":"main::"},{"line":154,"kind":12,"name":"carp"},{"line":158,"name":"croak","kind":12},{"kind":12,"name":"configsfile","line":162},{"kind":12,"name":"configsfile","line":162},{"line":165,"kind":12,"name":"configsfile"},{"kind":12,"name":"clargs","line":166},{"line":176,"name":"configs","kind":12},{"line":176,"name":"dumpconfigsandexit","kind":12},{"name":"configs","kind":12,"line":178},{"kind":12,"name":"configsfile","line":178},{"kind":12,"name":"configs","line":179},{"name":"globalchain","kind":12,"line":179},{"name":"configs","kind":12,"line":180},{"line":180,"kind":12,"name":"dumpconfigsandexit"},{"line":182,"kind":12,"name":"recursiveHashPrint"},{"line":182,"name":"configs","kind":12},{"line":189,"name":"Dumper","kind":12},{"kind":12,"name":"recursiveHashPrint","detail":"($ref,$prefix)","line":195,"definition":"sub","signature":{"parameters":[{"label":"$ref"},{"label":"$prefix"}],"documentation":"# Recursive sub to print out a hash to STDOUT in a manner that matches \"use Config::File;\"","label":"recursiveHashPrint($ref,$prefix)"},"containerName":"main::","children":[{"name":"$ref","kind":13,"definition":"my","line":196,"containerName":"recursiveHashPrint","localvar":"my"},{"kind":13,"name":"$prefix","containerName":"recursiveHashPrint","line":196},{"line":197,"containerName":"recursiveHashPrint","name":"$prefix","kind":13},{"line":197,"containerName":"recursiveHashPrint","kind":13,"name":"$prefix"},{"containerName":"recursiveHashPrint","name":"$ref","kind":13,"line":199},{"localvar":"my","containerName":"recursiveHashPrint","name":"$key","kind":13,"definition":"my","line":200},{"containerName":"recursiveHashPrint","kind":13,"name":"$ref","line":200},{"kind":13,"name":"$new_prefix","line":203,"definition":"my","containerName":"recursiveHashPrint","localvar":"my"},{"kind":13,"name":"$prefix","containerName":"recursiveHashPrint","line":203},{"name":"$ref","kind":13,"containerName":"recursiveHashPrint","line":204},{"kind":13,"name":"$key","containerName":"recursiveHashPrint","line":204},{"name":"$new_prefix","kind":13,"containerName":"recursiveHashPrint","line":204}],"range":{"end":{"line":206,"character":9999},"start":{"character":0,"line":195}}},{"line":207,"name":"%ref","kind":13,"containerName":null},{"localvar":"my","containerName":null,"definition":"my","line":210,"name":"$line","kind":13},{"kind":13,"name":"$ref","containerName":null,"line":210},{"line":211,"containerName":null,"kind":13,"name":"$line"},{"containerName":null,"kind":13,"name":"$line","line":212},{"kind":13,"name":"%line","containerName":null,"line":213},{"definition":"my","line":217,"name":"$line","kind":13,"localvar":"my","containerName":null},{"containerName":null,"kind":13,"name":"$line","line":218},{"line":219,"name":"$line","kind":13,"containerName":null},{"line":220,"containerName":null,"name":"$line","kind":13},{"children":[{"containerName":"iptables_thread","localvar":"my","name":"$self","kind":13,"line":225,"definition":"my"},{"localvar":"my","containerName":"iptables_thread","name":"$TID","kind":13,"line":226,"definition":"my"},{"line":226,"kind":12,"name":"tid","containerName":"iptables_thread"},{"line":227,"containerName":"iptables_thread","kind":13,"name":"$TID"},{"name":"$TID","kind":13,"containerName":"iptables_thread","line":227},{"containerName":"iptables_thread","kind":13,"name":"$logger","line":229},{"containerName":"iptables_thread","name":"info","kind":12,"line":229},{"localvar":"my","containerName":"iptables_thread","definition":"my","line":232,"kind":13,"name":"$iptablesQueue_pending"},{"line":232,"kind":13,"name":"$IptablesQueue","containerName":"iptables_thread"},{"line":232,"kind":12,"name":"pending","containerName":"iptables_thread"},{"line":233,"containerName":"iptables_thread","name":"$iptablesQueue_pending","kind":13},{"name":"$logmsg","kind":13,"definition":"my","line":234,"containerName":"iptables_thread","localvar":"my"},{"kind":13,"name":"$logmsg","containerName":"iptables_thread","line":235},{"containerName":"iptables_thread","kind":13,"name":"$logger","line":236},{"containerName":"iptables_thread","name":"info","kind":12,"line":236},{"name":"$logmsg","kind":13,"containerName":"iptables_thread","line":236},{"containerName":"iptables_thread","kind":13,"name":"$iptablesQueue_pending","line":240},{"name":"$logger","kind":13,"containerName":"iptables_thread","line":241},{"line":241,"kind":12,"name":"info","containerName":"iptables_thread"},{"containerName":"iptables_thread","localvar":"my","line":242,"definition":"my","kind":13,"name":"$data"},{"containerName":"iptables_thread","name":"$IptablesQueue","kind":13,"line":242},{"name":"dequeue","kind":12,"containerName":"iptables_thread","line":242},{"name":"$logger","kind":13,"containerName":"iptables_thread","line":243},{"line":243,"name":"debug","kind":12,"containerName":"iptables_thread"},{"kind":13,"name":"$data","containerName":"iptables_thread","line":243},{"containerName":"iptables_thread","kind":13,"name":"$logger","line":243},{"line":243,"kind":12,"name":"is_debug","containerName":"iptables_thread"},{"line":244,"containerName":"iptables_thread","kind":13,"name":"$self"},{"kind":12,"name":"run_iptables","containerName":"iptables_thread","line":244},{"line":244,"containerName":"iptables_thread","name":"$data","kind":13},{"containerName":"iptables_thread","kind":13,"name":"$logger","line":244},{"containerName":"iptables_thread","kind":12,"name":"error","line":244},{"containerName":"iptables_thread","kind":13,"name":"$data","line":244},{"line":246,"name":"$iptablesQueue_pending","kind":13,"containerName":"iptables_thread"},{"name":"$logger","kind":13,"containerName":"iptables_thread","line":247},{"containerName":"iptables_thread","kind":12,"name":"info","line":247},{"containerName":"iptables_thread","kind":13,"name":"$logger","line":251},{"line":251,"kind":12,"name":"error","containerName":"iptables_thread"}],"range":{"end":{"line":255,"character":9999},"start":{"line":224,"character":0}},"signature":{"parameters":[],"documentation":"","label":"iptables_thread()"},"containerName":"main::","definition":"sub","line":224,"detail":"()","kind":12,"name":"iptables_thread"},{"kind":12,"name":"threads","line":226},{"kind":12,"name":"Dumper","line":243},{"line":244,"kind":12,"name":"Dumper"},{"definition":"sub","line":262,"name":"go","kind":12,"detail":"()","range":{"start":{"character":0,"line":262},"end":{"line":301,"character":9999}},"children":[{"containerName":"go","localvar":"my","kind":13,"name":"$self","definition":"my","line":263},{"line":266,"kind":13,"name":"$self","containerName":"go"},{"name":"$logger","kind":13,"containerName":"go","line":267},{"line":267,"name":"error","kind":12,"containerName":"go"},{"containerName":"go","name":"$self","kind":13,"line":272},{"line":273,"containerName":"go","name":"$self","kind":13},{"name":"set_iptables_command","kind":12,"containerName":"go","line":273},{"line":273,"containerName":"go","kind":13,"name":"$logger"},{"containerName":"go","kind":12,"name":"error","line":273},{"containerName":"go","name":"$self","kind":13,"line":274},{"name":"set_signal_handler","kind":12,"containerName":"go","line":274},{"kind":13,"name":"$self","containerName":"go","line":275},{"name":"set_lockFile","kind":12,"containerName":"go","line":275},{"line":275,"kind":13,"name":"$logger","containerName":"go"},{"containerName":"go","kind":12,"name":"logdie","line":275},{"definition":"my","line":279,"kind":13,"name":"$iptables_thr","containerName":"go","localvar":"my"},{"line":279,"containerName":"go","name":"create","kind":12},{"containerName":"go","name":"$self","kind":13,"line":279},{"line":282,"containerName":"go","kind":13,"name":"$self"},{"kind":12,"name":"add_global_chains_to_input_output","containerName":"go","line":282},{"line":283,"kind":13,"name":"$logger","containerName":"go"},{"name":"logdie","kind":12,"containerName":"go","line":283},{"name":"$self","kind":13,"containerName":"go","line":286},{"line":286,"kind":12,"name":"add_global_allow_deny_ips","containerName":"go"},{"line":292,"containerName":"go","kind":13,"name":"$logger"},{"line":292,"containerName":"go","name":"logdie","kind":12},{"line":292,"kind":13,"name":"$self","containerName":"go"},{"line":292,"containerName":"go","name":"logger_thread","kind":12},{"name":"$self","kind":13,"containerName":"go","line":300},{"containerName":"go","kind":12,"name":"dataQueue_runner","line":300}],"signature":{"parameters":[],"documentation":" Creates two initial threads:\n   One for iptables commands to run.\n   Another to watch the log files\n       This in turn creates a thread for each log file to watch\n Also starts running the DataQueue queue which handles the data","label":"go()"},"containerName":"main::"},{"line":266,"kind":12,"name":"configs"},{"line":266,"kind":12,"name":"logs_to_review"},{"line":272,"name":"run_iptables_line","kind":12},{"line":279,"name":"threads","kind":12},{"range":{"end":{"line":333,"character":9999},"start":{"character":0,"line":305}},"children":[{"localvar":"my","containerName":"add_ifconfig_ips_to_allowlist","kind":13,"name":"$self","definition":"my","line":306}],"signature":{"documentation":" Description:  Adds IPs on the local interfaces to the global allowlist\n  This does not work becasue it onkly handles IPv4 addresses","label":"add_ifconfig_ips_to_allowlist()","parameters":[]},"containerName":"main::","definition":"sub","line":305,"detail":"()","name":"add_ifconfig_ips_to_allowlist","kind":12},{"kind":12,"name":"dataQueue_runner","detail":"()","line":335,"definition":"sub","containerName":"main::","signature":{"parameters":[],"documentation":"","label":"dataQueue_runner()"},"children":[{"definition":"my","line":336,"name":"$self","kind":13,"localvar":"my","containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","localvar":"my","name":"$TID","kind":13,"line":337,"definition":"my"},{"containerName":"dataQueue_runner","name":"tid","kind":12,"line":337},{"line":338,"kind":13,"name":"$TID","containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","name":"$TID","kind":13,"line":338},{"name":"$Data","kind":13,"containerName":"dataQueue_runner","line":340},{"line":341,"containerName":"dataQueue_runner","kind":13,"name":"$Data"},{"line":343,"containerName":"dataQueue_runner","kind":13,"name":"$logger"},{"name":"info","kind":12,"containerName":"dataQueue_runner","line":343},{"localvar":"my","containerName":"dataQueue_runner","kind":13,"name":"$queuechecktime","line":344,"definition":"my"},{"containerName":"dataQueue_runner","name":"$self","kind":13,"line":344},{"name":"$queuecycles","kind":13,"line":345,"definition":"my","containerName":"dataQueue_runner","localvar":"my"},{"line":345,"kind":13,"name":"$self","containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","localvar":"my","definition":"my","line":348,"kind":13,"name":"$dataqueue_pending"},{"line":348,"kind":13,"name":"$DataQueue","containerName":"dataQueue_runner"},{"line":348,"kind":12,"name":"pending","containerName":"dataQueue_runner"},{"kind":13,"name":"$dataqueue_pending","containerName":"dataQueue_runner","line":349},{"containerName":"dataQueue_runner","name":"$logger","kind":13,"line":350},{"name":"info","kind":12,"containerName":"dataQueue_runner","line":350},{"line":354,"containerName":"dataQueue_runner","name":"$dataqueue_pending","kind":13},{"line":355,"containerName":"dataQueue_runner","name":"$logger","kind":13},{"name":"info","kind":12,"containerName":"dataQueue_runner","line":355},{"line":356,"definition":"my","kind":13,"name":"$data","containerName":"dataQueue_runner","localvar":"my"},{"line":356,"kind":13,"name":"$DataQueue","containerName":"dataQueue_runner"},{"line":356,"containerName":"dataQueue_runner","name":"dequeue","kind":12},{"line":358,"containerName":"dataQueue_runner","kind":13,"name":"$logger"},{"line":358,"containerName":"dataQueue_runner","kind":12,"name":"debug"},{"line":358,"containerName":"dataQueue_runner","name":"$data","kind":13},{"line":358,"name":"$logger","kind":13,"containerName":"dataQueue_runner"},{"line":358,"containerName":"dataQueue_runner","kind":12,"name":"is_debug"},{"containerName":"dataQueue_runner","kind":13,"name":"$dataqueue_pending","line":360},{"localvar":"my","containerName":"dataQueue_runner","name":"$logmsg","kind":13,"line":361,"definition":"my"},{"line":362,"kind":13,"name":"$logmsg","containerName":"dataQueue_runner"},{"name":"$logger","kind":13,"containerName":"dataQueue_runner","line":363},{"line":363,"kind":12,"name":"info","containerName":"dataQueue_runner"},{"line":363,"name":"$logmsg","kind":13,"containerName":"dataQueue_runner"},{"containerName":"dataQueue_runner","kind":13,"name":"$queuecycles","line":364},{"containerName":"dataQueue_runner","kind":13,"name":"$queuecycles","line":365},{"line":366,"containerName":"dataQueue_runner","kind":13,"name":"$queuechecktime"},{"containerName":"dataQueue_runner","kind":13,"name":"$logger","line":369},{"kind":12,"name":"error","containerName":"dataQueue_runner","line":369},{"line":374,"kind":13,"name":"$logger","containerName":"dataQueue_runner"},{"kind":12,"name":"info","containerName":"dataQueue_runner","line":374}],"range":{"start":{"character":0,"line":335},"end":{"character":9999,"line":375}}},{"line":337,"name":"threads","kind":12},{"line":340,"kind":12,"name":"Dumper","containerName":"Terse"},{"containerName":"Indent","kind":12,"name":"Dumper","line":341},{"line":344,"kind":12,"name":"configs"},{"kind":12,"name":"queuechecktime","line":344},{"line":345,"name":"configs","kind":12},{"name":"queuecycles","kind":12,"line":345},{"name":"Dumper","kind":12,"line":358},{"detail":"()","kind":12,"name":"setup_Logger","definition":"sub","line":381,"signature":{"label":"setup_Logger()","documentation":" Assumptions:\n   $self->{configs}->{log4perlconf} is set\n   $self->{configs}->{logwatch_interval} is set\n These assumptions *should* be true because this is called from new()","parameters":[]},"containerName":"main::","children":[{"localvar":"my","containerName":"setup_Logger","kind":13,"name":"$self","line":382,"definition":"my"},{"containerName":"setup_Logger","localvar":"my","kind":13,"name":"$log4perlconf","definition":"my","line":385},{"line":385,"containerName":"setup_Logger","name":"$self","kind":13},{"localvar":"my","containerName":"setup_Logger","name":"$logwatch_interval","kind":13,"line":386,"definition":"my"},{"line":386,"containerName":"setup_Logger","kind":13,"name":"$self"},{"line":387,"containerName":"setup_Logger","name":"init_and_watch","kind":12},{"line":387,"containerName":"setup_Logger","kind":13,"name":"$log4perlconf"},{"line":387,"kind":13,"name":"$logwatch_interval","containerName":"setup_Logger"},{"name":"easy_init","kind":12,"containerName":"setup_Logger","line":391},{"line":391,"containerName":"setup_Logger","name":"$Log","kind":13},{"name":"$logger","kind":13,"containerName":"setup_Logger","line":393},{"line":394,"containerName":"setup_Logger","kind":13,"name":"$self"},{"line":395,"containerName":"setup_Logger","kind":13,"name":"$logger"},{"line":395,"containerName":"setup_Logger","kind":12,"name":"level"},{"line":395,"containerName":"setup_Logger","name":"$self","kind":13},{"line":396,"containerName":"setup_Logger","kind":13,"name":"$logger"},{"kind":12,"name":"info","containerName":"setup_Logger","line":396},{"containerName":"setup_Logger","name":"$logger","kind":13,"line":396},{"line":396,"name":"level","kind":12,"containerName":"setup_Logger"},{"line":403,"containerName":"setup_Logger","kind":13,"name":"$logger"},{"kind":12,"name":"info","containerName":"setup_Logger","line":403},{"name":"$logger","kind":13,"containerName":"setup_Logger","line":405}],"range":{"end":{"character":9999,"line":406},"start":{"line":381,"character":0}}},{"name":"configs","kind":12,"line":385},{"line":385,"name":"log4perlconf","kind":12},{"line":386,"kind":12,"name":"configs"},{"name":"logwatch_interval","kind":12,"line":386},{"containerName":"Log4perl","kind":12,"name":"Log","line":387},{"line":389,"name":"carp","kind":12},{"name":"carp","kind":12,"line":390},{"line":391,"containerName":"Log4perl","name":"Log","kind":12},{"line":391,"containerName":"DEBUG","name":"Log4perl","kind":12},{"kind":12,"name":"get_logger","line":393},{"kind":12,"name":"croak","line":393},{"name":"configs","kind":12,"line":394},{"line":394,"name":"loglevel","kind":12},{"kind":12,"name":"configs","line":395},{"line":395,"name":"loglevel","kind":12},{"detail":"()","kind":12,"name":"set_lockFile","definition":"sub","line":410,"containerName":"main::","signature":{"parameters":[],"documentation":" Set lock file\n   Returns 1 if lock file is set, otherwise returns 0","label":"set_lockFile()"},"range":{"start":{"line":410,"character":0},"end":{"line":452,"character":9999}},"children":[{"line":411,"definition":"my","kind":13,"name":"$self","containerName":"set_lockFile","localvar":"my"},{"line":413,"containerName":"set_lockFile","name":"$self","kind":13},{"kind":13,"name":"$logger","containerName":"set_lockFile","line":414},{"containerName":"set_lockFile","kind":12,"name":"logdie","line":414},{"localvar":"my","containerName":"set_lockFile","name":"$lockfile","kind":13,"line":417,"definition":"my"},{"line":417,"containerName":"set_lockFile","kind":13,"name":"$self"},{"localvar":"my","containerName":"set_lockFile","definition":"my","line":420,"kind":13,"name":"$lf"},{"kind":13,"name":"$self","containerName":"set_lockFile","line":420},{"line":421,"containerName":"set_lockFile","kind":13,"name":"$logger"},{"name":"debug","kind":12,"containerName":"set_lockFile","line":421},{"containerName":"set_lockFile","name":"$lf","kind":13,"line":423},{"line":424,"kind":13,"name":"$self","containerName":"set_lockFile"},{"name":"$logger","kind":13,"containerName":"set_lockFile","line":425},{"kind":12,"name":"info","containerName":"set_lockFile","line":425},{"line":426,"kind":13,"name":"$lf","containerName":"set_lockFile"},{"name":"$logger","kind":13,"containerName":"set_lockFile","line":426},{"line":426,"containerName":"set_lockFile","kind":12,"name":"logdie"},{"definition":"my","line":429,"name":"$fh","kind":13,"localvar":"my","containerName":"set_lockFile"},{"name":"$lf","kind":13,"containerName":"set_lockFile","line":429},{"line":429,"name":"$logger","kind":13,"containerName":"set_lockFile"},{"line":429,"name":"logdie","kind":12,"containerName":"set_lockFile"},{"containerName":"set_lockFile","localvar":"my","line":430,"definition":"my","kind":13,"name":"@contents"},{"containerName":"set_lockFile","name":"$fh","kind":13,"line":430},{"line":431,"kind":13,"name":"$fh","containerName":"set_lockFile"},{"line":432,"containerName":"set_lockFile","name":"@contents","kind":13},{"containerName":"set_lockFile","localvar":"my","kind":13,"name":"$printable_contents","definition":"my","line":433},{"line":433,"containerName":"set_lockFile","kind":13,"name":"@contents"},{"kind":13,"name":"$logmsg","definition":"my","line":434,"containerName":"set_lockFile","localvar":"my"},{"containerName":"set_lockFile","name":"$logger","kind":13,"line":435},{"line":435,"name":"info","kind":12,"containerName":"set_lockFile"},{"line":435,"kind":13,"name":"$logmsg","containerName":"set_lockFile"},{"line":439,"containerName":"set_lockFile","name":"$lf","kind":13},{"name":"$logger","kind":13,"containerName":"set_lockFile","line":439},{"line":439,"kind":12,"name":"logdie","containerName":"set_lockFile"},{"line":442,"containerName":"set_lockFile","name":"$self","kind":13},{"containerName":"set_lockFile","kind":12,"name":"make","line":442},{"line":445,"containerName":"set_lockFile","name":"$logger","kind":13},{"name":"debug","kind":12,"containerName":"set_lockFile","line":445},{"line":445,"name":"$self","kind":13,"containerName":"set_lockFile"},{"containerName":"set_lockFile","name":"$logger","kind":13,"line":445},{"kind":12,"name":"is_debug","containerName":"set_lockFile","line":445},{"line":446,"containerName":"set_lockFile","kind":13,"name":"$self"},{"containerName":"set_lockFile","name":"$self","kind":13,"line":446},{"containerName":"set_lockFile","name":"lock","kind":12,"line":446},{"line":446,"kind":13,"name":"$lf","containerName":"set_lockFile"},{"containerName":"set_lockFile","name":"$logger","kind":13,"line":447},{"line":447,"containerName":"set_lockFile","name":"logdie","kind":12},{"containerName":"set_lockFile","name":"$lock_obj","kind":13,"line":448},{"line":448,"containerName":"set_lockFile","name":"$self","kind":13},{"line":450,"name":"$logger","kind":13,"containerName":"set_lockFile"},{"kind":12,"name":"info","containerName":"set_lockFile","line":450}]},{"line":413,"name":"configs","kind":12},{"line":413,"kind":12,"name":"lockfile"},{"line":417,"kind":12,"name":"configs"},{"line":417,"kind":12,"name":"lockfile"},{"name":"configs","kind":12,"line":420},{"name":"lockfile","kind":12,"line":420},{"line":424,"kind":12,"name":"configs"},{"line":424,"kind":12,"name":"forceremovelockfile"},{"line":442,"name":"lockmgr","kind":12},{"containerName":"Simple","kind":12,"name":"LockFile","line":442},{"line":445,"kind":12,"name":"Dumper"},{"line":445,"name":"lockmgr","kind":12},{"line":446,"kind":12,"name":"lock"},{"line":446,"name":"lockmgr","kind":12},{"line":448,"kind":12,"name":"lock"},{"signature":{"parameters":[],"documentation":"# Description: Creates a thread for each log file to review\n# Returns 1 or dies if thread can not be created","label":"logger_thread()"},"containerName":"main::","children":[{"containerName":"logger_thread","localvar":"my","definition":"my","line":457,"name":"$self","kind":13},{"name":"$logstoreview","kind":13,"line":459,"definition":"my","containerName":"logger_thread","localvar":"my"},{"line":459,"containerName":"logger_thread","name":"$self","kind":13},{"name":"$logstoreview","kind":13,"containerName":"logger_thread","line":460},{"localvar":"my","containerName":"logger_thread","definition":"my","line":463,"name":"$logtoreview","kind":13},{"line":463,"name":"$logstoreview","kind":13,"containerName":"logger_thread"}],"range":{"start":{"line":456,"character":0},"end":{"line":463,"character":9999}},"kind":12,"name":"logger_thread","detail":"()","definition":"sub","line":456},{"line":459,"name":"configs","kind":12},{"name":"logs_to_review","kind":12,"line":459},{"line":464,"containerName":null,"kind":13,"name":"$logger"},{"line":464,"kind":12,"name":"info","containerName":"main::"},{"kind":13,"name":"$logobj","line":465,"definition":"my","containerName":null,"localvar":"my"},{"name":"%logstoreview","kind":13,"containerName":null,"line":465},{"line":465,"kind":13,"name":"$logtoreview","containerName":null},{"line":466,"containerName":null,"kind":13,"name":"%logobj"},{"line":466,"kind":12,"name":"chain"},{"name":"$logtoreview","kind":13,"containerName":null,"line":466},{"name":"$thr","kind":13,"line":468,"definition":"my","localvar":"my","containerName":null},{"line":468,"name":"threads","kind":12},{"containerName":"main::","kind":12,"name":"create","line":468},{"line":468,"kind":12,"name":"review_log"},{"kind":13,"name":"$self","containerName":null,"line":468},{"containerName":null,"name":"$logobj","kind":13,"line":468},{"containerName":null,"kind":13,"name":"$logger","line":468},{"containerName":"main::","name":"logdie","kind":12,"line":468},{"name":"$LoggerTIDS","kind":13,"containerName":null,"line":469},{"kind":13,"name":"$thr","containerName":null,"line":469},{"line":469,"kind":12,"name":"tid","containerName":"main::"},{"containerName":null,"kind":13,"name":"$logger","line":470},{"line":470,"containerName":"main::","kind":12,"name":"debug"},{"line":470,"kind":13,"name":"$thr","containerName":null},{"line":470,"name":"tid","kind":12,"containerName":"main::"},{"kind":13,"name":"$logger","containerName":null,"line":470},{"line":470,"kind":12,"name":"is_debug","containerName":"main::"},{"kind":13,"name":"$logger","containerName":null,"line":471},{"name":"debug","kind":12,"containerName":"main::","line":471},{"line":471,"containerName":null,"kind":13,"name":"$thr"},{"line":471,"name":"tid","kind":12,"containerName":"main::"},{"name":"$thr","kind":13,"containerName":null,"line":471},{"line":471,"containerName":"main::","name":"is_running","kind":12},{"line":471,"containerName":null,"kind":13,"name":"$logger"},{"line":471,"containerName":"main::","kind":12,"name":"is_debug"},{"kind":12,"name":"review_log","detail":"()","line":481,"definition":"sub","signature":{"documentation":" This is called as a thread and runs a loop to check the log file for new entries\n   Prior to checking the log file, it creates a chain for the log file and adds it to the global chain","label":"review_log()","parameters":[]},"containerName":"main::","range":{"end":{"line":553,"character":9999},"start":{"line":481,"character":0}},"children":[{"line":482,"definition":"my","kind":13,"name":"$self","localvar":"my","containerName":"review_log"},{"name":"$logobj","kind":13,"containerName":"review_log","line":482},{"line":484,"containerName":"review_log","name":"$logobj","kind":13},{"localvar":"my","containerName":"review_log","line":485,"definition":"my","name":"$TID","kind":13},{"line":485,"containerName":"review_log","kind":12,"name":"tid"},{"line":486,"containerName":"review_log","name":"$TID","kind":13},{"line":486,"containerName":"review_log","name":"$TID","kind":13},{"kind":13,"name":"$logger","containerName":"review_log","line":488},{"containerName":"review_log","name":"debug","kind":12,"line":488},{"containerName":"review_log","name":"$logobj","kind":13,"line":488},{"containerName":"review_log","name":"$logger","kind":13,"line":488},{"line":488,"containerName":"review_log","name":"is_debug","kind":12},{"line":491,"kind":13,"name":"$logobj","containerName":"review_log"},{"line":491,"containerName":"review_log","kind":13,"name":"$self"},{"kind":13,"name":"$cycles","line":492,"definition":"my","containerName":"review_log","localvar":"my"},{"containerName":"review_log","kind":13,"name":"$logobj","line":492},{"kind":13,"name":"$logobj","containerName":"review_log","line":493},{"name":"$self","kind":13,"containerName":"review_log","line":493},{"localvar":"my","containerName":"review_log","name":"$cyclesleep","kind":13,"line":494,"definition":"my"},{"containerName":"review_log","name":"$logobj","kind":13,"line":494},{"name":"$cyclesleep","kind":13,"containerName":"review_log","line":495},{"kind":13,"name":"$cyclesleep","containerName":"review_log","line":495},{"line":497,"kind":13,"name":"$logger","containerName":"review_log"},{"containerName":"review_log","kind":12,"name":"info","line":497},{"containerName":"review_log","localvar":"my","definition":"my","line":504,"kind":13,"name":"$chain"},{"line":504,"kind":13,"name":"$logobj","containerName":"review_log"},{"name":"$logger","kind":13,"containerName":"review_log","line":505},{"line":505,"containerName":"review_log","name":"info","kind":12},{"line":506,"containerName":"review_log","kind":13,"name":"$self"},{"containerName":"review_log","name":"create_iptables_chain","kind":12,"line":506},{"containerName":"review_log","kind":13,"name":"$chain","line":506},{"kind":13,"name":"$logger","containerName":"review_log","line":509},{"line":509,"containerName":"review_log","name":"info","kind":12},{"definition":"my","line":510,"kind":13,"name":"$table","localvar":"my","containerName":"review_log"},{"localvar":"my","containerName":"review_log","definition":"my","line":511,"kind":13,"name":"$args"},{"line":515,"name":"$logger","kind":13,"containerName":"review_log"},{"line":515,"kind":12,"name":"info","containerName":"review_log"},{"containerName":"review_log","name":"$self","kind":13,"line":516},{"line":516,"containerName":"review_log","kind":12,"name":"iptablesqueue_enqueue"},{"kind":13,"name":"$args","containerName":"review_log","line":516},{"containerName":"review_log","name":"$cycles","kind":13,"line":519},{"kind":13,"name":"$logger","containerName":"review_log","line":520},{"containerName":"review_log","name":"info","kind":12,"line":520},{"line":521,"containerName":"review_log","name":"$logobj","kind":13},{"containerName":"review_log","name":"$self","kind":13,"line":521},{"line":521,"kind":12,"name":"readlogfile","containerName":"review_log"},{"kind":13,"name":"$logobj","containerName":"review_log","line":521},{"kind":13,"name":"$logobj","containerName":"review_log","line":522},{"line":522,"name":"$self","kind":13,"containerName":"review_log"},{"line":522,"kind":12,"name":"_grep_regexps","containerName":"review_log"},{"line":522,"name":"$logobj","kind":13,"containerName":"review_log"},{"line":522,"containerName":"review_log","kind":13,"name":"$logobj"},{"kind":13,"name":"$logobj","containerName":"review_log","line":523},{"name":"$self","kind":13,"containerName":"review_log","line":523},{"containerName":"review_log","name":"clean_ips_to_block_allowdeny","kind":12,"line":523},{"line":523,"containerName":"review_log","kind":13,"name":"$logobj"},{"localvar":"my","containerName":"review_log","definition":"my","line":533,"kind":13,"name":"$ip"},{"line":533,"name":"$logobj","kind":13,"containerName":"review_log"},{"containerName":"review_log","name":"$logger","kind":13,"line":534},{"line":534,"containerName":"review_log","name":"info","kind":12},{"definition":"my","line":535,"name":"$args","kind":13,"containerName":"review_log","localvar":"my"},{"containerName":"review_log","kind":13,"name":"$logger","line":539},{"kind":12,"name":"debug","containerName":"review_log","line":539},{"line":540,"kind":13,"name":"$self","containerName":"review_log"},{"containerName":"review_log","name":"iptablesqueue_enqueue","kind":12,"line":540},{"name":"$args","kind":13,"containerName":"review_log","line":540},{"containerName":"review_log","localvar":"my","name":"$args","kind":13,"definition":"my","line":542},{"line":546,"kind":13,"name":"$logger","containerName":"review_log"},{"line":546,"kind":12,"name":"debug","containerName":"review_log"},{"line":547,"name":"$self","kind":13,"containerName":"review_log"},{"containerName":"review_log","name":"iptablesqueue_enqueue","kind":12,"line":547},{"name":"$args","kind":13,"containerName":"review_log","line":547},{"kind":13,"name":"$cycles","containerName":"review_log","line":550},{"containerName":"review_log","name":"$logger","kind":13,"line":551},{"line":551,"kind":12,"name":"info","containerName":"review_log"},{"containerName":"review_log","kind":13,"name":"$cyclesleep","line":552}]},{"line":485,"name":"threads","kind":12},{"kind":12,"name":"Dumper","line":488},{"name":"cycles","kind":12,"line":491},{"name":"configs","kind":12,"line":491},{"line":491,"kind":12,"name":"cycles"},{"line":491,"kind":12,"name":"LONG_MAX"},{"line":492,"name":"cycles","kind":12},{"line":493,"kind":12,"name":"cyclesleep"},{"kind":12,"name":"configs","line":493},{"name":"cyclesleep","kind":12,"line":493},{"line":494,"name":"cyclesleep","kind":12},{"line":504,"name":"chain","kind":12},{"line":512,"kind":12,"name":"options"},{"line":513,"kind":12,"name":"rule"},{"name":"ips_to_block","kind":12,"line":522},{"kind":12,"name":"logcontents","line":522},{"kind":12,"name":"ips_to_block","line":533},{"name":"options","kind":12,"line":536},{"line":537,"name":"rule","kind":12},{"line":543,"name":"options","kind":12},{"line":544,"kind":12,"name":"rule"},{"name":"usleep","kind":12,"line":552},{"name":"$logger","kind":13,"containerName":null,"line":555},{"kind":12,"name":"info","containerName":"main::","line":555},{"name":"iptables_ipblock_commands","kind":12,"detail":"()","line":561,"definition":"sub","containerName":"main::","signature":{"parameters":[],"documentation":" Description: takes the ips_to_block, ports, and protocols and creates the iptables commands to run\n Returns a hash of iptables commands to run","label":"iptables_ipblock_commands()"},"range":{"start":{"line":561,"character":0},"end":{"line":585,"character":9999}},"children":[{"localvar":"my","containerName":"iptables_ipblock_commands","name":"$self","kind":13,"line":562,"definition":"my"},{"containerName":"iptables_ipblock_commands","localvar":"my","kind":13,"name":"$logobj","definition":"my","line":563},{"localvar":"my","containerName":"iptables_ipblock_commands","kind":13,"name":"$TID","definition":"my","line":565},{"kind":12,"name":"tid","containerName":"iptables_ipblock_commands","line":565},{"line":566,"name":"$TID","kind":13,"containerName":"iptables_ipblock_commands"},{"name":"$TID","kind":13,"containerName":"iptables_ipblock_commands","line":566},{"containerName":"iptables_ipblock_commands","name":"$logobj","kind":13,"line":568},{"containerName":"iptables_ipblock_commands","localvar":"my","name":"$iptables_commands","kind":13,"definition":"my","line":572},{"localvar":"my","containerName":"iptables_ipblock_commands","definition":"my","line":584,"name":"$ips_to_block","kind":13},{"kind":13,"name":"$logobj","containerName":"iptables_ipblock_commands","line":584},{"localvar":"my","containerName":"iptables_ipblock_commands","kind":13,"name":"$chain","definition":"my","line":585},{"line":585,"containerName":"iptables_ipblock_commands","name":"$ips_to_block","kind":13}]},{"name":"threads","kind":12,"line":565},{"kind":12,"name":"ips_to_block","line":584},{"name":"$ip","kind":13,"line":586,"definition":"my","localvar":"my","containerName":null},{"line":586,"containerName":null,"kind":13,"name":"%ips_to_block"},{"line":586,"name":"%chain","kind":13,"containerName":null},{"name":"$port","kind":13,"line":587,"definition":"my","containerName":null,"localvar":"my"},{"kind":13,"name":"%ips_to_block","containerName":null,"line":587},{"name":"%chain","kind":13,"containerName":null,"line":587},{"line":587,"containerName":null,"name":"%ip","kind":13},{"containerName":null,"localvar":"my","definition":"my","line":588,"kind":13,"name":"$protocol"},{"line":588,"kind":13,"name":"%ips_to_block","containerName":null},{"line":588,"kind":13,"name":"%chain","containerName":null},{"line":588,"name":"%ip","kind":13,"containerName":null},{"line":588,"containerName":null,"kind":13,"name":"%port"},{"containerName":null,"localvar":"my","name":"$iptables_command","kind":13,"line":589,"definition":"my"},{"line":589,"containerName":null,"name":"%self","kind":13},{"line":589,"kind":12,"name":"iptables_command"},{"line":590,"containerName":null,"kind":13,"name":"$iptables_command"},{"name":"$iptables_command","kind":13,"containerName":null,"line":591},{"name":"$iptables_command","kind":13,"containerName":null,"line":592},{"name":"$iptables_command","kind":13,"containerName":null,"line":593},{"name":"%iptables_commands","kind":13,"containerName":null,"line":594},{"line":594,"containerName":null,"name":"%chain","kind":13},{"name":"%ip","kind":13,"containerName":null,"line":594},{"line":594,"containerName":null,"kind":13,"name":"%port"},{"line":594,"kind":13,"name":"$protocol","containerName":null},{"line":594,"name":"$iptables_command","kind":13,"containerName":null},{"line":600,"containerName":null,"kind":13,"name":"$logger"},{"containerName":"main::","kind":12,"name":"debug","line":600},{"kind":12,"name":"Dumper","line":600},{"line":600,"containerName":null,"name":"$iptables_commands","kind":13},{"line":600,"name":"$logger","kind":13,"containerName":null},{"name":"is_debug","kind":12,"containerName":"main::","line":600},{"line":602,"kind":13,"name":"$iptables_commands","containerName":null},{"containerName":"main::","range":{"end":{"character":9999,"line":630},"start":{"line":606,"character":0}},"children":[{"containerName":"load_configs","localvar":"my","line":607,"definition":"my","name":"$self","kind":13},{"containerName":"load_configs","localvar":"my","name":"$configsfile","kind":13,"definition":"my","line":608},{"line":608,"containerName":"load_configs","name":"$self","kind":13},{"line":609,"definition":"my","name":"$clargs","kind":13,"containerName":"load_configs","localvar":"my"},{"line":609,"containerName":"load_configs","name":"$self","kind":13},{"containerName":"load_configs","name":"$configsfile","kind":13,"line":611},{"name":"$self","kind":13,"containerName":"load_configs","line":614},{"containerName":"load_configs","kind":13,"name":"$self","line":614},{"line":615,"name":"$self","kind":13,"containerName":"load_configs"},{"containerName":"load_configs","kind":13,"name":"$self","line":615},{"name":"$self","kind":13,"containerName":"load_configs","line":616},{"name":"$msg","kind":13,"line":621,"definition":"my","localvar":"my","containerName":"load_configs"},{"line":622,"name":"$msg","kind":13,"containerName":"load_configs"},{"containerName":"load_configs","name":"$msg","kind":13,"line":623},{"line":623,"containerName":"load_configs","name":"$clargs","kind":13},{"line":624,"containerName":"load_configs","name":"$msg","kind":13},{"containerName":"load_configs","kind":13,"name":"$DEFAULTS","line":624},{"line":625,"containerName":"load_configs","kind":13,"name":"$msg"},{"containerName":"load_configs","name":"$msg","kind":13,"line":626},{"name":"$msg","kind":13,"containerName":"load_configs","line":627},{"definition":"my","line":630,"kind":13,"name":"$config","containerName":"load_configs","localvar":"my"},{"name":"$DEFAULTS","kind":13,"containerName":"load_configs","line":630}],"name":"load_configs","kind":12,"line":606,"definition":"sub"},{"line":608,"kind":12,"name":"configsfile"},{"line":609,"name":"clargs","kind":12},{"line":614,"kind":12,"name":"configs"},{"containerName":"File::read_config_file","name":"Config","kind":12,"line":614},{"kind":12,"name":"configsfile","line":614},{"kind":12,"name":"configs","line":615},{"line":615,"kind":12,"name":"globalchain"},{"line":615,"kind":12,"name":"configs"},{"kind":12,"name":"globalchain","line":615},{"name":"configs","kind":12,"line":616},{"line":616,"kind":12,"name":"globalchain"},{"name":"Dumper","kind":12,"line":623},{"line":624,"kind":12,"name":"Dumper"},{"kind":12,"name":"carp","line":626},{"name":"%self","kind":13,"containerName":null,"line":634},{"name":"configs","kind":12,"line":634},{"kind":13,"name":"$config","containerName":null,"line":634},{"line":635,"containerName":null,"name":"%clargs","kind":13},{"line":635,"containerName":null,"kind":13,"name":"$config"},{"containerName":null,"kind":13,"name":"%clargs","line":636},{"name":"$config","kind":13,"containerName":null,"line":636},{"name":"%self","kind":13,"containerName":null,"line":637},{"name":"configs","kind":12,"line":637},{"name":"$config","kind":13,"containerName":null,"line":637},{"line":637,"containerName":null,"kind":13,"name":"%DEFAULTS"},{"containerName":null,"name":"$config","kind":13,"line":637},{"line":640,"containerName":null,"name":"%self","kind":13},{"kind":12,"name":"configs","line":640},{"signature":{"documentation":" Special helper function for clean_ips_to_block()","label":"reverseMapHash()","parameters":[]},"containerName":"main::","children":[{"line":645,"definition":"my","name":"$self","kind":13,"localvar":"my","containerName":"reverseMapHash"},{"localvar":"my","containerName":"reverseMapHash","kind":13,"name":"$hash","line":646,"definition":"my"},{"localvar":"my","containerName":"reverseMapHash","definition":"my","line":650,"name":"$new_hash","kind":13},{"containerName":"reverseMapHash","localvar":"my","definition":"my","line":651,"kind":13,"name":"$key"},{"line":651,"name":"$hash","kind":13,"containerName":"reverseMapHash"}],"range":{"end":{"line":651,"character":9999},"start":{"character":0,"line":644}},"kind":12,"name":"reverseMapHash","detail":"()","definition":"sub","line":644},{"name":"%new_hash","kind":13,"containerName":null,"line":652},{"containerName":null,"name":"%hash","kind":13,"line":652},{"line":652,"containerName":null,"name":"$key","kind":13},{"line":656,"containerName":null,"kind":13,"name":"$new_hash"},{"containerName":"main::","signature":{"parameters":[],"label":"clean_ips_to_block_combined()","documentation":" Description: Combines the IPs from regex from the log to be blocked and the IPs from the allow/deny lists into\n               one hash"},"children":[{"localvar":"my","containerName":"clean_ips_to_block_combined","kind":13,"name":"$self","definition":"my","line":662},{"containerName":"clean_ips_to_block_combined","localvar":"my","line":663,"definition":"my","kind":13,"name":"$logobj"},{"name":"$TID","kind":13,"line":664,"definition":"my","localvar":"my","containerName":"clean_ips_to_block_combined"},{"kind":12,"name":"tid","containerName":"clean_ips_to_block_combined","line":664},{"containerName":"clean_ips_to_block_combined","name":"$TID","kind":13,"line":665},{"line":665,"containerName":"clean_ips_to_block_combined","name":"$TID","kind":13},{"containerName":"clean_ips_to_block_combined","kind":13,"name":"$Data","line":667},{"line":668,"name":"$Data","kind":13,"containerName":"clean_ips_to_block_combined"}],"range":{"start":{"character":0,"line":661},"end":{"line":670,"character":9999}},"kind":12,"name":"clean_ips_to_block_combined","detail":"()","line":661,"definition":"sub"},{"name":"threads","kind":12,"line":664},{"containerName":"Terse","name":"Dumper","kind":12,"line":667},{"containerName":"Indent","kind":12,"name":"Dumper","line":668},{"definition":"sub","line":675,"detail":"()","kind":12,"name":"clean_ips_to_block_allowdeny","children":[{"kind":13,"name":"$self","definition":"my","line":676,"localvar":"my","containerName":"clean_ips_to_block_allowdeny"},{"kind":13,"name":"$logobj","definition":"my","line":677,"localvar":"my","containerName":"clean_ips_to_block_allowdeny"},{"name":"$TID","kind":13,"definition":"my","line":678,"containerName":"clean_ips_to_block_allowdeny","localvar":"my"},{"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"tid","line":678},{"line":679,"kind":13,"name":"$TID","containerName":"clean_ips_to_block_allowdeny"},{"name":"$TID","kind":13,"containerName":"clean_ips_to_block_allowdeny","line":679},{"line":681,"name":"$Data","kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"line":682,"kind":13,"name":"$Data","containerName":"clean_ips_to_block_allowdeny"},{"definition":"my","line":686,"kind":13,"name":"$allowdeny","containerName":"clean_ips_to_block_allowdeny","localvar":"my"},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logobj","line":686},{"line":686,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$self"},{"name":"$logobj_allowlist","kind":13,"line":687,"definition":"my","localvar":"my","containerName":"clean_ips_to_block_allowdeny"},{"line":687,"name":"$logobj","kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"line":687,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$self"},{"kind":13,"name":"$logobj_denylist","definition":"my","line":688,"containerName":"clean_ips_to_block_allowdeny","localvar":"my"},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logobj","line":688},{"line":688,"kind":13,"name":"$self","containerName":"clean_ips_to_block_allowdeny"},{"kind":13,"name":"$global_denylist","line":689,"definition":"my","localvar":"my","containerName":"clean_ips_to_block_allowdeny"},{"line":689,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$self"},{"containerName":"clean_ips_to_block_allowdeny","localvar":"my","line":690,"definition":"my","name":"$global_allowlist","kind":13},{"line":690,"name":"$self","kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"localvar":"my","containerName":"clean_ips_to_block_allowdeny","name":"$ips_to_block","kind":13,"line":692,"definition":"my"},{"containerName":"clean_ips_to_block_allowdeny","name":"$logobj","kind":13,"line":692},{"line":695,"containerName":"clean_ips_to_block_allowdeny","name":"$logobj_allowlist","kind":13},{"line":695,"containerName":"clean_ips_to_block_allowdeny","name":"$self","kind":13},{"containerName":"clean_ips_to_block_allowdeny","name":"reverseMapHash","kind":12,"line":695},{"line":695,"kind":13,"name":"$logobj_allowlist","containerName":"clean_ips_to_block_allowdeny"},{"line":696,"kind":13,"name":"$logobj_denylist","containerName":"clean_ips_to_block_allowdeny"},{"line":696,"containerName":"clean_ips_to_block_allowdeny","name":"$self","kind":13},{"name":"reverseMapHash","kind":12,"containerName":"clean_ips_to_block_allowdeny","line":696},{"line":696,"kind":13,"name":"$logobj_denylist","containerName":"clean_ips_to_block_allowdeny"},{"line":697,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$global_allowlist"},{"name":"$self","kind":13,"containerName":"clean_ips_to_block_allowdeny","line":697},{"line":697,"kind":12,"name":"reverseMapHash","containerName":"clean_ips_to_block_allowdeny"},{"name":"$global_allowlist","kind":13,"containerName":"clean_ips_to_block_allowdeny","line":697},{"line":698,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$global_denylist"},{"line":698,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$self"},{"line":698,"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"reverseMapHash"},{"containerName":"clean_ips_to_block_allowdeny","name":"$global_denylist","kind":13,"line":698},{"kind":13,"name":"$logger","containerName":"clean_ips_to_block_allowdeny","line":701},{"name":"info","kind":12,"containerName":"clean_ips_to_block_allowdeny","line":701},{"containerName":"clean_ips_to_block_allowdeny","name":"$logger","kind":13,"line":702},{"line":702,"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"debug"},{"line":702,"kind":13,"name":"$logobj_allowlist","containerName":"clean_ips_to_block_allowdeny"},{"line":702,"containerName":"clean_ips_to_block_allowdeny","name":"$logger","kind":13},{"kind":12,"name":"is_debug","containerName":"clean_ips_to_block_allowdeny","line":702},{"kind":13,"name":"$logger","containerName":"clean_ips_to_block_allowdeny","line":703},{"containerName":"clean_ips_to_block_allowdeny","kind":12,"name":"debug","line":703},{"line":703,"kind":13,"name":"$logobj_denylist","containerName":"clean_ips_to_block_allowdeny"},{"line":703,"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logger"},{"name":"is_debug","kind":12,"containerName":"clean_ips_to_block_allowdeny","line":703},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logger","line":704},{"kind":12,"name":"debug","containerName":"clean_ips_to_block_allowdeny","line":704},{"line":704,"kind":13,"name":"$ips_to_block","containerName":"clean_ips_to_block_allowdeny"},{"line":704,"containerName":"clean_ips_to_block_allowdeny","name":"$logger","kind":13},{"line":704,"kind":12,"name":"is_debug","containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logger","line":705},{"kind":12,"name":"debug","containerName":"clean_ips_to_block_allowdeny","line":705},{"containerName":"clean_ips_to_block_allowdeny","name":"$global_allowlist","kind":13,"line":705},{"line":705,"kind":13,"name":"$logger","containerName":"clean_ips_to_block_allowdeny"},{"line":705,"name":"is_debug","kind":12,"containerName":"clean_ips_to_block_allowdeny"},{"line":706,"name":"$logger","kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"name":"debug","kind":12,"containerName":"clean_ips_to_block_allowdeny","line":706},{"line":706,"name":"$global_denylist","kind":13,"containerName":"clean_ips_to_block_allowdeny"},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$logger","line":706},{"line":706,"name":"is_debug","kind":12,"containerName":"clean_ips_to_block_allowdeny"},{"localvar":"my","containerName":"clean_ips_to_block_allowdeny","line":709,"definition":"my","name":"$allowlist","kind":13},{"containerName":"clean_ips_to_block_allowdeny","kind":13,"name":"$global_allowlist","line":709},{"line":709,"name":"$logobj_allowlist","kind":13,"containerName":"clean_ips_to_block_allowdeny"}],"range":{"start":{"line":675,"character":0},"end":{"line":709,"character":9999}},"containerName":"main::","signature":{"parameters":[],"documentation":" Description: Returns the logobj with ips_to_block set with the IPs to block from the allow/deny lists\n   There is a lot of logging available in this sub.\n   This sub is called from review_log()","label":"clean_ips_to_block_allowdeny()"}},{"name":"threads","kind":12,"line":678},{"line":681,"name":"Dumper","kind":12,"containerName":"Terse"},{"kind":12,"name":"Dumper","containerName":"Indent","line":682},{"line":686,"kind":12,"name":"allowdeny"},{"name":"configs","kind":12,"line":686},{"name":"allowdeny","kind":12,"line":686},{"kind":12,"name":"allowlist","line":687},{"line":687,"name":"configs","kind":12},{"kind":12,"name":"allowlist","line":687},{"line":688,"name":"denylist","kind":12},{"name":"configs","kind":12,"line":688},{"line":688,"name":"denylist","kind":12},{"name":"configs","kind":12,"line":689},{"line":689,"name":"denylist","kind":12},{"kind":12,"name":"configs","line":690},{"kind":12,"name":"allowlist","line":690},{"kind":12,"name":"ips_to_block","line":692},{"line":702,"kind":12,"name":"Dumper"},{"line":703,"kind":12,"name":"Dumper"},{"line":704,"kind":12,"name":"Dumper"},{"line":705,"kind":12,"name":"Dumper"},{"kind":12,"name":"Dumper","line":706},{"kind":13,"name":"%denylist","definition":"my","line":710,"containerName":null,"localvar":"my"},{"containerName":null,"name":"$global_denylist","kind":13,"line":710},{"line":710,"kind":13,"name":"$logobj_denylist","containerName":null},{"line":713,"containerName":null,"name":"$logger","kind":13},{"line":713,"containerName":"main::","kind":12,"name":"debug"},{"line":713,"name":"Dumper","kind":12},{"containerName":null,"kind":13,"name":"$allowlist","line":713},{"line":713,"name":"$logger","kind":13,"containerName":null},{"line":713,"kind":12,"name":"is_debug","containerName":"main::"},{"containerName":null,"name":"$logger","kind":13,"line":714},{"containerName":"main::","name":"debug","kind":12,"line":714},{"line":714,"name":"Dumper","kind":12},{"containerName":null,"kind":13,"name":"$denylist","line":714},{"line":714,"kind":13,"name":"$logger","containerName":null},{"containerName":"main::","name":"is_debug","kind":12,"line":714},{"line":717,"name":"%denylist","kind":13,"containerName":null},{"kind":13,"name":"$denylist","containerName":null,"line":717},{"line":717,"containerName":null,"kind":13,"name":"$ips_to_block"},{"containerName":null,"name":"$logger","kind":13,"line":720},{"line":720,"containerName":"main::","kind":12,"name":"debug"},{"name":"Dumper","kind":12,"line":720},{"kind":13,"name":"$denylist","containerName":null,"line":720},{"line":720,"kind":13,"name":"$logger","containerName":null},{"line":720,"kind":12,"name":"is_debug","containerName":"main::"},{"line":724,"name":"%allowdeny","kind":13,"containerName":null},{"kind":13,"name":"%logobj","containerName":null,"line":725},{"name":"ips_to_block","kind":12,"line":725},{"name":"$denylist","kind":13,"containerName":null,"line":725},{"containerName":null,"kind":13,"name":"%logobj","line":726},{"kind":13,"name":"%denylist","containerName":null,"line":731},{"line":731,"containerName":null,"kind":13,"name":"$allowlist"},{"name":"%logobj","kind":13,"containerName":null,"line":732},{"line":732,"kind":12,"name":"ips_to_block"},{"name":"$denylist","kind":13,"containerName":null,"line":732},{"line":733,"kind":13,"name":"$logobj","containerName":null},{"line":748,"definition":"sub","kind":12,"name":"run_iptables","detail":"()","children":[{"line":749,"definition":"my","kind":13,"name":"$self","localvar":"my","containerName":"run_iptables"},{"kind":13,"name":"$args","containerName":"run_iptables","line":749},{"localvar":"my","containerName":"run_iptables","definition":"my","line":750,"name":"@caller_lst","kind":13},{"name":"$goodcaller","kind":13,"definition":"my","line":751,"localvar":"my","containerName":"run_iptables"},{"line":751,"containerName":"run_iptables","name":"$self","kind":13},{"kind":13,"name":"$caller_lst","containerName":"run_iptables","line":752},{"line":752,"containerName":"run_iptables","name":"$goodcaller","kind":13},{"containerName":"run_iptables","localvar":"my","line":753,"definition":"my","name":"$logmsg","kind":13},{"line":754,"name":"@caller_lst","kind":13,"containerName":"run_iptables"},{"containerName":"run_iptables","kind":13,"name":"$logger","line":759},{"kind":12,"name":"error","containerName":"run_iptables","line":759},{"name":"$logmsg","kind":13,"containerName":"run_iptables","line":759},{"containerName":"run_iptables","localvar":"my","line":761,"definition":"my","name":"$TID","kind":13},{"name":"tid","kind":12,"containerName":"run_iptables","line":761},{"line":762,"kind":13,"name":"$TID","containerName":"run_iptables"},{"containerName":"run_iptables","name":"$TID","kind":13,"line":762},{"line":765,"name":"$args","kind":13,"containerName":"run_iptables"},{"kind":13,"name":"$logger","containerName":"run_iptables","line":765},{"kind":12,"name":"error","containerName":"run_iptables","line":765},{"kind":13,"name":"$self","containerName":"run_iptables","line":766},{"containerName":"run_iptables","kind":13,"name":"$logger","line":766},{"line":766,"kind":12,"name":"error","containerName":"run_iptables"},{"containerName":"run_iptables","localvar":"my","kind":13,"name":"$iptables","definition":"my","line":768},{"line":768,"containerName":"run_iptables","kind":13,"name":"$self"},{"kind":13,"name":"$rule","line":769,"definition":"my","containerName":"run_iptables","localvar":"my"},{"line":769,"name":"$args","kind":13,"containerName":"run_iptables"},{"definition":"my","line":770,"kind":13,"name":"$options","localvar":"my","containerName":"run_iptables"},{"name":"$args","kind":13,"containerName":"run_iptables","line":770},{"line":772,"containerName":"run_iptables","name":"$logger","kind":13},{"containerName":"run_iptables","name":"is_debug","kind":12,"line":772},{"containerName":"run_iptables","kind":13,"name":"$logger","line":773},{"name":"debug","kind":12,"containerName":"run_iptables","line":773},{"line":774,"name":"$args","kind":13,"containerName":"run_iptables"},{"kind":13,"name":"$args","containerName":"run_iptables","line":782},{"containerName":"run_iptables","localvar":"my","line":783,"definition":"my","kind":13,"name":"$allowdupes"},{"containerName":"run_iptables","name":"$args","kind":13,"line":783},{"containerName":"run_iptables","name":"$allowdupes","kind":13,"line":785},{"line":786,"containerName":"run_iptables","name":"$logger","kind":13},{"line":786,"containerName":"run_iptables","name":"debug","kind":12},{"line":787,"definition":"my","name":"$retval","kind":13,"localvar":"my","containerName":"run_iptables"},{"containerName":"run_iptables","name":"$self","kind":13,"line":787},{"line":787,"name":"check_if_rule_exists","kind":12,"containerName":"run_iptables"},{"name":"$args","kind":13,"containerName":"run_iptables","line":787},{"name":"$retval","kind":13,"containerName":"run_iptables","line":788},{"containerName":"run_iptables","kind":13,"name":"$logger","line":792},{"containerName":"run_iptables","kind":12,"name":"debug","line":792},{"line":795,"containerName":"run_iptables","kind":13,"name":"$retval"},{"line":796,"containerName":"run_iptables","name":"$logger","kind":13},{"line":796,"name":"debug","kind":12,"containerName":"run_iptables"},{"name":"$retval","kind":13,"containerName":"run_iptables","line":798},{"line":799,"containerName":"run_iptables","kind":13,"name":"$options"},{"kind":13,"name":"$logger","containerName":"run_iptables","line":802},{"line":802,"containerName":"run_iptables","name":"debug","kind":12},{"line":805,"kind":13,"name":"$self","containerName":"run_iptables"},{"kind":13,"name":"$rule","containerName":"run_iptables","line":805},{"line":807,"name":"$retval","kind":13,"containerName":"run_iptables"},{"line":808,"containerName":"run_iptables","kind":13,"name":"$logger"},{"containerName":"run_iptables","kind":12,"name":"error","line":808},{"line":811,"containerName":"run_iptables","kind":13,"name":"$retval"},{"containerName":"run_iptables","name":"$logger","kind":13,"line":812},{"kind":12,"name":"error","containerName":"run_iptables","line":812},{"line":816,"kind":13,"name":"$logger","containerName":"run_iptables"},{"name":"error","kind":12,"containerName":"run_iptables","line":816},{"line":816,"name":"$retval","kind":13,"containerName":"run_iptables"},{"definition":"my","line":821,"name":"$command","kind":13,"containerName":"run_iptables","localvar":"my"},{"line":822,"containerName":"run_iptables","kind":13,"name":"$self"},{"containerName":"run_iptables","name":"$logger","kind":13,"line":823},{"containerName":"run_iptables","kind":12,"name":"debug","line":823},{"name":"$output","kind":13,"line":824,"definition":"my","containerName":"run_iptables","localvar":"my"},{"containerName":"run_iptables","name":"$logger","kind":13,"line":825},{"line":825,"name":"debug","kind":12,"containerName":"run_iptables"},{"kind":13,"name":"$logger","containerName":"run_iptables","line":829},{"name":"info","kind":12,"containerName":"run_iptables","line":829},{"kind":13,"name":"$logger","containerName":"run_iptables","line":834},{"kind":12,"name":"error","containerName":"run_iptables","line":834}],"range":{"start":{"character":0,"line":748},"end":{"character":9999,"line":836}},"containerName":"main::","signature":{"parameters":[],"documentation":" Runs whatever parameters are passed to it against iptables\n  This is intended to be a one stop shop for running iptables out from a queue.\n  However, there are a few instances where it is called directly... especially when creating chains\n   This hopefully prevents excessive wait/locking on iptables\n   and helps to keep commands running in the order they are received.\n Arguments must be passed as a hash reference with (so far) the following keys:\n   rule:  The rule to run\n   options:  Any options to pass to iptables\n  Where it is ran like this:\n   iptables $options $rule 2>&1\n Future enhancement:\n   1. delete existing rule if it exists","label":"run_iptables()"}},{"kind":12,"name":"run_iptables_line","line":751},{"kind":12,"name":"Dumper","line":754},{"kind":12,"name":"threads","line":761},{"line":765,"name":"rule","kind":12},{"name":"configs","kind":12,"line":766},{"kind":12,"name":"iptables","line":766},{"kind":12,"name":"configs","line":768},{"line":768,"name":"iptables","kind":12},{"name":"rule","kind":12,"line":769},{"name":"options","kind":12,"line":770},{"line":774,"kind":12,"name":"Dumper"},{"kind":12,"name":"allowdupes","line":782},{"line":783,"name":"allowdupes","kind":12},{"line":805,"kind":12,"name":"chains_created"},{"kind":12,"name":"configs","line":822},{"kind":12,"name":"PRODMODE","line":822},{"detail":"()","name":"set_iptables_command","kind":12,"definition":"sub","line":839,"containerName":"main::","signature":{"documentation":" Maybe an unnecessary sub but maybe some better checks down the road","label":"set_iptables_command()","parameters":[]},"range":{"end":{"character":9999,"line":847},"start":{"character":0,"line":839}},"children":[{"localvar":"my","containerName":"set_iptables_command","definition":"my","line":840,"name":"$self","kind":13},{"line":843,"name":"$self","kind":13,"containerName":"set_iptables_command"},{"line":844,"kind":13,"name":"$self","containerName":"set_iptables_command"},{"name":"$logger","kind":13,"containerName":"set_iptables_command","line":845},{"kind":12,"name":"info","containerName":"set_iptables_command","line":845}]},{"line":843,"kind":12,"name":"configs"},{"line":843,"kind":12,"name":"iptables"},{"line":844,"kind":12,"name":"configs"},{"name":"iptables","kind":12,"line":844},{"detail":"($self,$args)","kind":12,"name":"check_if_rule_exists","definition":"sub","line":851,"signature":{"label":"check_if_rule_exists($self,$args)","documentation":"# Returns 0 if there is an unknown return value from running iptables\n#          Otherwise returns a string","parameters":[{"label":"$self"},{"label":"$args"}]},"containerName":"main::","children":[{"containerName":"check_if_rule_exists","localvar":"my","line":852,"definition":"my","name":"$self","kind":13},{"containerName":"check_if_rule_exists","name":"$args","kind":13,"line":852},{"localvar":"my","containerName":"check_if_rule_exists","name":"$TID","kind":13,"line":853,"definition":"my"},{"line":853,"containerName":"check_if_rule_exists","name":"tid","kind":12},{"line":854,"name":"$TID","kind":13,"containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","kind":13,"name":"$TID","line":854},{"line":857,"containerName":"check_if_rule_exists","kind":13,"name":"$args"},{"line":857,"containerName":"check_if_rule_exists","name":"$self","kind":13},{"line":857,"kind":12,"name":"log_and_return","containerName":"check_if_rule_exists"},{"kind":13,"name":"$self","containerName":"check_if_rule_exists","line":858},{"line":858,"name":"$logger","kind":13,"containerName":"check_if_rule_exists"},{"containerName":"check_if_rule_exists","name":"error","kind":12,"line":858},{"kind":13,"name":"$iptables","line":860,"definition":"my","containerName":"check_if_rule_exists","localvar":"my"},{"line":860,"containerName":"check_if_rule_exists","kind":13,"name":"$self"},{"line":861,"definition":"my","name":"$rule","kind":13,"containerName":"check_if_rule_exists","localvar":"my"},{"line":861,"name":"$args","kind":13,"containerName":"check_if_rule_exists"},{"definition":"my","line":862,"kind":13,"name":"$options","localvar":"my","containerName":"check_if_rule_exists"},{"line":862,"name":"$args","kind":13,"containerName":"check_if_rule_exists"},{"line":864,"name":"$options","kind":13,"containerName":"check_if_rule_exists"},{"line":865,"definition":"my","name":"$logmsg","kind":13,"containerName":"check_if_rule_exists","localvar":"my"},{"line":866,"containerName":"check_if_rule_exists","kind":13,"name":"$logmsg"},{"containerName":"check_if_rule_exists","kind":13,"name":"$logger","line":867},{"name":"debug","kind":12,"containerName":"check_if_rule_exists","line":867},{"line":867,"name":"$logmsg","kind":13,"containerName":"check_if_rule_exists"},{"localvar":"my","containerName":"check_if_rule_exists","kind":13,"name":"$checkrule_result","definition":"my","line":871},{"line":873,"kind":13,"name":"$logger","containerName":"check_if_rule_exists"},{"line":873,"containerName":"check_if_rule_exists","kind":12,"name":"debug"},{"line":877,"kind":13,"name":"$checkrule_result","containerName":"check_if_rule_exists"},{"kind":13,"name":"$logger","containerName":"check_if_rule_exists","line":878},{"line":878,"containerName":"check_if_rule_exists","kind":12,"name":"debug"},{"kind":13,"name":"$logger","containerName":"check_if_rule_exists","line":879},{"containerName":"check_if_rule_exists","name":"debug","kind":12,"line":879},{"name":"$checkrule_result","kind":13,"containerName":"check_if_rule_exists","line":883},{"name":"$logger","kind":13,"containerName":"check_if_rule_exists","line":884},{"containerName":"check_if_rule_exists","name":"debug","kind":12,"line":884},{"line":885,"containerName":"check_if_rule_exists","name":"$logger","kind":13},{"kind":12,"name":"debug","containerName":"check_if_rule_exists","line":885},{"kind":13,"name":"$checkrule_result","containerName":"check_if_rule_exists","line":889},{"line":890,"name":"$logger","kind":13,"containerName":"check_if_rule_exists"},{"line":890,"containerName":"check_if_rule_exists","kind":12,"name":"debug"},{"kind":13,"name":"$logger","containerName":"check_if_rule_exists","line":891},{"line":891,"kind":12,"name":"debug","containerName":"check_if_rule_exists"},{"line":895,"containerName":"check_if_rule_exists","name":"$self","kind":13},{"containerName":"check_if_rule_exists","name":"log_and_return","kind":12,"line":895}],"range":{"start":{"line":851,"character":0},"end":{"character":9999,"line":896}}},{"line":853,"kind":12,"name":"threads"},{"name":"rule","kind":12,"line":857},{"line":858,"name":"configs","kind":12},{"line":858,"kind":12,"name":"iptables"},{"name":"configs","kind":12,"line":860},{"kind":12,"name":"iptables","line":860},{"line":861,"name":"rule","kind":12},{"line":862,"kind":12,"name":"options"},{"detail":"($self,$error_message)","kind":12,"name":"log_and_return","line":898,"definition":"sub","signature":{"documentation":"","label":"log_and_return($self,$error_message)","parameters":[{"label":"$self"},{"label":"$error_message"}]},"containerName":"main::","range":{"end":{"line":904,"character":9999},"start":{"line":898,"character":0}},"children":[{"containerName":"log_and_return","localvar":"my","kind":13,"name":"$self","definition":"my","line":899},{"containerName":"log_and_return","name":"$error_message","kind":13,"line":899},{"line":900,"definition":"my","name":"$TID","kind":13,"localvar":"my","containerName":"log_and_return"},{"containerName":"log_and_return","name":"tid","kind":12,"line":900},{"line":901,"kind":13,"name":"$TID","containerName":"log_and_return"},{"line":901,"containerName":"log_and_return","name":"$TID","kind":13},{"containerName":"log_and_return","kind":13,"name":"$logger","line":902},{"line":902,"containerName":"log_and_return","kind":12,"name":"error"},{"line":902,"containerName":"log_and_return","kind":13,"name":"$error_message"}]},{"line":900,"name":"threads","kind":12},{"signature":{"documentation":" This is a one time event to add the global chains to the INPUT and OUTPUT chains\n   This is only called once when the module is first run\n   This is only called if the global rules do not exist","label":"add_global_chains_to_input_output()","parameters":[]},"containerName":"main::","range":{"start":{"character":0,"line":909},"end":{"character":9999,"line":921}},"children":[{"localvar":"my","containerName":"add_global_chains_to_input_output","definition":"my","line":910,"kind":13,"name":"$self"},{"localvar":"my","containerName":"add_global_chains_to_input_output","line":913,"definition":"my","name":"@allowdenyorder","kind":13},{"containerName":"add_global_chains_to_input_output","localvar":"my","line":918,"definition":"my","name":"@builtinchains","kind":13},{"containerName":"add_global_chains_to_input_output","name":"$self","kind":13,"line":919},{"containerName":"add_global_chains_to_input_output","kind":13,"name":"@builtinchains","line":920},{"line":920,"kind":13,"name":"$self","containerName":"add_global_chains_to_input_output"}],"detail":"()","kind":12,"name":"add_global_chains_to_input_output","line":909,"definition":"sub"},{"line":919,"kind":12,"name":"configs"},{"kind":12,"name":"globalchains","line":919},{"line":920,"kind":12,"name":"configs"},{"line":920,"kind":12,"name":"globalchains"},{"containerName":null,"name":"%self","kind":13,"line":926},{"line":926,"name":"configs","kind":12},{"name":"allowdeny","kind":12,"line":926},{"name":"@allowdenyorder","kind":13,"containerName":null,"line":927},{"line":927,"containerName":null,"kind":13,"name":"@allowdenyorder"},{"line":927,"containerName":null,"kind":13,"name":"%self"},{"kind":12,"name":"configs","line":927},{"line":927,"name":"allowdeny","kind":12},{"localvar":"my","containerName":null,"definition":"my","line":936,"kind":13,"name":"$newchain"},{"containerName":null,"kind":13,"name":"@allowdenyorder","line":936},{"containerName":null,"kind":13,"name":"$IptablesQueue","line":939},{"line":939,"containerName":"main::","name":"enqueue","kind":12},{"name":"options","kind":12,"line":941},{"name":"rule","kind":12,"line":942},{"localvar":"my","containerName":null,"definition":"my","line":946,"name":"$builtinchain","kind":13},{"line":946,"containerName":null,"kind":13,"name":"@builtinchains"},{"containerName":null,"localvar":"my","definition":"my","line":947,"kind":13,"name":"$arguments"},{"name":"$IptablesQueue","kind":13,"containerName":null,"line":952},{"containerName":"main::","kind":12,"name":"enqueue","line":952},{"name":"options","kind":12,"line":954},{"kind":12,"name":"rule","line":955},{"line":956,"name":"allowdupes","kind":12},{"name":"deleteexisting","kind":12,"line":957},{"line":968,"definition":"sub","detail":"()","kind":12,"name":"create_iptables_chain","children":[{"name":"$self","kind":13,"definition":"my","line":969,"localvar":"my","containerName":"create_iptables_chain"},{"kind":13,"name":"$name","containerName":"create_iptables_chain","line":969},{"localvar":"my","containerName":"create_iptables_chain","name":"$TID","kind":13,"definition":"my","line":970},{"name":"tid","kind":12,"containerName":"create_iptables_chain","line":970},{"line":972,"containerName":"create_iptables_chain","kind":13,"name":"$logger"},{"containerName":"create_iptables_chain","kind":12,"name":"info","line":972},{"containerName":"create_iptables_chain","kind":13,"name":"$name","line":973},{"line":976,"name":"$logger","kind":13,"containerName":"create_iptables_chain"},{"line":976,"name":"error","kind":12,"containerName":"create_iptables_chain"},{"containerName":"create_iptables_chain","localvar":"my","name":"$rule","kind":13,"line":979,"definition":"my"},{"line":980,"definition":"my","kind":13,"name":"$options","containerName":"create_iptables_chain","localvar":"my"},{"localvar":"my","containerName":"create_iptables_chain","kind":13,"name":"$args","definition":"my","line":981},{"line":981,"containerName":"create_iptables_chain","kind":13,"name":"$rule"},{"containerName":"create_iptables_chain","name":"$options","kind":13,"line":981},{"containerName":"create_iptables_chain","kind":13,"name":"$self","line":983},{"line":983,"containerName":"create_iptables_chain","name":"iptablesqueue_enqueue","kind":12},{"line":983,"containerName":"create_iptables_chain","name":"$args","kind":13}],"range":{"start":{"line":968,"character":0},"end":{"line":985,"character":9999}},"signature":{"parameters":[],"label":"create_iptables_chain()","documentation":" Create iptables chain"},"containerName":"main::"},{"line":970,"name":"threads","kind":12},{"name":"rule","kind":12,"line":981},{"line":981,"kind":12,"name":"options"},{"detail":"()","name":"iptablesqueue_enqueue","kind":12,"line":987,"definition":"sub","signature":{"documentation":"","label":"iptablesqueue_enqueue()","parameters":[]},"containerName":"main::","range":{"end":{"line":1002,"character":9999},"start":{"line":987,"character":0}},"children":[{"containerName":"iptablesqueue_enqueue","localvar":"my","line":988,"definition":"my","kind":13,"name":"$self"},{"containerName":"iptablesqueue_enqueue","kind":13,"name":"$args","line":988},{"definition":"my","line":989,"kind":13,"name":"$TID","containerName":"iptablesqueue_enqueue","localvar":"my"},{"line":989,"containerName":"iptablesqueue_enqueue","kind":12,"name":"tid"},{"line":990,"name":"$TID","kind":13,"containerName":"iptablesqueue_enqueue"},{"line":990,"containerName":"iptablesqueue_enqueue","name":"$TID","kind":13},{"line":991,"kind":13,"name":"$logger","containerName":"iptablesqueue_enqueue"},{"kind":12,"name":"is_debug","containerName":"iptablesqueue_enqueue","line":991},{"containerName":"iptablesqueue_enqueue","localvar":"my","name":"$lastqitem","kind":13,"definition":"my","line":992},{"containerName":"iptablesqueue_enqueue","name":"$IptablesQueue","kind":13,"line":992},{"kind":12,"name":"peek","containerName":"iptablesqueue_enqueue","line":992},{"line":993,"name":"$logger","kind":13,"containerName":"iptablesqueue_enqueue"},{"line":993,"kind":12,"name":"debug","containerName":"iptablesqueue_enqueue"},{"line":993,"name":"$lastqitem","kind":13,"containerName":"iptablesqueue_enqueue"},{"containerName":"iptablesqueue_enqueue","name":"$logger","kind":13,"line":994},{"containerName":"iptablesqueue_enqueue","kind":12,"name":"debug","line":994},{"line":994,"containerName":"iptablesqueue_enqueue","name":"$args","kind":13},{"containerName":"iptablesqueue_enqueue","kind":13,"name":"$IptablesQueue","line":996},{"line":996,"name":"enqueue","kind":12,"containerName":"iptablesqueue_enqueue"},{"containerName":"iptablesqueue_enqueue","name":"$args","kind":13,"line":996},{"name":"$logger","kind":13,"containerName":"iptablesqueue_enqueue","line":997},{"containerName":"iptablesqueue_enqueue","name":"is_debug","kind":12,"line":997},{"definition":"my","line":998,"name":"$lastqitem","kind":13,"containerName":"iptablesqueue_enqueue","localvar":"my"},{"line":998,"containerName":"iptablesqueue_enqueue","kind":13,"name":"$IptablesQueue"},{"containerName":"iptablesqueue_enqueue","kind":12,"name":"peek","line":998},{"name":"$logger","kind":13,"containerName":"iptablesqueue_enqueue","line":999},{"line":999,"kind":12,"name":"debug","containerName":"iptablesqueue_enqueue"},{"containerName":"iptablesqueue_enqueue","name":"$lastqitem","kind":13,"line":999}]},{"line":989,"kind":12,"name":"threads"},{"kind":12,"name":"Dumper","line":993},{"name":"Dumper","kind":12,"line":994},{"line":999,"name":"Dumper","kind":12},{"name":"readlogfile","kind":12,"detail":"($self,$logobj)","line":1009,"definition":"sub","signature":{"parameters":[{"label":"$self"},{"label":"$logobj"}],"documentation":" This function reads the log file into memory from the seek position (if it exists)\n The reading of a log file based on the seek position creates a big issue if the log file is rotated AND is larger than\n   the seek position\n   This is a tradeoff of reading the entire log file into memory and then grepping for the regexps\n Returns: $logobj","label":"readlogfile($self,$logobj)"},"containerName":"main::","range":{"start":{"line":1009,"character":0},"end":{"character":9999,"line":1054}},"children":[{"definition":"my","line":1010,"kind":13,"name":"$self","localvar":"my","containerName":"readlogfile"},{"containerName":"readlogfile","kind":13,"name":"$logobj","line":1010},{"containerName":"readlogfile","localvar":"my","name":"$TID","kind":13,"definition":"my","line":1011},{"line":1011,"kind":12,"name":"tid","containerName":"readlogfile"},{"name":"$TID","kind":13,"containerName":"readlogfile","line":1012},{"containerName":"readlogfile","kind":13,"name":"$TID","line":1012},{"kind":13,"name":"$file","definition":"my","line":1015,"localvar":"my","containerName":"readlogfile"},{"line":1015,"containerName":"readlogfile","kind":13,"name":"$logobj"},{"containerName":"readlogfile","name":"$file","kind":13,"line":1016},{"line":1016,"containerName":"readlogfile","kind":13,"name":"$logger"},{"line":1016,"kind":12,"name":"error","containerName":"readlogfile"},{"containerName":"readlogfile","name":"$logobj","kind":13,"line":1016},{"line":1019,"name":"$logobj","kind":13,"containerName":"readlogfile"},{"line":1020,"containerName":"readlogfile","name":"$logobj","kind":13},{"name":"$file","kind":13,"containerName":"readlogfile","line":1020},{"name":"$logobj","kind":13,"containerName":"readlogfile","line":1020},{"line":1021,"name":"$logobj","kind":13,"containerName":"readlogfile"},{"line":1021,"containerName":"readlogfile","name":"$self","kind":13},{"kind":13,"name":"$logobj","containerName":"readlogfile","line":1022},{"line":1022,"containerName":"readlogfile","name":"$logobj","kind":13},{"line":1024,"name":"$logger","kind":13,"containerName":"readlogfile"},{"line":1024,"containerName":"readlogfile","name":"debug","kind":12},{"definition":"my","line":1030,"kind":13,"name":"$fh","containerName":"readlogfile","localvar":"my"},{"line":1030,"containerName":"readlogfile","kind":13,"name":"$file"},{"containerName":"readlogfile","kind":13,"name":"$logger","line":1031},{"name":"error","kind":12,"containerName":"readlogfile","line":1031},{"containerName":"readlogfile","kind":13,"name":"$logobj","line":1032},{"containerName":"readlogfile","name":"$fh","kind":13,"line":1034},{"kind":13,"name":"$logobj","containerName":"readlogfile","line":1034},{"definition":"my","line":1035,"name":"@logcontents","kind":13,"containerName":"readlogfile","localvar":"my"},{"line":1035,"containerName":"readlogfile","name":"$fh","kind":13},{"kind":13,"name":"$logobj","containerName":"readlogfile","line":1036},{"name":"$fh","kind":13,"containerName":"readlogfile","line":1036},{"containerName":"readlogfile","kind":13,"name":"$fh","line":1037},{"containerName":"readlogfile","kind":13,"name":"@logcontents","line":1039},{"line":1040,"name":"$logger","kind":13,"containerName":"readlogfile"},{"line":1040,"kind":12,"name":"info","containerName":"readlogfile"},{"containerName":"readlogfile","kind":13,"name":"$logobj","line":1041},{"containerName":"readlogfile","kind":13,"name":"$logger","line":1044},{"line":1044,"containerName":"readlogfile","kind":12,"name":"debug"},{"line":1044,"name":"@logcontents","kind":13,"containerName":"readlogfile"},{"containerName":"readlogfile","name":"@logcontents","kind":13,"line":1047},{"containerName":"readlogfile","kind":13,"name":"$logobj","line":1048},{"line":1048,"name":"@logcontents","kind":13,"containerName":"readlogfile"},{"line":1050,"containerName":"readlogfile","name":"$logger","kind":13},{"line":1050,"kind":12,"name":"debug","containerName":"readlogfile"},{"containerName":"readlogfile","kind":13,"name":"@logcontents","line":1050},{"line":1051,"kind":13,"name":"$logger","containerName":"readlogfile"},{"kind":12,"name":"trace","containerName":"readlogfile","line":1051},{"line":1051,"containerName":"readlogfile","name":"$logobj","kind":13},{"name":"$logger","kind":13,"containerName":"readlogfile","line":1051},{"line":1051,"containerName":"readlogfile","name":"is_trace","kind":12},{"containerName":"readlogfile","name":"$logobj","kind":13,"line":1053}]},{"name":"threads","kind":12,"line":1011},{"kind":12,"name":"file","line":1015},{"name":"seek","kind":12,"line":1019},{"line":1020,"kind":12,"name":"seek"},{"line":1020,"kind":12,"name":"seek"},{"line":1021,"kind":12,"name":"readentirefile"},{"line":1021,"name":"configs","kind":12},{"line":1021,"kind":12,"name":"readentirefile"},{"name":"seek","kind":12,"line":1022},{"name":"readentirefile","kind":12,"line":1022},{"kind":12,"name":"seek","line":1034},{"kind":12,"name":"seek","line":1036},{"kind":12,"name":"logcontents","line":1041},{"name":"logcontents","kind":12,"line":1048},{"name":"Dumper","kind":12,"line":1051},{"kind":12,"name":"logcontents","line":1051},{"containerName":"main::","signature":{"documentation":" # This greps for multiple regexps and returns the matchedlines from logobj->{logcontents}\n # Returns an array reference of matched lines\n sub _grep_regexp() {\n     my ( $self, $logobj, $regexps ) = @_;\n     my @matchedlines = ();\n     foreach my $regexp ( sort keys %{$regexps} ) {\n         # my $value = $regexps->{$regexp};\n         my $value = ${$regexps}{$regexp};\n         $logger->info(\"Grep'ing for >>$value<< in $logobj->{file} from byte position $logobj->{seek}\");\n         # @matchedlines = grep { /$value/ } @{ $logobj->{logcontents} };\n         push @matchedlines, grep { /$value/ } @{ $logobj->{logcontents} };\n         $logger->debug( \"Dumper of current matches: \" . Dumper(@matchedlines) ) if ( $logger->is_debug() );\n     } ## end foreach my $regexp ( sort keys...)\n     return \\@matchedlines;\n } ## end sub _grep_regexp\n Description:  Using the logobj, this greps against the log contents for matching lines and then gets the\n               IP address on each line.\n Returns:  Hash reference of IP addresses with count of how many times the IP address was found","label":"_grep_regexps($self,$log)","parameters":[{"label":"$self"},{"label":"$log"}]},"children":[{"containerName":"_grep_regexps","localvar":"my","kind":13,"name":"$self","line":1079,"definition":"my"},{"containerName":"_grep_regexps","name":"$log","kind":13,"line":1079},{"kind":13,"name":"$TID","line":1080,"definition":"my","localvar":"my","containerName":"_grep_regexps"},{"containerName":"_grep_regexps","name":"tid","kind":12,"line":1080},{"containerName":"_grep_regexps","localvar":"my","kind":13,"name":"$matches","line":1082,"definition":"my"},{"containerName":"_grep_regexps","localvar":"my","definition":"my","line":1083,"kind":13,"name":"@log_contents"},{"name":"$log","kind":13,"containerName":"_grep_regexps","line":1083}],"range":{"start":{"line":1078,"character":0},"end":{"line":1083,"character":9999}},"detail":"($self,$log)","name":"_grep_regexps","kind":12,"line":1078,"definition":"sub"},{"line":1080,"kind":12,"name":"threads"},{"name":"logcontents","kind":12,"line":1083},{"definition":"my","line":1086,"kind":13,"name":"$regex","containerName":null,"localvar":"my"},{"line":1086,"kind":13,"name":"%log","containerName":null},{"kind":12,"name":"regexpdeny","line":1086},{"line":1087,"definition":"my","kind":13,"name":"$pattern","containerName":null,"localvar":"my"},{"line":1087,"containerName":null,"kind":13,"name":"%log"},{"name":"regexpdeny","kind":12,"line":1087},{"kind":13,"name":"$regex","containerName":null,"line":1087},{"line":1088,"containerName":null,"kind":13,"name":"$logger"},{"line":1088,"containerName":"main::","kind":12,"name":"info"},{"kind":13,"name":"@current_matches","definition":"my","line":1090,"localvar":"my","containerName":null},{"containerName":null,"name":"@log_contents","kind":13,"line":1090},{"containerName":null,"kind":13,"name":"$logger","line":1091},{"line":1091,"kind":12,"name":"debug","containerName":"main::"},{"line":1091,"kind":12,"name":"Dumper"},{"line":1091,"name":"@current_matches","kind":13,"containerName":null},{"line":1091,"containerName":null,"name":"$logger","kind":13},{"line":1091,"containerName":"main::","name":"is_debug","kind":12},{"name":"$line","kind":13,"definition":"my","line":1093,"containerName":null,"localvar":"my"},{"line":1093,"kind":13,"name":"@current_matches","containerName":null},{"containerName":null,"name":"$line","kind":13,"line":1094},{"line":1095,"containerName":null,"name":"$logger","kind":13},{"line":1095,"containerName":"main::","name":"debug","kind":12},{"definition":"my","line":1097,"name":"$ip_address","kind":13,"localvar":"my","containerName":null},{"line":1097,"kind":13,"name":"$line","containerName":null},{"line":1097,"containerName":null,"kind":13,"name":"%line"},{"line":1098,"containerName":null,"kind":13,"name":"%matches"},{"containerName":null,"kind":13,"name":"$ip_address","line":1098},{"containerName":null,"kind":13,"name":"$logger","line":1099},{"containerName":"main::","name":"debug","kind":12,"line":1099},{"line":1104,"name":"$logger","kind":13,"containerName":null},{"containerName":"main::","name":"debug","kind":12,"line":1104},{"name":"Dumper","kind":12,"line":1104},{"line":1104,"kind":13,"name":"$matches","containerName":null},{"line":1104,"containerName":null,"name":"$logger","kind":13},{"kind":12,"name":"is_debug","containerName":"main::","line":1104},{"localvar":"my","containerName":null,"kind":13,"name":"$log_msg","line":1106,"definition":"my"},{"kind":13,"name":"$log_msg","containerName":null,"line":1107},{"containerName":null,"kind":13,"name":"$matches","line":1107},{"containerName":null,"kind":13,"name":"$logger","line":1108},{"containerName":"main::","name":"info","kind":12,"line":1108},{"line":1108,"name":"$log_msg","kind":13,"containerName":null},{"containerName":null,"name":"$matches","kind":13,"line":1110},{"containerName":"main::","signature":{"parameters":[{"label":"$self"}],"label":"add_global_allow_deny_ips($self)","documentation":" Description:  Adds the IPs to block or accept from the configs globalallow and globaldeny\n Returns:  1"},"children":[{"kind":13,"name":"$self","line":1116,"definition":"my","containerName":"add_global_allow_deny_ips","localvar":"my"},{"definition":"my","line":1117,"name":"$TID","kind":13,"localvar":"my","containerName":"add_global_allow_deny_ips"},{"containerName":"add_global_allow_deny_ips","name":"tid","kind":12,"line":1117},{"kind":13,"name":"$logger","containerName":"add_global_allow_deny_ips","line":1118},{"line":1118,"containerName":"add_global_allow_deny_ips","name":"debug","kind":12},{"localvar":"my","containerName":"add_global_allow_deny_ips","kind":13,"name":"%ip_rules","definition":"my","line":1120},{"line":1121,"kind":13,"name":"$self","containerName":"add_global_allow_deny_ips"},{"name":"$self","kind":13,"containerName":"add_global_allow_deny_ips","line":1122},{"name":"$logger","kind":13,"containerName":"add_global_allow_deny_ips","line":1125},{"line":1125,"name":"debug","kind":12,"containerName":"add_global_allow_deny_ips"},{"line":1125,"kind":13,"name":"%ip_rules","containerName":"add_global_allow_deny_ips"},{"containerName":"add_global_allow_deny_ips","name":"$logger","kind":13,"line":1125},{"containerName":"add_global_allow_deny_ips","kind":12,"name":"is_debug","line":1125},{"containerName":"add_global_allow_deny_ips","localvar":"my","name":"$action","kind":13,"definition":"my","line":1127},{"kind":13,"name":"%ip_rules","containerName":"add_global_allow_deny_ips","line":1127},{"localvar":"my","containerName":"add_global_allow_deny_ips","definition":"my","line":1128,"name":"$chain","kind":13},{"containerName":"add_global_allow_deny_ips","name":"$action","kind":13,"line":1128},{"containerName":"add_global_allow_deny_ips","localvar":"my","line":1129,"definition":"my","name":"$rule_action","kind":13},{"line":1129,"name":"$action","kind":13,"containerName":"add_global_allow_deny_ips"},{"localvar":"my","containerName":"add_global_allow_deny_ips","name":"$ruleorder","kind":13,"line":1130,"definition":"my"},{"kind":13,"name":"$ip_rules","containerName":"add_global_allow_deny_ips","line":1130},{"line":1130,"containerName":"add_global_allow_deny_ips","name":"$action","kind":13},{"definition":"my","line":1131,"kind":13,"name":"$ip","localvar":"my","containerName":"add_global_allow_deny_ips"},{"kind":13,"name":"$ip_rules","containerName":"add_global_allow_deny_ips","line":1131},{"name":"$action","kind":13,"containerName":"add_global_allow_deny_ips","line":1131},{"line":1131,"kind":13,"name":"$ruleorder","containerName":"add_global_allow_deny_ips"},{"containerName":"add_global_allow_deny_ips","localvar":"my","line":1132,"definition":"my","name":"$direction","kind":13},{"localvar":"my","containerName":"add_global_allow_deny_ips","name":"$rule","kind":13,"definition":"my","line":1134},{"containerName":"add_global_allow_deny_ips","localvar":"my","definition":"my","line":1135,"kind":13,"name":"$args"},{"kind":13,"name":"$rule","containerName":"add_global_allow_deny_ips","line":1135},{"line":1137,"containerName":"add_global_allow_deny_ips","name":"$logger","kind":13},{"line":1137,"name":"debug","kind":12,"containerName":"add_global_allow_deny_ips"},{"line":1138,"kind":13,"name":"$self","containerName":"add_global_allow_deny_ips"},{"line":1138,"containerName":"add_global_allow_deny_ips","name":"iptablesqueue_enqueue","kind":12},{"line":1138,"containerName":"add_global_allow_deny_ips","kind":13,"name":"$args"}],"range":{"start":{"character":0,"line":1115},"end":{"character":9999,"line":1141}},"detail":"($self)","kind":12,"name":"add_global_allow_deny_ips","definition":"sub","line":1115},{"line":1117,"name":"threads","kind":12},{"name":"allow","kind":12,"line":1121},{"line":1121,"kind":12,"name":"configs"},{"line":1121,"name":"allowlist","kind":12},{"name":"deny","kind":12,"line":1122},{"line":1122,"kind":12,"name":"configs"},{"kind":12,"name":"denylist","line":1122},{"name":"Dumper","kind":12,"line":1125},{"line":1135,"name":"rule","kind":12},{"line":1135,"kind":12,"name":"options"},{"name":"stop","kind":12,"detail":"()","definition":"sub","line":1149,"signature":{"documentation":" Stops the module\n  Future enhancements:\n   Clear the thread queues","label":"stop()","parameters":[]},"containerName":"main::","children":[{"definition":"my","line":1150,"name":"$self","kind":13,"containerName":"stop","localvar":"my"},{"line":1151,"name":"$logger","kind":13,"containerName":"stop"},{"line":1151,"kind":12,"name":"info","containerName":"stop"},{"line":1154,"kind":13,"name":"$self","containerName":"stop"},{"name":"$logger","kind":13,"containerName":"stop","line":1155},{"line":1155,"containerName":"stop","kind":12,"name":"info"},{"localvar":"my","containerName":"stop","line":1156,"definition":"my","kind":13,"name":"$chain"},{"containerName":"stop","kind":13,"name":"$self","line":1156},{"name":"$logger","kind":13,"containerName":"stop","line":1157},{"line":1157,"containerName":"stop","kind":12,"name":"info"},{"line":1158,"kind":13,"name":"$IptablesQueue","containerName":"stop"},{"line":1158,"containerName":"stop","kind":12,"name":"enqueue"}],"range":{"end":{"line":1165,"character":9999},"start":{"line":1149,"character":0}}},{"kind":12,"name":"chains_created","line":1154},{"kind":12,"name":"chains_created","line":1156},{"name":"options","kind":12,"line":1160},{"line":1161,"kind":12,"name":"rule"},{"kind":13,"name":"$logger","containerName":null,"line":1167},{"containerName":"main::","name":"info","kind":12,"line":1167},{"line":1170,"containerName":null,"kind":13,"name":"$logger"},{"kind":12,"name":"info","containerName":"main::","line":1170},{"line":1171,"kind":12,"name":"clear_queues"},{"name":"$logger","kind":13,"containerName":null,"line":1171},{"line":1171,"name":"error","kind":12,"containerName":"main::"},{"name":"$logger","kind":13,"containerName":null,"line":1172},{"line":1172,"containerName":"main::","kind":12,"name":"info"},{"name":"join_threads","kind":12,"line":1173},{"containerName":null,"name":"$logger","kind":13,"line":1173},{"containerName":"main::","kind":12,"name":"error","line":1173},{"line":1175,"name":"$logger","kind":13,"containerName":null},{"containerName":"main::","kind":12,"name":"info","line":1175},{"line":1176,"name":"$lock_obj","kind":13,"containerName":null},{"line":1176,"containerName":"main::","kind":12,"name":"release"},{"line":1177,"containerName":null,"name":"$logger","kind":13},{"line":1177,"containerName":"main::","name":"info","kind":12},{"containerName":"main::","signature":{"parameters":[],"documentation":" Joins all threads\n   Simple sub but really needs some rework\n   If a thread is taking a while to join then it will block the other threads from joining\n   Some of the threads could be reading a log file and if the log file is large then it could take a while or\n   if the log file is causing soem kind of blocking for reading then it could take a while.\n   This may be an issue, if an example, if trying to read a file across NFS or SSHFS and there is a network issue.","label":"join_threads()"},"children":[{"containerName":"join_threads","name":"$logger","kind":13,"line":1187},{"line":1187,"name":"debug","kind":12,"containerName":"join_threads"},{"containerName":"join_threads","name":"join","kind":12,"line":1188},{"line":1188,"kind":12,"name":"list","containerName":"join_threads"}],"range":{"start":{"character":0,"line":1186},"end":{"character":9999,"line":1190}},"name":"join_threads","kind":12,"detail":"()","definition":"sub","line":1186},{"kind":12,"name":"threads","line":1188},{"detail":"()","kind":12,"name":"clear_queues","definition":"sub","line":1193,"containerName":"main::","signature":{"parameters":[],"label":"clear_queues()","documentation":" Clears the queues"},"range":{"start":{"character":0,"line":1193},"end":{"character":9999,"line":1211}},"children":[{"line":1194,"kind":13,"name":"$logger","containerName":"clear_queues"},{"kind":12,"name":"debug","containerName":"clear_queues","line":1194},{"line":1195,"name":"$DataQueue","kind":13,"containerName":"clear_queues"},{"line":1195,"name":"end","kind":12,"containerName":"clear_queues"},{"name":"$IptablesQueue","kind":13,"containerName":"clear_queues","line":1196},{"containerName":"clear_queues","name":"end","kind":12,"line":1196},{"line":1197,"kind":13,"name":"$DataQueue","containerName":"clear_queues"},{"line":1197,"containerName":"clear_queues","kind":12,"name":"pending"},{"line":1197,"kind":13,"name":"$IptablesQueue","containerName":"clear_queues"},{"containerName":"clear_queues","kind":12,"name":"pending","line":1197},{"containerName":"clear_queues","kind":13,"name":"$DataQueue","line":1198},{"line":1198,"containerName":"clear_queues","kind":12,"name":"pending"},{"kind":13,"name":"$logger","containerName":"clear_queues","line":1198},{"line":1198,"containerName":"clear_queues","kind":12,"name":"debug"},{"line":1199,"kind":13,"name":"$IptablesQueue","containerName":"clear_queues"},{"kind":12,"name":"pending","containerName":"clear_queues","line":1199},{"line":1199,"containerName":"clear_queues","kind":13,"name":"$logger"},{"name":"debug","kind":12,"containerName":"clear_queues","line":1199},{"containerName":"clear_queues","name":"$DataQueue","kind":13,"line":1203},{"line":1203,"kind":12,"name":"pending","containerName":"clear_queues"},{"line":1203,"name":"$IptablesQueue","kind":13,"containerName":"clear_queues"},{"name":"pending","kind":12,"containerName":"clear_queues","line":1203},{"line":1204,"containerName":"clear_queues","name":"$logger","kind":13},{"line":1204,"name":"error","kind":12,"containerName":"clear_queues"},{"name":"$logger","kind":13,"containerName":"clear_queues","line":1208},{"containerName":"clear_queues","kind":12,"name":"debug","line":1208}]},{"children":[{"name":"$logger","kind":13,"containerName":"reload","line":1214},{"line":1214,"containerName":"reload","kind":12,"name":"info"}],"range":{"end":{"line":1238,"character":9999},"start":{"character":0,"line":1213}},"containerName":"main::","signature":{"parameters":[],"documentation":"","label":"reload()"},"line":1213,"definition":"sub","detail":"()","name":"reload","kind":12},{"kind":12,"name":"SIG_INT","line":1242,"definition":"sub","containerName":"main::","range":{"start":{"character":0,"line":1242},"end":{"character":9999,"line":1246}},"children":[{"line":1243,"containerName":"SIG_INT","name":"$logger","kind":13},{"line":1243,"kind":12,"name":"info","containerName":"SIG_INT"}]},{"kind":12,"name":"SIG_HUP","definition":"sub","line":1250,"containerName":"main::","children":[{"kind":13,"name":"$logger","containerName":"SIG_HUP","line":1251},{"kind":12,"name":"info","containerName":"SIG_HUP","line":1251}],"range":{"end":{"character":9999,"line":1253},"start":{"line":1250,"character":0}}},{"children":[{"containerName":"SIG_TERM","kind":13,"name":"$logger","line":1258},{"containerName":"SIG_TERM","name":"info","kind":12,"line":1258}],"range":{"start":{"character":0,"line":1257},"end":{"character":9999,"line":1260}},"containerName":"main::","definition":"sub","line":1257,"kind":12,"name":"SIG_TERM"},{"range":{"end":{"line":1267,"character":9999},"start":{"character":0,"line":1264}},"children":[{"localvar":"my","containerName":"SIG_QUIT","line":1265,"definition":"my","name":"$self","kind":13}],"containerName":"main::","line":1264,"definition":"sub","name":"SIG_QUIT","kind":12},{"children":[{"line":1270,"kind":13,"name":"$logger","containerName":"set_signal_handler"},{"containerName":"set_signal_handler","kind":12,"name":"info","line":1270},{"containerName":"set_signal_handler","kind":13,"name":"$SIG","line":1272},{"line":1273,"name":"$SIG","kind":13,"containerName":"set_signal_handler"},{"line":1274,"containerName":"set_signal_handler","kind":13,"name":"$SIG"},{"kind":13,"name":"$SIG","containerName":"set_signal_handler","line":1275}],"range":{"end":{"character":9999,"line":1276},"start":{"line":1269,"character":0}},"containerName":"main::","signature":{"label":"set_signal_handler()","documentation":"","parameters":[]},"line":1269,"definition":"sub","detail":"()","kind":12,"name":"set_signal_handler"},{"line":1272,"name":"INT","kind":12},{"line":1273,"name":"TERM","kind":12},{"kind":12,"name":"HUP","line":1274},{"kind":12,"name":"QUIT","line":1275}],"version":5}